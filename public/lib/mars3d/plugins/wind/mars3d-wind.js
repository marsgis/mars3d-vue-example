/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.10.5
 * 编译日期：2025-09-16 22:06
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-07-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x28b140,_0x2ef27c){function _0x5e3f35(_0x34977c,_0x430d98){return _0x3a86(_0x430d98-0x1a9,_0x34977c);}const _0x509a38=_0x28b140();function _0x525b5a(_0x15dd6f,_0x7cf1af){return _0x3a86(_0x7cf1af-0xd5,_0x15dd6f);}while(!![]){try{const _0x52beb2=parseInt(_0x5e3f35(0x422,0x3a7))/0x1*(-parseInt(_0x525b5a(0x196,0x1bf))/0x2)+parseInt(_0x525b5a(0x1b9,0x21b))/0x3*(parseInt(_0x525b5a(0x1d6,0x1e9))/0x4)+parseInt(_0x5e3f35(0x333,0x307))/0x5*(-parseInt(_0x5e3f35(0x350,0x325))/0x6)+-parseInt(_0x5e3f35(0x2e4,0x366))/0x7*(-parseInt(_0x5e3f35(0x307,0x2a7))/0x8)+parseInt(_0x5e3f35(0x341,0x347))/0x9*(-parseInt(_0x525b5a(0x323,0x29b))/0xa)+-parseInt(_0x525b5a(0x275,0x27c))/0xb+parseInt(_0x5e3f35(0x314,0x346))/0xc;if(_0x52beb2===_0x2ef27c)break;else _0x509a38['push'](_0x509a38['shift']());}catch(_0x4988f9){_0x509a38['push'](_0x509a38['shift']());}}}(_0x2672,0x2a73c));function _interopNamespace(_0x3819a7){function _0x857b03(_0x2ce6fb,_0x45dbae){return _0x3a86(_0x2ce6fb-0x12,_0x45dbae);}if(_0x3819a7&&_0x3819a7[_0x857b03(0x117,0x9a)])return _0x3819a7;function _0x53f5bf(_0x1b6cff,_0x1cbaf5){return _0x3a86(_0x1b6cff-0x1c3,_0x1cbaf5);}var _0x585bd0=Object[_0x857b03(0x1a2,0x136)](null);return _0x3819a7&&Object[_0x857b03(0x182,0x11b)](_0x3819a7)[_0x53f5bf(0x320,0x2c3)](function(_0x5ab246){function _0x30af5c(_0x27c3a7,_0x122f0b){return _0x857b03(_0x27c3a7- -0x91,_0x122f0b);}if(_0x5ab246!=='default'){var _0x1e48b4=Object['getOwnPropertyDescriptor'](_0x3819a7,_0x5ab246);Object['defineProperty'](_0x585bd0,_0x5ab246,_0x1e48b4[_0x30af5c(0x148,0x12c)]?_0x1e48b4:{'enumerable':!![],'get':function(){return _0x3819a7[_0x5ab246];}});}}),_0x585bd0[_0x857b03(0x1d3,0x185)]=_0x3819a7,_0x585bd0;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace[_0x99d407(0x2f6,0x26c)];function getU(_0x5c8d80,_0x23cb50){const _0x297621=_0x5c8d80*Math['cos'](Cesium$2[_0x33134d(-0x197,-0x177)]['toRadians'](_0x23cb50));function _0x33134d(_0x47a05b,_0x3bd468){return _0x99d407(_0x3bd468,_0x47a05b- -0x4aa);}return _0x297621;}function getV(_0x35b1e3,_0x41a323){function _0x268eae(_0x471b91,_0x1791cf){return _0x99d407(_0x471b91,_0x1791cf- -0x3d);}const _0x2f231e=_0x35b1e3*Math[_0x268eae(0x2bd,0x2a7)](Cesium$2[_0x268eae(0x277,0x2d6)]['toRadians'](_0x41a323));function _0x5f3287(_0x43e0d5,_0x3d2c75){return _0x99d407(_0x3d2c75,_0x43e0d5- -0x381);}return _0x2f231e;}function getSpeed(_0x596c2c,_0x5d5955){function _0xa33ff0(_0xc4b8bb,_0x23e857){return _0x99d407(_0xc4b8bb,_0x23e857- -0x451);}const _0x2ee8d6=Math['sqrt'](Math[_0xa33ff0(-0xf3,-0x175)](_0x596c2c,0x2)+Math['pow'](_0x5d5955,0x2));return _0x2ee8d6;}function getDirection(_0xbb9cf3,_0x26a41a){let _0x14326e=Cesium$2[_0x4c6fd3(0x52f,0x4e0)][_0x5a7d3f(0x3e7,0x373)](Math[_0x4c6fd3(0x4b9,0x47e)](_0x26a41a,_0xbb9cf3));_0x14326e+=_0x14326e<0x0?0x168:0x0;function _0x4c6fd3(_0x2069ad,_0x3a49ab){return _0x99d407(_0x2069ad,_0x3a49ab-0x1cd);}function _0x5a7d3f(_0x48ba49,_0x1a23ad){return _0x99d407(_0x48ba49,_0x1a23ad-0x22);}return _0x14326e;}const _0x499d09={};_0x499d09['__proto__']=null,_0x499d09[_0x99d407(0x34a,0x32f)]=getU,_0x499d09['getV']=getV,_0x499d09['getSpeed']=getSpeed,_0x499d09['getDirection']=getDirection;var WindUtil=_0x499d09,updatePositionShader=_0x557a97(-0xba,-0xea),calculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader=_0x99d407(0x334,0x369),renderParticlesVertexShader=_0x557a97(-0x169,-0x151);const {ShaderSource:ShaderSource$1}=mars3d__namespace[_0x557a97(-0x23e,-0x1c5)];class ShaderManager{static['getCalculateSpeedShader'](){const _0x576952={};return _0x576952['sources']=[calculateSpeedShader],new ShaderSource$1(_0x576952);}static[_0x99d407(0x24a,0x2b4)](){const _0x418837={};return _0x418837['sources']=[updatePositionShader],new ShaderSource$1(_0x418837);}static['getSegmentDrawVertexShader'](){const _0x19f12a={};_0x19f12a[_0x31de06(-0x1cb,-0x215)]=[renderParticlesVertexShader];function _0x31de06(_0x3f8a65,_0x2c3219){return _0x557a97(_0x3f8a65,_0x2c3219- -0x6a);}return new ShaderSource$1(_0x19f12a);}static[_0x99d407(0x212,0x28b)](){const _0x1c784b={};function _0x399f9e(_0x49c7f6,_0x3ae5b7){return _0x99d407(_0x49c7f6,_0x3ae5b7-0x18e);}return _0x1c784b[_0x399f9e(0x39c,0x414)]=[renderParticlesFragmentShader],new ShaderSource$1(_0x1c784b);}static['getPostProcessingPositionShader'](){const _0x1fdc03={};function _0x675158(_0x50b6ac,_0x2e2543){return _0x557a97(_0x2e2543,_0x50b6ac-0x27b);}return _0x1fdc03[_0x675158(0xd0,0x120)]=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x1fdc03);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace[_0x99d407(0x213,0x26c)];class CustomPrimitive{constructor(_0x4cb6c0){this['commandType']=_0x4cb6c0['commandType'],this[_0x5bf63f(0x391,0x378)]=_0x4cb6c0[_0x5bf63f(0x32a,0x378)],this[_0x5bf63f(0x45f,0x419)]=_0x4cb6c0[_0x4c48a5(-0x130,-0xc0)],this['primitiveType']=_0x4cb6c0['primitiveType'],this['uniformMap']=_0x4cb6c0[_0x4c48a5(-0x16f,-0x15d)]||{},this['vertexShaderSource']=_0x4cb6c0['vertexShaderSource'],this['fragmentShaderSource']=_0x4cb6c0['fragmentShaderSource'];function _0x4c48a5(_0x5235aa,_0x2c7d59){return _0x557a97(_0x5235aa,_0x2c7d59-0x32);}this['rawRenderState']=_0x4cb6c0['rawRenderState'];function _0x5bf63f(_0x5ddfd7,_0x498bb5){return _0x557a97(_0x5ddfd7,_0x498bb5-0x50b);}this[_0x5bf63f(0x341,0x37f)]=_0x4cb6c0[_0x4c48a5(-0xde,-0x15a)],this[_0x5bf63f(0x410,0x3ac)]=_0x4cb6c0['outputTexture'],this['autoClear']=_0x4cb6c0['autoClear']??![],this['preExecute']=_0x4cb6c0[_0x4c48a5(-0xff,-0x122)],this[_0x4c48a5(-0x61,-0xbf)]=!![],this[_0x4c48a5(-0x69,-0xb9)]=undefined,this[_0x5bf63f(0x451,0x447)]=undefined,this[_0x5bf63f(0x422,0x411)]=_0x4cb6c0['isDynamic']??(()=>!![]),this['autoClear']&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x4c48a5(-0x18f,-0x15a)],'pass':Pass$1['OPAQUE']}));}['createCommand'](_0x3bac67){function _0x4e9124(_0x2e2eee,_0x4ec636){return _0x557a97(_0x2e2eee,_0x4ec636-0x5fe);}function _0x1feb40(_0x4c073b,_0x380ff2){return _0x99d407(_0x380ff2,_0x4c073b- -0x439);}if(this[_0x1feb40(-0x1af,-0x171)]===_0x1feb40(-0x160,-0x132)){const _0x565c56={};_0x565c56[_0x4e9124(0x4ee,0x547)]=_0x3bac67,_0x565c56['geometry']=this[_0x1feb40(-0x19b,-0x14a)],_0x565c56['attributeLocations']=this[_0x1feb40(-0xfa,-0x85)],_0x565c56['bufferUsage']=BufferUsage$1['STATIC_DRAW'];const _0xce4495=VertexArray$1['fromGeometry'](_0x565c56),_0x42fec6={};_0x42fec6[_0x1feb40(-0xbf,-0x148)]=_0x3bac67,_0x42fec6['vertexShaderSource']=this[_0x1feb40(-0x127,-0x1ae)],_0x42fec6['fragmentShaderSource']=this[_0x1feb40(-0x1b1,-0x1b3)],_0x42fec6['attributeLocations']=this[_0x4e9124(0x51d,0x50c)];const _0x2eee95=ShaderProgram['fromCache'](_0x42fec6),_0x57ad77=RenderState['fromCache'](this[_0x4e9124(0x530,0x4c0)]),_0x292856={};return _0x292856['owner']=this,_0x292856['vertexArray']=_0xce4495,_0x292856[_0x4e9124(0x4bd,0x535)]=this['primitiveType'],_0x292856['modelMatrix']=Matrix4['IDENTITY'],_0x292856['renderState']=_0x57ad77,_0x292856['shaderProgram']=_0x2eee95,_0x292856['framebuffer']=this[_0x4e9124(0x487,0x472)],_0x292856['uniformMap']=this[_0x1feb40(-0x197,-0x1d0)],_0x292856[_0x4e9124(0x4b3,0x4ec)]=Pass$1[_0x1feb40(-0xe2,-0x92)],new DrawCommand(_0x292856);}else{if(this[_0x4e9124(0x4c1,0x457)]==='Compute'){const _0x412f57={};return _0x412f57[_0x1feb40(-0x1c7,-0x1c5)]=this,_0x412f57[_0x4e9124(0x3fe,0x455)]=this[_0x4e9124(0x4a3,0x455)],_0x412f57[_0x4e9124(0x435,0x46f)]=this['uniformMap'],_0x412f57['outputTexture']=this['outputTexture'],_0x412f57['persists']=!![],new ComputeCommand(_0x412f57);}else throw new Error('Unknown\x20command\x20type');}}['setGeometry'](_0x3ee53f,_0x230c2b){this['geometry']=_0x230c2b;function _0x220e4e(_0x4db8e4,_0x1ce85c){return _0x99d407(_0x4db8e4,_0x1ce85c- -0x3f2);}function _0x582a14(_0x39ce29,_0xc94771){return _0x99d407(_0x39ce29,_0xc94771- -0x4dd);}defined(this['commandToExecute'])&&(this['commandToExecute'][_0x220e4e(-0x77,-0xd6)]=VertexArray$1[_0x220e4e(-0x1e6,-0x18e)]({'context':_0x3ee53f,'geometry':this[_0x220e4e(-0x1a8,-0x154)],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1[_0x220e4e(-0x87,-0x88)]}));}[_0x99d407(0x329,0x360)](_0x346c1f){if(!this['isDynamic']())return;if(!this['show']||!defined(_0x346c1f))return;!defined(this[_0x4e9cfb(0x332,0x332)])&&(this['commandToExecute']=this['createCommand'](_0x346c1f[_0x4e9cfb(0x366,0x3e9)]));function _0x4e9cfb(_0x24a2b9,_0x575f01){return _0x557a97(_0x575f01,_0x24a2b9-0x41d);}defined(this['preExecute'])&&this[_0x28c36e(0x35a,0x395)]();function _0x28c36e(_0x4f4488,_0x46d5e9){return _0x557a97(_0x4f4488,_0x46d5e9-0x4e9);}if(!_0x346c1f['commandList']){console['warn'](_0x4e9cfb(0x25c,0x29a));return;}defined(this['clearCommand'])&&_0x346c1f['commandList']['push'](this['clearCommand']),defined(this[_0x28c36e(0x3b8,0x3fe)])&&_0x346c1f['commandList'][_0x4e9cfb(0x329,0x34e)](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){function _0x449e98(_0x3cb7a1,_0x7e8d5c){return _0x99d407(_0x3cb7a1,_0x7e8d5c- -0x2bd);}if(defined(this[_0x449e98(0x65,0x89)])){var _0x1dc2ca;(_0x1dc2ca=this[_0x449e98(0x42,0x89)]['shaderProgram'])===null||_0x1dc2ca===void 0x0||_0x1dc2ca[_0x4fa896(-0x141,-0xc2)](),this['commandToExecute'][_0x449e98(-0xc8,-0x44)]=undefined;}function _0x4fa896(_0x4d3cb3,_0x29c3d1){return _0x99d407(_0x4d3cb3,_0x29c3d1- -0x32a);}return destroyObject(this);}}function deepMerge(_0x25ab0c,_0x13a040){function _0x3daeb4(_0x50e25f,_0x2f1aa5){return _0x99d407(_0x2f1aa5,_0x50e25f-0x14b);}if(!_0x25ab0c)return _0x13a040;if(!_0x13a040)return _0x25ab0c;const _0x1f171e={..._0x13a040};function _0x54f348(_0x4cdc25,_0x289e7f){return _0x99d407(_0x4cdc25,_0x289e7f- -0x1e8);}const _0x40e44c=_0x1f171e;for(const _0x3e8859 in _0x25ab0c){if(Object['prototype']['hasOwnProperty'][_0x3daeb4(0x459,0x4c5)](_0x25ab0c,_0x3e8859)){const _0x3de2aa=_0x25ab0c[_0x3e8859],_0x27af9=_0x13a040[_0x3e8859];if(Array['isArray'](_0x3de2aa)){_0x40e44c[_0x3e8859]=_0x3de2aa['slice']();continue;}if(_0x3de2aa&&typeof _0x3de2aa===_0x3daeb4(0x3b6,0x363)){_0x40e44c[_0x3e8859]=deepMerge(_0x3de2aa,_0x27af9||{});continue;}_0x3de2aa!==undefined&&(_0x40e44c[_0x3e8859]=_0x3de2aa);}}return _0x40e44c;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace['Cesium'];class WindParticlesComputing{constructor(_0x25ef8a,_0x14e3a2,_0x44bf06,_0x2d4e61,_0x589d3a){this['context']=_0x25ef8a;function _0x16e5bf(_0x19daa0,_0xc86bee){return _0x99d407(_0xc86bee,_0x19daa0- -0x78);}this['options']=_0x44bf06,this['viewerParameters']=_0x2d4e61,this[_0x136bc0(0x2aa,0x313)]=_0x14e3a2;function _0x136bc0(_0x362b54,_0x391927){return _0x557a97(_0x391927,_0x362b54-0x3aa);}this['frameRate']=0x3c,this[_0x136bc0(0x2d2,0x351)]=0x1;const _0x426a83={};_0x426a83['scene']=_0x589d3a,_0x426a83[_0x16e5bf(0x276,0x1f0)]=0x1,_0x426a83['quietPeriod']=0x0,this['frameRateMonitor']=new FrameRateMonitor(_0x426a83),this['initFrameRate'](),this[_0x136bc0(0x28a,0x30a)](),this['createParticlesTextures'](),this[_0x136bc0(0x2c6,0x306)]();}['initFrameRate'](){const _0x25d30e=()=>{function _0x508bd0(_0x32c88f,_0x2432d9){return _0x3a86(_0x2432d9- -0x13a,_0x32c88f);}function _0x13769e(_0x580fca,_0x671bb7){return _0x3a86(_0x580fca-0x3ba,_0x671bb7);}this[_0x13769e(0x501,0x540)]['lastFramesPerSecond']>0x14&&(this['frameRate']=this['frameRateMonitor']['lastFramesPerSecond'],this['frameRateAdjustment']=0x3c/Math[_0x13769e(0x4e0,0x53d)](this['frameRate'],0x1));};_0x25d30e();const _0x39a992=setInterval(_0x25d30e,0x3e8),_0x333916=this['destroy']['bind'](this);this['destroy']=()=>{clearInterval(_0x39a992),_0x333916();};}['createWindTextures'](){function _0x19e6ef(_0x28653d,_0x21f399){return _0x557a97(_0x28653d,_0x21f399-0x71);}const _0x28939f={};function _0x3955ec(_0x323445,_0x2f88f9){return _0x99d407(_0x323445,_0x2f88f9- -0xf9);}_0x28939f['minificationFilter']=TextureMinificationFilter$1[_0x19e6ef(-0xdf,-0x14a)],_0x28939f['magnificationFilter']=TextureMagnificationFilter$1[_0x19e6ef(-0xd0,-0x14a)];const _0x2c87d5={'context':this[_0x3955ec(0x242,0x281)],'width':this['windData']['width'],'height':this[_0x19e6ef(-0x7b,-0x8f)]['height'],'pixelFormat':PixelFormat$1['RED'],'pixelDatatype':PixelDatatype$1[_0x3955ec(0x1d2,0x1d4)],'flipY':this[_0x19e6ef(-0x6f,-0x68)][_0x19e6ef(-0xd3,-0xc1)]??![],'sampler':new Sampler$1(_0x28939f)};this[_0x3955ec(0x27e,0x230)]={'U':new Texture$1({..._0x2c87d5,'source':{'arrayBufferView':new Float32Array(this['windData']['u'][_0x3955ec(0x225,0x1a1)])}}),'V':new Texture$1({..._0x2c87d5,'source':{'arrayBufferView':new Float32Array(this['windData']['v']['array'])}})};}[_0x99d407(0x2aa,0x2a7)](){function _0x52973a(_0x54fcc4,_0x286eb0){return _0x99d407(_0x286eb0,_0x54fcc4- -0x1d);}const _0x2464b4={};_0x2464b4['minificationFilter']=TextureMinificationFilter$1[_0x1314c0(0x432,0x476)],_0x2464b4[_0x1314c0(0x44f,0x44e)]=TextureMagnificationFilter$1['NEAREST'];function _0x1314c0(_0xdca62b,_0xc347ef){return _0x557a97(_0xdca62b,_0xc347ef-0x5cf);}const _0x6d44b5={'context':this['context'],'width':this[_0x1314c0(0x50f,0x4f6)][_0x1314c0(0x45d,0x4bb)],'height':this['options']['particlesTextureSize'],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':![],'source':{'arrayBufferView':new Float32Array(this[_0x1314c0(0x560,0x4f6)]['particlesTextureSize']*this[_0x52973a(0x33b,0x3b6)]['particlesTextureSize']*0x4)[_0x52973a(0x249,0x24b)](0x0)},'sampler':new Sampler$1(_0x2464b4)};this['particlesTextures']={'previousParticlesPosition':new Texture$1(_0x6d44b5),'currentParticlesPosition':new Texture$1(_0x6d44b5),'nextParticlesPosition':new Texture$1(_0x6d44b5),'postProcessingPosition':new Texture$1(_0x6d44b5),'particlesSpeed':new Texture$1(_0x6d44b5)};}[_0x557a97(-0x46,-0xd2)](){Object['values'](this['particlesTextures'])['forEach'](_0x4c9f1b=>_0x4c9f1b['destroy']());}['createComputingPrimitives'](){function _0x27b7f3(_0x30ea91,_0x19b7b1){return _0x557a97(_0x30ea91,_0x19b7b1-0x331);}function _0x4e3814(_0x135126,_0x42a3c1){return _0x557a97(_0x135126,_0x42a3c1-0x423);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':()=>this[_0x27b7f3(0x25a,0x229)]['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this[_0x27b7f3(0x278,0x231)]['u']['min'],this['windData']['u']['max']),'vRange':()=>new Cartesian2$1(this['windData']['v']['min'],this['windData']['v']['max']),'speedRange':()=>new Cartesian2$1(this['windData'][_0x4e3814(0x2e1,0x276)]['min'],this[_0x4e3814(0x37c,0x323)]['speed'][_0x27b7f3(0x12c,0x1a3)]),'currentParticlesPosition':()=>this[_0x27b7f3(0x25f,0x264)]['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x3845cd(_0x425e7e,_0x4af166){return _0x4e3814(_0x4af166,_0x425e7e-0x91);}function _0x4e3395(_0x1a517e,_0x5971c3){return _0x4e3814(_0x5971c3,_0x1a517e- -0x544);}return(this[_0x4e3395(-0x252,-0x27e)]['pixelSize']+0x32)*this['options'][_0x3845cd(0x341,0x394)];},'frameRateAdjustment':()=>this['frameRateAdjustment'],'dimension':()=>new Cartesian2$1(this[_0x27b7f3(0x1a9,0x231)]['width'],this[_0x4e3814(0x2d7,0x323)][_0x27b7f3(0x191,0x1c5)]),'minimum':()=>new Cartesian2$1(this['windData']['bounds']['west'],this['windData']['bounds'][_0x27b7f3(0x18c,0x185)]),'maximum':()=>new Cartesian2$1(this['windData']['bounds']['east'],this['windData']['bounds']['north'])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{const _0x2b3943=this[_0xba5641(0x35,-0x1e)][_0xba5641(-0x88,-0x99)];this['particlesTextures'][_0xba5641(-0xc6,-0x99)]=this[_0xba5641(0x62,-0x1e)]['currentParticlesPosition'];function _0x528b06(_0x48be8c,_0x4f6bb9){return _0x27b7f3(_0x4f6bb9,_0x48be8c-0x263);}this['particlesTextures'][_0xba5641(-0xe9,-0xf4)]=this['particlesTextures'][_0xba5641(-0x131,-0xe7)];function _0xba5641(_0x2968c4,_0x4c6156){return _0x27b7f3(_0x2968c4,_0x4c6156- -0x282);}this[_0x528b06(0x4c7,0x485)]['postProcessingPosition']=_0x2b3943,this['primitives'][_0xba5641(-0x1a8,-0x11d)]['commandToExecute']&&(this[_0x528b06(0x419,0x448)]['calculateSpeed']['commandToExecute']['outputTexture']=this['particlesTextures'][_0x528b06(0x4b8,0x456)]);},'isDynamic':()=>this[_0x27b7f3(0x26d,0x258)][_0x27b7f3(0x255,0x222)]}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this[_0x4e3814(0x366,0x356)]['currentParticlesPosition'],'particlesSpeed':()=>this['particlesTextures'][_0x27b7f3(0x2c3,0x255)]},'fragmentShaderSource':ShaderManager[_0x27b7f3(0x157,0x1b4)](),'outputTexture':this['particlesTextures'][_0x4e3814(0x2e1,0x28a)],'preExecute':()=>{function _0x3334dc(_0x4d3e44,_0x262237){return _0x4e3814(_0x262237,_0x4d3e44- -0x1d2);}function _0x1119db(_0x3f9ce1,_0x33c7c2){return _0x27b7f3(_0x33c7c2,_0x3f9ce1- -0x36a);}this['primitives'][_0x3334dc(0x172,0x145)][_0x1119db(-0x124,-0xca)]&&(this[_0x1119db(-0x1b4,-0x1b6)]['updatePosition'][_0x3334dc(0x166,0x147)]['outputTexture']=this[_0x1119db(-0x106,-0x186)][_0x1119db(-0x1d2,-0x170)]);},'isDynamic':()=>this['options'][_0x4e3814(0x378,0x314)]}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':()=>this[_0x4e3814(0x396,0x356)]['nextParticlesPosition'],'particlesSpeed':()=>this[_0x27b7f3(0x2cf,0x264)][_0x4e3814(0x373,0x347)],'lonRange':()=>this['viewerParameters']['lonRange'],'latRange':()=>this['viewerParameters']['latRange'],'dataLonRange':()=>new Cartesian2$1(this['windData']['bounds'][_0x4e3814(0x2da,0x2aa)],this[_0x27b7f3(0x267,0x231)][_0x4e3814(0x34a,0x2d8)][_0x27b7f3(0x168,0x171)]),'dataLatRange':()=>new Cartesian2$1(this['windData']['bounds'][_0x4e3814(0x2e1,0x277)],this['windData']['bounds']['north']),'randomCoefficient':function(){function _0x357eeb(_0x1b6c60,_0x1cd408){return _0x4e3814(_0x1cd408,_0x1b6c60- -0x2a1);}return Math[_0x357eeb(0x56,0x1a)]();},'dropRate':()=>this['options'][_0x4e3814(0x271,0x2ac)],'dropRateBump':()=>this['options'][_0x4e3814(0x249,0x279)],'useViewerBounds':()=>this['options']['useViewerBounds']},'fragmentShaderSource':ShaderManager['getPostProcessingPositionShader'](),'outputTexture':this[_0x4e3814(0x399,0x356)][_0x4e3814(0x228,0x28d)],'preExecute':()=>{function _0x4f2f93(_0x29f9a8,_0x2d45e3){return _0x27b7f3(_0x29f9a8,_0x2d45e3- -0x2ac);}function _0x1b9560(_0x2866ec,_0x19e330){return _0x4e3814(_0x2866ec,_0x19e330-0x76);}this['primitives']['postProcessingPosition']['commandToExecute']&&(this['primitives']['postProcessingPosition']['commandToExecute'][_0x4f2f93(-0xe6,-0xda)]=this['particlesTextures'][_0x1b9560(0x387,0x303)]);},'isDynamic':()=>this[_0x27b7f3(0x26d,0x258)][_0x4e3814(0x380,0x314)]})};}[_0x99d407(0x2ce,0x2f7)](){this[_0x33441e(0x311,0x393)]['U']['destroy'](),this['windTextures']['V'][_0x33441e(0x2b3,0x2d2)]();function _0x210951(_0x3b4c35,_0xa09db2){return _0x99d407(_0x3b4c35,_0xa09db2- -0x22f);}function _0x33441e(_0xaa38d8,_0xe0db65){return _0x99d407(_0xaa38d8,_0xe0db65-0x6a);}this[_0x33441e(0x3cf,0x37b)]();}['updateWindData'](_0x4c3b16){this['windData']=_0x4c3b16,this['reCreateWindTextures']();}['updateOptions'](_0x2411e2){function _0x3b630c(_0x55b42d,_0x3e6a39){return _0x99d407(_0x55b42d,_0x3e6a39- -0x318);}const _0x4256c7=_0x2411e2[_0x5d29bc(0x17c,0x18d)]!==undefined&&_0x2411e2['flipY']!==this[_0x3b630c(0x32,0x40)]['flipY'];this[_0x3b630c(0x8b,0x40)]=deepMerge(_0x2411e2,this['options']);function _0x5d29bc(_0x2a7365,_0x43eb4d){return _0x99d407(_0x43eb4d,_0x2a7365- -0x183);}_0x4256c7&&this[_0x5d29bc(0x174,0x1f0)]();}[_0x99d407(0x321,0x2f1)](_0x51f0fc){const {array:_0x13be8a}=_0x51f0fc;let {min:_0x985914,max:_0x5dd642}=_0x51f0fc;const _0xbe3a7d=new Float32Array(_0x13be8a['length']);function _0x5961f2(_0x468b2d,_0x23ff58){return _0x557a97(_0x468b2d,_0x23ff58-0x131);}function _0x4429ff(_0x1faecc,_0x7b7d6){return _0x99d407(_0x7b7d6,_0x1faecc- -0x527);}_0x985914===undefined&&(console[_0x5961f2(0x69,-0x8)]('min\x20is\x20undefined,\x20calculate\x20min'),_0x985914=Math['min'](..._0x13be8a));_0x5dd642===undefined&&(console['warn'](_0x5961f2(-0x8b,-0xa)),_0x5dd642=Math[_0x5961f2(0x1,-0x5d)](..._0x13be8a));const _0x2ea6f4=Math['max'](Math[_0x5961f2(-0x38,0xc)](_0x985914),Math[_0x5961f2(0x32,0xc)](_0x5dd642));for(let _0x25cb71=0x0;_0x25cb71<_0x13be8a['length'];_0x25cb71++){const _0x59567c=_0x13be8a[_0x25cb71]/_0x2ea6f4;_0xbe3a7d[_0x25cb71]=_0x59567c;}return _0xbe3a7d;}['destroy'](){function _0x53c70f(_0x4bbe8f,_0x11b3a8){return _0x99d407(_0x11b3a8,_0x4bbe8f- -0x2a0);}Object[_0x219b26(0xa0,0xec)](this['windTextures'])['forEach'](_0x57955f=>_0x57955f[_0x219b26(0x1b,0x4)]());function _0x219b26(_0x57df9d,_0x536d3c){return _0x99d407(_0x57df9d,_0x536d3c- -0x264);}Object[_0x53c70f(0xb0,0x8d)](this[_0x219b26(0x131,0x100)])[_0x219b26(0xd9,0x76)](_0x3f8000=>_0x3f8000['destroy']()),Object['values'](this[_0x219b26(-0x29,0x52)])[_0x53c70f(0x3a,-0xb)](_0x2b3223=>_0x2b3223[_0x219b26(0x47,0x4)]()),this[_0x219b26(0x7a,0x60)][_0x219b26(0x3,0x4)]();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace['Cesium'];class WindParticlesRendering{constructor(_0x417448,_0x353284,_0xe32a20,_0x1ee108){this[_0x39fe24(0x55a,0x5d3)]=_0x417448;function _0x3a2bec(_0x21f665,_0x4ea090){return _0x557a97(_0x21f665,_0x4ea090-0x4ed);}function _0x39fe24(_0x230b3d,_0x3fe405){return _0x99d407(_0x230b3d,_0x3fe405-0x259);}this['options']=_0x353284,this['viewerParameters']=_0xe32a20,this['computing']=_0x1ee108,(typeof this[_0x3a2bec(0x3ab,0x414)]['particlesTextureSize']!=='number'||this[_0x3a2bec(0x40b,0x414)]['particlesTextureSize']<=0x0)&&(console[_0x3a2bec(0x322,0x36b)](_0x39fe24(0x4ba,0x4eb)),this['options']['particlesTextureSize']=0x100),this[_0x39fe24(0x555,0x5c4)]=this['createColorTableTexture'](),this[_0x3a2bec(0x38d,0x39d)]=this['createRenderingTextures'](),this['framebuffers']=this[_0x3a2bec(0x398,0x31f)](),this['primitives']=this[_0x3a2bec(0x375,0x3fe)]();}[_0x557a97(-0x7c,-0xfb)](){const _0x16a738={};_0x16a738[_0x2047bb(0x27e,0x26a)]=this['context'];function _0x2047bb(_0x325393,_0x524fa8){return _0x99d407(_0x325393,_0x524fa8- -0x110);}_0x16a738[_0x603d9a(0x14b,0xc0)]=this[_0x603d9a(0x256,0x207)][_0x2047bb(0x1d3,0x1a7)],_0x16a738[_0x2047bb(0x1a7,0x1b5)]=this['context'][_0x2047bb(0x1bd,0x1b0)],_0x16a738['pixelFormat']=PixelFormat[_0x603d9a(0x1e7,0x26c)],_0x16a738[_0x2047bb(0x11f,0x152)]=PixelDatatype['UNSIGNED_BYTE'];const _0x351250=_0x16a738,_0x43d682={};_0x43d682[_0x2047bb(0x284,0x26a)]=this[_0x2047bb(0x2d7,0x26a)],_0x43d682['width']=this['context']['drawingBufferWidth'],_0x43d682['height']=this['context'][_0x2047bb(0x1f8,0x1b0)],_0x43d682[_0x2047bb(0x28c,0x1ff)]=PixelFormat['DEPTH_COMPONENT'],_0x43d682['pixelDatatype']=PixelDatatype[_0x2047bb(0x2e0,0x267)];const _0x203e12=_0x43d682;function _0x603d9a(_0x156aaf,_0x26c254){return _0x557a97(_0x26c254,_0x156aaf-0x30d);}return{'segmentsColor':new Texture(_0x351250),'segmentsDepth':new Texture(_0x203e12)};}['createRenderingFramebuffers'](){function _0x51f67d(_0x589410,_0x477711){return _0x557a97(_0x477711,_0x589410-0x3e1);}const _0x1de7f3={};function _0x1a5b3b(_0x3bbef5,_0x46a575){return _0x557a97(_0x46a575,_0x3bbef5-0x68c);}return _0x1de7f3['context']=this[_0x1a5b3b(0x5d5,0x656)],_0x1de7f3['colorTextures']=[this['textures']['segmentsColor']],_0x1de7f3[_0x1a5b3b(0x501,0x4a3)]=this['textures'][_0x1a5b3b(0x4c8,0x509)],{'segments':new Framebuffer(_0x1de7f3)};}[_0x557a97(-0x18d,-0x183)](){function _0x5d1da0(_0x9ad171,_0x172bb9){return _0x557a97(_0x9ad171,_0x172bb9-0x68d);}Object['values'](this['framebuffers'])[_0x5d1da0(0x5a5,0x536)](_0x1c9935=>{function _0x5c08ee(_0x3b5553,_0x119a17){return _0x5d1da0(_0x119a17,_0x3b5553- -0x207);}_0x1c9935[_0x5c08ee(0x2bd,0x304)]();});}[_0x99d407(0x356,0x326)](){function _0x5089e5(_0x185ef1,_0x1e7816){return _0x557a97(_0x185ef1,_0x1e7816-0x482);}const _0x2752e9=new Float32Array(this['options']['colors']['flatMap'](_0x3f47ab=>{const _0x2cb64e=Color$1['fromCssColorString'](_0x3f47ab);function _0x3d8725(_0x17b834,_0x446cd1){return _0x3a86(_0x17b834-0x211,_0x446cd1);}return[_0x2cb64e['red'],_0x2cb64e['green'],_0x2cb64e[_0x3d8725(0x315,0x35f)],_0x2cb64e['alpha']];})),_0x187400={};_0x187400['minificationFilter']=TextureMinificationFilter['LINEAR'],_0x187400['magnificationFilter']=TextureMagnificationFilter['LINEAR'],_0x187400['wrapS']=TextureWrap['CLAMP_TO_EDGE'];function _0x236d29(_0x1107a0,_0x24127d){return _0x99d407(_0x24127d,_0x1107a0-0x1fa);}return _0x187400['wrapT']=TextureWrap['CLAMP_TO_EDGE'],new Texture({'context':this['context'],'width':this[_0x236d29(0x552,0x54c)][_0x5089e5(0x284,0x2d0)][_0x5089e5(0x352,0x37f)],'height':0x1,'pixelFormat':PixelFormat[_0x236d29(0x505,0x516)],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x187400),'source':{'width':this['options']['colors'][_0x236d29(0x528,0x4e3)],'height':0x1,'arrayBufferView':_0x2752e9}});}[_0x99d407(0x324,0x2fe)](){const _0x11909b=0x4,_0x187439=this['options']['particlesTextureSize'];let _0x5eab89=[];for(let _0x4b8065=0x0;_0x4b8065<_0x187439;_0x4b8065++){for(let _0x3c5131=0x0;_0x3c5131<_0x187439;_0x3c5131++){for(let _0x4cabe0=0x0;_0x4cabe0<_0x11909b;_0x4cabe0++){_0x5eab89['push'](_0x4b8065/_0x187439),_0x5eab89[_0x4c2ef9(0x211,0x29f)](_0x3c5131/_0x187439);}}}function _0x4c2ef9(_0x38f40f,_0x4bac4a){return _0x99d407(_0x38f40f,_0x4bac4a- -0x9e);}_0x5eab89=new Float32Array(_0x5eab89);const _0x247be9=this[_0x35ef8d(0x4de,0x4c6)][_0x4c2ef9(0x270,0x27f)]**0x2;let _0x5c49f9=[];for(let _0x571c06=0x0;_0x571c06<_0x247be9;_0x571c06++){_0x5c49f9['push'](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x5c49f9=new Float32Array(_0x5c49f9);let _0x7b0d66=[];for(let _0x56805b=0x0,_0x209c24=0x0;_0x56805b<_0x247be9;_0x56805b++){_0x7b0d66['push'](_0x209c24+0x0,_0x209c24+0x1,_0x209c24+0x2,_0x209c24+0x2,_0x209c24+0x1,_0x209c24+0x3),_0x209c24+=_0x11909b;}function _0x35ef8d(_0x8c3829,_0x11a14c){return _0x99d407(_0x8c3829,_0x11a14c-0x16e);}_0x7b0d66=new Uint32Array(_0x7b0d66);const _0x2f1cf2={};_0x2f1cf2['componentDatatype']=ComponentDatatype['FLOAT'],_0x2f1cf2[_0x35ef8d(0x4ae,0x4e0)]=0x2,_0x2f1cf2[_0x35ef8d(0x489,0x4be)]=_0x5eab89;const _0x16a151={};_0x16a151['componentDatatype']=ComponentDatatype[_0x4c2ef9(0x221,0x22f)],_0x16a151['componentsPerAttribute']=0x3,_0x16a151['values']=_0x5c49f9;const _0x1179d0=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x2f1cf2),'normal':new GeometryAttribute(_0x16a151)}),'indices':_0x7b0d66});return _0x1179d0;}['createRawRenderState'](_0xe8567c){const _0xfd1a90={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0xe8567c};function _0x2341e3(_0x5b2685,_0x18855f){return _0x557a97(_0x18855f,_0x5b2685-0x67a);}return Appearance[_0x2341e3(0x5b9,0x5ea)](!![],![],_0xfd1a90);}[_0x557a97(-0x137,-0xef)](){const _0x429455={};_0x429455['st']=0x0,_0x429455['normal']=0x1;const _0x2be7ba={};_0x2be7ba['enabled']=!![];function _0x59ab9a(_0x494f41,_0x40c82c){return _0x99d407(_0x40c82c,_0x494f41- -0x1a5);}const _0x4c553a={};_0x4c553a['enabled']=!![],_0x4c553a[_0x59ab9a(0x13a,0x198)]=WebGLRenderingContext['FUNC_ADD'],_0x4c553a[_0x1e34d1(-0x4d,-0x81)]=WebGLRenderingContext[_0x59ab9a(0xe4,0x166)],_0x4c553a['blendFuncDestination']=WebGLRenderingContext[_0x1e34d1(-0x6c,-0x67)];const _0x49fd9c={};_0x49fd9c['viewport']=undefined,_0x49fd9c['depthTest']=_0x2be7ba,_0x49fd9c[_0x1e34d1(0x17,0x65)]=!![],_0x49fd9c['blending']=_0x4c553a;function _0x1e34d1(_0x98a51b,_0x484eb6){return _0x557a97(_0x484eb6,_0x98a51b-0xf4);}const _0x418d82=new CustomPrimitive({'commandType':_0x1e34d1(-0x64,-0x80),'attributeLocations':_0x429455,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType[_0x59ab9a(0xef,0x158)],'uniformMap':{'previousParticlesPosition':()=>this[_0x1e34d1(0xb,-0x19)][_0x1e34d1(0x27,-0x20)]['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing'][_0x1e34d1(0x27,0xa1)]['currentParticlesPosition'],'postProcessingPosition':()=>this['computing'][_0x1e34d1(0x27,0x10)]['postProcessingPosition'],'particlesSpeed':()=>this[_0x1e34d1(0xb,0x5e)]['particlesTextures'][_0x1e34d1(0x18,0x9)],'frameRateAdjustment':()=>this[_0x1e34d1(0xb,0x56)]['frameRateAdjustment'],'colorTable':()=>this[_0x59ab9a(0x1c6,0x1fe)],'domain':()=>{var _0x5b9225,_0x25a212;const _0xec1b05=new Cartesian2(((_0x5b9225=this[_0x5cd23e(0x3bb,0x3fd)][_0x105941(0x64,0xc2)])===null||_0x5b9225===void 0x0?void 0x0:_0x5b9225['min'])??this[_0x5cd23e(0x3ab,0x41e)]['windData']['speed']['min'],((_0x25a212=this[_0x105941(0x170,0x181)]['domain'])===null||_0x25a212===void 0x0?void 0x0:_0x25a212['max'])??this['computing']['windData'][_0x5cd23e(0x2e7,0x335)][_0x5cd23e(0x306,0x38e)]);function _0x5cd23e(_0x4c6a1a,_0xde8f32){return _0x59ab9a(_0x4c6a1a-0x208,_0xde8f32);}function _0x105941(_0xa13eb2,_0x4d4b48){return _0x59ab9a(_0x4d4b48- -0x32,_0xa13eb2);}return _0xec1b05;},'displayRange':()=>{var _0x4e3e1f,_0x49f142;function _0x33e385(_0x2c0a6,_0x46a29b){return _0x59ab9a(_0x2c0a6-0x2bc,_0x46a29b);}function _0x1a21ef(_0x2ac186,_0x1e6817){return _0x59ab9a(_0x2ac186- -0x19d,_0x1e6817);}const _0x226845=new Cartesian2(((_0x4e3e1f=this[_0x1a21ef(0x16,0x61)][_0x33e385(0x3b4,0x3ca)])===null||_0x4e3e1f===void 0x0?void 0x0:_0x4e3e1f[_0x1a21ef(0x21,0x83)])??this['computing']['windData']['speed']['min'],((_0x49f142=this['options'][_0x1a21ef(-0xa5,-0xf5)])===null||_0x49f142===void 0x0?void 0x0:_0x49f142['max'])??this[_0x33e385(0x45f,0x4da)]['windData'][_0x33e385(0x39b,0x393)]['max']);return _0x226845;},'particleHeight':()=>this[_0x1e34d1(0x1b,0x21)][_0x1e34d1(-0xaa,-0x118)]||0x0,'aspect':()=>this['context'][_0x1e34d1(-0x86,-0x49)]/this[_0x59ab9a(0x1d5,0x22d)]['drawingBufferHeight'],'pixelSize':()=>this[_0x1e34d1(-0x3d,0x28)][_0x59ab9a(0x129,0xff)],'lineWidth':()=>{const _0x8d0df2={};_0x8d0df2['min']=0x1;function _0x1db70f(_0x88bb34,_0x226e95){return _0x59ab9a(_0x88bb34- -0x32a,_0x226e95);}_0x8d0df2['max']=0x2;const _0x3046a1=this['options']['lineWidth']||_0x8d0df2;return new Cartesian2(_0x3046a1[_0x1db70f(-0x16c,-0xf7)],_0x3046a1['max']);},'lineLength':()=>{function _0xc56435(_0x82bddf,_0x13c250){return _0x1e34d1(_0x13c250- -0xcc,_0x82bddf);}function _0x4da9c4(_0x5dc9da,_0x2e9125){return _0x59ab9a(_0x5dc9da- -0x304,_0x2e9125);}const _0x5329ac={};_0x5329ac[_0xc56435(-0x8d,-0xa6)]=0x14,_0x5329ac['max']=0x64;const _0x14a7ae=this['options'][_0xc56435(-0x18a,-0x1a8)]||_0x5329ac;return new Cartesian2(_0x14a7ae['min'],_0x14a7ae[_0x4da9c4(-0x206,-0x187)]);},'is3D':()=>this['viewerParameters']['sceneMode']===SceneMode['SCENE3D'],'segmentsDepthTexture':()=>this[_0x59ab9a(0x13c,0xff)]['segmentsDepth']},'vertexShaderSource':ShaderManager['getSegmentDrawVertexShader'](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this['createRawRenderState'](_0x49fd9c)}),_0x2f7677={};return _0x2f7677['segments']=_0x418d82,_0x2f7677;}[_0x557a97(-0x126,-0xe3)](){const _0x43fb92=this['createSegmentsGeometry']();this['primitives']['segments']['geometry']=_0x43fb92;const _0x10b848={};_0x10b848[_0x5a3e73(0x462,0x40c)]=this['context'],_0x10b848['geometry']=_0x43fb92;function _0x5a3e73(_0x1ba12f,_0x38981e){return _0x99d407(_0x1ba12f,_0x38981e-0x92);}_0x10b848[_0x5ebef6(-0x11,0x3f)]=this[_0x5a3e73(0x3c8,0x348)][_0x5ebef6(-0x53,-0xa0)]['attributeLocations'],_0x10b848[_0x5a3e73(0x378,0x336)]=BufferUsage[_0x5ebef6(0x39,0x6a)];function _0x5ebef6(_0x3eaccf,_0x20c083){return _0x557a97(_0x3eaccf,_0x20c083-0x131);}const _0x912a30=VertexArray['fromGeometry'](_0x10b848);this['primitives']['segments']['commandToExecute']&&(this['primitives'][_0x5a3e73(0x345,0x2f2)]['commandToExecute'][_0x5ebef6(-0x65,0x1c)]=_0x912a30);}['onColorTableChange'](){this[_0x3773ed(-0x1cc,-0x168)]['destroy']();function _0x3773ed(_0x2d77b1,_0x4e7e74){return _0x557a97(_0x2d77b1,_0x4e7e74- -0xa2);}this['colorTable']=this['createColorTableTexture']();}[_0x557a97(-0x9e,-0x113)](_0x35292a){const _0x31b63d=_0x35292a['colors']&&JSON['stringify'](_0x35292a[_0x250303(0x2a6,0x29c)])!==JSON[_0x5c9dc2(0x49a,0x4d9)](this[_0x250303(0x33a,0x375)]['colors']);function _0x250303(_0x372a58,_0x70fc1b){return _0x99d407(_0x372a58,_0x70fc1b-0x1d);}function _0x5c9dc2(_0x2294ed,_0x2d633a){return _0x99d407(_0x2294ed,_0x2d633a-0x226);}this[_0x5c9dc2(0x514,0x57e)]=deepMerge(_0x35292a,this[_0x250303(0x3d4,0x375)]),_0x31b63d&&this['onColorTableChange']();}['destroy'](){function _0x3095ce(_0x4d4a1e,_0x3a3792){return _0x557a97(_0x3a3792,_0x4d4a1e-0x435);}Object[_0x3095ce(0x354,0x36e)](this['framebuffers'])[_0x3095ce(0x2de,0x2d7)](_0x44d23d=>{_0x44d23d['destroy']();}),Object['values'](this['primitives'])[_0xbd652f(-0x16d,-0x111)](_0x5748d5=>{_0x5748d5['destroy']();});function _0xbd652f(_0x4b334c,_0x42eee0){return _0x99d407(_0x42eee0,_0x4b334c- -0x447);}this['colorTable'][_0x3095ce(0x26c,0x262)]();}}const {ClearCommand,Color,Pass}=mars3d__namespace[_0x99d407(0x2aa,0x26c)];function _0x557a97(_0x2139e6,_0x2f6c66){return _0x3a86(_0x2f6c66- -0x2b4,_0x2139e6);}class WindParticleSystem{constructor(_0x35fa74,_0x1cc5d3,_0x4cc61d,_0x308c9f,_0x435ed4){function _0x5d2e1f(_0x2f388b,_0x31f021){return _0x557a97(_0x2f388b,_0x31f021-0x58b);}this[_0x5d2e1f(0x523,0x4d4)]=_0x35fa74,this['options']=_0x4cc61d,this['viewerParameters']=_0x308c9f,this[_0x589342(-0x5b,0x2)]=new WindParticlesComputing(_0x35fa74,_0x1cc5d3,_0x4cc61d,_0x308c9f,_0x435ed4);function _0x589342(_0x11a49f,_0x36e5b8){return _0x99d407(_0x36e5b8,_0x11a49f- -0x3a3);}this['rendering']=new WindParticlesRendering(_0x35fa74,_0x4cc61d,_0x308c9f,this['computing']),this['clearFramebuffers']();}[_0x99d407(0x2e8,0x2bb)](){function _0x42b91d(_0x34ffe9,_0x29b1ec){return _0x557a97(_0x29b1ec,_0x34ffe9- -0x73);}function _0x2770f1(_0x55b2f2,_0x6e90aa){return _0x557a97(_0x55b2f2,_0x6e90aa-0x4fd);}const _0x265ba2=[this['computing']['primitives']['calculateSpeed'],this['computing']['primitives'][_0x42b91d(-0x152,-0x1af)],this['computing']['primitives']['postProcessingPosition'],this['rendering']['primitives'][_0x42b91d(-0x244,-0x22e)]];return _0x265ba2;}[_0x557a97(-0x18d,-0x129)](){const _0x4a37c4=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});function _0x323afa(_0x477426,_0x1da6c1){return _0x99d407(_0x1da6c1,_0x477426- -0x26b);}function _0x269d95(_0x2f3ff4,_0x28a3b2){return _0x99d407(_0x2f3ff4,_0x28a3b2- -0x64);}Object[_0x269d95(0x257,0x289)](this['rendering'][_0x269d95(0x1da,0x22b)])[_0x323afa(0x6f,0x14)](_0x2bc650=>{function _0x36f3bf(_0x2a43bd,_0x17a898){return _0x323afa(_0x2a43bd- -0x153,_0x17a898);}function _0xb9d78e(_0x40f666,_0xca5d29){return _0x269d95(_0x40f666,_0xca5d29- -0x1ed);}_0x4a37c4[_0xb9d78e(0x94,0x54)]=this[_0xb9d78e(0x82,0xaa)][_0xb9d78e(0x98,0x3e)][_0x2bc650],_0x4a37c4['execute'](this[_0xb9d78e(0x180,0x129)]);});}[_0x99d407(0x2e7,0x278)](_0x3bc105){let _0x52012a=![];_0x3bc105['particlesTextureSize']&&this['options']['particlesTextureSize']!==_0x3bc105[_0x8501e0(0x200,0x1a6)]&&(_0x52012a=!![]);const _0x3ba082=deepMerge(_0x3bc105,this[_0x37b40d(-0xf4,-0xdc)]);function _0x8501e0(_0x542596,_0x390be1){return _0x557a97(_0x390be1,_0x542596-0x314);}if(_0x3ba082[_0x37b40d(-0x12f,-0xe4)]<0x1)throw new Error('particlesTextureSize\x20must\x20be\x20greater\x20than\x200');this['options']=_0x3ba082,this['rendering']['updateOptions'](_0x3bc105);function _0x37b40d(_0x6ac065,_0x33949e){return _0x99d407(_0x33949e,_0x6ac065- -0x44c);}this['computing']['updateOptions'](_0x3bc105),_0x52012a&&(this['computing']['destroyParticlesTextures'](),this[_0x37b40d(-0x104,-0xf8)]['createParticlesTextures'](),this['rendering']['onParticlesTextureSizeChange']());}['applyViewerParameters'](_0x5b4108){this['viewerParameters']=_0x5b4108,this['computing']['viewerParameters']=_0x5b4108;function _0x58bb5a(_0x10f90f,_0x4bd2ce){return _0x99d407(_0x10f90f,_0x4bd2ce-0xb);}this[_0x58bb5a(0x37b,0x306)]['viewerParameters']=_0x5b4108;}[_0x99d407(0x2c5,0x268)](){function _0x180d16(_0x285dfa,_0x2815ae){return _0x99d407(_0x2815ae,_0x285dfa- -0x22f);}this[_0x180d16(0x119,0xe7)]['destroy'](),this['rendering']['destroy']();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer'][_0x557a97(-0x148,-0x1a4)],_0x5327a6={};_0x5327a6['min']=0x1,_0x5327a6[_0x557a97(-0x20d,-0x18e)]=0x2;const _0x13a31c={};_0x13a31c['min']=0x14,_0x13a31c['max']=0x64;const _0x364524={};function _0x3a86(_0x3a9899,_0xd4e3e0){const _0x2672fc=_0x2672();return _0x3a86=function(_0x3a8633,_0x166a73){_0x3a8633=_0x3a8633-0xe3;let _0x4af238=_0x2672fc[_0x3a8633];return _0x4af238;},_0x3a86(_0x3a9899,_0xd4e3e0);}function _0x99d407(_0xf9bd2b,_0x5b1c59){return _0x3a86(_0x5b1c59-0x17d,_0xf9bd2b);}_0x364524[_0x99d407(0x336,0x31d)]=0x64,_0x364524[_0x99d407(0x246,0x293)]=0x0,_0x364524['lineWidth']=_0x5327a6,_0x364524['lineLength']=_0x13a31c,_0x364524['speedFactor']=0x1,_0x364524['dropRate']=0.003,_0x364524[_0x557a97(-0x123,-0x1aa)]=0.001,_0x364524['colors']=['rgb(206,255,255)'],_0x364524['flipY']=![],_0x364524['dynamic']=!![];const DEF_OPTIONS=_0x364524;class WindLayer extends BaseLayer$1{constructor(_0x4ed14f={}){function _0x346041(_0x182a95,_0x5510bb){return _0x557a97(_0x5510bb,_0x182a95-0x8a);}_0x4ed14f={...DEF_OPTIONS,..._0x4ed14f},super(_0x4ed14f),this[_0x346041(-0x6c,-0x80)](_0x4ed14f,_0x4ed14f);}get['layer'](){return this['primitives'];}get['data'](){function _0x56144c(_0x55d191,_0x38e06d){return _0x99d407(_0x38e06d,_0x55d191- -0x81);}return this[_0x56144c(0x2d7,0x2d9)]['data'];}set[_0x557a97(-0x18e,-0x1c3)](_0x1d62f8){this['options']['data']=_0x1d62f8,this['setData'](_0x1d62f8);}get[_0x99d407(0x309,0x27f)](){function _0x17645d(_0x391995,_0x29e6e5){return _0x557a97(_0x391995,_0x29e6e5- -0x37);}return this['options'][_0x17645d(-0x244,-0x1e9)];}set[_0x99d407(0x20e,0x27f)](_0x12655c){this['options']['colors']=_0x12655c;const _0x1f34a0={};function _0x42e0b0(_0x2178d2,_0x3222e7){return _0x557a97(_0x2178d2,_0x3222e7-0x506);}_0x1f34a0['colors']=_0x12655c,this['_setOptionsHook'](this[_0x42e0b0(0x49b,0x42d)],_0x1f34a0);}['_showHook'](_0x29fdae){function _0x377fe6(_0x5fb1f6,_0x2cac5c){return _0x557a97(_0x2cac5c,_0x5fb1f6-0x240);}_0x29fdae?this[_0x377fe6(0x127,0x17a)]():this['_removedHook']();}['_mountedHook'](){}[_0x99d407(0x31f,0x318)](){function _0x558e78(_0x1d7080,_0x998cb6){return _0x557a97(_0x1d7080,_0x998cb6- -0x134);}this['scene']=this['_map']['scene'],this['camera']=this[_0x5c30e8(-0x24,-0x1b)]['camera'];this['options']['data']&&this[_0x5c30e8(-0x1b,0x6a)](this[_0x5c30e8(0x95,0x11a)]['data']);if(!this['windData']||!this[_0x558e78(-0x1ed,-0x225)])return;this['viewerParameters']={'lonRange':new Cesium$1[(_0x5c30e8(0xb5,0x2e))](-0xb4,0xb4),'latRange':new Cesium$1[(_0x5c30e8(0xb5,0x4f))](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this[_0x5c30e8(0x1f,-0x4c)][_0x558e78(-0x2fb,-0x2f1)]};function _0x5c30e8(_0x3f2e0e,_0x1b3706){return _0x557a97(_0x1b3706,_0x3f2e0e-0x16e);}this['updateViewerParameters'](),this[_0x5c30e8(-0x11,-0x28)]=new WindParticleSystem(this['scene']['context'],this[_0x5c30e8(0x6e,0x1e)],this[_0x5c30e8(0x95,0xb)],this[_0x558e78(-0x1f9,-0x265)],this['scene']),this['primitives']=this['particleSystem'][_0x5c30e8(-0x8,-0x55)](),this['primitives']['forEach'](_0x4515fc=>{function _0x4dca71(_0x28a815,_0x3341e0){return _0x558e78(_0x3341e0,_0x28a815-0x2a5);}function _0x1af272(_0x46b0ad,_0x429ea2){return _0x5c30e8(_0x46b0ad- -0x1ff,_0x429ea2);}this[_0x4dca71(0x22,0x5d)]['primitives'][_0x1af272(-0x156,-0xfb)](_0x4515fc);}),this[_0x558e78(-0x300,-0x282)]['percentageChanged']=0.01,this['camera']['changed']['addEventListener'](this[_0x558e78(-0x1be,-0x239)]['bind'](this)),this[_0x558e78(-0x29d,-0x283)]['morphComplete']['addEventListener'](this[_0x5c30e8(0x69,0x31)]['bind'](this)),window['addEventListener'](_0x5c30e8(-0x17,0x24),this[_0x5c30e8(0x69,0xad)]['bind'](this));}['_removedHook'](){this[_0x5b5d0f(0x2cb,0x2e3)]['changed'][_0x5b5d0f(0x2b4,0x26a)](this['updateViewerParameters']['bind'](this));function _0xaa6869(_0x100983,_0x41d75a){return _0x99d407(_0x100983,_0x41d75a- -0xfd);}this['scene']['morphComplete'][_0x5b5d0f(0x223,0x26a)](this[_0xaa6869(0x1d9,0x22f)]['bind'](this)),window['removeEventListener']('resize',this[_0x5b5d0f(0x398,0x32c)][_0x5b5d0f(0x22d,0x275)](this));function _0x5b5d0f(_0x420c67,_0x4d4882){return _0x557a97(_0x420c67,_0x4d4882-0x431);}this['primitives']&&(this['primitives']['forEach'](_0x41cea9=>{function _0xcfe143(_0x575611,_0x4aec7a){return _0x5b5d0f(_0x575611,_0x4aec7a- -0x1db);}function _0x9deef2(_0x2b4120,_0x24d69f){return _0x5b5d0f(_0x2b4120,_0x24d69f- -0x544);}this[_0xcfe143(0xe9,0x107)]['primitives'][_0xcfe143(0x1e8,0x15d)](_0x41cea9);}),delete this[_0xaa6869(0x1d5,0x1b9)]),this['particleSystem']&&(this[_0xaa6869(0x228,0x1b5)][_0x5b5d0f(0x22a,0x268)](),delete this['particleSystem']);}['setData'](_0x1d39e0,_0x13a649){function _0x284c7d(_0x5510f0,_0x193b4f){return _0x99d407(_0x193b4f,_0x5510f0-0x106);}this[_0x59e8b2(0x3b9,0x401)]=this['processWindData'](_0x1d39e0);function _0x59e8b2(_0x583455,_0x59e084){return _0x557a97(_0x59e084,_0x583455-0x4b9);}if(_0x13a649){this[_0x284c7d(0x3c7,0x431)](),this['_addedHook']();return;}this['particleSystem']?(this['particleSystem']['computing']['updateWindData'](this['windData']),this[_0x59e8b2(0x36a,0x35e)][_0x59e8b2(0x38c,0x349)]()):this['_addedHook']();}['_setOptionsHook'](_0x3f3af2,_0x5a35ea){function _0x2be868(_0x4c90ee,_0x483121){return _0x557a97(_0x483121,_0x4c90ee-0x3f2);}function _0xb941b3(_0x519dc2,_0x184bcb){return _0x557a97(_0x184bcb,_0x519dc2-0x40b);}this['particleSystem']&&(this['particleSystem'][_0x2be868(0x239,0x1f1)](_0x5a35ea),this[_0xb941b3(0x2bc,0x30b)]['requestRender']());}['processWindData'](_0x4e663c){var _0x248de1,_0x387ac7;const _0x3fef24={..._0x4e663c},_0x335914=_0x3fef24;function _0x2231c9(_0x15337,_0x120b55){return _0x557a97(_0x15337,_0x120b55- -0x79);}!_0x335914['height']&&_0x335914[_0x2231c9(-0x156,-0x14f)]&&(_0x335914['height']=_0x335914['rows']);!_0x335914[_0x2231c9(-0x1f2,-0x23b)]&&_0x335914['cols']&&(_0x335914[_0x5b77d4(-0xf6,-0x183)]=_0x335914['cols']);function _0x5b77d4(_0xba88d,_0x588c0f){return _0x99d407(_0xba88d,_0x588c0f- -0x3f2);}!_0x335914['bounds']&&(_0x335914[_0x5b77d4(-0x16a,-0x10c)]={'west':_0x335914['xmin'],'south':_0x335914['ymin'],'east':_0x335914[_0x2231c9(-0x191,-0x1c0)],'north':_0x335914[_0x5b77d4(-0xe6,-0xc7)]});if(!_0x335914['u']){const _0x5bdf2d={};_0x5bdf2d['array']=_0x4e663c['udata'],_0x5bdf2d['min']=_0x4e663c['umin'],_0x5bdf2d['max']=_0x4e663c['umax'],_0x335914['u']=_0x5bdf2d;}if(!_0x335914['v']){const _0x144ca0={};_0x144ca0['array']=_0x4e663c['vdata'],_0x144ca0['min']=_0x4e663c['vmin'],_0x144ca0[_0x2231c9(-0x265,-0x207)]=_0x4e663c[_0x2231c9(-0x1c5,-0x16e)],_0x335914['v']=_0x144ca0;}if(((_0x248de1=_0x335914['speed'])===null||_0x248de1===void 0x0?void 0x0:_0x248de1['min'])===undefined||((_0x387ac7=_0x335914['speed'])===null||_0x387ac7===void 0x0?void 0x0:_0x387ac7[_0x5b77d4(-0x1c1,-0x14f)])===undefined||_0x335914['speed']['array']===undefined){const _0x1dc2ba={'array':new Float32Array(_0x335914['u']['array']['length']),'min':Number[_0x5b77d4(-0x12d,-0x11d)],'max':Number['MIN_VALUE']};for(let _0x497e21=0x0;_0x497e21<_0x335914['u'][_0x2231c9(-0x283,-0x210)]['length'];_0x497e21++){_0x1dc2ba['array'][_0x497e21]=Math[_0x2231c9(-0x1d6,-0x1a9)](_0x335914['u']['array'][_0x497e21]*_0x335914['u'][_0x5b77d4(-0x170,-0x158)][_0x497e21]+_0x335914['v'][_0x5b77d4(-0x19e,-0x158)][_0x497e21]*_0x335914['v'][_0x5b77d4(-0x1cf,-0x158)][_0x497e21]),_0x1dc2ba[_0x5b77d4(-0x1b4,-0x158)][_0x497e21]!==0x0&&(_0x1dc2ba['min']=Math[_0x2231c9(-0xfa,-0x147)](_0x1dc2ba[_0x5b77d4(-0x11b,-0x8f)],_0x1dc2ba['array'][_0x497e21]),_0x1dc2ba[_0x5b77d4(-0x184,-0x14f)]=Math['max'](_0x1dc2ba['max'],_0x1dc2ba[_0x5b77d4(-0x125,-0x158)][_0x497e21]));}_0x335914['speed']=_0x1dc2ba;}return _0x335914;}[_0x557a97(-0x87,-0x105)](){var _0x58d3de;const _0x591fbc=this[_0x4d1c58(-0x23c,-0x238)];if(!_0x591fbc)return;const _0x1bbbcb=_0x591fbc[_0x1d0080(-0x2ad,-0x309)],_0x54dfde={};_0x54dfde['x']=0x0,_0x54dfde['y']=0x0;const _0x352f82={};_0x352f82['x']=0x0,_0x352f82['y']=_0x1bbbcb[_0x1d0080(-0x2ca,-0x2a1)];const _0x381e80={};function _0x4d1c58(_0x59b6bb,_0x4a51b7){return _0x99d407(_0x59b6bb,_0x4a51b7- -0x51a);}_0x381e80['x']=_0x1bbbcb[_0x4d1c58(-0x29d,-0x22b)],_0x381e80['y']=0x0;const _0x35a8fd={};_0x35a8fd['x']=_0x1bbbcb['clientWidth'],_0x35a8fd['y']=_0x1bbbcb['clientHeight'];const _0x1a2097=[_0x54dfde,_0x352f82,_0x381e80,_0x35a8fd];let _0x3ca736=0xb4,_0x523cd=-0xb4,_0x3d69ed=0x5a,_0x48046e=-0x5a,_0x168341=![];function _0x1d0080(_0x3b077a,_0x343ee4){return _0x557a97(_0x343ee4,_0x3b077a- -0x125);}for(const _0x378739 of _0x1a2097){const _0x5385f8=_0x591fbc[_0x4d1c58(-0x1f3,-0x237)]['pickEllipsoid'](new Cesium$1['Cartesian2'](_0x378739['x'],_0x378739['y']),_0x591fbc[_0x4d1c58(-0x1e7,-0x1ed)]['ellipsoid']);if(!_0x5385f8){_0x168341=!![];break;}const _0x14f91e=_0x591fbc['globe'][_0x4d1c58(-0x210,-0x1be)][_0x4d1c58(-0x250,-0x254)](_0x5385f8),_0x1164d2=Cesium$1['Math']['toDegrees'](_0x14f91e['longitude']),_0x2fa2cb=Cesium$1[_0x1d0080(-0x243,-0x1fe)][_0x4d1c58(-0x1cf,-0x1c9)](_0x14f91e[_0x1d0080(-0x26f,-0x2a2)]);_0x3ca736=Math['min'](_0x3ca736,_0x1164d2),_0x523cd=Math[_0x1d0080(-0x2b3,-0x2fd)](_0x523cd,_0x1164d2),_0x3d69ed=Math[_0x1d0080(-0x1f3,-0x20b)](_0x3d69ed,_0x2fa2cb),_0x48046e=Math['max'](_0x48046e,_0x2fa2cb);}if(!_0x168341){const _0x171f2e=new Cesium$1['Cartesian2'](Math[_0x4d1c58(-0x272,-0x277)](this[_0x1d0080(-0x225,-0x1ef)][_0x1d0080(-0x270,-0x243)]['west'],_0x3ca736),Math['min'](this[_0x4d1c58(-0x15b,-0x1e9)]['bounds']['east'],_0x523cd)),_0x1b59a4=new Cesium$1[(_0x4d1c58(-0x18a,-0x1a2))](Math['max'](this['windData'][_0x4d1c58(-0x1d2,-0x234)]['south'],_0x3d69ed),Math['min'](this[_0x1d0080(-0x225,-0x1aa)]['bounds']['north'],_0x48046e)),_0xc1c288=(_0x171f2e['y']-_0x171f2e['x'])*0.05,_0x143704=(_0x1b59a4['y']-_0x1b59a4['x'])*0.05;_0x171f2e['x']=Math[_0x1d0080(-0x2b3,-0x326)](this['windData'][_0x1d0080(-0x270,-0x2e9)]['west'],_0x171f2e['x']-_0xc1c288),_0x171f2e['y']=Math['min'](this['windData'][_0x1d0080(-0x270,-0x22a)]['east'],_0x171f2e['y']+_0xc1c288),_0x1b59a4['x']=Math[_0x1d0080(-0x2b3,-0x2b8)](this['windData']['bounds']['south'],_0x1b59a4['x']-_0x143704),_0x1b59a4['y']=Math[_0x4d1c58(-0x1f5,-0x1b7)](this['windData'][_0x1d0080(-0x270,-0x1f9)][_0x1d0080(-0x28a,-0x250)],_0x1b59a4['y']+_0x143704),this[_0x4d1c58(-0x254,-0x21a)]['lonRange']=_0x171f2e,this['viewerParameters']['latRange']=_0x1b59a4;const _0x2127cb=this['windData']['bounds']['east']-this[_0x4d1c58(-0x241,-0x1e9)]['bounds']['west'],_0xaac188=this['windData']['bounds']['north']-this['windData']['bounds'][_0x4d1c58(-0x2f1,-0x295)],_0x4353b6=(_0x171f2e['y']-_0x171f2e['x'])/_0x2127cb,_0x22a388=(_0x1b59a4['y']-_0x1b59a4['x'])/_0xaac188,_0x573fc4=Math[_0x4d1c58(-0x242,-0x1b7)](_0x4353b6,_0x22a388),_0x103eca=0x3e8*_0x573fc4;_0x103eca>0x0&&(this[_0x1d0080(-0x256,-0x22d)][_0x1d0080(-0x288,-0x250)]=Math['max'](0x0,Math['min'](0x3e8,_0x103eca)));}this[_0x1d0080(-0x256,-0x248)]['sceneMode']=this[_0x4d1c58(-0x23a,-0x238)][_0x4d1c58(-0x25f,-0x2a6)],(_0x58d3de=this['particleSystem'])===null||_0x58d3de===void 0x0||_0x58d3de['applyViewerParameters'](this['viewerParameters']);}['getDataAtLonLat'](_0x17eea9,_0x305bce){function _0x21d1c7(_0x349236,_0x511b96){return _0x557a97(_0x349236,_0x511b96-0x5cd);}const {bounds:_0x32a5ac,width:_0x3dc3d6,height:_0x915677,u:_0x2472d5,v:_0x4f0d89,speed:_0x3e6e71}=this['windData'],{flipY:_0x433f72}=this[_0x1ecbbd(0x365,0x3d4)];if(_0x17eea9<_0x32a5ac[_0x21d1c7(0x444,0x454)]||_0x17eea9>_0x32a5ac[_0x1ecbbd(0x2fa,0x2ed)]||_0x305bce<_0x32a5ac[_0x21d1c7(0x3e4,0x421)]||_0x305bce>_0x32a5ac[_0x1ecbbd(0x2ce,0x348)])return null;const _0x139d70=(_0x17eea9-_0x32a5ac[_0x21d1c7(0x459,0x454)])/(_0x32a5ac[_0x1ecbbd(0x354,0x2ed)]-_0x32a5ac[_0x21d1c7(0x436,0x454)])*(_0x3dc3d6-0x1);let _0x91808d=(_0x305bce-_0x32a5ac[_0x21d1c7(0x3ec,0x421)])/(_0x32a5ac[_0x21d1c7(0x45d,0x468)]-_0x32a5ac['south'])*(_0x915677-0x1);_0x433f72&&(_0x91808d=_0x915677-0x1-_0x91808d);const _0x2000a5=Math[_0x1ecbbd(0x3e1,0x3b0)](_0x139d70),_0x558917=Math[_0x21d1c7(0x444,0x4d0)](_0x91808d),_0x3679a5=Math[_0x1ecbbd(0x3da,0x3b0)](_0x139d70),_0x5557a3=Math['min'](_0x3679a5+0x1,_0x3dc3d6-0x1),_0x36129a=Math[_0x1ecbbd(0x415,0x3b0)](_0x91808d),_0x2dc55a=Math['min'](_0x36129a+0x1,_0x915677-0x1),_0x1ac907=_0x139d70-_0x3679a5,_0x4d49d3=_0x91808d-_0x36129a,_0x1eaef7=_0x558917*_0x3dc3d6+_0x2000a5,_0x2d8a26=_0x36129a*_0x3dc3d6+_0x3679a5,_0x336b8e=_0x36129a*_0x3dc3d6+_0x5557a3,_0x21eeb6=_0x2dc55a*_0x3dc3d6+_0x3679a5,_0x25691a=_0x2dc55a*_0x3dc3d6+_0x5557a3,_0x5f4d1d=_0x2472d5[_0x21d1c7(0x3cc,0x436)][_0x2d8a26],_0x332839=_0x2472d5['array'][_0x336b8e],_0x3527d9=_0x2472d5['array'][_0x21eeb6],_0xfbc688=_0x2472d5['array'][_0x25691a],_0x9e0b01=(0x1-_0x1ac907)*(0x1-_0x4d49d3)*_0x5f4d1d+_0x1ac907*(0x1-_0x4d49d3)*_0x332839+(0x1-_0x1ac907)*_0x4d49d3*_0x3527d9+_0x1ac907*_0x4d49d3*_0xfbc688,_0xb483e2=_0x4f0d89[_0x1ecbbd(0x381,0x316)][_0x2d8a26],_0x392674=_0x4f0d89['array'][_0x336b8e],_0x1e118e=_0x4f0d89['array'][_0x21eeb6],_0x392ac9=_0x4f0d89['array'][_0x25691a],_0x35019b=(0x1-_0x1ac907)*(0x1-_0x4d49d3)*_0xb483e2+_0x1ac907*(0x1-_0x4d49d3)*_0x392674+(0x1-_0x1ac907)*_0x4d49d3*_0x1e118e+_0x1ac907*_0x4d49d3*_0x392ac9,_0x571171=Math['sqrt'](_0x9e0b01*_0x9e0b01+_0x35019b*_0x35019b),_0x5d67c1={};_0x5d67c1['u']=_0x2472d5['array'][_0x1eaef7],_0x5d67c1['v']=_0x4f0d89['array'][_0x1eaef7],_0x5d67c1['speed']=_0x3e6e71['array'][_0x1eaef7];const _0x3cad97={};_0x3cad97['u']=_0x9e0b01;function _0x1ecbbd(_0x57d55c,_0xf25d05){return _0x557a97(_0x57d55c,_0xf25d05-0x4ad);}_0x3cad97['v']=_0x35019b,_0x3cad97['speed']=_0x571171;const _0x1c6600={};return _0x1c6600['original']=_0x5d67c1,_0x1c6600[_0x1ecbbd(0x367,0x346)]=_0x3cad97,_0x1c6600;}}mars3d__namespace['LayerUtil']['register'](_0x99d407(0x368,0x310),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){function _0x48ab7e(_0x56634b,_0x3a21ea){return _0x99d407(_0x3a21ea,_0x56634b- -0x3be);}function _0x4fa0cd(_0x26f8da,_0xed6c4e){return _0x99d407(_0x26f8da,_0xed6c4e-0x1f2);}this['lng']=null,this[_0x48ab7e(-0x74,-0x40)]=null,this['tlng']=null,this[_0x4fa0cd(0x479,0x4da)]=null,this['age']=null,this['speed']=null;}[_0x99d407(0x23a,0x268)](){for(const _0x5386c5 in this){delete this[_0x5386c5];}}}class CanvasWindField{constructor(_0x3edb61){function _0x1b352b(_0x8952d0,_0x24ce79){return _0x557a97(_0x8952d0,_0x24ce79- -0xbb);}this[_0x1b352b(-0x107,-0x179)](_0x3edb61);}get['speedRate'](){function _0x47dd78(_0x14dff8,_0x3fbb28){return _0x557a97(_0x14dff8,_0x3fbb28-0x598);}return this[_0x47dd78(0x4a5,0x41c)];}set['speedRate'](_0x25cdc8){this['_speedRate']=(0x64-(_0x25cdc8>0x63?0x63:_0x25cdc8))*0x64;function _0x51f3b0(_0x24d042,_0x376e90){return _0x557a97(_0x24d042,_0x376e90-0x40f);}function _0x4c5d2a(_0x2cab80,_0x2c612e){return _0x557a97(_0x2cab80,_0x2c612e-0x29d);}this['_calc_speedRate']=[(this[_0x4c5d2a(0x120,0x156)]-this[_0x51f3b0(0x1ec,0x27a)])/this['_speedRate'],(this['ymax']-this['ymin'])/this['_speedRate']];}get['maxAge'](){return this['_maxAge'];}set['maxAge'](_0x4d0c5d){this['_maxAge']=_0x4d0c5d;}['setOptions'](_0x143f13){function _0x132f75(_0x302280,_0x5d9a55){return _0x557a97(_0x5d9a55,_0x302280-0x1d);}function _0x3096e6(_0x3de30e,_0x4a0ef0){return _0x557a97(_0x4a0ef0,_0x3de30e-0x36);}this['options']=_0x143f13,this[_0x3096e6(-0x116,-0xa7)]=_0x143f13[_0x132f75(-0x12f,-0x10b)]||0x78,this['speedRate']=_0x143f13['speedRate']||0x32,this['particles']=[];const _0x12ef9c=_0x143f13['particlesNumber']||0x1000;for(let _0x56a2e5=0x0;_0x56a2e5<_0x12ef9c;_0x56a2e5++){const _0x477721=this[_0x3096e6(-0x125,-0xe8)](new CanvasParticle());this[_0x3096e6(-0x164,-0x13f)][_0x132f75(-0xd7,-0x149)](_0x477721);}}[_0x99d407(0x2d7,0x323)](_0x279c74){this[_0x255d19(0x42,-0x15)]=_0x279c74['rows'],this['cols']=_0x279c74['cols'],this[_0xb6c9d(-0x236,-0x258)]=_0x279c74['xmin'],this['xmax']=_0x279c74[_0xb6c9d(-0x268,-0x20a)],this['ymin']=_0x279c74['ymin'],this['ymax']=_0x279c74['ymax'],this['grid']=[];const _0xb87daa=_0x279c74[_0x255d19(0x3d,0xbb)],_0x48535e=_0x279c74['vdata'];function _0xb6c9d(_0x345154,_0x3cf5e9){return _0x99d407(_0x345154,_0x3cf5e9- -0x4f4);}let _0x1c167d=![];_0xb87daa[_0x255d19(0x15,-0x5a)]===this[_0xb6c9d(-0x1fe,-0x199)]&&_0xb87daa[0x0]['length']===this[_0x255d19(0xe,0x71)]&&(_0x1c167d=!![]);let _0x60b1a2=0x0,_0x539263=null;function _0x255d19(_0x5c72e7,_0x57f465){return _0x557a97(_0x57f465,_0x5c72e7-0x118);}let _0x107bda=null;for(let _0x54952e=0x0;_0x54952e<this[_0x255d19(0x42,0x6f)];_0x54952e++){_0x539263=[];for(let _0xa1a90f=0x0;_0xa1a90f<this['cols'];_0xa1a90f++,_0x60b1a2++){_0x1c167d?_0x107bda=this['_calcUV'](_0xb87daa[_0x54952e][_0xa1a90f],_0x48535e[_0x54952e][_0xa1a90f]):_0x107bda=this['_calcUV'](_0xb87daa[_0x60b1a2],_0x48535e[_0x60b1a2]),_0x539263['push'](_0x107bda);}this['grid'][_0x255d19(0x24,0x9f)](_0x539263);}!this['options']['flipY']&&this[_0x255d19(0x4d,0x27)]['reverse']();}['clear'](){delete this[_0x567dae(-0xca,-0x62)],delete this['cols'],delete this['xmin'];function _0x567dae(_0x206310,_0xfa9024){return _0x99d407(_0x206310,_0xfa9024- -0x3bd);}delete this['xmax'];function _0x3e499d(_0x2e03bc,_0x36c03f){return _0x557a97(_0x2e03bc,_0x36c03f-0x377);}delete this['ymin'],delete this[_0x3e499d(0x2dd,0x271)],delete this['grid'],delete this['particles'];}['toGridXY'](_0x1e2ec2,_0x471a79){function _0xa02531(_0x31a798,_0x15a3cd){return _0x99d407(_0x15a3cd,_0x31a798- -0x24e);}const _0x413c31=(_0x1e2ec2-this['xmin'])/(this['xmax']-this['xmin'])*(this[_0xa02531(0xd9,0xd4)]-0x1),_0x5949ac=(this['ymax']-_0x471a79)/(this['ymax']-this['ymin'])*(this['rows']-0x1);return[_0x413c31,_0x5949ac];}[_0x99d407(0x2e8,0x307)](_0x3a084f,_0x5d5580){if(_0x3a084f<0x0||_0x3a084f>=this[_0x54b491(0x2d3,0x2a8)]||_0x5d5580>=this['rows'])return[0x0,0x0,0x0];const _0x8e0e46=Math['floor'](_0x3a084f);function _0x453b99(_0x695a7a,_0x365c0c){return _0x557a97(_0x695a7a,_0x365c0c-0x1fc);}const _0xf99887=Math[_0x54b491(0x2e0,0x319)](_0x5d5580);if(_0x8e0e46===_0x3a084f&&_0xf99887===_0x5d5580)return this['grid'][_0x5d5580][_0x3a084f];const _0x55bc74=_0x8e0e46+0x1,_0x53ba0c=_0xf99887+0x1,_0xfc9842=this['getUVByXY'](_0x8e0e46,_0xf99887),_0x3573c7=this['getUVByXY'](_0x55bc74,_0xf99887),_0x5ed4c8=this[_0x54b491(0x2b3,0x2ab)](_0x8e0e46,_0x53ba0c),_0x5cc586=this['getUVByXY'](_0x55bc74,_0x53ba0c);function _0x54b491(_0x130fdd,_0x4233ed){return _0x99d407(_0x4233ed,_0x130fdd- -0x54);}let _0x5615d0=null;try{_0x5615d0=this[_0x54b491(0x24d,0x1f2)](_0x3a084f-_0x8e0e46,_0x5d5580-_0xf99887,_0xfc9842,_0x3573c7,_0x5ed4c8,_0x5cc586);}catch(_0x50bb39){console[_0x453b99(0xae,0x49)](_0x3a084f,_0x5d5580);}return _0x5615d0;}['_bilinearInterpolation'](_0xe67f97,_0x53a49c,_0x2e733f,_0x13da51,_0x54f15d,_0xdbf82a){const _0x26542a=0x1-_0xe67f97,_0x40e507=0x1-_0x53a49c,_0x2daf96=_0x26542a*_0x40e507,_0x33bf15=_0xe67f97*_0x40e507,_0xe67e8c=_0x26542a*_0x53a49c,_0x49479c=_0xe67f97*_0x53a49c,_0x33c025=_0x2e733f[0x0]*_0x2daf96+_0x13da51[0x0]*_0x33bf15+_0x54f15d[0x0]*_0xe67e8c+_0xdbf82a[0x0]*_0x49479c,_0x4a793f=_0x2e733f[0x1]*_0x2daf96+_0x13da51[0x1]*_0x33bf15+_0x54f15d[0x1]*_0xe67e8c+_0xdbf82a[0x1]*_0x49479c;return this['_calcUV'](_0x33c025,_0x4a793f);}['_calcUV'](_0x399102,_0x3cd450){return[+_0x399102,+_0x3cd450,Math['sqrt'](_0x399102*_0x399102+_0x3cd450*_0x3cd450)];}['getUVByPoint'](_0x1647e7,_0xf211fa){if(!this['isInExtent'](_0x1647e7,_0xf211fa))return null;const _0x15eb78=this['toGridXY'](_0x1647e7,_0xf211fa),_0x128976=this['getUVByXY'](_0x15eb78[0x0],_0x15eb78[0x1]);return _0x128976;}['isInExtent'](_0x4e0489,_0x137c29){function _0x496064(_0x4dc0e8,_0x42fcc8){return _0x99d407(_0x42fcc8,_0x4dc0e8-0x17c);}function _0x4329c9(_0x1394c5,_0x48600c){return _0x557a97(_0x1394c5,_0x48600c- -0x1);}return _0x4e0489>=this[_0x496064(0x418,0x432)]&&_0x4e0489<=this[_0x4329c9(-0xf1,-0x148)]&&_0x137c29>=this['ymin']&&_0x137c29<=this['ymax']?!![]:![];}[_0x557a97(-0x140,-0xfe)](){function _0x58755b(_0x21712b,_0x58de52){return _0x99d407(_0x58de52,_0x21712b- -0x3d6);}const _0x231da6=fRandomByfloat(this[_0x58755b(-0x13a,-0xfa)],this[_0x58755b(-0xec,-0x71)]),_0x24e7ab=fRandomByfloat(this['ymin'],this['ymax']),_0x261921={};_0x261921['lat']=_0x24e7ab;function _0x2f9de4(_0x164ebd,_0x1157e9){return _0x557a97(_0x164ebd,_0x1157e9-0xf9);}return _0x261921[_0x58755b(-0x61,-0xee)]=_0x231da6,_0x261921;}['getParticles'](){function _0x5dcf92(_0x22f2b0,_0x34ebdb){return _0x557a97(_0x22f2b0,_0x34ebdb-0x54d);}let _0x2fce02,_0x360c67,_0x3298c7;function _0x11088c(_0x9eb2a9,_0x6042a5){return _0x99d407(_0x9eb2a9,_0x6042a5-0xac);}for(let _0x38cbb9=0x0,_0x1a9bfa=this['particles']['length'];_0x38cbb9<_0x1a9bfa;_0x38cbb9++){let _0x5d0a3f=this[_0x5dcf92(0x3a9,0x3b3)][_0x38cbb9];_0x5d0a3f[_0x5dcf92(0x48f,0x433)]<=0x0&&(_0x5d0a3f=this['_randomParticle'](_0x5d0a3f));if(_0x5d0a3f[_0x11088c(0x3a2,0x3c3)]>0x0){const _0x54b3a8=_0x5d0a3f['tlng'],_0x368d54=_0x5d0a3f['tlat'];_0x3298c7=this[_0x5dcf92(0x484,0x45d)](_0x54b3a8,_0x368d54),_0x3298c7?(_0x2fce02=_0x54b3a8+this['_calc_speedRate'][0x0]*_0x3298c7[0x0],_0x360c67=_0x368d54+this['_calc_speedRate'][0x1]*_0x3298c7[0x1],_0x5d0a3f[_0x5dcf92(0x4a3,0x491)]=_0x54b3a8,_0x5d0a3f[_0x5dcf92(0x406,0x466)]=_0x368d54,_0x5d0a3f[_0x11088c(0x368,0x3c5)]=_0x2fce02,_0x5d0a3f['tlat']=_0x360c67,_0x5d0a3f['speed']=_0x3298c7[0x2],_0x5d0a3f['age']--):_0x5d0a3f[_0x5dcf92(0x4b2,0x433)]=0x0;}}return this[_0x5dcf92(0x34c,0x3b3)];}['_randomParticle'](_0x480230){function _0x2037b8(_0x1c758b,_0x2e87fb){return _0x99d407(_0x2e87fb,_0x1c758b- -0x1af);}let _0x178173,_0x24af87;for(let _0xff26b0=0x0;_0xff26b0<0x1e;_0xff26b0++){_0x178173=this['getRandomLatLng'](),_0x24af87=this['getUVByPoint'](_0x178173[_0x33bca3(0x5ad,0x5ac)],_0x178173['lat']);if(_0x24af87&&_0x24af87[0x2]>0x0)break;}if(!_0x24af87)return _0x480230;const _0x3ffa17=_0x178173['lng']+this[_0x33bca3(0x4aa,0x50b)][0x0]*_0x24af87[0x0],_0x2922fe=_0x178173['lat']+this[_0x33bca3(0x535,0x50b)][0x1]*_0x24af87[0x1];_0x480230['lng']=_0x178173['lng'],_0x480230['lat']=_0x178173['lat'],_0x480230['tlng']=_0x3ffa17,_0x480230['tlat']=_0x2922fe;function _0x33bca3(_0x493c79,_0x59863f){return _0x557a97(_0x493c79,_0x59863f-0x668);}return _0x480230[_0x33bca3(0x5da,0x54e)]=Math['round'](0xa+Math['random']()*this[_0x2037b8(0x136,0x16e)]),_0x480230['speed']=_0x24af87[0x2],_0x480230;}[_0x99d407(0x1ea,0x268)](){for(const _0xa20e8c in this){delete this[_0xa20e8c];}}}function fRandomByfloat(_0x18ef3e,_0x433823){return _0x18ef3e+Math['random']()*(_0x433823-_0x18ef3e);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x557a97(-0x7d,-0xff)][_0x99d407(0x2de,0x28d)];function _0x2672(){const _0x432567=['particleSystem','stringify','getUpdatePositionShader','_speedRate','primitives','drawingBufferWidth','west','steps','dropRate','getPrimitives','mouseHidden','canvasHeight','speedFactor','redraw','drawingBufferHeight','_removedHook','_onMapWhellEvent','20055qXTiia','frameRateMonitor','height','cartesianToCartographic','mouse_move','none','mouse_down','interpolated','CanvasWindField','north','FLOAT','pixelSize','_pointerEvents','style','ONE_MINUS_SRC_ALPHA','outputTexture','particlesNumber','_calc_speedRate','MAX_VALUE','_randomParticle','strokeStyle','NEAREST','Draw','forEach','39845LfBkcZ','pow','preExecute','_showHook','blendEquation','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a','textures','scene','camera','sin','maxAge','bounds','latitude','tlat','previousParticlesPosition','xmax','color','_drawLines','keys','samplingWindow','clientWidth','blendFuncSource','processWindData','addEventListener','rawRenderState','_onMouseDownEvent','_tomap','max\x20is\x20undefined,\x20calculate\x20max','reCreateWindTextures','warn','204SptlTd','toWindowCoordinates','rendering','mouseMove','mouseDown','createSegmentsGeometry','flipY','viewerParameters','sqrt','visible','beginPath','requestRender','random','unbindEvent','getUVByXY','clearFramebuffers','stroke','pointer-events','RGBA','abs','create','call','pixelFormat','wind','createWindTextures','vertexShaderSource','Math','windField','alt','_createCanvas','age','_addedHook','tlng','7497564aFmwQU','4311poWyQk','vertexArray','particlesTextureSize','updateOptions','pass','hidden','_updateIng2','dynamic','setDate','2174920nkoJoM','postMessage','createColorTableTexture','cols','moveTo','windTextures','WindLayer','ymax','updateViewerParameters','globe','length','getU','register','windData','layer','getRandomLatLng','floor','rectangle','createRenderingTextures','isDynamic','remove','value','7ExHFNm','_setOptionsHook','vmax','push','default','attributeLocations','show','getUVByPoint','createPrimitives','7260vZfhrQ','get','position','commandToExecute','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a','computing','fromDegrees','lat','speedRate','cancelAnimationFrame','createComputingPrimitives','onParticlesTextureSizeChange','talt','values','toDegrees','updatePosition','DomUtil','depthMask','particlesSpeed','udata','OPAQUE','options','frameRateAdjustment','refreshTimer','rows','ellipsoid','SCENE3D','frameTime','destroyParticlesTextures','update','canvasWidth','0px','min','particlesTextures','mouseUp','grid','now','primitiveType','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a','STATIC_DRAW','colorTable','add','clearCommand','_canrefresh','_animateFrame','getDefaultRenderState','canvasContext','componentsPerAttribute','setOptions','_colorRamp','lng','isPointVisible','UNSIGNED_INT','Cartesian2','init','context','17337vwYnJt','segments','lineLength','pixelDatatype','createRenderingFramebuffers','fromGeometry','calculateSpeed','fill','10odymAd','destroy','getColor','removeEventListener','object','Cesium','segmentsDepth','data','width','frameState.commandList\x20is\x20undefined','east','owner','worker','mode','bind','LINEAR','Log','changeOptions','shaderProgram','fillRect','1478336THKRxc','EventType','pointerEvents','log','colors','getParticles','blue','__esModule','type','speed','south','sources','dropRateBump','fragmentShaderSource','SRC_ALPHA','commandType','getSegmentDrawFragmentShader','clientHeight','BaseLayer','currentParticlesPosition','framebuffers','_onMouseMoveEvent','160kADqos','Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.','fixedHeight','TRIANGLES','off','ColorRamp','particles','nextParticlesPosition','domain','array','postProcessingPosition','xmin','displayRange','geometry','_map','positionWC','_bilinearInterpolation','uniformMap','max','bufferUsage','framebuffer','depthTexture','createParticlesTextures','setData','canvas','globalCompositeOperation','lineWidth','resize','globalAlpha','destoryRenderingFramebuffers','error','magnificationFilter','atan2'];_0x2672=function(){return _0x432567;};return _0x2672();}class CanvasWindLayer extends BaseLayer{constructor(_0x3d42d={}){function _0x2d7bd1(_0xc86fb4,_0x219198){return _0x99d407(_0x219198,_0xc86fb4- -0x30e);}super(_0x3d42d),this[_0x2d7bd1(0x2d,0x73)](_0x3d42d);function _0x2fbef4(_0x15b586,_0x3e0afa){return _0x557a97(_0x15b586,_0x3e0afa-0x64f);}this['canvas']=null,_0x3d42d['colors']&&_0x3d42d[_0x2d7bd1(-0x55,-0xce)]&&(this[_0x2d7bd1(0x66,0x5d)]=new mars3d__namespace[(_0x2fbef4(0x44e,0x4b4))](_0x3d42d));}[_0x99d407(0x37a,0x33b)](_0x3f081e,_0xeaa4f7){this[_0x100d18(0x2b1,0x280)]=0x3e8/(_0x3f081e['frameRate']||0xa);function _0x35b796(_0x578708,_0x471ef6){return _0x557a97(_0x471ef6,_0x578708-0x204);}this['_pointerEvents']=this['options']['pointerEvents']??![],this[_0x35b796(0xbe,0xf6)]=_0x3f081e[_0x35b796(0xbe,0x13b)]||'#ffffff';function _0x100d18(_0x1de8c4,_0x546c14){return _0x557a97(_0x546c14,_0x1de8c4-0x384);}this['lineWidth']=_0x3f081e['lineWidth']||0x1,this[_0x35b796(0x66,0xd7)]=_0x3f081e['fixedHeight']??0x0,this['flipY']=_0x3f081e['flipY']??![],this['windField']&&this['windField']['setOptions'](_0x3f081e);}get['layer'](){function _0x8ac272(_0x4617dd,_0x5cb9dc){return _0x99d407(_0x4617dd,_0x5cb9dc-0x195);}return this[_0x8ac272(0x47f,0x43e)];}get['canvasWidth'](){function _0x3a8fb1(_0x4908d2,_0x228567){return _0x557a97(_0x4908d2,_0x228567-0x10e);}function _0x6830ab(_0x231590,_0x49ba49){return _0x557a97(_0x231590,_0x49ba49- -0xa3);}return this[_0x3a8fb1(-0x7c,-0x84)][_0x3a8fb1(0x6,-0x41)][_0x6830ab(-0x259,-0x22b)]['clientWidth'];}get[_0x99d407(0x27b,0x2bd)](){function _0x2f1ed5(_0x80da2,_0x590455){return _0x557a97(_0x80da2,_0x590455-0x2c8);}function _0x282fbd(_0x519b82,_0x230843){return _0x557a97(_0x519b82,_0x230843- -0x55);}return this['_map'][_0x2f1ed5(0x1fc,0x179)]['canvas'][_0x2f1ed5(0x141,0x123)];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x557a97(-0x20c,-0x1b4)](_0x4e8c06){function _0x2eabac(_0x2420de,_0x5006ed){return _0x557a97(_0x5006ed,_0x2420de- -0xdd);}function _0x595075(_0x3d836b,_0x4ad5af){return _0x557a97(_0x3d836b,_0x4ad5af-0x62f);}this[_0x595075(0x528,0x4cd)]=_0x4e8c06;if(!this[_0x2eabac(-0x265,-0x2d6)])return;_0x4e8c06?this[_0x595075(0x420,0x4a7)][_0x595075(0x44a,0x4ce)][_0x595075(0x572,0x508)]='all':this[_0x2eabac(-0x265,-0x1ea)]['style'][_0x595075(0x4b1,0x508)]=_0x595075(0x49d,0x4c6);}get['particlesNumber'](){function _0x5333b6(_0x1911fc,_0x15e0e2){return _0x99d407(_0x15e0e2,_0x1911fc- -0x3de);}function _0xa4adf0(_0x3abc12,_0x182f07){return _0x99d407(_0x182f07,_0x3abc12- -0x188);}return this[_0x5333b6(-0x86,-0x54)][_0xa4adf0(0x14b,0x165)];}set[_0x557a97(-0xf6,-0x15e)](_0x1403ab){function _0x2edef5(_0x3dc5c7,_0x207ad4){return _0x557a97(_0x207ad4,_0x3dc5c7- -0xb5);}this['options']['particlesNumber']=_0x1403ab,clearTimeout(this['_canrefresh']),this[_0x2edef5(-0x178,-0x179)]=setTimeout(()=>{function _0x42d760(_0x3b738e,_0x3cb2bc){return _0x2edef5(_0x3cb2bc-0x4c4,_0x3b738e);}this[_0x42d760(0x265,0x29d)]();},0x1f4);}get['speedRate'](){function _0x5a15b5(_0x2ac1e8,_0x3a7533){return _0x99d407(_0x2ac1e8,_0x3a7533- -0x13c);}return this[_0x5a15b5(0x1e8,0x21c)]['speedRate'];}set[_0x557a97(-0x82,-0xe6)](_0x32917c){this[_0x49ce34(0x29b,0x2ec)]['speedRate']=_0x32917c;function _0x49ce34(_0x1177e5,_0x115eff){return _0x557a97(_0x115eff,_0x1177e5-0x374);}this['windField']&&(this['windField']['speedRate']=_0x32917c);}get['maxAge'](){return this['options']['maxAge'];}set['maxAge'](_0x184c0f){this[_0x6b226(-0x18,0x12)]['maxAge']=_0x184c0f;function _0x1290f1(_0x3cb582,_0x3446a3){return _0x557a97(_0x3446a3,_0x3cb582-0x44);}function _0x6b226(_0x302eae,_0x5d4b38){return _0x99d407(_0x5d4b38,_0x302eae- -0x370);}this[_0x6b226(-0x5c,-0x40)]&&(this[_0x1290f1(-0xd9,-0x7c)]['maxAge']=_0x184c0f);}get['data'](){return this['windData'];}set[_0x557a97(-0x1bb,-0x1c3)](_0x26998e){function _0x280086(_0x18e3d6,_0x4751f0){return _0x99d407(_0x18e3d6,_0x4751f0- -0x342);}this[_0x280086(-0x10c,-0x9a)](_0x26998e);}get[_0x99d407(0x370,0x335)](){let _0x74fb37=this[_0x4cc270(0x400,0x400)][_0x2c4365(-0x24c,-0x26c)],_0x1c8fbb=this[_0x4cc270(0x377,0x400)]['xmax'],_0x3af1db=this[_0x4cc270(0x467,0x400)]['ymin'],_0x2d1cf4=this['windData'][_0x2c4365(-0x1bd,-0x1ba)];_0x1c8fbb>=0x167&&_0x74fb37===0x0&&(_0x74fb37=-0xb4,_0x1c8fbb=0xb4);_0x74fb37=Math[_0x2c4365(-0x245,-0x1c7)](_0x74fb37,-0xb4),_0x1c8fbb=Math[_0x4cc270(0x403,0x432)](_0x1c8fbb,0xb4);function _0x4cc270(_0x67ff6a,_0x52b1d4){return _0x99d407(_0x67ff6a,_0x52b1d4-0xcf);}_0x3af1db=Math[_0x2c4365(-0x245,-0x281)](_0x3af1db,-0x5a),_0x2d1cf4=Math[_0x2c4365(-0x185,-0x1f3)](_0x2d1cf4,0x5a);function _0x2c4365(_0x3bb1f6,_0x59faa7){return _0x99d407(_0x59faa7,_0x3bb1f6- -0x4e8);}return Cesium['Rectangle'][_0x2c4365(-0x19f,-0x1b1)](_0x74fb37,_0x3af1db,_0x1c8fbb,_0x2d1cf4);}[_0x557a97(-0x133,-0x153)](_0x1b049d){function _0x2632b8(_0x5a07fd,_0x191395){return _0x557a97(_0x5a07fd,_0x191395-0x3b8);}function _0x1a4359(_0x515037,_0x137ba3){return _0x557a97(_0x515037,_0x137ba3-0x5c2);}_0x1b049d?this['_addedHook']():(this[_0x1a4359(0x4ac,0x4c2)]&&(this['options'][_0x1a4359(0x417,0x3ff)]=this[_0x2632b8(0x2f0,0x2b8)]),this[_0x2632b8(0x288,0x248)]());}['_mountedHook'](){function _0x340c7a(_0x1fcbe9,_0x36c377){return _0x557a97(_0x1fcbe9,_0x36c377-0x4ab);}this['options'][_0x340c7a(0x2e0,0x2ed)]?this['initWorker']():this['windField']=new CanvasWindField(this['options']);}['_addedHook'](){this['canvas']=this[_0x4d3cca(-0x272,-0x23f)]();function _0x4d3cca(_0x5b4a25,_0x37a26a){return _0x99d407(_0x5b4a25,_0x37a26a- -0x555);}const _0x4ef63c={};function _0x64dd4f(_0x31bb48,_0x4aa769){return _0x99d407(_0x4aa769,_0x31bb48- -0x84);}_0x4ef63c['willReadFrequently']=!![],this[_0x64dd4f(0x2ed,0x2fe)]=this[_0x4d3cca(-0x292,-0x2ac)]['getContext']('2d',_0x4ef63c),this['bindEvent'](),this[_0x4d3cca(-0x1e6,-0x1fd)][_0x64dd4f(0x1ea,0x230)]&&this[_0x64dd4f(0x224,0x1a7)](this[_0x4d3cca(-0x1d3,-0x1fd)][_0x4d3cca(-0x310,-0x2e7)]);}['_removedHook'](){function _0x54cd71(_0x3c7648,_0x53d7a9){return _0x557a97(_0x3c7648,_0x53d7a9-0x40b);}function _0x5638c2(_0x5ad12f,_0x14cdd8){return _0x557a97(_0x14cdd8,_0x5ad12f- -0x87);}this['clear'](),this['unbindEvent'](),this['canvas']&&(this[_0x5638c2(-0x219,-0x1b9)]['container']['removeChild'](this['canvas']),delete this[_0x5638c2(-0x20f,-0x1ee)]);}['_createCanvas'](){function _0x419b1c(_0x189905,_0x28a541){return _0x557a97(_0x28a541,_0x189905-0x21b);}const _0x59bfa3=mars3d__namespace[_0x1dce04(0x1f9,0x174)]['create']('canvas','mars3d-canvasWind',this['_map']['container']);_0x59bfa3[_0x1dce04(0x176,0x121)][_0x419b1c(0x12f,0xbd)]='absolute',_0x59bfa3['style']['top']='0px',_0x59bfa3['style']['left']=_0x419b1c(0x14c,0x1a0),_0x59bfa3[_0x1dce04(0x176,0xf6)][_0x419b1c(0x59,0x23)]=this[_0x419b1c(0x89,0xee)]['scene']['canvas']['clientWidth']+'px',_0x59bfa3['style']['height']=this[_0x419b1c(0x89,0xc5)][_0x1dce04(0x188,0x1d3)][_0x1dce04(0x14f,0x1bc)]['clientHeight']+'px',_0x59bfa3['style'][_0x419b1c(0x67,0x7c)]=this[_0x419b1c(0xb9,0x73)]?'auto':'none',_0x59bfa3[_0x419b1c(0xba,0x10a)]['zIndex']=this[_0x1dce04(0x1fe,0x21f)]['zIndex']??0x9;function _0x1dce04(_0x5d4d42,_0x2eb305){return _0x99d407(_0x2eb305,_0x5d4d42- -0x15a);}return _0x59bfa3['width']=this[_0x1dce04(0x145,0x1c9)]['scene']['canvas'][_0x1dce04(0x195,0x18a)],_0x59bfa3['height']=this[_0x419b1c(0x89,0x2c)]['scene'][_0x1dce04(0x14f,0x16a)]['clientHeight'],_0x59bfa3;}[_0x99d407(0x256,0x2ac)](){function _0x3f7f74(_0x521e57,_0x1f3282){return _0x99d407(_0x1f3282,_0x521e57- -0x2bb);}function _0x4b550e(_0x125601,_0x20d4c2){return _0x557a97(_0x20d4c2,_0x125601-0x2af);}this[_0x3f7f74(-0x12,-0x24)]&&(this['canvas']['style']['width']=this[_0x4b550e(0x11d,0x1a4)][_0x3f7f74(0x27,0x53)]['canvas'][_0x4b550e(0x16d,0xeb)]+'px',this[_0x4b550e(0x127,0x13b)]['style'][_0x3f7f74(0xa,0x1f)]=this['_map'][_0x4b550e(0x160,0x17a)]['canvas'][_0x4b550e(0x10a,0xc6)]+'px',this['canvas']['width']=this[_0x3f7f74(-0x1c,-0xa7)][_0x4b550e(0x160,0x110)][_0x3f7f74(-0x12,0x49)][_0x4b550e(0x16d,0x16a)],this['canvas'][_0x4b550e(0x143,0x193)]=this['_map']['scene']['canvas']['clientHeight']);}['bindEvent'](){const _0x3bf0dd=this;function _0x5d2bf8(_0x477d26,_0xa4ec8c){return _0x557a97(_0xa4ec8c,_0x477d26-0x1f3);}let _0x538f1c=Date[_0x5d2bf8(0x129,0xed)]();(function _0x2a705f(){function _0x1a587e(_0x2d87fd,_0x405c41){return _0x5d2bf8(_0x405c41-0x478,_0x2d87fd);}if(_0x3bf0dd['isDestroy'])return;function _0x3e90da(_0x4e8529,_0x43cf72){return _0x5d2bf8(_0x43cf72- -0x107,_0x4e8529);}_0x3bf0dd['_animateFrame']=window['requestAnimationFrame'](_0x2a705f);if(_0x3bf0dd['show']&&_0x3bf0dd[_0x3e90da(-0x37,-0x31)]){const _0x56c162=Date['now'](),_0x282bba=_0x56c162-_0x538f1c;_0x282bba>_0x3bf0dd['frameTime']&&(_0x538f1c=_0x56c162-_0x282bba%_0x3bf0dd[_0x1a587e(0x621,0x598)],_0x3bf0dd[_0x1a587e(0x593,0x59a)]());}}());function _0x473fef(_0x58559e,_0x15249b){return _0x557a97(_0x58559e,_0x15249b- -0x57);}window[_0x473fef(-0x15f,-0x196)](_0x5d2bf8(0x6e,0xc7),this['resize'][_0x473fef(-0x26f,-0x213)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this['options']['mouseHidden']&&(this[_0x5d2bf8(0x61,0x4f)]['on'](mars3d__namespace['EventType']['wheel'],this[_0x473fef(-0x1bf,-0x1c6)],this),this['_map']['on'](mars3d__namespace['EventType'][_0x473fef(-0x156,-0x18b)],this['_onMouseDownEvent'],this),this[_0x5d2bf8(0x61,0xd5)]['on'](mars3d__namespace['EventType'][_0x473fef(-0xb2,-0x123)],this['_onMouseUpEvent'],this));}[_0x557a97(-0x120,-0x12b)](){function _0x5e7157(_0x156b25,_0x1f2fc7){return _0x557a97(_0x156b25,_0x1f2fc7-0x295);}function _0x303552(_0x5bb6ce,_0x519cd4){return _0x557a97(_0x519cd4,_0x5bb6ce-0x21d);}window[_0x303552(0x138,0xc7)](this['_animateFrame']),delete this[_0x5e7157(0x1d9,0x1d3)],window['removeEventListener']('resize',this[_0x5e7157(0xb0,0x110)]),this['options'][_0x303552(0xa8,0x58)]&&(this['_map']['off'](mars3d__namespace['EventType']['wheel'],this[_0x5e7157(0xfa,0x126)],this),this[_0x5e7157(0x159,0x103)][_0x303552(0x81,0x29)](mars3d__namespace['EventType']['mouseDown'],this[_0x303552(0xe0,0xb0)],this),this['_map']['off'](mars3d__namespace['EventType'][_0x5e7157(0x1e1,0x1c9)],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this));}[_0x557a97(-0x150,-0x16f)](_0x36d7e1){clearTimeout(this[_0x122420(0x3cf,0x44a)]);if(!this['show']||!this['canvas'])return;this['canvas']['style']['visibility']='hidden';function _0x122420(_0x9aaeeb,_0x18d5d1){return _0x557a97(_0x18d5d1,_0x9aaeeb-0x4a6);}this['refreshTimer']=setTimeout(()=>{if(!this[_0x368da2(-0xac,-0x132)])return;function _0x368da2(_0x3d668c,_0x500e5e){return _0x122420(_0x500e5e- -0x4e7,_0x3d668c);}function _0x568ca5(_0x2e2d8c,_0x2a4d09){return _0x122420(_0x2a4d09- -0x31c,_0x2e2d8c);}this[_0x568ca5(-0x4c,0x18)](),this['canvas'][_0x368da2(-0x20c,-0x1a2)]['visibility']=_0x368da2(-0xe3,-0x170);},0xc8);}[_0x99d407(0x356,0x2f4)](_0x5cd3c2){this[_0x26bf17(-0x214,-0x1a3)]=!![];function _0x5d5ee8(_0x54a1d3,_0x5e0fb5){return _0x557a97(_0x5e0fb5,_0x54a1d3-0x1e2);}function _0x26bf17(_0x3bb303,_0x1bb423){return _0x557a97(_0x3bb303,_0x1bb423- -0x3b);}this[_0x26bf17(-0x249,-0x1cd)]['off'](mars3d__namespace[_0x5d5ee8(0x2d,0x24)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x5d5ee8(0xad,0xfe)],this['_onMouseMoveEvent'],this);}[_0x99d407(0x236,0x290)](_0x185f31){function _0x16a5a3(_0xbf3de6,_0x352091){return _0x557a97(_0x352091,_0xbf3de6-0x2f5);}if(!this['show']||!this[_0x70ae69(-0x20f,-0x1c2)])return;function _0x70ae69(_0x352e6a,_0x4111d0){return _0x557a97(_0x352e6a,_0x4111d0- -0x3a);}this['mouse_down']&&(this['canvas']['style']['visibility']=_0x16a5a3(0x1e4,0x20e),this['mouse_move']=!![]);}['_onMouseUpEvent'](_0x1a5101){if(!this['show']||!this['canvas'])return;this[_0x518bff(0x30a,0x31b)]['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);function _0x518bff(_0x37e53c,_0x3b375f){return _0x557a97(_0x37e53c,_0x3b375f-0x4ad);}this[_0x28df10(-0x14,-0x4e)]&&this['mouse_move']&&this[_0x518bff(0x387,0x33b)]();this[_0x28df10(-0x34,-0xc1)][_0x518bff(0x354,0x34c)]['visibility']=_0x518bff(0x3b6,0x37e);function _0x28df10(_0x226ae7,_0x470cab){return _0x557a97(_0x470cab,_0x226ae7-0x154);}this[_0x518bff(0x2cf,0x345)]=![],this[_0x518bff(0x388,0x343)]=![];}['setData'](_0x3a0235){function _0x4f14bf(_0x11e64e,_0x453e62){return _0x99d407(_0x453e62,_0x11e64e- -0x14c);}function _0x2a774a(_0x53ad4d,_0x41d5d7){return _0x99d407(_0x41d5d7,_0x53ad4d- -0x277);}this['clear'](),this['windData']=_0x3a0235,this[_0x2a774a(0x9d,0x104)][_0x2a774a(0xac,0x28)](_0x3a0235),this['redraw']();}['redraw'](){function _0x5f05c4(_0x197514,_0x274704){return _0x557a97(_0x274704,_0x197514-0x1f1);}function _0x1764ed(_0x52794a,_0x5d672f){return _0x99d407(_0x5d672f,_0x52794a-0x242);}if(!this['show'])return;this[_0x1764ed(0x556,0x581)]['setOptions'](this[_0x1764ed(0x59a,0x610)]),this['update']();}['update'](){if(this['_updateIng'])return;function _0x1b741a(_0x30d075,_0x304374){return _0x557a97(_0x304374,_0x30d075-0x2ba);}this['_updateIng']=!![];if(this['worker'])this['windField'][_0x1b741a(0x1e9,0x193)]();else{const _0x1e34aa=this['windField'][_0xdd7ee5(-0x168,-0x199)]();this[_0xdd7ee5(-0xfc,-0x151)](_0x1e34aa);}function _0xdd7ee5(_0x8e9aff,_0x1d63cc){return _0x557a97(_0x1d63cc,_0x8e9aff-0x49);}this['_updateIng']=![];}[_0x99d407(0x2aa,0x2ec)](_0x278cbf){this['_canvasParticles']=_0x278cbf;function _0x1f2a54(_0xd291f4,_0x3401c7){return _0x557a97(_0x3401c7,_0xd291f4- -0x85);}this['canvasContext'][_0xdc591f(0x11c,0x11c)]='destination-in',this['canvasContext'][_0x1f2a54(-0x23c,-0x261)](0x0,0x0,this[_0x1f2a54(-0x155,-0x1a8)],this[_0xdc591f(0x12f,0x112)]),this[_0xdc591f(0x1e3,0x1e7)]['globalCompositeOperation']='lighter';function _0xdc591f(_0x1f27e2,_0x3b03bc){return _0x557a97(_0x3b03bc,_0x1f27e2-0x2a3);}this[_0x1f2a54(-0x145,-0x1b8)][_0x1f2a54(-0x209,-0x203)]=0.9;const _0x22ec3e=this[_0xdc591f(0x111,0x12c)][_0xdc591f(0x154,0x13c)][_0xdc591f(0xe6,0x120)]!==Cesium['SceneMode'][_0x1f2a54(-0x159,-0x15b)],_0x220758=this['canvasWidth']*0.25;if(this[_0x1f2a54(-0x142,-0x19d)])for(let _0xfb3e58=0x0,_0x4acb5f=_0x278cbf['length'];_0xfb3e58<_0x4acb5f;_0xfb3e58++){const _0x309be2=_0x278cbf[_0xfb3e58],_0x16ae2f=this['_tomap'](_0x309be2,_0x309be2[_0xdc591f(0x1e7,0x1c8)],_0x309be2[_0x1f2a54(-0x16c,-0x106)],_0x309be2[_0xdc591f(0x187,0x20f)]),_0x21ac59=this[_0xdc591f(0x167,0xfa)](_0x309be2,_0x309be2[_0x1f2a54(-0x19d,-0x17f)],_0x309be2['tlat'],_0x309be2['talt']);if(!_0x16ae2f||!_0x21ac59)continue;if(_0x22ec3e&&Math[_0xdc591f(0x17e,0x13f)](_0x16ae2f[0x0]-_0x21ac59[0x0])>=_0x220758)continue;this[_0xdc591f(0x1e3,0x242)]['beginPath'](),this[_0x1f2a54(-0x145,-0x1cc)]['lineWidth']=this[_0xdc591f(0x11d,0xb8)],this['canvasContext'][_0x1f2a54(-0x1df,-0x1f5)]=this[_0x1f2a54(-0x142,-0x145)][_0xdc591f(0xdb,0xbf)](_0x309be2['speed']),this['canvasContext']['moveTo'](_0x16ae2f[0x0],_0x16ae2f[0x1]),this['canvasContext']['lineTo'](_0x21ac59[0x0],_0x21ac59[0x1]),this['canvasContext'][_0x1f2a54(-0x1ad,-0x22c)]();}else{this[_0xdc591f(0x1e3,0x15d)][_0xdc591f(0x175,0x1c6)](),this['canvasContext'][_0xdc591f(0x11d,0x145)]=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];for(let _0x4cee61=0x0,_0x235255=_0x278cbf['length'];_0x4cee61<_0x235255;_0x4cee61++){const _0xf8cd2c=_0x278cbf[_0x4cee61],_0x4cb467=this['_tomap'](_0xf8cd2c,_0xf8cd2c['lng'],_0xf8cd2c['lat'],_0xf8cd2c['alt']),_0x312afc=this['_tomap'](_0xf8cd2c,_0xf8cd2c[_0xdc591f(0x18b,0x1ea)],_0xf8cd2c['tlat'],_0xf8cd2c[_0x1f2a54(-0x167,-0x139)]);if(!_0x4cb467||!_0x312afc)continue;if(_0x22ec3e&&Math['abs'](_0x4cb467[0x0]-_0x312afc[0x0])>=_0x220758)continue;this['canvasContext'][_0xdc591f(0x19a,0x210)](_0x4cb467[0x0],_0x4cb467[0x1]),this[_0xdc591f(0x1e3,0x1e4)]['lineTo'](_0x312afc[0x0],_0x312afc[0x1]);}this['canvasContext']['stroke']();}}['_tomap'](_0x4c988c,_0x42c663,_0x15987b,_0x2418a0){function _0x28f3f8(_0x1e70df,_0x4c50bb){return _0x99d407(_0x4c50bb,_0x1e70df-0x1c2);}const _0x279d99=Cesium['Cartesian3'][_0x3736a8(-0x142,-0x1a2)](_0x42c663,_0x15987b,_0x2418a0??this['fixedHeight']),_0x17d3bf=this['_map']['scene'];if(_0x17d3bf[_0x3736a8(-0x217,-0x1e5)]===Cesium['SceneMode']['SCENE3D']){const _0x9d48b3=new Cesium['EllipsoidalOccluder'](_0x17d3bf['globe']['ellipsoid'],_0x17d3bf[_0x28f3f8(0x4a5,0x52a)][_0x3736a8(-0x1eb,-0x195)]),_0x43320e=_0x9d48b3[_0x3736a8(-0x115,-0x124)](_0x279d99);if(!_0x43320e)return _0x4c988c['age']=0x0,null;}function _0x3736a8(_0x10178b,_0x38ef24){return _0x557a97(_0x38ef24,_0x10178b- -0x5a);}const _0x1836ee=mars3d__namespace['PointTrans'][_0x28f3f8(0x4bc,0x4e8)](this[_0x28f3f8(0x461,0x4a4)]['scene'],_0x279d99);return _0x1836ee?[_0x1836ee['x'],_0x1836ee['y']]:null;}['clear'](){function _0x416be8(_0x3fa736,_0x33c047){return _0x557a97(_0x33c047,_0x3fa736- -0xd1);}this['windField']['clear'](),delete this[_0x416be8(-0x1d1,-0x237)];}['initWorker'](){this['worker']=new Worker(this[_0x24e7d0(-0x1b2,-0x216)][_0x394422(-0x54,-0x28)]);function _0x24e7d0(_0x1e2a6c,_0x557f66){return _0x557a97(_0x557f66,_0x1e2a6c- -0xd9);}this['worker']['onmessage']=_0x386254=>{function _0x51e550(_0x3d2824,_0x36da77){return _0x24e7d0(_0x36da77-0x153,_0x3d2824);}function _0x47258d(_0x69e332,_0x4d9fd3){return _0x394422(_0x4d9fd3-0x202,_0x69e332);}this[_0x47258d(0x28f,0x227)](_0x386254[_0x51e550(-0x140,-0x149)]['particles']),this[_0x51e550(-0xc4,-0x96)]=![];};function _0x394422(_0x5a880,_0xb72cf4){return _0x99d407(_0xb72cf4,_0x5a880- -0x2c7);}this['windField']={'init':_0x3583ec=>{const _0x16b775={};_0x16b775[_0x246f06(-0x153,-0x1ba)]='init',_0x16b775['options']=_0x3583ec;function _0x246f06(_0x37ccd0,_0x4b4172){return _0x24e7d0(_0x37ccd0-0x134,_0x4b4172);}this['worker']['postMessage'](_0x16b775);},'setOptions':_0x503c32=>{const _0x14857b={};_0x14857b['type']='setOptions',_0x14857b['options']=_0x503c32,this['worker']['postMessage'](_0x14857b);},'setDate':_0x3f84bb=>{const _0x5b508b={};function _0x39dfaa(_0x58692d,_0x2a9ebb){return _0x24e7d0(_0x58692d-0x10a,_0x2a9ebb);}function _0x28d2c9(_0x5b4dfc,_0x376ac4){return _0x394422(_0x5b4dfc-0x119,_0x376ac4);}_0x5b508b['type']=_0x39dfaa(-0xdd,-0xb2),_0x5b508b[_0x39dfaa(-0x192,-0x19d)]=_0x3f84bb,this[_0x28d2c9(0xc5,0xf6)][_0x39dfaa(-0xdb,-0x144)](_0x5b508b);},'update':()=>{if(this['_updateIng2'])return;this['_updateIng2']=!![];const _0x437f29={};_0x437f29['type']='update',this['worker']['postMessage'](_0x437f29);},'clear':()=>{const _0x4b337b={};_0x4b337b['type']='clear',this['worker']['postMessage'](_0x4b337b);}},this[_0x394422(0x4d,0xd1)][_0x24e7d0(-0x191,-0x129)](this[_0x394422(0x91,0x92)]);}}mars3d__namespace['LayerUtil'][_0x557a97(-0xa8,-0x101)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace[_0x557a97(-0x1b2,-0x166)]=CanvasWindField,mars3d__namespace[_0x99d407(0x28d,0x277)]['logInfo']('mars3d-wind插件\x20注册成功'),mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports[_0x99d407(0x36e,0x32a)]=WindLayer,exports['WindUtil']=WindUtil;const _0x26f621={};_0x26f621[_0x557a97(-0x88,-0xf8)]=!![],Object['defineProperty'](exports,_0x99d407(0x21a,0x282),_0x26f621);
}));
