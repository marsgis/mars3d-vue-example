/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.10.0
 * 编译日期：2025-07-06 20:37
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-07-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0xae71bd,_0x3c3f53){function _0x141ce0(_0x312358,_0x192961){return _0x544d(_0x192961- -0x2b9,_0x312358);}const _0x3b6c8b=_0xae71bd();function _0x19a70d(_0x44df45,_0x2f31cc){return _0x544d(_0x2f31cc- -0x25,_0x44df45);}while(!![]){try{const _0xee4959=parseInt(_0x141ce0(-0xae,-0xd9))/0x1*(parseInt(_0x141ce0(-0xbd,-0x101))/0x2)+-parseInt(_0x19a70d(0x195,0x181))/0x3*(parseInt(_0x19a70d(0x1a3,0x185))/0x4)+-parseInt(_0x141ce0(-0x1e1,-0x151))/0x5*(-parseInt(_0x19a70d(0x1d2,0x177))/0x6)+-parseInt(_0x19a70d(0x1e0,0x156))/0x7+-parseInt(_0x19a70d(0x16f,0xfe))/0x8*(parseInt(_0x141ce0(-0x188,-0x14a))/0x9)+parseInt(_0x141ce0(-0xcd,-0x104))/0xa+parseInt(_0x19a70d(0x275,0x208))/0xb*(parseInt(_0x19a70d(0x1ab,0x162))/0xc);if(_0xee4959===_0x3c3f53)break;else _0x3b6c8b['push'](_0x3b6c8b['shift']());}catch(_0x9d5ed0){_0x3b6c8b['push'](_0x3b6c8b['shift']());}}}(_0x8d19,0xd6b48));function _interopNamespace(_0x29fb91){if(_0x29fb91&&_0x29fb91[_0x510911(0x4b3,0x48d)])return _0x29fb91;var _0x108072=Object[_0x510911(0x4bc,0x500)](null);function _0x510911(_0x4a9995,_0x2c71d6){return _0x544d(_0x2c71d6-0x367,_0x4a9995);}_0x29fb91&&Object['keys'](_0x29fb91)['forEach'](function(_0x167321){function _0x13dd79(_0x46f700,_0x186d01){return _0x510911(_0x186d01,_0x46f700- -0x1db);}function _0x485063(_0x4529d7,_0x1f6974){return _0x510911(_0x1f6974,_0x4529d7- -0x3f0);}if(_0x167321!==_0x13dd79(0x2cc,0x317)){var _0xdcd1a4=Object[_0x13dd79(0x2ad,0x2c4)](_0x29fb91,_0x167321);Object['defineProperty'](_0x108072,_0x167321,_0xdcd1a4[_0x485063(0x120,0xf7)]?_0xdcd1a4:{'enumerable':!![],'get':function(){return _0x29fb91[_0x167321];}});}});function _0x152916(_0x5c8000,_0x4ba871){return _0x544d(_0x5c8000-0x2e3,_0x4ba871);}return _0x108072['default']=_0x29fb91,_0x108072;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x779052,_0x427222){function _0x560ec9(_0x5a2dee,_0x457540){return _0x544d(_0x457540- -0x12a,_0x5a2dee);}const _0x5e16fd=_0x779052*Math['cos'](Cesium$2[_0x560ec9(0x40,0x5)]['toRadians'](_0x427222));return _0x5e16fd;}function _0x544d(_0x2eabcc,_0x5a23ce){const _0x8d19d4=_0x8d19();return _0x544d=function(_0x544d86,_0x338086){_0x544d86=_0x544d86-0x121;let _0x2efd4b=_0x8d19d4[_0x544d86];return _0x2efd4b;},_0x544d(_0x2eabcc,_0x5a23ce);}function getV(_0x3f7489,_0x3c183a){const _0x43897d=_0x3f7489*Math['sin'](Cesium$2['Math']['toRadians'](_0x3c183a));return _0x43897d;}function getSpeed(_0x4379f2,_0x5160f5){function _0x373668(_0x489f6e,_0x141646){return _0x544d(_0x141646- -0x6c,_0x489f6e);}function _0x6743f4(_0x3379f4,_0x4bbb3b){return _0x544d(_0x3379f4- -0x360,_0x4bbb3b);}const _0x4be2c1=Math[_0x6743f4(-0x22a,-0x284)](Math[_0x6743f4(-0x1be,-0x16e)](_0x4379f2,0x2)+Math['pow'](_0x5160f5,0x2));return _0x4be2c1;}function getDirection(_0x8bf6a1,_0x48593c){let _0x400d52=Cesium$2['Math']['toDegrees'](Math[_0x2f191d(0x2f0,0x2f8)](_0x48593c,_0x8bf6a1));_0x400d52+=_0x400d52<0x0?0x168:0x0;function _0x2f191d(_0x44cd65,_0x219a15){return _0x544d(_0x219a15-0x1aa,_0x44cd65);}return _0x400d52;}const _0x2b9c55={};_0x2b9c55['__proto__']=null,_0x2b9c55[_0x8bac9f(-0x11,0x37)]=getU,_0x2b9c55['getV']=getV,_0x2b9c55['getSpeed']=getSpeed,_0x2b9c55['getDirection']=getDirection;function _0x8bac9f(_0x1109fd,_0x39dd79){return _0x544d(_0x39dd79- -0x171,_0x1109fd);}var WindUtil=_0x2b9c55,updatePositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a',calculateSpeedShader=_0x5a583e(0x4f6,0x48d),postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader=_0x8bac9f(-0x24,0xd),renderParticlesVertexShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a';const {ShaderSource:ShaderSource$1}=mars3d__namespace[_0x5a583e(0x4c8,0x491)];class ShaderManager{static[_0x8bac9f(-0x6a,-0x46)](){const _0xe016da={};return _0xe016da['sources']=[calculateSpeedShader],new ShaderSource$1(_0xe016da);}static[_0x8bac9f(0x17,0x14)](){const _0xad2dfe={};return _0xad2dfe['sources']=[updatePositionShader],new ShaderSource$1(_0xad2dfe);}static[_0x8bac9f(-0x47,0x3d)](){const _0x1d1a93={};_0x1d1a93[_0x357df6(-0x2c,0xa)]=[renderParticlesVertexShader];function _0x357df6(_0x31efd8,_0x2c0252){return _0x5a583e(_0x2c0252,_0x31efd8- -0x54a);}return new ShaderSource$1(_0x1d1a93);}static[_0x8bac9f(-0xae,-0x3a)](){const _0x29348f={};function _0x46fefa(_0x4ceb18,_0x3f101b){return _0x8bac9f(_0x3f101b,_0x4ceb18-0x553);}return _0x29348f[_0x46fefa(0x626,0x59f)]=[renderParticlesFragmentShader],new ShaderSource$1(_0x29348f);}static[_0x5a583e(0x51c,0x4c8)](){const _0x1e2587={};return _0x1e2587['sources']=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x1e2587);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x10bd1a){this[_0x44a44c(-0x231,-0x285)]=_0x10bd1a[_0x44a44c(-0x231,-0x25e)];function _0x44a44c(_0x1f07b7,_0x2a1bb4){return _0x5a583e(_0x2a1bb4,_0x1f07b7- -0x6c1);}this['geometry']=_0x10bd1a['geometry'],this['attributeLocations']=_0x10bd1a[_0x44a44c(-0x2a0,-0x261)],this[_0x1163a6(0x41e,0x452)]=_0x10bd1a[_0x44a44c(-0x1df,-0x1a6)],this['uniformMap']=_0x10bd1a['uniformMap']||{},this['vertexShaderSource']=_0x10bd1a['vertexShaderSource'],this[_0x44a44c(-0x1f3,-0x1a4)]=_0x10bd1a[_0x44a44c(-0x1f3,-0x20c)],this[_0x1163a6(0x33d,0x3b3)]=_0x10bd1a[_0x1163a6(0x3a0,0x3b3)],this['framebuffer']=_0x10bd1a['framebuffer'],this[_0x1163a6(0x469,0x43a)]=_0x10bd1a['outputTexture'],this[_0x44a44c(-0x2bd,-0x2ad)]=_0x10bd1a[_0x1163a6(0x3dc,0x374)]??![],this['preExecute']=_0x10bd1a['preExecute'],this[_0x1163a6(0x436,0x41c)]=!![],this['commandToExecute']=undefined,this[_0x1163a6(0x372,0x3ea)]=undefined;function _0x1163a6(_0x1d191b,_0x3c9d1f){return _0x8bac9f(_0x1d191b,_0x3c9d1f-0x3bb);}this['isDynamic']=_0x10bd1a['isDynamic']??(()=>!![]),this['autoClear']&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Pass$1['OPAQUE']}));}[_0x8bac9f(0x37,0x63)](_0x6f55d){function _0xeb5258(_0x161c5f,_0x44599c){return _0x8bac9f(_0x161c5f,_0x44599c- -0x153);}function _0x8b03c7(_0x585e17,_0x41ad60){return _0x8bac9f(_0x41ad60,_0x585e17-0x311);}if(this['commandType']===_0xeb5258(-0xa3,-0x91)){const _0x53fd4d={};_0x53fd4d['context']=_0x6f55d,_0x53fd4d['geometry']=this['geometry'],_0x53fd4d['attributeLocations']=this['attributeLocations'],_0x53fd4d[_0x8b03c7(0x3d6,0x40e)]=BufferUsage$1[_0x8b03c7(0x386,0x405)];const _0x523cdc=VertexArray$1['fromGeometry'](_0x53fd4d),_0x2014cd={};_0x2014cd['context']=_0x6f55d,_0x2014cd['vertexShaderSource']=this['vertexShaderSource'],_0x2014cd[_0xeb5258(-0x137,-0xd0)]=this[_0xeb5258(-0x65,-0xd0)],_0x2014cd['attributeLocations']=this['attributeLocations'];const _0xb10ecf=ShaderProgram['fromCache'](_0x2014cd),_0x4d4cd2=RenderState['fromCache'](this['rawRenderState']),_0x2bca33={};return _0x2bca33[_0xeb5258(-0x106,-0x18a)]=this,_0x2bca33['vertexArray']=_0x523cdc,_0x2bca33[_0x8b03c7(0x3a8,0x39e)]=this['primitiveType'],_0x2bca33['modelMatrix']=Matrix4['IDENTITY'],_0x2bca33[_0xeb5258(-0xec,-0x135)]=_0x4d4cd2,_0x2bca33[_0x8b03c7(0x3e1,0x40b)]=_0xb10ecf,_0x2bca33[_0xeb5258(-0x2f,-0xa8)]=this[_0xeb5258(-0x1e,-0xa8)],_0x2bca33['uniformMap']=this['uniformMap'],_0x2bca33['pass']=Pass$1['OPAQUE'],new DrawCommand(_0x2bca33);}else{if(this[_0x8b03c7(0x356,0x3a1)]==='Compute'){const _0x3e3767={};return _0x3e3767[_0x8b03c7(0x2da,0x273)]=this,_0x3e3767['fragmentShaderSource']=this['fragmentShaderSource'],_0x3e3767['uniformMap']=this[_0x8b03c7(0x382,0x318)],_0x3e3767['outputTexture']=this['outputTexture'],_0x3e3767['persists']=!![],new ComputeCommand(_0x3e3767);}else throw new Error(_0xeb5258(-0x11d,-0x15e));}}['setGeometry'](_0x1fd825,_0x5303b3){this['geometry']=_0x5303b3;function _0x1354dc(_0x13529a,_0x4bbd30){return _0x5a583e(_0x4bbd30,_0x13529a- -0x165);}function _0x4f9384(_0x35a592,_0x463968){return _0x8bac9f(_0x463968,_0x35a592-0x25e);}defined(this['commandToExecute'])&&(this[_0x1354dc(0x299,0x2bc)]['vertexArray']=VertexArray$1[_0x1354dc(0x2a6,0x29e)]({'context':_0x1fd825,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1[_0x1354dc(0x35b,0x311)]}));}['update'](_0x266f51){if(!this['isDynamic']())return;if(!this['show']||!defined(_0x266f51))return;!defined(this[_0xa719e0(0x47d,0x44b)])&&(this['commandToExecute']=this['createCommand'](_0x266f51['context']));defined(this['preExecute'])&&this[_0xa719e0(0x596,0x60c)]();if(!_0x266f51['commandList']){console[_0x3bcbe0(0x1d2,0x198)](_0xa719e0(0x598,0x524));return;}function _0xa719e0(_0x18cb8d,_0x4e566f){return _0x5a583e(_0x4e566f,_0x18cb8d-0x7f);}function _0x3bcbe0(_0x4f3f08,_0x1af04c){return _0x8bac9f(_0x4f3f08,_0x1af04c-0x10c);}defined(this['clearCommand'])&&_0x266f51[_0x3bcbe0(0x187,0x109)]['push'](this[_0x3bcbe0(0xde,0x13b)]),defined(this[_0xa719e0(0x47d,0x436)])&&_0x266f51['commandList'][_0x3bcbe0(0x1b4,0x146)](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){if(defined(this[_0x6b7e1d(-0x1d9,-0x1e0)])){var _0x484597;(_0x484597=this[_0x6b7e1d(-0x1d2,-0x1e0)][_0x6b7e1d(-0x83,-0xc3)])===null||_0x484597===void 0x0||_0x484597[_0x3feb2b(0x45f,0x401)](),this['commandToExecute'][_0x6b7e1d(-0x122,-0xc3)]=undefined;}function _0x3feb2b(_0x475043,_0x4c2e2f){return _0x5a583e(_0x4c2e2f,_0x475043-0x21);}function _0x6b7e1d(_0x17ed39,_0x4ffd25){return _0x5a583e(_0x17ed39,_0x4ffd25- -0x5de);}return destroyObject(this);}}function deepMerge(_0x48fe24,_0x5f34c8){function _0x1910ba(_0x2c7daf,_0xca0dd0){return _0x5a583e(_0x2c7daf,_0xca0dd0- -0xce);}if(!_0x48fe24)return _0x5f34c8;if(!_0x5f34c8)return _0x48fe24;const _0x6c7240={..._0x5f34c8};function _0x3af3be(_0x17c672,_0x1b119d){return _0x5a583e(_0x17c672,_0x1b119d- -0x221);}const _0x39c56e=_0x6c7240;for(const _0x4404e2 in _0x48fe24){if(Object[_0x3af3be(0x2cf,0x2c5)]['hasOwnProperty'][_0x1910ba(0x3fa,0x447)](_0x48fe24,_0x4404e2)){const _0x136825=_0x48fe24[_0x4404e2],_0x316fff=_0x5f34c8[_0x4404e2];if(Array['isArray'](_0x136825)){_0x39c56e[_0x4404e2]=_0x136825[_0x1910ba(0x30c,0x360)]();continue;}if(_0x136825&&typeof _0x136825===_0x3af3be(0x21d,0x1db)){_0x39c56e[_0x4404e2]=deepMerge(_0x136825,_0x316fff||{});continue;}_0x136825!==undefined&&(_0x39c56e[_0x4404e2]=_0x136825);}}return _0x39c56e;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace['Cesium'];class WindParticlesComputing{constructor(_0x562374,_0x560d1d,_0x143b78,_0x4d5d60,_0x4a997d){function _0x19ddba(_0x4f1975,_0x4f9e63){return _0x5a583e(_0x4f1975,_0x4f9e63- -0x40e);}this['context']=_0x562374,this['options']=_0x143b78,this['viewerParameters']=_0x4d5d60,this[_0x39a5d7(0x4d0,0x541)]=_0x560d1d,this[_0x39a5d7(0x603,0x5ab)]=0x3c,this['frameRateAdjustment']=0x1;function _0x39a5d7(_0x166d9f,_0xb1e066){return _0x8bac9f(_0x166d9f,_0xb1e066-0x53b);}const _0x541969={};_0x541969['scene']=_0x4a997d,_0x541969['samplingWindow']=0x1,_0x541969['quietPeriod']=0x0,this[_0x39a5d7(0x5dd,0x5fc)]=new FrameRateMonitor(_0x541969),this['initFrameRate'](),this[_0x39a5d7(0x5a3,0x5c0)](),this[_0x19ddba(0x9a,0x49)](),this['createComputingPrimitives']();}['initFrameRate'](){const _0x4e084f=()=>{function _0x127e3f(_0x205025,_0x585e5a){return _0x544d(_0x585e5a-0x52,_0x205025);}function _0x1891f7(_0x210916,_0x41259e){return _0x544d(_0x41259e- -0x345,_0x210916);}this[_0x1891f7(-0x9a,-0x113)]['lastFramesPerSecond']>0x14&&(this['frameRate']=this[_0x1891f7(-0x162,-0x113)][_0x127e3f(0x21e,0x1ce)],this['frameRateAdjustment']=0x3c/Math['max'](this['frameRate'],0x1));};_0x4e084f();function _0xe7a489(_0x3d2e86,_0x29aca2){return _0x5a583e(_0x3d2e86,_0x29aca2- -0x3b);}function _0x139dd7(_0x45203f,_0x46aec0){return _0x5a583e(_0x45203f,_0x46aec0-0x108);}const _0x3e1c0c=setInterval(_0x4e084f,0x3e8),_0x523122=this[_0xe7a489(0x37f,0x403)][_0xe7a489(0x455,0x4a3)](this);this[_0xe7a489(0x393,0x403)]=()=>{clearInterval(_0x3e1c0c),_0x523122();};}['createWindTextures'](){function _0x1fde30(_0x4e4d9d,_0x455699){return _0x8bac9f(_0x4e4d9d,_0x455699- -0x3);}const _0x216349={};_0x216349[_0x1fde30(-0x4e,0x2)]=TextureMinificationFilter$1['LINEAR'];function _0xb05c75(_0x364170,_0x2a6d6a){return _0x5a583e(_0x2a6d6a,_0x364170-0x85);}_0x216349['magnificationFilter']=TextureMagnificationFilter$1[_0xb05c75(0x570,0x553)];const _0x557b69={'context':this[_0x1fde30(0x147,0xbc)],'width':this['windData'][_0xb05c75(0x576,0x5b9)],'height':this['windData']['height'],'pixelFormat':PixelFormat$1['RED'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this['options'][_0xb05c75(0x579,0x502)]??![],'sampler':new Sampler$1(_0x216349)};this[_0x1fde30(0x10e,0x8d)]={'U':new Texture$1({..._0x557b69,'source':{'arrayBufferView':new Float32Array(this['windData']['u']['array'])}}),'V':new Texture$1({..._0x557b69,'source':{'arrayBufferView':new Float32Array(this['windData']['v']['array'])}})};}['createParticlesTextures'](){function _0x5af1e4(_0x75db6f,_0xcb4a9c){return _0x8bac9f(_0x75db6f,_0xcb4a9c- -0x9b);}function _0x1b0d37(_0x443cb4,_0x1e0be6){return _0x8bac9f(_0x1e0be6,_0x443cb4-0x151);}const _0x6739cd={};_0x6739cd['minificationFilter']=TextureMinificationFilter$1['NEAREST'],_0x6739cd['magnificationFilter']=TextureMagnificationFilter$1['NEAREST'];const _0x2e2746={'context':this['context'],'width':this['options'][_0x1b0d37(0x1e7,0x19f)],'height':this['options'][_0x5af1e4(0x5a,-0x5)],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options']['particlesTextureSize']*this[_0x5af1e4(-0x27,-0x45)]['particlesTextureSize']*0x4)['fill'](0x0)},'sampler':new Sampler$1(_0x6739cd)};this[_0x1b0d37(0x1c5,0x155)]={'previousParticlesPosition':new Texture$1(_0x2e2746),'currentParticlesPosition':new Texture$1(_0x2e2746),'nextParticlesPosition':new Texture$1(_0x2e2746),'postProcessingPosition':new Texture$1(_0x2e2746),'particlesSpeed':new Texture$1(_0x2e2746)};}[_0x5a583e(0x3c5,0x43a)](){function _0x7b84c0(_0x2f7e6c,_0x5f013c){return _0x8bac9f(_0x2f7e6c,_0x5f013c- -0xe4);}function _0x444c0f(_0x406d5e,_0x3e7564){return _0x5a583e(_0x3e7564,_0x406d5e- -0x60a);}Object[_0x444c0f(-0x18b,-0x1e3)](this['particlesTextures'])['forEach'](_0x5dc6de=>_0x5dc6de[_0x444c0f(-0x1cc,-0x253)]());}['createComputingPrimitives'](){function _0x424062(_0x2e266c,_0x4ef5e2){return _0x5a583e(_0x2e266c,_0x4ef5e2- -0x1ee);}function _0x3b2dfb(_0x201233,_0x31ba73){return _0x5a583e(_0x201233,_0x31ba73- -0xdf);}this[_0x3b2dfb(0x464,0x429)]={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':()=>this['windTextures']['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this[_0x424062(0x20e,0x263)]['u']['min'],this['windData']['u']['max']),'vRange':()=>new Cartesian2$1(this[_0x3b2dfb(0x2f9,0x372)]['v'][_0x3b2dfb(0x40f,0x3c4)],this['windData']['v']['max']),'speedRange':()=>new Cartesian2$1(this['windData'][_0x424062(0x2a3,0x2e7)][_0x424062(0x262,0x2b5)],this['windData'][_0x3b2dfb(0x380,0x3f6)]['max']),'currentParticlesPosition':()=>this[_0x424062(0x29c,0x2d1)]['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x5882f8(_0x1efddb,_0x2bccfa){return _0x3b2dfb(_0x2bccfa,_0x1efddb- -0x31);}return(this['viewerParameters']['pixelSize']+0x32)*this['options'][_0x5882f8(0x3e0,0x3c7)];},'frameRateAdjustment':()=>this['frameRateAdjustment'],'dimension':()=>new Cartesian2$1(this['windData']['width'],this['windData'][_0x424062(0x326,0x30d)]),'minimum':()=>new Cartesian2$1(this[_0x3b2dfb(0x356,0x372)]['bounds'][_0x3b2dfb(0x439,0x427)],this['windData']['bounds']['south']),'maximum':()=>new Cartesian2$1(this[_0x3b2dfb(0x3a9,0x372)][_0x424062(0x217,0x246)]['east'],this['windData']['bounds'][_0x424062(0x27f,0x2db)])},'fragmentShaderSource':ShaderManager[_0x3b2dfb(0x36b,0x326)](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{function _0x5aae6d(_0x5dad7f,_0x5144a9){return _0x3b2dfb(_0x5144a9,_0x5dad7f- -0x51a);}const _0x2df49e=this[_0x2cd695(-0x13f,-0xb1)][_0x5aae6d(-0x1ed,-0x224)];this[_0x2cd695(-0x13f,-0xf4)]['previousParticlesPosition']=this['particlesTextures']['currentParticlesPosition'];function _0x2cd695(_0x380cda,_0x3a64d2){return _0x424062(_0x3a64d2,_0x380cda- -0x410);}this['particlesTextures']['currentParticlesPosition']=this['particlesTextures'][_0x5aae6d(-0xf6,-0xb8)],this['particlesTextures']['postProcessingPosition']=_0x2df49e,this['primitives']['calculateSpeed'][_0x5aae6d(-0x1fb,-0x18b)]&&(this['primitives']['calculateSpeed']['commandToExecute']['outputTexture']=this['particlesTextures']['particlesSpeed']);},'isDynamic':()=>this['options']['dynamic']}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this[_0x424062(0x2ba,0x2d1)][_0x3b2dfb(0x37c,0x3aa)],'particlesSpeed':()=>this[_0x3b2dfb(0x460,0x3e0)][_0x3b2dfb(0x445,0x40e)]},'fragmentShaderSource':ShaderManager[_0x3b2dfb(0x34c,0x380)](),'outputTexture':this[_0x3b2dfb(0x423,0x3e0)][_0x3b2dfb(0x398,0x401)],'preExecute':()=>{function _0x7dc471(_0x319679,_0x2b9e9c){return _0x3b2dfb(_0x319679,_0x2b9e9c- -0x32f);}function _0x53b53e(_0x1b0c61,_0x4d6884){return _0x424062(_0x4d6884,_0x1b0c61- -0xa0);}this['primitives'][_0x53b53e(0x1aa,0x122)]['commandToExecute']&&(this['primitives']['updatePosition']['commandToExecute'][_0x7dc471(0x67,0xbc)]=this[_0x53b53e(0x231,0x26d)][_0x53b53e(0x252,0x280)]);},'isDynamic':()=>this['options'][_0x3b2dfb(0x3e2,0x3b6)]}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x3b2dfb(0x423,0x414),'uniformMap':{'nextParticlesPosition':()=>this['particlesTextures']['nextParticlesPosition'],'particlesSpeed':()=>this['particlesTextures'][_0x3b2dfb(0x37f,0x40e)],'lonRange':()=>this['viewerParameters']['lonRange'],'latRange':()=>this['viewerParameters']['latRange'],'dataLonRange':()=>new Cartesian2$1(this[_0x424062(0x2cb,0x263)]['bounds'][_0x424062(0x287,0x318)],this['windData']['bounds']['east']),'dataLatRange':()=>new Cartesian2$1(this['windData']['bounds'][_0x3b2dfb(0x479,0x3f9)],this['windData'][_0x424062(0x23c,0x246)]['north']),'randomCoefficient':function(){return Math['random']();},'dropRate':()=>this[_0x424062(0x26f,0x2b3)]['dropRate'],'dropRateBump':()=>this[_0x3b2dfb(0x350,0x3c2)][_0x424062(0x22d,0x237)],'useViewerBounds':()=>this['options'][_0x424062(0x244,0x2d6)]},'fragmentShaderSource':ShaderManager['getPostProcessingPositionShader'](),'outputTexture':this['particlesTextures'][_0x424062(0x2bf,0x315)],'preExecute':()=>{function _0x486b7e(_0x580ce7,_0x56f7b4){return _0x424062(_0x56f7b4,_0x580ce7-0x137);}function _0xe6c7cb(_0x50cc27,_0x50a0be){return _0x424062(_0x50a0be,_0x50cc27- -0x260);}this[_0x486b7e(0x451,0x498)]['postProcessingPosition'][_0xe6c7cb(-0x50,-0x6e)]&&(this['primitives']['postProcessingPosition']['commandToExecute'][_0xe6c7cb(0x7c,-0x3)]=this['particlesTextures'][_0xe6c7cb(0xb5,0x4c)]);},'isDynamic':()=>this['options']['dynamic']})};}[_0x5a583e(0x3f8,0x41c)](){this['windTextures']['U']['destroy'](),this['windTextures']['V']['destroy'](),this['createWindTextures']();}['updateWindData'](_0x3979de){this['windData']=_0x3979de;function _0x4b7f5b(_0x19a905,_0xe73679){return _0x5a583e(_0x19a905,_0xe73679- -0x675);}this[_0x4b7f5b(-0x2b9,-0x259)]();}['updateOptions'](_0x1e3ac5){function _0x1b1698(_0x1cfee9,_0x14784b){return _0x5a583e(_0x14784b,_0x1cfee9-0xf);}function _0x19d4fb(_0x47680f,_0x5e83b3){return _0x8bac9f(_0x47680f,_0x5e83b3- -0x1ad);}const _0x1ad9fb=_0x1e3ac5[_0x19d4fb(-0x195,-0x104)]!==undefined&&_0x1e3ac5[_0x1b1698(0x503,0x4d9)]!==this[_0x19d4fb(-0x11f,-0x157)][_0x1b1698(0x503,0x481)];this['options']=deepMerge(_0x1e3ac5,this['options']),_0x1ad9fb&&this['reCreateWindTextures']();}['processWindData'](_0x52569c){const {array:_0x5b2ff6}=_0x52569c;let {min:_0x4b46dd,max:_0x277226}=_0x52569c;const _0x3a5a6e=new Float32Array(_0x5b2ff6['length']);_0x4b46dd===undefined&&(console[_0x280278(0xe5,0xfa)](_0x19acbb(0x500,0x542)),_0x4b46dd=Math['min'](..._0x5b2ff6));_0x277226===undefined&&(console[_0x280278(0xe5,0x8e)]('max\x20is\x20undefined,\x20calculate\x20max'),_0x277226=Math['max'](..._0x5b2ff6));const _0x331527=Math[_0x280278(0xb0,0x24)](Math[_0x19acbb(0x50c,0x4b4)](_0x4b46dd),Math[_0x19acbb(0x50a,0x4b4)](_0x277226));function _0x280278(_0x5af432,_0x3e15e7){return _0x8bac9f(_0x3e15e7,_0x5af432-0x59);}function _0x19acbb(_0x5322b2,_0x3179a9){return _0x5a583e(_0x5322b2,_0x3179a9-0x3d);}for(let _0x5466a4=0x0;_0x5466a4<_0x5b2ff6['length'];_0x5466a4++){const _0x1912c2=_0x5b2ff6[_0x5466a4]/_0x331527;_0x3a5a6e[_0x5466a4]=_0x1912c2;}return _0x3a5a6e;}['destroy'](){Object['values'](this['windTextures'])[_0x42b5c0(0x57e,0x5e3)](_0x182880=>_0x182880['destroy']()),Object['values'](this['particlesTextures'])['forEach'](_0x15600f=>_0x15600f['destroy']()),Object['values'](this['primitives'])['forEach'](_0x1155b3=>_0x1155b3['destroy']());function _0x42b5c0(_0x2e15f2,_0xf72c74){return _0x5a583e(_0xf72c74,_0x2e15f2-0x92);}this['frameRateMonitor']['destroy']();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace[_0x8bac9f(-0x2e,0x46)];class WindParticlesRendering{constructor(_0x48d449,_0x386ecd,_0x2e18a5,_0xebb0d4){function _0x5aedb4(_0x3195c9,_0x4b2876){return _0x8bac9f(_0x3195c9,_0x4b2876-0x93);}this['context']=_0x48d449,this[_0x5aedb4(0x14a,0xe9)]=_0x386ecd,this['viewerParameters']=_0x2e18a5,this[_0x5aedb4(0x15a,0xfa)]=_0xebb0d4;function _0x460063(_0x1b619c,_0x90b1af){return _0x8bac9f(_0x90b1af,_0x1b619c- -0x265);}(typeof this['options']['particlesTextureSize']!==_0x5aedb4(0x13e,0x10a)||this['options']['particlesTextureSize']<=0x0)&&(console['error'](_0x460063(-0x23c,-0x24e)),this['options'][_0x460063(-0x1cf,-0x159)]=0x100),this[_0x460063(-0x219,-0x2a6)]=this[_0x5aedb4(0x127,0xf1)](),this['textures']=this['createRenderingTextures'](),this['framebuffers']=this[_0x5aedb4(0x14c,0xec)](),this['primitives']=this['createPrimitives']();}['createRenderingTextures'](){const _0x3f8998={};_0x3f8998['context']=this['context'],_0x3f8998['width']=this[_0x503d57(0x6a,0x63)]['drawingBufferWidth'],_0x3f8998[_0x1b1ecb(-0x85,-0x6b)]=this[_0x1b1ecb(-0x76,-0x9a)]['drawingBufferHeight'];function _0x503d57(_0x1b2b77,_0x57f0b6){return _0x5a583e(_0x1b2b77,_0x57f0b6- -0x4a7);}_0x3f8998[_0x1b1ecb(-0xca,-0xef)]=PixelFormat['RGBA'],_0x3f8998[_0x1b1ecb(-0x84,-0xab)]=PixelDatatype['UNSIGNED_BYTE'];const _0x4bf2a6=_0x3f8998,_0x3de408={};_0x3de408[_0x1b1ecb(-0x76,-0x24)]=this[_0x1b1ecb(-0x76,-0x60)],_0x3de408['width']=this[_0x503d57(0xe5,0x63)]['drawingBufferWidth'],_0x3de408['height']=this['context']['drawingBufferHeight'];function _0x1b1ecb(_0x29d4af,_0x2943f5){return _0x8bac9f(_0x2943f5,_0x29d4af- -0x135);}_0x3de408[_0x1b1ecb(-0xca,-0x143)]=PixelFormat[_0x1b1ecb(-0x81,-0xcb)],_0x3de408['pixelDatatype']=PixelDatatype['UNSIGNED_INT'];const _0x18a104=_0x3de408;return{'segmentsColor':new Texture(_0x4bf2a6),'segmentsDepth':new Texture(_0x18a104)};}['createRenderingFramebuffers'](){function _0x1f5bcb(_0x478255,_0x1b2b85){return _0x5a583e(_0x478255,_0x1b2b85- -0x5ad);}const _0x19d08a={};_0x19d08a[_0x35bf1a(0xc,0x44)]=this[_0x1f5bcb(-0x2d,-0xa3)];function _0x35bf1a(_0x1af0e8,_0x2a4b00){return _0x8bac9f(_0x1af0e8,_0x2a4b00- -0x7b);}return _0x19d08a['colorTextures']=[this['textures']['segmentsColor']],_0x19d08a['depthTexture']=this['textures'][_0x35bf1a(-0x5e,0x1d)],{'segments':new Framebuffer(_0x19d08a)};}['destoryRenderingFramebuffers'](){function _0x2c6ad7(_0x100a09,_0x22c2f8){return _0x8bac9f(_0x100a09,_0x22c2f8-0xa);}Object['values'](this[_0x2c6ad7(0x4,0x18)])['forEach'](_0x7496d=>{_0x7496d['destroy']();});}['createColorTableTexture'](){const _0x3f8a90=new Float32Array(this[_0x9d39f1(-0x6b,-0x65)][_0x5e0818(-0x120,-0x116)]['flatMap'](_0x296e2e=>{function _0x181fe9(_0x32dad0,_0x187216){return _0x5e0818(_0x32dad0,_0x187216-0x360);}function _0x72289e(_0x53ef2c,_0x1f5828){return _0x9d39f1(_0x53ef2c-0x106,_0x1f5828);}const _0x5132c1=Color$1[_0x72289e(0x10d,0x9e)](_0x296e2e);return[_0x5132c1['red'],_0x5132c1[_0x181fe9(0x101,0x190)],_0x5132c1[_0x72289e(0x88,0xca)],_0x5132c1[_0x181fe9(0x199,0x210)]];})),_0xc5615={};_0xc5615['minificationFilter']=TextureMinificationFilter['LINEAR'],_0xc5615['magnificationFilter']=TextureMagnificationFilter[_0x5e0818(-0xcb,-0x122)],_0xc5615['wrapS']=TextureWrap[_0x5e0818(-0xf3,-0x114)];function _0x9d39f1(_0x116136,_0x1f5351){return _0x8bac9f(_0x1f5351,_0x116136- -0xc1);}_0xc5615[_0x5e0818(-0x191,-0x207)]=TextureWrap[_0x5e0818(-0x116,-0x114)];function _0x5e0818(_0x933f0e,_0x44d13c){return _0x5a583e(_0x933f0e,_0x44d13c- -0x60d);}return new Texture({'context':this['context'],'width':this[_0x9d39f1(-0x6b,-0x20)][_0x9d39f1(-0x15,-0x87)][_0x5e0818(-0x17f,-0x1d8)],'height':0x1,'pixelFormat':PixelFormat[_0x5e0818(-0x1aa,-0x1c1)],'pixelDatatype':PixelDatatype[_0x5e0818(-0x14f,-0x1a0)],'sampler':new Sampler(_0xc5615),'source':{'width':this['options'][_0x9d39f1(-0x15,-0x68)]['length'],'height':0x1,'arrayBufferView':_0x3f8a90}});}['createSegmentsGeometry'](){const _0x2b8a96=0x4,_0x44b5a6=this['options']['particlesTextureSize'];let _0x524ff3=[];for(let _0x4e56ca=0x0;_0x4e56ca<_0x44b5a6;_0x4e56ca++){for(let _0x23a2e7=0x0;_0x23a2e7<_0x44b5a6;_0x23a2e7++){for(let _0x522f21=0x0;_0x522f21<_0x2b8a96;_0x522f21++){_0x524ff3['push'](_0x4e56ca/_0x44b5a6),_0x524ff3['push'](_0x23a2e7/_0x44b5a6);}}}_0x524ff3=new Float32Array(_0x524ff3);function _0x59a8aa(_0x2810a0,_0xa7b92d){return _0x8bac9f(_0xa7b92d,_0x2810a0-0x2e3);}const _0x232b78=this[_0x59a8aa(0x339,0x3c6)]['particlesTextureSize']**0x2;function _0x353c7a(_0x10c7cb,_0x54a048){return _0x5a583e(_0x54a048,_0x10c7cb-0xa5);}let _0x5d5111=[];for(let _0x21009b=0x0;_0x21009b<_0x232b78;_0x21009b++){_0x5d5111[_0x59a8aa(0x31d,0x30d)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x5d5111=new Float32Array(_0x5d5111);let _0xd82ed6=[];for(let _0x10f54d=0x0,_0x5c43b1=0x0;_0x10f54d<_0x232b78;_0x10f54d++){_0xd82ed6[_0x59a8aa(0x31d,0x28a)](_0x5c43b1+0x0,_0x5c43b1+0x1,_0x5c43b1+0x2,_0x5c43b1+0x2,_0x5c43b1+0x1,_0x5c43b1+0x3),_0x5c43b1+=_0x2b8a96;}_0xd82ed6=new Uint32Array(_0xd82ed6);const _0x5a09b3={};_0x5a09b3['componentDatatype']=ComponentDatatype['FLOAT'],_0x5a09b3['componentsPerAttribute']=0x2,_0x5a09b3[_0x353c7a(0x524,0x537)]=_0x524ff3;const _0x5d5fac={};_0x5d5fac['componentDatatype']=ComponentDatatype['FLOAT'],_0x5d5fac[_0x59a8aa(0x29f,0x308)]=0x3,_0x5d5fac['values']=_0x5d5111;const _0x204e84=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x5a09b3),'normal':new GeometryAttribute(_0x5d5fac)}),'indices':_0xd82ed6});return _0x204e84;}['createRawRenderState'](_0x3f432e){function _0x49e1e9(_0x532391,_0x12738c){return _0x8bac9f(_0x532391,_0x12738c-0x44d);}const _0x1e44b2={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x3f432e};return Appearance[_0x49e1e9(0x559,0x502)](!![],![],_0x1e44b2);}[_0x8bac9f(-0x4,0x26)](){const _0x77678b={};_0x77678b['st']=0x0,_0x77678b['normal']=0x1;const _0x66d492={};function _0x1c534c(_0x3caa38,_0x3d5179){return _0x8bac9f(_0x3caa38,_0x3d5179- -0x125);}_0x66d492['enabled']=!![];const _0x582376={};_0x582376[_0x3bfdbf(-0x25c,-0x1df)]=!![],_0x582376[_0x1c534c(-0x63,-0x9c)]=WebGLRenderingContext['FUNC_ADD'],_0x582376[_0x1c534c(-0x153,-0xd1)]=WebGLRenderingContext['SRC_ALPHA'],_0x582376['blendFuncDestination']=WebGLRenderingContext['ONE_MINUS_SRC_ALPHA'];const _0x108a53={};function _0x3bfdbf(_0x907018,_0x19d30f){return _0x5a583e(_0x907018,_0x19d30f- -0x658);}_0x108a53['viewport']=undefined,_0x108a53[_0x1c534c(0x33,-0x5a)]=_0x66d492,_0x108a53[_0x1c534c(-0x1c0,-0x16e)]=!![],_0x108a53[_0x3bfdbf(-0x2d5,-0x250)]=_0x582376;const _0x24767b=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x77678b,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType[_0x3bfdbf(-0x26a,-0x231)],'uniformMap':{'previousParticlesPosition':()=>this['computing']['particlesTextures']['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing']['particlesTextures'][_0x1c534c(-0xd0,-0xe7)],'postProcessingPosition':()=>this['computing'][_0x1c534c(-0x109,-0xb1)]['postProcessingPosition'],'particlesSpeed':()=>this[_0x3bfdbf(-0x188,-0x1a6)]['particlesTextures']['particlesSpeed'],'frameRateAdjustment':()=>this[_0x3bfdbf(-0x16e,-0x1a6)][_0x1c534c(-0xd7,-0x53)],'colorTable':()=>this[_0x1c534c(-0xdc,-0xd9)],'domain':()=>{function _0xf922c1(_0x181193,_0x52a1b7){return _0x3bfdbf(_0x52a1b7,_0x181193-0x4b9);}function _0x277bd4(_0x137b09,_0x4409b7){return _0x1c534c(_0x4409b7,_0x137b09-0x25);}var _0x21c4d6,_0x235777;const _0xca958b=new Cartesian2(((_0x21c4d6=this[_0xf922c1(0x302,0x334)]['domain'])===null||_0x21c4d6===void 0x0?void 0x0:_0x21c4d6[_0xf922c1(0x304,0x2df)])??this['computing'][_0x277bd4(-0xfa,-0xc5)]['speed'][_0xf922c1(0x304,0x36f)],((_0x235777=this[_0x277bd4(-0xaa,-0x63)][_0x277bd4(-0xa6,-0xa2)])===null||_0x235777===void 0x0?void 0x0:_0x235777['max'])??this['computing']['windData']['speed']['max']);return _0xca958b;},'displayRange':()=>{function _0x1b52d3(_0xd8b9bd,_0x3aac3f){return _0x3bfdbf(_0xd8b9bd,_0x3aac3f-0x625);}var _0x57237b,_0x4fc732;function _0x408ced(_0x8d683f,_0x15f733){return _0x1c534c(_0x15f733,_0x8d683f-0x206);}const _0x165842=new Cartesian2(((_0x57237b=this['options']['displayRange'])===null||_0x57237b===void 0x0?void 0x0:_0x57237b['min'])??this[_0x408ced(0x148,0x1ba)][_0x1b52d3(0x3b0,0x41e)]['speed']['min'],((_0x4fc732=this['options']['displayRange'])===null||_0x4fc732===void 0x0?void 0x0:_0x4fc732[_0x1b52d3(0x4e4,0x46f)])??this['computing'][_0x1b52d3(0x483,0x41e)]['speed']['max']);return _0x165842;},'particleHeight':()=>this['options']['fixedHeight']||0x0,'aspect':()=>this['context'][_0x3bfdbf(-0x180,-0x1f4)]/this[_0x3bfdbf(-0x1cb,-0x14e)]['drawingBufferHeight'],'pixelSize':()=>this['viewerParameters']['pixelSize'],'lineWidth':()=>{const _0x4fc6d2={};_0x4fc6d2[_0x30bb82(0x310,0x305)]=0x1,_0x4fc6d2[_0x30bb82(0x30f,0x28a)]=0x2;const _0x182e54=this[_0x5a1be9(0x4fd,0x57e)][_0x5a1be9(0x492,0x4c9)]||_0x4fc6d2;function _0x5a1be9(_0x545783,_0x5a6af9){return _0x3bfdbf(_0x5a6af9,_0x545783-0x6b4);}function _0x30bb82(_0x319e8f,_0x459adb){return _0x3bfdbf(_0x459adb,_0x319e8f-0x4c5);}return new Cartesian2(_0x182e54[_0x30bb82(0x310,0x389)],_0x182e54[_0x30bb82(0x30f,0x359)]);},'lineLength':()=>{function _0x105b05(_0x8615c5,_0xfe1367){return _0x1c534c(_0xfe1367,_0x8615c5-0x1bf);}const _0x544bef={};_0x544bef['min']=0x14;function _0x3dec77(_0x3e9c2d,_0xe2ee4){return _0x1c534c(_0x3e9c2d,_0xe2ee4-0x45f);}_0x544bef['max']=0x64;const _0x5240e4=this[_0x3dec77(0x3a3,0x390)][_0x105b05(0xbe,0xd0)]||_0x544bef;return new Cartesian2(_0x5240e4['min'],_0x5240e4[_0x105b05(0xf1,0xa6)]);},'is3D':()=>this['viewerParameters'][_0x3bfdbf(-0x1fe,-0x186)]===SceneMode['SCENE3D'],'segmentsDepthTexture':()=>this[_0x1c534c(-0xeb,-0xd7)]['segmentsDepth']},'vertexShaderSource':ShaderManager['getSegmentDrawVertexShader'](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this['createRawRenderState'](_0x108a53)}),_0x4e2b67={};return _0x4e2b67[_0x1c534c(-0x9a,-0x8c)]=_0x24767b,_0x4e2b67;}[_0x8bac9f(0x3a,0x5d)](){const _0x3953a0=this['createSegmentsGeometry']();this[_0x4e284a(-0x103,-0xbb)][_0x2e1de0(0x22d,0x1ae)][_0x4e284a(-0x113,-0xe2)]=_0x3953a0;function _0x2e1de0(_0x3f9731,_0x3f0584){return _0x5a583e(_0x3f9731,_0x3f0584- -0x336);}const _0x3e8943={};_0x3e8943['context']=this[_0x2e1de0(0x1cb,0x1d4)],_0x3e8943['geometry']=_0x3953a0,_0x3e8943['attributeLocations']=this['primitives']['segments']['attributeLocations'],_0x3e8943[_0x2e1de0(0x24b,0x1da)]=BufferUsage['STATIC_DRAW'];function _0x4e284a(_0x390412,_0x58983d){return _0x5a583e(_0x58983d,_0x390412- -0x60b);}const _0x200c1d=VertexArray[_0x2e1de0(0x83,0xd5)](_0x3e8943);this['primitives'][_0x4e284a(-0x127,-0x17a)][_0x2e1de0(0x3b,0xc8)]&&(this['primitives'][_0x4e284a(-0x127,-0x16c)]['commandToExecute']['vertexArray']=_0x200c1d);}['onColorTableChange'](){function _0x36df13(_0x291acd,_0xf435b4){return _0x5a583e(_0x291acd,_0xf435b4- -0x48f);}function _0x3b7668(_0x131024,_0x4ed7e7){return _0x8bac9f(_0x4ed7e7,_0x131024- -0x17d);}this[_0x3b7668(-0x131,-0xa4)][_0x3b7668(-0x18a,-0x204)](),this['colorTable']=this[_0x36df13(-0x3a,0x1a)]();}['updateOptions'](_0x5d307b){const _0xad794b=_0x5d307b['colors']&&JSON[_0x415673(0x4c8,0x481)](_0x5d307b[_0x4e34b8(0x24a,0x2da)])!==JSON[_0x415673(0x4c8,0x47a)](this[_0x4e34b8(0x232,0x284)]['colors']);this[_0x415673(0x55b,0x4f7)]=deepMerge(_0x5d307b,this['options']);function _0x4e34b8(_0x26faed,_0x2198f8){return _0x5a583e(_0x26faed,_0x2198f8- -0x21d);}function _0x415673(_0x375a,_0x31374a){return _0x8bac9f(_0x31374a,_0x375a-0x505);}_0xad794b&&this['onColorTableChange']();}[_0x5a583e(0x478,0x43e)](){function _0x33235a(_0x4e8b45,_0x51ccc0){return _0x5a583e(_0x4e8b45,_0x51ccc0- -0x462);}Object['values'](this[_0x5b958d(0x2ee,0x2a1)])['forEach'](_0x112b17=>{function _0x40aeb1(_0x1e07c5,_0x5e169c){return _0x5b958d(_0x5e169c-0x144,_0x1e07c5);}_0x112b17[_0x40aeb1(0x4a0,0x417)]();}),Object[_0x5b958d(0x314,0x398)](this['primitives'])['forEach'](_0xcbcbbc=>{function _0x229cdd(_0x3fab37,_0x48ba7e){return _0x33235a(_0x3fab37,_0x48ba7e- -0x198);}_0xcbcbbc[_0x229cdd(-0x1f3,-0x1bc)]();});function _0x5b958d(_0x15854a,_0x3f77af){return _0x8bac9f(_0x3f77af,_0x15854a-0x2e0);}this['colorTable'][_0x33235a(-0xb7,-0x24)]();}}const {ClearCommand,Color,Pass}=mars3d__namespace[_0x8bac9f(0x49,0x46)];class WindParticleSystem{constructor(_0x26aec0,_0x2ba635,_0x459ae3,_0x5c7de8,_0x4fd119){this['context']=_0x26aec0,this['options']=_0x459ae3,this['viewerParameters']=_0x5c7de8,this['computing']=new WindParticlesComputing(_0x26aec0,_0x2ba635,_0x459ae3,_0x5c7de8,_0x4fd119);function _0x15d03d(_0x1d3b15,_0x28a9a6){return _0x5a583e(_0x1d3b15,_0x28a9a6- -0x114);}this[_0x15d03d(0x326,0x323)]=new WindParticlesRendering(_0x26aec0,_0x459ae3,_0x5c7de8,this['computing']),this['clearFramebuffers']();}[_0x5a583e(0x495,0x420)](){const _0x211680=[this['computing'][_0x24cf43(-0xab,-0x2f)]['calculateSpeed'],this[_0x24cf43(-0x101,-0x153)][_0x2f88ec(0x31a,0x2b9)]['updatePosition'],this['computing']['primitives']['postProcessingPosition'],this[_0x2f88ec(0x249,0x2b1)]['primitives']['segments']];function _0x24cf43(_0x204386,_0x9a908e){return _0x8bac9f(_0x9a908e,_0x204386- -0x168);}function _0x2f88ec(_0x2d0c30,_0x54596a){return _0x5a583e(_0x54596a,_0x2d0c30- -0x1ee);}return _0x211680;}['clearFramebuffers'](){function _0x3dc9f3(_0x583fe8,_0x1d6cea){return _0x5a583e(_0x583fe8,_0x1d6cea-0x28);}function _0x840941(_0x4cd0d3,_0x502c2e){return _0x8bac9f(_0x4cd0d3,_0x502c2e-0x3d9);}const _0x274cc7=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});Object[_0x3dc9f3(0x445,0x457)](this[_0x3dc9f3(0x496,0x45f)]['framebuffers'])[_0x3dc9f3(0x501,0x514)](_0x5d07cc=>{_0x274cc7['framebuffer']=this['rendering']['framebuffers'][_0x5d07cc];function _0x398132(_0x4f066b,_0xd9dd63){return _0x3dc9f3(_0x4f066b,_0xd9dd63- -0x35c);}_0x274cc7[_0x398132(0x165,0x133)](this['context']);});}[_0x5a583e(0x3ee,0x444)](_0x31e56e){let _0x5e74f4=![];_0x31e56e[_0x34ee35(0x465,0x49e)]&&this['options']['particlesTextureSize']!==_0x31e56e['particlesTextureSize']&&(_0x5e74f4=!![]);const _0x1108d0=deepMerge(_0x31e56e,this['options']);function _0x10860e(_0x5ac211,_0x3802e0){return _0x5a583e(_0x5ac211,_0x3802e0-0xd5);}if(_0x1108d0['particlesTextureSize']<0x1)throw new Error('particlesTextureSize\x20must\x20be\x20greater\x20than\x200');this['options']=_0x1108d0;function _0x34ee35(_0x44f9cf,_0x182360){return _0x5a583e(_0x182360,_0x44f9cf- -0x7c);}this[_0x34ee35(0x3bb,0x3ec)][_0x34ee35(0x402,0x39d)](_0x31e56e),this['computing']['updateOptions'](_0x31e56e),_0x5e74f4&&(this['computing']['destroyParticlesTextures'](),this['computing'][_0x34ee35(0x3db,0x43a)](),this['rendering'][_0x10860e(0x5b6,0x57d)]());}['applyViewerParameters'](_0x5931da){function _0x4b2ed3(_0x489ad6,_0x518cfc){return _0x5a583e(_0x489ad6,_0x518cfc-0x10d);}this[_0x4b2ed3(0x60e,0x57b)]=_0x5931da,this['computing']['viewerParameters']=_0x5931da;function _0xe0c929(_0x24944a,_0x44dba6){return _0x8bac9f(_0x44dba6,_0x24944a-0xb9);}this[_0xe0c929(0xa5,0x7f)]['viewerParameters']=_0x5931da;}['destroy'](){function _0x27989e(_0x656108,_0x688abe){return _0x8bac9f(_0x688abe,_0x656108-0x28e);}function _0x428eb8(_0x4a5172,_0x825c19){return _0x8bac9f(_0x825c19,_0x4a5172-0x503);}this[_0x27989e(0x2f5,0x2c3)]['destroy'](),this['rendering'][_0x27989e(0x281,0x1fb)]();}}const Cesium$1=mars3d__namespace[_0x5a583e(0x47e,0x491)],BaseLayer$1=mars3d__namespace[_0x8bac9f(-0xb8,-0x25)]['BaseLayer'],_0x17e9a6={};_0x17e9a6[_0x5a583e(0x456,0x4a3)]=0x1,_0x17e9a6['max']=0x2;const _0x16f752={};_0x16f752['min']=0x14,_0x16f752['max']=0x64;const _0x3c328c={};_0x3c328c['particlesTextureSize']=0x64,_0x3c328c['fixedHeight']=0x0,_0x3c328c['lineWidth']=_0x17e9a6,_0x3c328c[_0x5a583e(0x4f9,0x46f)]=_0x16f752,_0x3c328c['speedFactor']=0x1,_0x3c328c[_0x5a583e(0x4c6,0x4ab)]=0.003,_0x3c328c['dropRateBump']=0.001,_0x3c328c['colors']=['rgb(206,255,255)'],_0x3c328c[_0x5a583e(0x586,0x4f4)]=![],_0x3c328c[_0x8bac9f(0x97,0x4a)]=!![];const DEF_OPTIONS=_0x3c328c;class WindLayer extends BaseLayer$1{constructor(_0x532b10={}){function _0x18ffb7(_0x42a4f3,_0x3cc8df){return _0x5a583e(_0x3cc8df,_0x42a4f3- -0x44a);}_0x532b10={...DEF_OPTIONS,..._0x532b10},super(_0x532b10),this[_0x18ffb7(-0x40,-0x7b)](_0x532b10,_0x532b10);}get['layer'](){function _0x59603c(_0x22e2d3,_0x5ca0fe){return _0x8bac9f(_0x5ca0fe,_0x22e2d3-0x15d);}return this[_0x59603c(0x21a,0x1f7)];}get['data'](){function _0x474664(_0x41abf6,_0x146fce){return _0x8bac9f(_0x41abf6,_0x146fce- -0x77);}return this['options'][_0x474664(-0x56,0xd)];}set[_0x5a583e(0x524,0x4cf)](_0x135ee4){function _0x53151d(_0x23d797,_0x5cf3d5){return _0x8bac9f(_0x23d797,_0x5cf3d5-0xaa);}function _0x409a99(_0x3c38c1,_0x346b32){return _0x5a583e(_0x3c38c1,_0x346b32- -0x663);}this[_0x409a99(-0x1d0,-0x1c2)][_0x409a99(-0x12c,-0x194)]=_0x135ee4,this['setData'](_0x135ee4);}get[_0x5a583e(0x545,0x4f7)](){function _0xa9ddb3(_0x448669,_0x1bb7f6){return _0x5a583e(_0x448669,_0x1bb7f6- -0x35b);}return this[_0xa9ddb3(0x11b,0x146)]['colors'];}set[_0x8bac9f(0x105,0xac)](_0x2f66f9){function _0x54f0f5(_0x2ddd13,_0xeff278){return _0x8bac9f(_0xeff278,_0x2ddd13-0x525);}this['options'][_0x41ab6e(0x595,0x564)]=_0x2f66f9;const _0x44d2b6={};_0x44d2b6['colors']=_0x2f66f9;function _0x41ab6e(_0x2fce3d,_0x2c5886){return _0x8bac9f(_0x2fce3d,_0x2c5886-0x4b8);}this[_0x54f0f5(0x4e4,0x52a)](this['options'],_0x44d2b6);}['_showHook'](_0x78b6ee){_0x78b6ee?this['_addedHook']():this['_removedHook']();}['_mountedHook'](){}[_0x8bac9f(0x7f,0x1d)](){this['scene']=this['_map'][_0x439319(0xb5,0x95)],this['camera']=this[_0x439319(0xba,0x8c)]['camera'];this[_0x439319(0xd6,0xd0)][_0x439319(0xfa,0xfe)]&&this['setData'](this['options']['data']);if(!this['windData']||!this['show'])return;this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](-0xb4,0xb4),'latRange':new Cesium$1['Cartesian2'](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this['scene'][_0x439319(0xe8,0x109)]},this[_0x439319(0xcc,0x76)](),this['particleSystem']=new WindParticleSystem(this['scene'][_0x439319(0x169,0x139)],this['windData'],this['options'],this['viewerParameters'],this[_0x276b80(-0x12,-0x76)]);function _0x439319(_0x2576f6,_0x1438ad){return _0x8bac9f(_0x2576f6,_0x1438ad-0x7a);}this[_0x276b80(0x90,0xcc)]=this['particleSystem'][_0x439319(0x75,0x4f)]();function _0x276b80(_0x331c11,_0x156107){return _0x5a583e(_0x156107,_0x331c11- -0x478);}this[_0x276b80(0x90,0x11a)][_0x439319(0xa2,0x11b)](_0x406dd5=>{function _0x15b092(_0x324a66,_0xd59421){return _0x276b80(_0xd59421-0x72,_0x324a66);}this['scene']['primitives'][_0x15b092(0x82,0xe8)](_0x406dd5);}),this[_0x276b80(0x7d,0x67)][_0x439319(0x9e,0x131)]=0.01,this[_0x439319(0x195,0x124)]['changed'][_0x439319(0xbe,0x83)](this['updateViewerParameters'][_0x439319(0x16b,0x10d)](this)),this['scene'][_0x276b80(0x3d,-0x47)][_0x276b80(-0x24,0x5c)](this['updateViewerParameters']['bind'](this)),window['addEventListener']('resize',this['updateViewerParameters']['bind'](this));}['_removedHook'](){function _0x1b379c(_0x6e573d,_0x1f8919){return _0x8bac9f(_0x1f8919,_0x6e573d-0x325);}this[_0x1b379c(0x3cf,0x3d5)]['changed'][_0x3747c9(0x13f,0x194)](this['updateViewerParameters']['bind'](this)),this[_0x1b379c(0x340,0x362)][_0x1b379c(0x38f,0x350)]['removeEventListener'](this['updateViewerParameters']['bind'](this)),window[_0x3747c9(0x1b3,0x194)]('resize',this['updateViewerParameters'][_0x3747c9(0x209,0x250)](this));this[_0x1b379c(0x3e2,0x3a0)]&&(this[_0x3747c9(0x2bd,0x27a)][_0x1b379c(0x3c6,0x369)](_0x14b07c=>{this['scene']['primitives']['remove'](_0x14b07c);}),delete this['primitives']);function _0x3747c9(_0x450461,_0x5c6d96){return _0x5a583e(_0x450461,_0x5c6d96- -0x28e);}this['particleSystem']&&(this['particleSystem']['destroy'](),delete this['particleSystem']);}['setData'](_0x244d36,_0x3232d9){this['windData']=this[_0x57de4f(0x53c,0x4d8)](_0x244d36);function _0x57de4f(_0x56a49d,_0x39ba16){return _0x8bac9f(_0x56a49d,_0x39ba16-0x4b9);}function _0x3b3cfa(_0xc45151,_0x2cfd45){return _0x8bac9f(_0xc45151,_0x2cfd45- -0x12e);}if(_0x3232d9){this[_0x57de4f(0x43a,0x4b3)](),this['_addedHook']();return;}this['particleSystem']?(this['particleSystem']['computing'][_0x3b3cfa(-0x1b7,-0x17a)](this[_0x57de4f(0x485,0x4bf)]),this[_0x3b3cfa(-0x150,-0x113)]['requestRender']()):this['_addedHook']();}['_setOptionsHook'](_0x2a8222,_0x3c42e0){this['particleSystem']&&(this['particleSystem']['changeOptions'](_0x3c42e0),this['scene']['requestRender']());}[_0x5a583e(0x419,0x46a)](_0xa94949){var _0x4eb0b0,_0x4a952d;function _0x510cfe(_0x41b846,_0x58c125){return _0x8bac9f(_0x41b846,_0x58c125-0x25c);}const _0x34aa2e={..._0xa94949},_0x4c15b1=_0x34aa2e;!_0x4c15b1['height']&&_0x4c15b1[_0x32af62(0x48b,0x459)]&&(_0x4c15b1[_0x32af62(0x482,0x4af)]=_0x4c15b1['rows']);!_0x4c15b1['width']&&_0x4c15b1['cols']&&(_0x4c15b1[_0x510cfe(0x2a4,0x302)]=_0x4c15b1[_0x32af62(0x437,0x3be)]);!_0x4c15b1['bounds']&&(_0x4c15b1[_0x32af62(0x3bb,0x38a)]={'west':_0x4c15b1['xmin'],'south':_0x4c15b1[_0x32af62(0x440,0x3b1)],'east':_0x4c15b1[_0x510cfe(0x245,0x2ae)],'north':_0x4c15b1['ymax']});if(!_0x4c15b1['u']){const _0x16140c={};_0x16140c[_0x510cfe(0x254,0x2ac)]=_0xa94949[_0x32af62(0x463,0x4b7)],_0x16140c['min']=_0xa94949[_0x510cfe(0x2bc,0x29c)],_0x16140c[_0x32af62(0x429,0x481)]=_0xa94949['umax'],_0x4c15b1['u']=_0x16140c;}if(!_0x4c15b1['v']){const _0x8cc730={};_0x8cc730[_0x32af62(0x422,0x488)]=_0xa94949['vdata'],_0x8cc730[_0x32af62(0x42a,0x432)]=_0xa94949[_0x510cfe(0x2c9,0x252)],_0x8cc730[_0x32af62(0x429,0x466)]=_0xa94949[_0x32af62(0x3f9,0x3aa)],_0x4c15b1['v']=_0x8cc730;}if(((_0x4eb0b0=_0x4c15b1['speed'])===null||_0x4eb0b0===void 0x0?void 0x0:_0x4eb0b0[_0x32af62(0x42a,0x42b)])===undefined||((_0x4a952d=_0x4c15b1[_0x32af62(0x45c,0x46e)])===null||_0x4a952d===void 0x0?void 0x0:_0x4a952d['max'])===undefined||_0x4c15b1[_0x510cfe(0x2e5,0x2e6)][_0x510cfe(0x2e3,0x2ac)]===undefined){const _0x4e67dc={'array':new Float32Array(_0x4c15b1['u']['array'][_0x32af62(0x3bc,0x42d)]),'min':Number['MAX_VALUE'],'max':Number['MIN_VALUE']};for(let _0x401c91=0x0;_0x401c91<_0x4c15b1['u']['array']['length'];_0x401c91++){_0x4e67dc[_0x32af62(0x422,0x400)][_0x401c91]=Math[_0x510cfe(0x1de,0x221)](_0x4c15b1['u']['array'][_0x401c91]*_0x4c15b1['u'][_0x510cfe(0x298,0x2ac)][_0x401c91]+_0x4c15b1['v'][_0x510cfe(0x287,0x2ac)][_0x401c91]*_0x4c15b1['v']['array'][_0x401c91]),_0x4e67dc['array'][_0x401c91]!==0x0&&(_0x4e67dc[_0x32af62(0x42a,0x3d3)]=Math[_0x32af62(0x42a,0x441)](_0x4e67dc[_0x32af62(0x42a,0x3ec)],_0x4e67dc[_0x32af62(0x422,0x3f9)][_0x401c91]),_0x4e67dc['max']=Math[_0x32af62(0x429,0x3bf)](_0x4e67dc['max'],_0x4e67dc['array'][_0x401c91]));}_0x4c15b1[_0x510cfe(0x353,0x2e6)]=_0x4e67dc;}function _0x32af62(_0x368a84,_0x30ba89){return _0x5a583e(_0x30ba89,_0x368a84- -0x79);}return _0x4c15b1;}[_0x5a583e(0x4b1,0x447)](){function _0xbac461(_0x1bf204,_0x3ce4b0){return _0x8bac9f(_0x3ce4b0,_0x1bf204-0x361);}var _0x2b2be;const _0x35098e=this['scene'];if(!_0x35098e)return;const _0x1a9a91=_0x35098e[_0xbac461(0x329,0x2c9)],_0x124425={};function _0xb2238(_0x247b1c,_0xa7dabc){return _0x5a583e(_0x247b1c,_0xa7dabc- -0x54b);}_0x124425['x']=0x0,_0x124425['y']=0x0;const _0x5bdec8={};_0x5bdec8['x']=0x0,_0x5bdec8['y']=_0x1a9a91['clientHeight'];const _0x466790={};_0x466790['x']=_0x1a9a91['clientWidth'],_0x466790['y']=0x0;const _0x171d37={};_0x171d37['x']=_0x1a9a91['clientWidth'],_0x171d37['y']=_0x1a9a91[_0xbac461(0x3dd,0x46d)];const _0x2e6f93=[_0x124425,_0x5bdec8,_0x466790,_0x171d37];let _0x4c3834=0xb4,_0x8da230=-0xb4,_0x3dbfdc=0x5a,_0x54ae0d=-0x5a,_0x1f8a6=![];for(const _0x4330f9 of _0x2e6f93){const _0x5913e9=_0x35098e[_0xb2238(-0x75,-0x56)]['pickEllipsoid'](new Cesium$1[(_0xb2238(-0x1d,-0x7f))](_0x4330f9['x'],_0x4330f9['y']),_0x35098e[_0xbac461(0x379,0x327)][_0xb2238(-0x28,-0x3c)]);if(!_0x5913e9){_0x1f8a6=!![];break;}const _0x390baa=_0x35098e[_0xb2238(-0x6b,-0xe8)]['ellipsoid']['cartesianToCartographic'](_0x5913e9),_0x405bf2=Cesium$1[_0xbac461(0x31f,0x2a4)][_0xb2238(-0x8a,-0xb8)](_0x390baa[_0xb2238(-0x18e,-0x12d)]),_0x97f429=Cesium$1[_0xbac461(0x31f,0x396)]['toDegrees'](_0x390baa['latitude']);_0x4c3834=Math['min'](_0x4c3834,_0x405bf2),_0x8da230=Math['max'](_0x8da230,_0x405bf2),_0x3dbfdc=Math['min'](_0x3dbfdc,_0x97f429),_0x54ae0d=Math['max'](_0x54ae0d,_0x97f429);}if(!_0x1f8a6){const _0x41bbff=new Cesium$1['Cartesian2'](Math['max'](this[_0xb2238(-0x124,-0xfa)][_0xbac461(0x34a,0x2cc)]['west'],_0x4c3834),Math['min'](this['windData']['bounds']['east'],_0x8da230)),_0x1b5988=new Cesium$1[(_0xb2238(-0xe7,-0x7f))](Math['max'](this['windData']['bounds'][_0xb2238(-0x30,-0x73)],_0x3dbfdc),Math[_0xbac461(0x3b9,0x42d)](this['windData'][_0xb2238(-0xf9,-0x117)]['north'],_0x54ae0d)),_0x282800=(_0x41bbff['y']-_0x41bbff['x'])*0.05,_0x27b57d=(_0x1b5988['y']-_0x1b5988['x'])*0.05;_0x41bbff['x']=Math['max'](this['windData']['bounds']['west'],_0x41bbff['x']-_0x282800),_0x41bbff['y']=Math[_0xb2238(-0x5b,-0xa8)](this['windData']['bounds'][_0xbac461(0x352,0x2ee)],_0x41bbff['y']+_0x282800),_0x1b5988['x']=Math[_0xb2238(-0x132,-0xa9)](this[_0xbac461(0x367,0x3ba)][_0xb2238(-0x13c,-0x117)]['south'],_0x1b5988['x']-_0x27b57d),_0x1b5988['y']=Math['min'](this['windData'][_0xb2238(-0xe6,-0x117)][_0xbac461(0x3df,0x38a)],_0x1b5988['y']+_0x27b57d),this['viewerParameters'][_0xbac461(0x3d7,0x40f)]=_0x41bbff,this[_0xbac461(0x384,0x30b)]['latRange']=_0x1b5988;const _0xb53855=this[_0xbac461(0x367,0x3ac)][_0xb2238(-0xb9,-0x117)]['east']-this[_0xbac461(0x367,0x384)]['bounds']['west'],_0x1807ce=this['windData']['bounds']['north']-this[_0xbac461(0x367,0x347)][_0xbac461(0x34a,0x32f)]['south'],_0x2e697a=(_0x41bbff['y']-_0x41bbff['x'])/_0xb53855,_0x251a14=(_0x1b5988['y']-_0x1b5988['x'])/_0x1807ce,_0xdcd532=Math['min'](_0x2e697a,_0x251a14),_0x44586e=0x3e8*_0xdcd532;_0x44586e>0x0&&(this[_0xb2238(-0x10d,-0xdd)][_0xb2238(-0x16f,-0x14a)]=Math['max'](0x0,Math['min'](0x3e8,_0x44586e)));}this[_0xbac461(0x384,0x3aa)]['sceneMode']=this[_0xbac461(0x37c,0x3a1)]['mode'],(_0x2b2be=this['particleSystem'])===null||_0x2b2be===void 0x0||_0x2b2be['applyViewerParameters'](this['viewerParameters']);}[_0x5a583e(0x41e,0x41b)](_0x3ac75e,_0x3884b9){const {bounds:_0x3d92c6,width:_0x4d9418,height:_0xd80526,u:_0x340a7a,v:_0x3d787f,speed:_0x28daf1}=this['windData'];function _0x507be5(_0x56945e,_0xe54825){return _0x5a583e(_0x56945e,_0xe54825-0xe);}const {flipY:_0x559f2d}=this['options'];if(_0x3ac75e<_0x3d92c6[_0x3bab23(0x1b6,0x1f6)]||_0x3ac75e>_0x3d92c6[_0x3bab23(0xec,0x14e)]||_0x3884b9<_0x3d92c6['south']||_0x3884b9>_0x3d92c6[_0x3bab23(0x179,0xf5)])return null;const _0x1dc5c8=(_0x3ac75e-_0x3d92c6[_0x507be5(0x523,0x514)])/(_0x3d92c6['east']-_0x3d92c6[_0x507be5(0x578,0x514)])*(_0x4d9418-0x1);let _0x4513f2=(_0x3884b9-_0x3d92c6[_0x507be5(0x535,0x4e6)])/(_0x3d92c6['north']-_0x3d92c6[_0x3bab23(0x188,0x118)])*(_0xd80526-0x1);_0x559f2d&&(_0x4513f2=_0xd80526-0x1-_0x4513f2);const _0x42ad06=Math['floor'](_0x1dc5c8),_0x213b73=Math['floor'](_0x4513f2),_0x210037=Math['floor'](_0x1dc5c8),_0x4c4156=Math['min'](_0x210037+0x1,_0x4d9418-0x1),_0x451b9e=Math['floor'](_0x4513f2),_0x3bd3fb=Math[_0x3bab23(0x153,0xc0)](_0x451b9e+0x1,_0xd80526-0x1),_0x29aebf=_0x1dc5c8-_0x210037,_0x1b15a5=_0x4513f2-_0x451b9e,_0x215703=_0x213b73*_0x4d9418+_0x42ad06,_0x5c318c=_0x451b9e*_0x4d9418+_0x210037,_0x241eb8=_0x451b9e*_0x4d9418+_0x4c4156,_0x443448=_0x3bd3fb*_0x4d9418+_0x210037,_0x2f11df=_0x3bd3fb*_0x4d9418+_0x4c4156,_0x3299f2=_0x340a7a['array'][_0x5c318c];function _0x3bab23(_0x707fa6,_0x59e328){return _0x8bac9f(_0x59e328,_0x707fa6-0xfb);}const _0x393bc8=_0x340a7a[_0x507be5(0x4ba,0x4a9)][_0x241eb8],_0x1d5290=_0x340a7a['array'][_0x443448],_0x34d297=_0x340a7a['array'][_0x2f11df],_0x556b5c=(0x1-_0x29aebf)*(0x1-_0x1b15a5)*_0x3299f2+_0x29aebf*(0x1-_0x1b15a5)*_0x393bc8+(0x1-_0x29aebf)*_0x1b15a5*_0x1d5290+_0x29aebf*_0x1b15a5*_0x34d297,_0xc6d94=_0x3d787f['array'][_0x5c318c],_0x4220bf=_0x3d787f[_0x3bab23(0x14b,0xc3)][_0x241eb8],_0x4e93d0=_0x3d787f[_0x3bab23(0x14b,0x1db)][_0x443448],_0x5e422e=_0x3d787f[_0x3bab23(0x14b,0xdc)][_0x2f11df],_0xb8b011=(0x1-_0x29aebf)*(0x1-_0x1b15a5)*_0xc6d94+_0x29aebf*(0x1-_0x1b15a5)*_0x4220bf+(0x1-_0x29aebf)*_0x1b15a5*_0x4e93d0+_0x29aebf*_0x1b15a5*_0x5e422e,_0x1a48a0=Math['sqrt'](_0x556b5c*_0x556b5c+_0xb8b011*_0xb8b011),_0x2cdad2={};_0x2cdad2['u']=_0x340a7a['array'][_0x215703],_0x2cdad2['v']=_0x3d787f['array'][_0x215703],_0x2cdad2[_0x507be5(0x4db,0x4e3)]=_0x28daf1[_0x507be5(0x466,0x4a9)][_0x215703];const _0x5cc13b={};_0x5cc13b['u']=_0x556b5c,_0x5cc13b['v']=_0xb8b011,_0x5cc13b['speed']=_0x1a48a0;const _0x3dffc0={};return _0x3dffc0[_0x3bab23(0x110,0xb0)]=_0x2cdad2,_0x3dffc0[_0x507be5(0x426,0x494)]=_0x5cc13b,_0x3dffc0;}}mars3d__namespace['LayerUtil']['register'](_0x5a583e(0x482,0x470),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){this[_0x51d868(0x2ae,0x2e5)]=null,this['lat']=null,this[_0x51d868(0x324,0x341)]=null,this['tlat']=null,this['age']=null;function _0x4b54eb(_0x4c9836,_0x3bafd5){return _0x5a583e(_0x4c9836,_0x3bafd5-0xff);}function _0x51d868(_0x560421,_0x8b1567){return _0x8bac9f(_0x560421,_0x8b1567-0x2e6);}this[_0x4b54eb(0x5c1,0x5d4)]=null;}['destroy'](){for(const _0x51861b in this){delete this[_0x51861b];}}}class CanvasWindField{constructor(_0x8cbf72){this['setOptions'](_0x8cbf72);}get[_0x8bac9f(0x10a,0x7b)](){return this['_speedRate'];}set[_0x5a583e(0x4e4,0x4c6)](_0x4fc1da){this['_speedRate']=(0x64-(_0x4fc1da>0x63?0x63:_0x4fc1da))*0x64;function _0x20d8e7(_0x4a19df,_0x537865){return _0x5a583e(_0x4a19df,_0x537865- -0x461);}function _0x17ef92(_0x5b6ffd,_0x10388b){return _0x8bac9f(_0x10388b,_0x5b6ffd- -0x1bb);}this['_calc_speedRate']=[(this[_0x20d8e7(0x68,0x3c)]-this[_0x20d8e7(-0x9e,-0x34)])/this[_0x17ef92(-0x11c,-0x19b)],(this['ymax']-this[_0x20d8e7(0xe6,0x58)])/this['_speedRate']];}get['maxAge'](){function _0x590b5f(_0x3e2caf,_0x3ec54b){return _0x8bac9f(_0x3ec54b,_0x3e2caf-0x3d2);}return this[_0x590b5f(0x3a6,0x439)];}set['maxAge'](_0x410328){this['_maxAge']=_0x410328;}['setOptions'](_0x9964f6){this['options']=_0x9964f6,this[_0x3d5562(0x557,0x52a)]=_0x9964f6['maxAge']||0x78;function _0x3d5562(_0x216978,_0x32b249){return _0x5a583e(_0x32b249,_0x216978-0x70);}this['speedRate']=_0x9964f6['speedRate']||0x32;function _0x22ac59(_0x17903e,_0x44d75c){return _0x5a583e(_0x44d75c,_0x17903e- -0x11);}this['particles']=[];const _0x27bc0d=_0x9964f6[_0x3d5562(0x489,0x465)]||0x1000;for(let _0x43904d=0x0;_0x43904d<_0x27bc0d;_0x43904d++){const _0x418373=this[_0x22ac59(0x46c,0x414)](new CanvasParticle());this['particles'][_0x3d5562(0x4f5,0x4a5)](_0x418373);}}[_0x5a583e(0x3f9,0x418)](_0x2a9e22){this['rows']=_0x2a9e22[_0x52b344(0x382,0x3f5)],this['cols']=_0x2a9e22[_0x3becc0(0xbf,0x98)],this['xmin']=_0x2a9e22[_0x3becc0(0x3c,0xb2)],this['xmax']=_0x2a9e22[_0x3becc0(0xac,0x66)],this['ymin']=_0x2a9e22['ymin'],this['ymax']=_0x2a9e22['ymax'],this['grid']=[];const _0x39f7b8=_0x2a9e22['udata'],_0x2af3c1=_0x2a9e22[_0x52b344(0x3f8,0x385)];let _0x346f6f=![];_0x39f7b8[_0x52b344(0x2a8,0x326)]===this['rows']&&_0x39f7b8[0x0]['length']===this[_0x52b344(0x415,0x3a1)]&&(_0x346f6f=!![]);let _0x4b1768=0x0,_0x2be205=null,_0x221c2b=null;function _0x3becc0(_0x3e9380,_0xdb303){return _0x8bac9f(_0xdb303,_0x3e9380-0x5a);}function _0x52b344(_0x477555,_0x44fe70){return _0x5a583e(_0x477555,_0x44fe70- -0x10f);}for(let _0x231846=0x0;_0x231846<this[_0x52b344(0x366,0x3f5)];_0x231846++){_0x2be205=[];for(let _0x220823=0x0;_0x220823<this['cols'];_0x220823++,_0x4b1768++){_0x346f6f?_0x221c2b=this['_calcUV'](_0x39f7b8[_0x231846][_0x220823],_0x2af3c1[_0x231846][_0x220823]):_0x221c2b=this['_calcUV'](_0x39f7b8[_0x4b1768],_0x2af3c1[_0x4b1768]),_0x2be205[_0x52b344(0x31a,0x376)](_0x221c2b);}this['grid']['push'](_0x2be205);}!this['options']['flipY']&&this[_0x52b344(0x38b,0x387)]['reverse']();}['clear'](){delete this['rows'],delete this[_0x55dfd9(0x208,0x238)],delete this[_0x55dfd9(0x199,0x1b5)];function _0x395e04(_0x46de00,_0x544c0d){return _0x8bac9f(_0x544c0d,_0x46de00-0x4c5);}delete this['xmax'];function _0x55dfd9(_0x239ff2,_0x491234){return _0x8bac9f(_0x239ff2,_0x491234-0x1d3);}delete this['ymin'],delete this['ymax'],delete this['grid'],delete this[_0x395e04(0x563,0x4e2)];}[_0x8bac9f(-0x79,-0x5)](_0x27f783,_0x5dbdb0){function _0x8df2cc(_0x2f6959,_0x203bd6){return _0x8bac9f(_0x203bd6,_0x2f6959-0x25e);}const _0x1330f3=(_0x27f783-this['xmin'])/(this[_0x8df2cc(0x2b0,0x2f2)]-this[_0x1d37ad(-0x2cb,-0x24a)])*(this[_0x1d37ad(-0x192,-0x1c7)]-0x1),_0x44b843=(this[_0x8df2cc(0x29a,0x2fb)]-_0x5dbdb0)/(this['ymax']-this['ymin'])*(this['rows']-0x1);function _0x1d37ad(_0x3b7745,_0x3e1067){return _0x5a583e(_0x3b7745,_0x3e1067- -0x677);}return[_0x1330f3,_0x44b843];}[_0x8bac9f(0xbd,0xcd)](_0xadeb44,_0x47b33d){if(_0xadeb44<0x0||_0xadeb44>=this['cols']||_0x47b33d>=this['rows'])return[0x0,0x0,0x0];const _0x1cd231=Math['floor'](_0xadeb44),_0x3acc9f=Math[_0x5417e8(0x4ac,0x482)](_0x47b33d);if(_0x1cd231===_0xadeb44&&_0x3acc9f===_0x47b33d)return this['grid'][_0x47b33d][_0xadeb44];const _0x13a5da=_0x1cd231+0x1;function _0x4f97e5(_0x396235,_0x512d93){return _0x8bac9f(_0x512d93,_0x396235- -0x1d1);}const _0x267f30=_0x3acc9f+0x1,_0x2b7711=this['getUVByXY'](_0x1cd231,_0x3acc9f),_0x1c6e32=this['getUVByXY'](_0x13a5da,_0x3acc9f),_0x5b3ae2=this['getUVByXY'](_0x1cd231,_0x267f30),_0x2fe3f1=this[_0x4f97e5(-0x104,-0x118)](_0x13a5da,_0x267f30);function _0x5417e8(_0x1be670,_0x8bd2f1){return _0x5a583e(_0x1be670,_0x8bd2f1-0x34);}let _0x5b8447=null;try{_0x5b8447=this['_bilinearInterpolation'](_0xadeb44-_0x1cd231,_0x47b33d-_0x3acc9f,_0x2b7711,_0x1c6e32,_0x5b3ae2,_0x2fe3f1);}catch(_0x1b49c4){console['log'](_0xadeb44,_0x47b33d);}return _0x5b8447;}['_bilinearInterpolation'](_0x16493d,_0x1ae0fd,_0x2eed0e,_0x5b051f,_0xbb4167,_0x1ea143){const _0x4be02c=0x1-_0x16493d,_0x441001=0x1-_0x1ae0fd,_0x2f84c5=_0x4be02c*_0x441001,_0x25477e=_0x16493d*_0x441001,_0x101094=_0x4be02c*_0x1ae0fd,_0x1a3b9c=_0x16493d*_0x1ae0fd,_0x53e6b5=_0x2eed0e[0x0]*_0x2f84c5+_0x5b051f[0x0]*_0x25477e+_0xbb4167[0x0]*_0x101094+_0x1ea143[0x0]*_0x1a3b9c,_0x14107f=_0x2eed0e[0x1]*_0x2f84c5+_0x5b051f[0x1]*_0x25477e+_0xbb4167[0x1]*_0x101094+_0x1ea143[0x1]*_0x1a3b9c;return this['_calcUV'](_0x53e6b5,_0x14107f);}[_0x5a583e(0x53e,0x512)](_0x25d837,_0x58bc2f){return[+_0x25d837,+_0x58bc2f,Math['sqrt'](_0x25d837*_0x25d837+_0x58bc2f*_0x58bc2f)];}[_0x5a583e(0x3e0,0x432)](_0x3dc379,_0x490306){if(!this['isInExtent'](_0x3dc379,_0x490306))return null;function _0x2fef0d(_0x574598,_0x10d952){return _0x8bac9f(_0x10d952,_0x574598- -0x7a);}const _0x42e93b=this[_0x2fef0d(-0x7f,-0xb8)](_0x3dc379,_0x490306),_0x4a2c49=this['getUVByXY'](_0x42e93b[0x0],_0x42e93b[0x1]);return _0x4a2c49;}['isInExtent'](_0x44a1d9,_0x3b9145){function _0x1f1095(_0xe0bb52,_0x5c22d5){return _0x5a583e(_0x5c22d5,_0xe0bb52- -0x1a0);}return _0x44a1d9>=this['xmin']&&_0x44a1d9<=this[_0x1f1095(0x2fd,0x2b9)]&&_0x3b9145>=this['ymin']&&_0x3b9145<=this['ymax']?!![]:![];}[_0x5a583e(0x41a,0x417)](){const _0x53796b=fRandomByfloat(this[_0xa194c8(-0x1f2,-0x17e)],this[_0xa194c8(-0x14c,-0x10e)]),_0x2fe87c=fRandomByfloat(this[_0xa194c8(-0x7d,-0xf2)],this[_0x4565f2(0x1bb,0x14f)]);function _0x4565f2(_0x2fc4c5,_0x4fca4e){return _0x5a583e(_0x4fca4e,_0x2fc4c5- -0x2cc);}const _0x157a75={};function _0xa194c8(_0x1c6beb,_0x270f19){return _0x8bac9f(_0x1c6beb,_0x270f19- -0x160);}return _0x157a75['lat']=_0x2fe87c,_0x157a75[_0x4565f2(0x17e,0x1fa)]=_0x53796b,_0x157a75;}['getParticles'](){function _0x2f4b5f(_0x34d27e,_0x52187c){return _0x8bac9f(_0x52187c,_0x34d27e-0x1c0);}let _0xc902a3,_0x179ec2,_0x51398f;for(let _0x37fcda=0x0,_0x5ebda3=this['particles']['length'];_0x37fcda<_0x5ebda3;_0x37fcda++){let _0x3dc541=this['particles'][_0x37fcda];_0x3dc541['age']<=0x0&&(_0x3dc541=this['_randomParticle'](_0x3dc541));if(_0x3dc541['age']>0x0){const _0xa4fd71=_0x3dc541['tlng'],_0x44cd7a=_0x3dc541['tlat'];_0x51398f=this['getUVByPoint'](_0xa4fd71,_0x44cd7a),_0x51398f?(_0xc902a3=_0xa4fd71+this['_calc_speedRate'][0x0]*_0x51398f[0x0],_0x179ec2=_0x44cd7a+this['_calc_speedRate'][0x1]*_0x51398f[0x1],_0x3dc541['lng']=_0xa4fd71,_0x3dc541['lat']=_0x44cd7a,_0x3dc541[_0x2f4b5f(0x21b,0x262)]=_0xc902a3,_0x3dc541['tlat']=_0x179ec2,_0x3dc541['speed']=_0x51398f[0x2],_0x3dc541[_0x4f7817(0x48d,0x40b)]--):_0x3dc541['age']=0x0;}}function _0x4f7817(_0x5884f6,_0x322bf0){return _0x5a583e(_0x322bf0,_0x5884f6- -0x49);}return this['particles'];}[_0x8bac9f(0x77,0x32)](_0x35e0ce){let _0x2351be,_0x283341;for(let _0x22f3e2=0x0;_0x22f3e2<0x1e;_0x22f3e2++){_0x2351be=this[_0x1911ec(0x18c,0x133)](),_0x283341=this['getUVByPoint'](_0x2351be[_0x1911ec(0x1bf,0x21e)],_0x2351be['lat']);if(_0x283341&&_0x283341[0x2]>0x0)break;}if(!_0x283341)return _0x35e0ce;function _0x9d141a(_0x2f95b7,_0x54ecf9){return _0x5a583e(_0x54ecf9,_0x2f95b7- -0x4ca);}const _0x5d2e94=_0x2351be['lng']+this['_calc_speedRate'][0x0]*_0x283341[0x0],_0x3f4dfe=_0x2351be['lat']+this[_0x1911ec(0x184,0x122)][0x1]*_0x283341[0x1];_0x35e0ce['lng']=_0x2351be[_0x1911ec(0x1bf,0x163)],_0x35e0ce['lat']=_0x2351be[_0x1911ec(0x1cf,0x1ac)],_0x35e0ce[_0x9d141a(-0x24,-0xaa)]=_0x5d2e94,_0x35e0ce[_0x9d141a(-0x20,-0xb3)]=_0x3f4dfe;function _0x1911ec(_0x3fd699,_0x72eb2){return _0x8bac9f(_0x72eb2,_0x3fd699-0x1c0);}return _0x35e0ce['age']=Math['round'](0xa+Math[_0x1911ec(0x20d,0x223)]()*this[_0x1911ec(0x25c,0x200)]),_0x35e0ce['speed']=_0x283341[0x2],_0x35e0ce;}['destroy'](){for(const _0x33c3f9 in this){delete this[_0x33c3f9];}}}function fRandomByfloat(_0x3c9f38,_0x2d5e6c){function _0x26c12d(_0x21d59d,_0x52d642){return _0x5a583e(_0x52d642,_0x21d59d- -0x68c);}return _0x3c9f38+Math[_0x26c12d(-0x1f4,-0x1c4)]()*(_0x2d5e6c-_0x3c9f38);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x5a583e(0x4b6,0x426)]['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0x463a44={}){super(_0x463a44),this[_0x37d93b(-0x286,-0x29d)](_0x463a44);function _0x37d93b(_0x3c726e,_0x5080fa){return _0x8bac9f(_0x5080fa,_0x3c726e- -0x245);}function _0x5eac10(_0x45f03b,_0x37551c){return _0x8bac9f(_0x45f03b,_0x37551c-0x1dd);}this['canvas']=null,_0x463a44['colors']&&_0x463a44[_0x37d93b(-0x1e9,-0x24d)]&&(this['_colorRamp']=new mars3d__namespace[(_0x37d93b(-0x266,-0x200))](_0x463a44));}['_setOptionsHook'](_0x210fad,_0x2569ff){function _0x2dbb55(_0x584d48,_0x1b2e2e){return _0x5a583e(_0x584d48,_0x1b2e2e- -0x227);}this['frameTime']=0x3e8/(_0x210fad['frameRate']||0xa),this['_pointerEvents']=this['options'][_0x2dbb55(0x327,0x2da)]??![],this['color']=_0x210fad['color']||_0x2dbb55(0x2a7,0x29e),this[_0x2dbb55(0x1a6,0x20f)]=_0x210fad['lineWidth']||0x1,this['fixedHeight']=_0x210fad[_0x2dbb55(0x2dd,0x2f8)]??0x0,this['flipY']=_0x210fad[_0x4955d7(0x5b6,0x5fd)]??![];function _0x4955d7(_0x5f376b,_0x4c7861){return _0x5a583e(_0x4c7861,_0x5f376b-0xc2);}this[_0x4955d7(0x4eb,0x53d)]&&this['windField']['setOptions'](_0x210fad);}get['layer'](){function _0x5323e8(_0x429ad6,_0x95af4b){return _0x5a583e(_0x95af4b,_0x429ad6- -0x277);}return this[_0x5323e8(0x19c,0x1e7)];}get['canvasWidth'](){function _0x4a21da(_0x342490,_0x241ece){return _0x5a583e(_0x342490,_0x241ece-0x62);}function _0x56f4fe(_0x3d8568,_0x424e09){return _0x8bac9f(_0x3d8568,_0x424e09- -0x20);}return this[_0x4a21da(0x51d,0x4bf)]['scene'][_0x4a21da(0x42b,0x475)][_0x4a21da(0x54a,0x51a)];}get[_0x8bac9f(0x74,0xc0)](){function _0x40053b(_0x3c6b0a,_0x40289e){return _0x8bac9f(_0x40289e,_0x3c6b0a-0xd5);}function _0x450809(_0x23ba00,_0x7b43e8){return _0x5a583e(_0x23ba00,_0x7b43e8- -0x56);}return this[_0x450809(0x48d,0x407)]['scene'][_0x450809(0x444,0x3bd)][_0x450809(0x4f9,0x471)];}get['pointerEvents'](){function _0x293fa3(_0x3385cd,_0x379581){return _0x5a583e(_0x3385cd,_0x379581-0x9);}return this[_0x293fa3(0x539,0x517)];}set['pointerEvents'](_0x16d2c1){function _0x231329(_0x301cb0,_0x4afcc5){return _0x5a583e(_0x4afcc5,_0x301cb0-0xfc);}this['_pointerEvents']=_0x16d2c1;if(!this['canvas'])return;function _0xbc58f(_0x4009e8,_0x3d8081){return _0x8bac9f(_0x4009e8,_0x3d8081-0x53c);}_0x16d2c1?this[_0x231329(0x50f,0x53d)][_0xbc58f(0x4d1,0x51d)]['pointer-events']=_0x231329(0x5fa,0x67a):this[_0xbc58f(0x4b6,0x504)]['style'][_0x231329(0x55a,0x570)]=_0x231329(0x52f,0x53d);}get['particlesNumber'](){function _0x2b1d4c(_0x2ffc7d,_0x5f05f8){return _0x8bac9f(_0x5f05f8,_0x2ffc7d-0x494);}return this[_0x2b1d4c(0x4ea,0x47c)]['particlesNumber'];}set[_0x8bac9f(-0x2d,-0x32)](_0x5c8c67){this['options']['particlesNumber']=_0x5c8c67,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(()=>{this['redraw']();},0x1f4);}get['speedRate'](){function _0x3fa1b2(_0x13dba2,_0x31dadd){return _0x5a583e(_0x31dadd,_0x13dba2- -0x5e8);}return this['options'][_0x3fa1b2(-0x122,-0x11b)];}set['speedRate'](_0x582bd1){function _0x3d3994(_0xd3054c,_0x19f4df){return _0x8bac9f(_0x19f4df,_0xd3054c-0x20d);}this['options']['speedRate']=_0x582bd1,this['windField']&&(this[_0x3d3994(0x1eb,0x230)]['speedRate']=_0x582bd1);}get['maxAge'](){return this['options']['maxAge'];}set['maxAge'](_0x3414f0){this[_0x190f54(0x372,0x3b2)]['maxAge']=_0x3414f0;function _0x582902(_0x428e4b,_0x1d67c2){return _0x8bac9f(_0x428e4b,_0x1d67c2-0x3b);}function _0x190f54(_0x4847b2,_0x13a976){return _0x5a583e(_0x13a976,_0x4847b2- -0x12f);}this[_0x582902(0x2d,0x19)]&&(this['windField']['maxAge']=_0x3414f0);}get['data'](){return this['windData'];}set['data'](_0x2aa845){function _0x1e00a1(_0xa02ee9,_0x20af2f){return _0x5a583e(_0xa02ee9,_0x20af2f- -0x543);}this[_0x1e00a1(-0x182,-0x104)](_0x2aa845);}get[_0x8bac9f(0x161,0xd1)](){let _0x85054e=this[_0x24c838(-0x14a,-0x106)]['xmin'],_0x55d407=this['windData']['xmax'],_0x4905a2=this[_0x24c838(-0x13f,-0x106)][_0x24c838(-0xc1,-0x9e)],_0x51bcc6=this['windData']['ymax'];_0x55d407>=0x167&&_0x85054e===0x0&&(_0x85054e=-0xb4,_0x55d407=0xb4);_0x85054e=Math[_0x71a46b(0x341,0x336)](_0x85054e,-0xb4),_0x55d407=Math[_0x71a46b(0x2f1,0x337)](_0x55d407,0xb4);function _0x24c838(_0x235663,_0x5ce160){return _0x8bac9f(_0x235663,_0x5ce160- -0x10c);}_0x4905a2=Math['max'](_0x4905a2,-0x5a),_0x51bcc6=Math['min'](_0x51bcc6,0x5a);function _0x71a46b(_0x134235,_0x16cac3){return _0x5a583e(_0x134235,_0x16cac3- -0x16c);}return Cesium['Rectangle']['fromDegrees'](_0x85054e,_0x4905a2,_0x55d407,_0x51bcc6);}[_0x8bac9f(-0x55,-0x1a)](_0x3ce8c7){function _0x3f66c3(_0x163cd1,_0xf40b4a){return _0x5a583e(_0x163cd1,_0xf40b4a-0x77);}function _0x5bba09(_0x33a24f,_0x186ca3){return _0x8bac9f(_0x186ca3,_0x33a24f-0x40b);}_0x3ce8c7?this['_addedHook']():(this[_0x5bba09(0x411,0x383)]&&(this[_0x5bba09(0x461,0x45c)]['data']=this['windData']),this[_0x5bba09(0x405,0x414)]());}['_mountedHook'](){function _0x2ea449(_0x25729f,_0x5a9a42){return _0x8bac9f(_0x25729f,_0x5a9a42- -0x229);}this[_0x2ea449(-0x25e,-0x1d3)]['worker']?this['initWorker']():this['windField']=new CanvasWindField(this['options']);}['_addedHook'](){this['canvas']=this['_createCanvas']();function _0x24e72d(_0x202b43,_0x3bca75){return _0x5a583e(_0x202b43,_0x3bca75- -0x144);}const _0x31e462={};_0x31e462[_0x24e72d(0x2d8,0x33d)]=!![],this[_0x24e72d(0x2e3,0x318)]=this[_0x4e15a9(-0x248,-0x26d)]['getContext']('2d',_0x31e462);function _0x4e15a9(_0x296d18,_0x3593bb){return _0x5a583e(_0x296d18,_0x3593bb- -0x680);}this['bindEvent'](),this[_0x24e72d(0x318,0x35d)]['data']&&this[_0x24e72d(0x280,0x2fb)](this[_0x24e72d(0x3d4,0x35d)]['data']);}['_removedHook'](){this['clear']();function _0x15b0f9(_0x4875fd,_0x251da5){return _0x8bac9f(_0x4875fd,_0x251da5-0x47);}this['unbindEvent']();function _0x16d733(_0x42d9fe,_0x29ed36){return _0x8bac9f(_0x42d9fe,_0x29ed36- -0x1ba);}this['canvas']&&(this[_0x16d733(-0x14b,-0x1a8)]['container']['removeChild'](this['canvas']),delete this[_0x15b0f9(0x9a,0xf)]);}['_createCanvas'](){const _0xac2dbb=mars3d__namespace[_0x1af56f(-0x14f,-0x192)][_0x1af56f(-0x1b0,-0x1ab)](_0x1af56f(-0x178,-0x20b),_0x1af56f(-0x11f,-0x1a9),this['_map']['container']);_0xac2dbb[_0x1af56f(-0x27b,-0x1f2)]['position']=_0x303d73(-0xfd,-0x17c),_0xac2dbb[_0x303d73(-0x1d6,-0x201)]['top']=_0x1af56f(-0x1c4,-0x145);function _0x1af56f(_0x2616d1,_0x32e5c5){return _0x5a583e(_0x2616d1,_0x32e5c5- -0x61e);}_0xac2dbb[_0x303d73(-0x259,-0x201)]['left']='0px',_0xac2dbb['style']['width']=this[_0x1af56f(-0x16c,-0x1c1)]['scene'][_0x303d73(-0x2ac,-0x21a)]['clientWidth']+'px',_0xac2dbb['style']['height']=this['_map']['scene']['canvas']['clientHeight']+'px';function _0x303d73(_0x43afcd,_0x36213f){return _0x8bac9f(_0x43afcd,_0x36213f- -0x1e2);}return _0xac2dbb[_0x1af56f(-0x248,-0x1f2)][_0x1af56f(-0x135,-0x11d)]=this['_pointerEvents']?_0x303d73(-0xdb,-0x15a):'none',_0xac2dbb[_0x303d73(-0x19f,-0x201)]['zIndex']=this['options']['zIndex']??0x9,_0xac2dbb['width']=this['_map']['scene']['canvas'][_0x303d73(-0x16a,-0x175)],_0xac2dbb['height']=this['_map'][_0x1af56f(-0x1e5,-0x1b8)]['canvas'][_0x1af56f(-0x190,-0x157)],_0xac2dbb;}['resize'](){function _0x4549bd(_0x5f3334,_0x5c86b7){return _0x5a583e(_0x5f3334,_0x5c86b7- -0x49e);}function _0x2d3b7f(_0x1b9900,_0x2fb758){return _0x8bac9f(_0x1b9900,_0x2fb758-0x285);}this['canvas']&&(this['canvas']['style']['width']=this['_map']['scene'][_0x2d3b7f(0x269,0x24d)]['clientWidth']+'px',this[_0x2d3b7f(0x1ec,0x24d)]['style']['height']=this[_0x4549bd(-0x9c,-0x41)]['scene'][_0x4549bd(-0x27,-0x8b)][_0x2d3b7f(0x361,0x301)]+'px',this['canvas']['width']=this['_map'][_0x2d3b7f(0x2f7,0x2a0)]['canvas']['clientWidth'],this['canvas']['height']=this[_0x2d3b7f(0x246,0x297)][_0x4549bd(-0x1c,-0x38)][_0x2d3b7f(0x276,0x24d)]['clientHeight']);}[_0x8bac9f(0x48,0xa7)](){const _0xc33b80=this;let _0x31884e=Date[_0x19d263(-0x197,-0x1a9)]();(function _0x94452c(){function _0x500dc1(_0x298568,_0x28b7c4){return _0x19d263(_0x298568-0x29,_0x28b7c4);}if(_0xc33b80[_0x273922(-0x15a,-0xed)])return;_0xc33b80[_0x273922(-0x110,-0x106)]=window[_0x500dc1(-0x238,-0x258)](_0x94452c);function _0x273922(_0x2f9df4,_0x368167){return _0x19d263(_0x368167-0x125,_0x2f9df4);}if(_0xc33b80['show']&&_0xc33b80['windField']){const _0x51b842=Date['now'](),_0xeacf32=_0x51b842-_0x31884e;_0xeacf32>_0xc33b80['frameTime']&&(_0x31884e=_0x51b842-_0xeacf32%_0xc33b80[_0x273922(-0xaf,-0x11c)],_0xc33b80['update']());}}());function _0x4045f9(_0x4eb8dd,_0xd31869){return _0x5a583e(_0x4eb8dd,_0xd31869- -0x4da);}window['addEventListener']('resize',this['resize']['bind'](this),![]),this[_0x4045f9(-0x34,-0x2b)]=![],this['mouse_move']=![];function _0x19d263(_0x3d919e,_0x3befb6){return _0x5a583e(_0x3befb6,_0x3d919e- -0x664);}this['options']['mouseHidden']&&(this[_0x19d263(-0x207,-0x1e1)]['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x19d263(-0x1f9,-0x1ff)],this['_onMouseDownEvent'],this),this[_0x4045f9(-0x106,-0x7d)]['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this));}['unbindEvent'](){window['cancelAnimationFrame'](this['_animateFrame']),delete this[_0x21a157(0x50a,0x490)];function _0x586b0e(_0x5acddf,_0x6fabd2){return _0x8bac9f(_0x5acddf,_0x6fabd2-0x47c);}function _0x21a157(_0x1e822d,_0x402bcd){return _0x8bac9f(_0x1e822d,_0x402bcd-0x4a2);}window[_0x586b0e(0x430,0x453)](_0x21a157(0x555,0x528),this[_0x21a157(0x4ae,0x528)]),this[_0x586b0e(0x4ab,0x4d2)]['mouseHidden']&&(this['_map']['off'](mars3d__namespace['EventType'][_0x586b0e(0x5a0,0x52e)],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace[_0x586b0e(0x5c5,0x551)]['mouseDown'],this[_0x586b0e(0x3e7,0x45c)],this),this['_map'][_0x21a157(0x581,0x53c)](mars3d__namespace['EventType']['mouseUp'],this[_0x21a157(0x479,0x4aa)],this),this['_map'][_0x21a157(0x58f,0x53c)](mars3d__namespace['EventType']['mouseMove'],this[_0x586b0e(0x5a2,0x53a)],this));}[_0x8bac9f(0x89,0x69)](_0x57493a){clearTimeout(this[_0x485cee(0x1a4,0x22c)]);function _0x1e9279(_0x3bae71,_0x50ac3f){return _0x5a583e(_0x3bae71,_0x50ac3f- -0x40b);}if(!this['show']||!this['canvas'])return;function _0x485cee(_0x2839e3,_0x582d17){return _0x5a583e(_0x582d17,_0x2839e3- -0x2ab);}this[_0x485cee(0x168,0x148)][_0x485cee(0x181,0x17b)]['visibility']=_0x485cee(0x20c,0x28d),this[_0x485cee(0x1a4,0x126)]=setTimeout(()=>{function _0x53b811(_0x55eb53,_0x3e2ab0){return _0x1e9279(_0x3e2ab0,_0x55eb53-0x148);}if(!this[_0x52eea9(-0x2d,-0x70)])return;function _0x52eea9(_0x1ba4d6,_0x57de43){return _0x485cee(_0x57de43- -0x271,_0x1ba4d6);}this['redraw'](),this[_0x52eea9(-0x142,-0x109)][_0x52eea9(-0xe5,-0xf0)][_0x53b811(0x21c,0x291)]='visible';},0xc8);}[_0x5a583e(0x3e2,0x42b)](_0x50a043){function _0x2b2cc2(_0x13c2db,_0x3e9b47){return _0x8bac9f(_0x3e9b47,_0x13c2db-0x419);}this['mouse_down']=!![];function _0x136313(_0x4409dc,_0x276274){return _0x8bac9f(_0x4409dc,_0x276274-0x4d2);}this['_map']['off'](mars3d__namespace[_0x136313(0x53e,0x5a7)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace[_0x2b2cc2(0x4ee,0x54c)]['mouseMove'],this['_onMouseMoveEvent'],this);}['_onMouseMoveEvent'](_0x43d954){function _0x2ddc7e(_0x578d34,_0x14affa){return _0x5a583e(_0x14affa,_0x578d34- -0xd3);}function _0x55db9e(_0x2343d7,_0x184e34){return _0x5a583e(_0x2343d7,_0x184e34-0xb5);}if(!this[_0x55db9e(0x5d5,0x561)]||!this[_0x55db9e(0x47a,0x4c8)])return;this[_0x2ddc7e(0x3dc,0x3f2)]&&(this[_0x55db9e(0x4e1,0x4c8)]['style'][_0x2ddc7e(0x40c,0x428)]='hidden',this[_0x55db9e(0x516,0x4c7)]=!![]);}[_0x5a583e(0x486,0x453)](_0xbd3747){if(!this['show']||!this[_0x4befa8(0x1af,0x121)])return;this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x4befa8(0x2a5,0x2fa)],this);this['mouse_down']&&this[_0x4befa8(0x1ae,0x194)]&&this[_0x688b8(-0x138,-0x107)]();function _0x688b8(_0x58028c,_0xd0b82c){return _0x8bac9f(_0xd0b82c,_0x58028c- -0x138);}this['canvas'][_0x4befa8(0x1c8,0x204)]['visibility']=_0x688b8(-0x69,-0xeb),this['mouse_down']=![];function _0x4befa8(_0x2471cf,_0x481a98){return _0x8bac9f(_0x481a98,_0x2471cf-0x1e7);}this[_0x688b8(-0x171,-0x1fa)]=![];}['setData'](_0x5d7de0){function _0x345b1a(_0x48d6ca,_0x265822){return _0x5a583e(_0x48d6ca,_0x265822- -0x2ac);}this[_0x54fcee(0x197,0x133)](),this['windData']=_0x5d7de0;function _0x54fcee(_0x590656,_0x14bbb8){return _0x5a583e(_0x590656,_0x14bbb8- -0x332);}this['windField'][_0x54fcee(0xde,0xe6)](_0x5d7de0),this['redraw']();}['redraw'](){if(!this['show'])return;function _0x1fcbf6(_0x3804bf,_0xc1d6df){return _0x8bac9f(_0xc1d6df,_0x3804bf-0x165);}function _0x4b7aa7(_0x569efd,_0x4328be){return _0x5a583e(_0x4328be,_0x569efd-0x75);}this['windField'][_0x4b7aa7(0x482,0x41e)](this[_0x4b7aa7(0x516,0x561)]),this['update']();}['update'](){if(this[_0xf9038f(-0x22,-0x4)])return;this['_updateIng']=!![];function _0xf9038f(_0x48ffa1,_0xd6f859){return _0x8bac9f(_0x48ffa1,_0xd6f859- -0x55);}if(this['worker'])this[_0x3d5858(-0x31,-0x98)]['update']();else{const _0x242b5b=this[_0x3d5858(-0x31,-0x3)]['getParticles']();this[_0xf9038f(0x41,0x48)](_0x242b5b);}function _0x3d5858(_0x2b763a,_0x2b42b5){return _0x5a583e(_0x2b42b5,_0x2b763a- -0x45a);}this['_updateIng']=![];}['_drawLines'](_0x219133){this['_canvasParticles']=_0x219133,this['canvasContext'][_0x24cc21(0x2e8,0x2f8)]='destination-in',this['canvasContext'][_0x3cc533(0x3f9,0x45f)](0x0,0x0,this['canvasWidth'],this[_0x3cc533(0x4a9,0x4dd)]),this['canvasContext']['globalCompositeOperation']='lighter',this['canvasContext'][_0x3cc533(0x419,0x464)]=0.9;function _0x24cc21(_0x3c9c72,_0x1f4ad0){return _0x8bac9f(_0x3c9c72,_0x1f4ad0-0x2a5);}const _0x6fffff=this['_map']['scene']['mode']!==Cesium[_0x24cc21(0x302,0x349)][_0x24cc21(0x304,0x2fa)];function _0x3cc533(_0x246d25,_0x3d587a){return _0x5a583e(_0x3d587a,_0x246d25- -0x62);}const _0x50427d=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0x80fcc6=0x0,_0xf35c77=_0x219133['length'];_0x80fcc6<_0xf35c77;_0x80fcc6++){const _0x34e4e8=_0x219133[_0x80fcc6],_0x425d83=this['_tomap'](_0x34e4e8,_0x34e4e8[_0x3cc533(0x3e8,0x443)],_0x34e4e8['lat'],_0x34e4e8['alt']),_0x130f54=this[_0x3cc533(0x44b,0x3d5)](_0x34e4e8,_0x34e4e8['tlng'],_0x34e4e8[_0x24cc21(0x288,0x304)],_0x34e4e8[_0x24cc21(0x340,0x2f4)]);if(!_0x425d83||!_0x130f54)continue;if(_0x6fffff&&Math[_0x24cc21(0x330,0x2d1)](_0x425d83[0x0]-_0x130f54[0x0])>=_0x50427d)continue;this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this[_0x3cc533(0x3fa,0x3ec)][_0x24cc21(0x265,0x295)]=this[_0x3cc533(0x40a,0x3c2)]['getColor'](_0x34e4e8[_0x24cc21(0x344,0x32f)]),this['canvasContext'][_0x24cc21(0x2e2,0x28a)](_0x425d83[0x0],_0x425d83[0x1]),this['canvasContext'][_0x24cc21(0x2de,0x36b)](_0x130f54[0x0],_0x130f54[0x1]),this['canvasContext']['stroke']();}else{this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this[_0x3cc533(0x3fa,0x372)]['strokeStyle']=this['color'];for(let _0x31a245=0x0,_0x3d51e3=_0x219133[_0x3cc533(0x3d3,0x39b)];_0x31a245<_0x3d51e3;_0x31a245++){const _0x2575dd=_0x219133[_0x31a245],_0x5462e2=this['_tomap'](_0x2575dd,_0x2575dd['lng'],_0x2575dd['lat'],_0x2575dd[_0x3cc533(0x498,0x430)]),_0x5e3827=this['_tomap'](_0x2575dd,_0x2575dd['tlng'],_0x2575dd[_0x3cc533(0x448,0x3f1)],_0x2575dd['talt']);if(!_0x5462e2||!_0x5e3827)continue;if(_0x6fffff&&Math['abs'](_0x5462e2[0x0]-_0x5e3827[0x0])>=_0x50427d)continue;this[_0x24cc21(0x342,0x2b6)][_0x24cc21(0x27e,0x28a)](_0x5462e2[0x0],_0x5462e2[0x1]),this['canvasContext']['lineTo'](_0x5e3827[0x0],_0x5e3827[0x1]);}this[_0x24cc21(0x238,0x2b6)]['stroke']();}}[_0x8bac9f(0x83,0x62)](_0x2f5e5e,_0x252c1e,_0x2590e0,_0x4d8dbb){const _0x5ec5c7=Cesium[_0x2db3f1(0xca,0x7e)]['fromDegrees'](_0x252c1e,_0x2590e0,_0x4d8dbb??this['fixedHeight']);function _0x51948f(_0x106c9c,_0x4854f1){return _0x5a583e(_0x106c9c,_0x4854f1- -0x230);}const _0x57b3e8=this['_map'][_0x51948f(0x2c4,0x236)];if(_0x57b3e8[_0x2db3f1(0x187,0x199)]===Cesium['SceneMode']['SCENE3D']){const _0x111e9a=new Cesium[(_0x51948f(0x201,0x1e6))](_0x57b3e8[_0x2db3f1(0x110,0x134)][_0x2db3f1(0x1bc,0x192)],_0x57b3e8['camera']['positionWC']),_0x12245f=_0x111e9a['isPointVisible'](_0x5ec5c7);if(!_0x12245f)return _0x2f5e5e[_0x2db3f1(0x183,0x136)]=0x0,null;}const _0xe57042=mars3d__namespace['PointTrans']['toWindowCoordinates'](this['_map']['scene'],_0x5ec5c7);function _0x2db3f1(_0x5bb795,_0x4c9b09){return _0x5a583e(_0x4c9b09,_0x5bb795- -0x353);}return _0xe57042?[_0xe57042['x'],_0xe57042['y']]:null;}[_0x8bac9f(0x75,0x1a)](){this['windField']['clear'](),delete this['windData'];}['initWorker'](){function _0xe100cc(_0x499db9,_0x1a594f){return _0x8bac9f(_0x499db9,_0x1a594f-0x240);}function _0x16f8bb(_0x418de4,_0x1b6d01){return _0x5a583e(_0x1b6d01,_0x418de4-0x1d);}this['worker']=new Worker(this['options'][_0x16f8bb(0x4fa,0x561)]),this[_0xe100cc(0x269,0x2d2)]['onmessage']=_0x1eb3e7=>{this['_drawLines'](_0x1eb3e7['data'][_0x5d134a(0x1ed,0x223)]);function _0x5d134a(_0x23b646,_0x35169b){return _0xe100cc(_0x35169b,_0x23b646- -0xf1);}this['_updateIng2']=![];},this['windField']={'init':_0x1f01a5=>{const _0x5511be={};_0x5511be[_0x52faa3(0x338,0x2ae)]='init';function _0x52faa3(_0xe692bf,_0x594a20){return _0x16f8bb(_0xe692bf- -0x1f9,_0x594a20);}_0x5511be['options']=_0x1f01a5,this['worker']['postMessage'](_0x5511be);},'setOptions':_0x5b8c1f=>{const _0x4dc453={};function _0x12e5dd(_0x350184,_0x505da6){return _0x16f8bb(_0x350184- -0xf0,_0x505da6);}_0x4dc453['type']=_0x12e5dd(0x33a,0x2db),_0x4dc453['options']=_0x5b8c1f,this['worker']['postMessage'](_0x4dc453);},'setDate':_0x28b931=>{const _0x5010b8={};function _0x5c042f(_0x3fe132,_0xd7aa94){return _0xe100cc(_0x3fe132,_0xd7aa94-0x2c2);}_0x5010b8[_0x3b22c3(0x2e9,0x30c)]=_0x5c042f(0x494,0x4cf),_0x5010b8['data']=_0x28b931;function _0x3b22c3(_0x5f12e0,_0x14a746){return _0xe100cc(_0x14a746,_0x5f12e0- -0x20);}this[_0x3b22c3(0x2b2,0x283)][_0x3b22c3(0x298,0x290)](_0x5010b8);},'update':()=>{function _0x2c2440(_0x1567dc,_0x166cc5){return _0x16f8bb(_0x1567dc- -0x3f2,_0x166cc5);}if(this['_updateIng2'])return;this[_0x2c2440(0xde,0x141)]=!![];const _0x49b405={};function _0x2e9d49(_0xc6141a,_0x2022b8){return _0x16f8bb(_0x2022b8- -0x4fc,_0xc6141a);}_0x49b405[_0x2e9d49(0x33,0x35)]=_0x2e9d49(0x18,-0x67),this[_0x2e9d49(0x39,-0x2)][_0x2c2440(0xee,0xf4)](_0x49b405);},'clear':()=>{const _0x2633a3={};_0x2633a3[_0x418c53(-0x63,-0xe5)]='clear';function _0x40ba53(_0x27b39e,_0x3e17de){return _0xe100cc(_0x27b39e,_0x3e17de-0x2c4);}function _0x418c53(_0x4af4e4,_0x3e4033){return _0x16f8bb(_0x4af4e4- -0x594,_0x3e4033);}this['worker'][_0x418c53(-0xb4,-0xbe)](_0x2633a3);}},this[_0x16f8bb(0x446,0x4bc)]['init'](this['options']);}}function _0x8d19(){const _0x42248b=['DomUtil','#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a','blue','8235150vzenYh','commandType','Cesium','2gZqwgm','toDegrees','vdata','dynamic','grid','colorTable','random','textures','talt','array','_updateIng','xmax','globalCompositeOperation','blendFuncSource','SCENE3D','options','max','min','createRenderingFramebuffers','domain','tlng','steps','onParticlesTextureSizeChange','createColorTableTexture','tlat','dropRate','show','_tomap','createCommand','mouse_down','cols','absolute','computing','_updateIng2','_onMapWhellEvent','morphComplete','pixelFormat','hidden','clientWidth','ymin','1617862dDBoBK','frameRate','uniformMap','alpha','register','particlesTextures','STATIC_DRAW','lonRange','number','postMessage','useViewerBounds','#ffffff','speedRate','clientHeight','getPostProcessingPositionShader','north','outputTexture','defineProperty','Cartesian2','now','fragmentShaderSource','data','createWindTextures','resize','sceneMode','auto','blendEquation','speed','age','warn','south','0px','mode','windTextures','udata','worker','bind','visibility','nextParticlesPosition','particlesTextureSize','primitiveType','segmentsDepth','segments','off','prototype','maxAge','_drawLines','particles','_speedRate','LINEAR','forEach','particlesSpeed','add','SceneMode','speedFactor','width','bindEvent','Compute','flipY','camera','framebuffer','colors','geometry','CLAMP_TO_EDGE','alt','height','pixelDatatype','wheel','all','DEPTH_COMPONENT','getDefaultRenderState','pointerEvents','percentageChanged','postProcessingPosition','rows','min\x20is\x20undefined,\x20calculate\x20min','west','209lyRuBl','primitives','_onMouseMoveEvent','context','canvasHeight','frameRateMonitor','Draw','_pointerEvents','ellipsoid','bufferUsage','lineTo','_calcUV','fromCssColorString','type','call','depthTest','preExecute','getUVByXY','frameState.commandList\x20is\x20undefined','visible','shaderProgram','rectangle','frameRateAdjustment','sources','fixedHeight','EventType','getOwnPropertyDescriptor','object','1022120HUbYSp','commandToExecute','updateWindData','__esModule','pixelSize','depthMask','requestAnimationFrame','autoClear','getCalculateSpeedShader','wrapT','componentsPerAttribute','blending','Math','_setOptionsHook','fromGeometry','previousParticlesPosition','setOptions','stringify','_calc_speedRate','sqrt','getSegmentDrawFragmentShader','mouse_move','canvas','owner','WindUtil','EllipsoidalOccluder','getRandomLatLng','setDate','particlesNumber','default','getDataAtLonLat','reCreateWindTextures','Cartesian3','longitude','_maxAge','getPrimitives','attributeLocations','removeEventListener','frameTime','CanvasWindField','dropRateBump','layer','TRIANGLES','atan2','windField','ColorRamp','_onMouseDownEvent','style','xmin','slice','keys','moveTo','_showHook','getUVByPoint','none','bounds','length','lineWidth','rendering','updatePosition','_animateFrame','destroyParticlesTextures','strokeStyle','east','green','destroy','setData','Unknown\x20command\x20type','vmin','5TyfMxL','rawRenderState','changeOptions','_removedHook','toGridXY','updateViewerParameters','commandList','108kkOnIJ','lng','redraw','RGBA','logInfo','floor','refreshTimer','minificationFilter','windData','isDestroy','_onMouseUpEvent','addEventListener','5604711oLaMMy','lastFramesPerSecond','createParticlesTextures','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a','framebuffers','lat','fillRect','canvasContext','_map','pointer-events','getUpdatePositionShader','original','420528SczFuX','LayerUtil','globe','drawingBufferWidth','clear','scene','execute','_addedHook','renderState','processWindData','mouseDown','_colorRamp','FLOAT','viewerParameters','lineLength','wind','createPrimitives','vmax','create','Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.','mars3d-canvasWind','1822938rkCuwO','abs','update','enabled','clearCommand','globalAlpha','pow','_randomParticle','updateOptions','values','87AGTOQM','willReadFrequently','getU','get','27276pkddyZ','push','interpolated','ymax','getSegmentDrawVertexShader','currentParticlesPosition','value','umin'];_0x8d19=function(){return _0x42248b;};return _0x8d19();}mars3d__namespace[_0x5a583e(0x41b,0x462)][_0x8bac9f(0x6b,0x73)]('canvasWind',CanvasWindLayer),mars3d__namespace[_0x5a583e(0x499,0x426)]['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['Log'][_0x8bac9f(-0x1c,0x2)]('mars3d-wind插件\x20注册成功'),mars3d__namespace['WindUtil']=WindUtil,exports[_0x5a583e(0x3e1,0x424)]=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer;function _0x5a583e(_0x297a03,_0x1ce2ac){return _0x544d(_0x1ce2ac-0x2da,_0x297a03);}exports['WindLayer']=WindLayer,exports[_0x8bac9f(-0xbd,-0x36)]=WindUtil;const _0x5905eb={};_0x5905eb[_0x8bac9f(0x8c,0x3f)]=!![],Object[_0x8bac9f(0x82,0x80)](exports,_0x5a583e(0x44d,0x400),_0x5905eb);
}));
