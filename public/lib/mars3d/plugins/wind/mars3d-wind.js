/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.10.8
 * 编译日期：2025-11-05 20:19
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-07-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x5a40cc,_0x2ebd1a){function _0x45961a(_0x15d144,_0x41ba45){return _0x5aa4(_0x41ba45- -0x2c5,_0x15d144);}const _0x5da51f=_0x5a40cc();function _0x23e9a5(_0x3c09e7,_0x4f28a9){return _0x5aa4(_0x3c09e7- -0x266,_0x4f28a9);}while(!![]){try{const _0xf71b08=parseInt(_0x45961a(-0x120,-0x17d))/0x1+parseInt(_0x23e9a5(-0x79,-0x21))/0x2+-parseInt(_0x45961a(-0x79,-0xe2))/0x3+-parseInt(_0x45961a(-0x1ad,-0x1c6))/0x4*(-parseInt(_0x45961a(-0xd8,-0x147))/0x5)+-parseInt(_0x45961a(-0x1b5,-0x19c))/0x6+parseInt(_0x45961a(-0xab,-0xe1))/0x7+-parseInt(_0x45961a(-0x16a,-0xf6))/0x8;if(_0xf71b08===_0x2ebd1a)break;else _0x5da51f['push'](_0x5da51f['shift']());}catch(_0x2390c6){_0x5da51f['push'](_0x5da51f['shift']());}}}(_0x2e28,0x9eb65));function _interopNamespace(_0x3acc89){if(_0x3acc89&&_0x3acc89[_0x1311c5(0x30,0x93)])return _0x3acc89;var _0xb98841=Object['create'](null);function _0x1311c5(_0x5c65f6,_0x4ba690){return _0x5aa4(_0x4ba690- -0x129,_0x5c65f6);}_0x3acc89&&Object[_0x4443f7(-0xc0,-0x13d)](_0x3acc89)['forEach'](function(_0x17696f){if(_0x17696f!=='default'){var _0x8c158e=Object['getOwnPropertyDescriptor'](_0x3acc89,_0x17696f);Object['defineProperty'](_0xb98841,_0x17696f,_0x8c158e['get']?_0x8c158e:{'enumerable':!![],'get':function(){return _0x3acc89[_0x17696f];}});}});_0xb98841['default']=_0x3acc89;function _0x4443f7(_0x1422e7,_0xc15bfc){return _0x5aa4(_0x1422e7- -0x1b7,_0xc15bfc);}return _0xb98841;}function _0x350367(_0xb6b4b3,_0x106519){return _0x5aa4(_0x106519- -0x257,_0xb6b4b3);}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x45afbb,_0xaa8c49){const _0x332ff1=_0x45afbb*Math['cos'](Cesium$2['Math']['toRadians'](_0xaa8c49));return _0x332ff1;}function _0x2e28(){const _0x85bb8f=['xmin','pointer-events','morphComplete','windData','requestRender','clear','mouse_move','abs','grid','canvasWidth','frameRateAdjustment','canvas','cols','particlesTextureSize','values','_maxAge','1222140PyjLgX','bufferUsage','lat','pow','canvasHeight','magnificationFilter','isDestroyed','getUVByPoint','outputTexture','vertexArray','updatePosition','createSegmentsGeometry','create','preExecute','frameRateMonitor','mouse_down','EventType','array','init','frameTime','all','onColorTableChange','canvasContext','atan2','setOptions','geometry','bindEvent','lineLength','changed','depthTexture','processWindData','strokeStyle','_addedHook','commandToExecute','speed','__proto__','sin','data','particlesNumber','worker','moveTo','sqrt','now','getDefaultRenderState','lastFramesPerSecond','framebuffer','removeEventListener','ymax','redraw','south','_speedRate','particleSystem','CLAMP_TO_EDGE','rows','99465vAqKVw','getV','height','fragmentShaderSource','ONE_MINUS_SRC_ALPHA','getParticles','age','none','options','attributeLocations','stroke','min','_bilinearInterpolation','lineTo','MAX_VALUE','_map','_tomap','particlesTextures','style','CanvasWindLayer','ymin','_onMouseUpEvent','tlat','xmax','warn','Cartesian2','rendering','getRandomLatLng','Compute','colorTextures','applyViewerParameters','Math','_updateIng2','mode','resize','RED','min\x20is\x20undefined,\x20calculate\x20min','NEAREST','ellipsoid','position','getPrimitives','textures','object','viewerParameters','west','createParticlesTextures','segmentsDepth','color','east','off','UNSIGNED_BYTE','blue','max','createWindTextures','mars3d-canvasWind','mouseHidden','frameRate','getPostProcessingPositionShader','hasOwnProperty','show','normal','latitude','__esModule','primitives','rawRenderState','forEach','fill','isArray','enabled','_showHook','visibility','STATIC_DRAW','SCENE3D','destroy','samplingWindow','dropRate','nextParticlesPosition','flipY','steps','colors','_removedHook','25131240VbHFfW','speedRate','CanvasWindField','layer','random','componentDatatype','bounds','windTextures','createColorTableTexture','beginPath','floor','destroyParticlesTextures','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a','clientHeight','drawingBufferWidth','isInExtent','uniformMap','LINEAR','getU','FLOAT','1504188CtzHtY','4469031uBFLBs','maxAge','wheel','particlesSpeed','auto','framebuffers','setData','colorTable','_onMouseMoveEvent','2483862cUbuwW','particlesTextureSize\x20must\x20be\x20greater\x20than\x200','globe','computing','north','container','type','percentageChanged','length','segments','_randomParticle','createCommand','commandList','sceneMode','keys','primitiveType','postMessage','postProcessingPosition','_calc_speedRate','_calcUV','previousParticlesPosition','useViewerBounds','244KuUwlL','autoClear','_onMapWhellEvent','minificationFilter','wind','createComputingPrimitives','pointerEvents','udata','createRenderingTextures','addEventListener','createPrimitives','logInfo','globalCompositeOperation','TRIANGLES','push','reCreateWindTextures','bind','LayerUtil','componentsPerAttribute','zIndex','createRawRenderState','modelMatrix','removeChild','toDegrees','dynamic','context','_onMouseDownEvent','particles','toGridXY','max\x20is\x20undefined,\x20calculate\x20max','lng','log','tlng','Cesium','getSegmentDrawVertexShader','original','getSegmentDrawFragmentShader','getUVByXY','currentParticlesPosition','_pointerEvents','commandType','scene','138546BpuTBT','width','camera','fixedHeight','mouseMove','_drawLines','lonRange','reverse','_updateIng','clientWidth','fromGeometry','vmin','windField','lineWidth','updateViewerParameters'];_0x2e28=function(){return _0x85bb8f;};return _0x2e28();}function getV(_0x403c13,_0x13a6ef){const _0x568b9b=_0x403c13*Math[_0x22a30c(-0x49,-0xa)](Cesium$2['Math']['toRadians'](_0x13a6ef));function _0x22a30c(_0x173c8e,_0x3067e4){return _0x5aa4(_0x173c8e- -0x1b5,_0x3067e4);}return _0x568b9b;}function getSpeed(_0x2ec0c5,_0x48ce31){const _0x196bc7=Math[_0x1627cc(-0x21b,-0x1d4)](Math['pow'](_0x2ec0c5,0x2)+Math[_0x1627cc(-0x24f,-0x1fa)](_0x48ce31,0x2));function _0x1627cc(_0x271974,_0x538f45){return _0x5aa4(_0x538f45- -0x345,_0x271974);}function _0x1d6bd9(_0x4c5bb3,_0x25d13e){return _0x5aa4(_0x25d13e-0x397,_0x4c5bb3);}return _0x196bc7;}function getDirection(_0x1b683c,_0x2c10c6){function _0x89848(_0x10d148,_0x57d78b){return _0x5aa4(_0x10d148-0x337,_0x57d78b);}let _0x5eb51b=Cesium$2['Math'][_0x2fffae(0x28a,0x2b3)](Math[_0x89848(0x496,0x489)](_0x2c10c6,_0x1b683c));_0x5eb51b+=_0x5eb51b<0x0?0x168:0x0;function _0x2fffae(_0xf8ccc9,_0x226145){return _0x5aa4(_0xf8ccc9-0x174,_0x226145);}return _0x5eb51b;}const _0x4c509={};_0x4c509[_0x28aa37(-0x32,-0x30)]=null,_0x4c509[_0x350367(-0xb3,-0x76)]=getU,_0x4c509[_0x28aa37(-0x1e,0x16)]=getV,_0x4c509['getSpeed']=getSpeed,_0x4c509['getDirection']=getDirection;var WindUtil=_0x4c509,updatePositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a',calculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',renderParticlesVertexShader=_0x28aa37(0x3e,-0x42);const {ShaderSource:ShaderSource$1}=mars3d__namespace['Cesium'];class ShaderManager{static['getCalculateSpeedShader'](){const _0x4277df={};return _0x4277df['sources']=[calculateSpeedShader],new ShaderSource$1(_0x4277df);}static['getUpdatePositionShader'](){const _0xfed55a={};return _0xfed55a['sources']=[updatePositionShader],new ShaderSource$1(_0xfed55a);}static[_0x350367(-0x16d,-0x136)](){const _0x52fa16={};return _0x52fa16['sources']=[renderParticlesVertexShader],new ShaderSource$1(_0x52fa16);}static[_0x28aa37(-0x7a,-0xd7)](){const _0x102a07={};return _0x102a07['sources']=[renderParticlesFragmentShader],new ShaderSource$1(_0x102a07);}static['getPostProcessingPositionShader'](){const _0x12a93e={};return _0x12a93e['sources']=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x12a93e);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x51b3d8){this[_0xa8510e(0x1ff,0x208)]=_0x51b3d8['commandType'],this[_0xa8510e(0x1c8,0x242)]=_0x51b3d8[_0xa8510e(0x2bc,0x242)],this['attributeLocations']=_0x51b3d8['attributeLocations'];function _0xa8510e(_0x58fd84,_0x18d537){return _0x28aa37(_0x18d537-0x27e,_0x58fd84);}this[_0xa8510e(0x1b9,0x1d9)]=_0x51b3d8['primitiveType'],this['uniformMap']=_0x51b3d8[_0xa8510e(0x2c8,0x2c0)]||{},this['vertexShaderSource']=_0x51b3d8['vertexShaderSource'],this[_0x5b15e2(0x4f1,0x475)]=_0x51b3d8['fragmentShaderSource'],this['rawRenderState']=_0x51b3d8[_0x5b15e2(0x474,0x4b2)],this['framebuffer']=_0x51b3d8['framebuffer'],this[_0x5b15e2(0x4bc,0x444)]=_0x51b3d8['outputTexture'],this[_0xa8510e(0x24a,0x1e1)]=_0x51b3d8['autoClear']??![],this['preExecute']=_0x51b3d8['preExecute'],this[_0xa8510e(0x223,0x29a)]=!![],this[_0x5b15e2(0x43f,0x45d)]=undefined,this['clearCommand']=undefined;function _0x5b15e2(_0x45a467,_0x3f9ec3){return _0x350367(_0x45a467,_0x3f9ec3-0x54b);}this['isDynamic']=_0x51b3d8['isDynamic']??(()=>!![]),this[_0xa8510e(0x18a,0x1e1)]&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x5b15e2(0x4d5,0x469)],'pass':Pass$1['OPAQUE']}));}[_0x350367(-0x1df,-0x163)](_0x324efa){function _0x1b83fb(_0x368053,_0x1ba5fd){return _0x28aa37(_0x368053-0x378,_0x1ba5fd);}function _0x31a6ba(_0x2e55cd,_0x3c6280){return _0x28aa37(_0x2e55cd-0x537,_0x3c6280);}if(this['commandType']==='Draw'){const _0x2422f5={};_0x2422f5['context']=_0x324efa,_0x2422f5[_0x1b83fb(0x33c,0x36c)]=this['geometry'],_0x2422f5['attributeLocations']=this[_0x1b83fb(0x362,0x391)],_0x2422f5[_0x31a6ba(0x4e3,0x4b5)]=BufferUsage$1[_0x31a6ba(0x55f,0x5c9)];const _0x32c504=VertexArray$1[_0x1b83fb(0x30e,0x2b5)](_0x2422f5),_0x17f826={};_0x17f826['context']=_0x324efa,_0x17f826['vertexShaderSource']=this['vertexShaderSource'],_0x17f826[_0x31a6ba(0x51b,0x583)]=this[_0x31a6ba(0x51b,0x56f)],_0x17f826['attributeLocations']=this[_0x31a6ba(0x521,0x50a)];const _0x1b4e29=ShaderProgram['fromCache'](_0x17f826),_0xebad0f=RenderState['fromCache'](this[_0x31a6ba(0x558,0x500)]),_0x216a62={};return _0x216a62['owner']=this,_0x216a62[_0x1b83fb(0x32c,0x2c3)]=_0x32c504,_0x216a62[_0x1b83fb(0x2d3,0x295)]=this[_0x31a6ba(0x492,0x498)],_0x216a62[_0x1b83fb(0x2ef,0x2be)]=Matrix4['IDENTITY'],_0x216a62['renderState']=_0xebad0f,_0x216a62['shaderProgram']=_0x1b4e29,_0x216a62['framebuffer']=this[_0x1b83fb(0x350,0x38b)],_0x216a62['uniformMap']=this['uniformMap'],_0x216a62['pass']=Pass$1['OPAQUE'],new DrawCommand(_0x216a62);}else{if(this['commandType']==='Compute'){const _0x519ba1={};return _0x519ba1['owner']=this,_0x519ba1['fragmentShaderSource']=this[_0x31a6ba(0x51b,0x552)],_0x519ba1[_0x31a6ba(0x579,0x536)]=this['uniformMap'],_0x519ba1['outputTexture']=this[_0x1b83fb(0x32b,0x2ab)],_0x519ba1['persists']=!![],new ComputeCommand(_0x519ba1);}else throw new Error('Unknown\x20command\x20type');}}['setGeometry'](_0x12c136,_0x1b84fb){this['geometry']=_0x1b84fb;function _0x356cbb(_0x380991,_0x3644bb){return _0x28aa37(_0x3644bb- -0x75,_0x380991);}function _0x1d0e53(_0x4ddf5a,_0x1b35ca){return _0x350367(_0x4ddf5a,_0x1b35ca-0x1a5);}defined(this['commandToExecute'])&&(this['commandToExecute'][_0x356cbb(-0xc0,-0xc1)]=VertexArray$1['fromGeometry']({'context':_0x12c136,'geometry':this[_0x1d0e53(0x10c,0xaf)],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1['STATIC_DRAW']}));}['update'](_0x327955){if(!this['isDynamic']())return;if(!this[_0x32e162(0x340,0x2de)]||!defined(_0x327955))return;!defined(this[_0x215e33(0x47c,0x4d5)])&&(this['commandToExecute']=this[_0x32e162(0x27b,0x2c5)](_0x327955['context']));function _0x215e33(_0x29e9a0,_0x6265a7){return _0x350367(_0x6265a7,_0x29e9a0-0x56a);}defined(this[_0x32e162(0x2dc,0x2b5)])&&this[_0x215e33(0x468,0x411)]();function _0x32e162(_0x3262e5,_0x41d0a4){return _0x350367(_0x41d0a4,_0x3262e5-0x3de);}if(!_0x327955[_0x32e162(0x27c,0x278)]){console[_0x215e33(0x4a9,0x4c1)]('frameState.commandList\x20is\x20undefined');return;}defined(this['clearCommand'])&&_0x327955['commandList']['push'](this['clearCommand']),defined(this['commandToExecute'])&&_0x327955[_0x215e33(0x408,0x458)]['push'](this['commandToExecute']);}[_0x28aa37(-0x4f,0x12)](){return![];}['destroy'](){if(defined(this['commandToExecute'])){var _0x2c6f0c;(_0x2c6f0c=this['commandToExecute']['shaderProgram'])===null||_0x2c6f0c===void 0x0||_0x2c6f0c[_0x4f8046(0x99,0x32)](),this['commandToExecute']['shaderProgram']=undefined;}function _0x4f8046(_0xc990a0,_0x36729b){return _0x28aa37(_0xc990a0-0x6f,_0x36729b);}return destroyObject(this);}}function deepMerge(_0xfa7b93,_0x563941){if(!_0xfa7b93)return _0x563941;if(!_0x563941)return _0xfa7b93;const _0x1100d4={..._0x563941};function _0x1c443a(_0x1d589c,_0x2b5610){return _0x28aa37(_0x1d589c- -0xfb,_0x2b5610);}function _0x431d8f(_0x367364,_0x2f59b7){return _0x350367(_0x2f59b7,_0x367364-0x1ca);}const _0x3948b6=_0x1100d4;for(const _0x580503 in _0xfa7b93){if(Object['prototype'][_0x431d8f(0x12b,0x16e)]['call'](_0xfa7b93,_0x580503)){const _0x4648dc=_0xfa7b93[_0x580503],_0xa4dec5=_0x563941[_0x580503];if(Array[_0x1c443a(-0xd7,-0x64)](_0x4648dc)){_0x3948b6[_0x580503]=_0x4648dc['slice']();continue;}if(_0x4648dc&&typeof _0x4648dc===_0x431d8f(0x11b,0x18d)){_0x3948b6[_0x580503]=deepMerge(_0x4648dc,_0xa4dec5||{});continue;}_0x4648dc!==undefined&&(_0x3948b6[_0x580503]=_0x4648dc);}}return _0x3948b6;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace['Cesium'];class WindParticlesComputing{constructor(_0x2e5e2f,_0xc449ec,_0x35da13,_0x1217a8,_0x3a0c2d){this[_0x1674d5(0x4f6,0x53f)]=_0x2e5e2f,this[_0x1674d5(0x564,0x5bb)]=_0x35da13;function _0x1674d5(_0x57404a,_0x366c28){return _0x28aa37(_0x57404a-0x57b,_0x366c28);}this['viewerParameters']=_0x1217a8,this['windData']=_0xc449ec,this['frameRate']=0x3c,this[_0x2a30eb(0x1f3,0x21b)]=0x1;const _0x4bc7d2={};_0x4bc7d2['scene']=_0x3a0c2d;function _0x2a30eb(_0x401bfb,_0x512fe1){return _0x350367(_0x401bfb,_0x512fe1-0x330);}_0x4bc7d2[_0x1674d5(0x5a6,0x619)]=0x1,_0x4bc7d2['quietPeriod']=0x0,this['frameRateMonitor']=new FrameRateMonitor(_0x4bc7d2),this['initFrameRate'](),this['createWindTextures'](),this['createParticlesTextures'](),this[_0x2a30eb(0x17c,0x1dd)]();}['initFrameRate'](){const _0x5a29c5=()=>{function _0x43567a(_0x32b4ed,_0x571f3a){return _0x5aa4(_0x32b4ed- -0xc6,_0x571f3a);}function _0xf7ac4b(_0x460994,_0x1f4c94){return _0x5aa4(_0x1f4c94-0x2e6,_0x460994);}this['frameRateMonitor'][_0x43567a(0xae,0x61)]>0x14&&(this[_0xf7ac4b(0x4f6,0x49c)]=this['frameRateMonitor']['lastFramesPerSecond'],this['frameRateAdjustment']=0x3c/Math['max'](this[_0x43567a(0xf0,0xe2)],0x1));};function _0x432360(_0x197384,_0x241a9d){return _0x28aa37(_0x241a9d- -0x2,_0x197384);}_0x5a29c5();function _0x2f20f2(_0x577e79,_0x42a941){return _0x350367(_0x577e79,_0x42a941-0x315);}const _0x126c2a=setInterval(_0x5a29c5,0x3e8),_0x1b1da9=this['destroy'][_0x2f20f2(0x21c,0x1cd)](this);this[_0x2f20f2(0x29a,0x285)]=()=>{clearInterval(_0x126c2a),_0x1b1da9();};}['createWindTextures'](){const _0x1857e5={};_0x1857e5[_0x35927f(0xef,0xe4)]=TextureMinificationFilter$1['LINEAR'];function _0x19da9a(_0x323e74,_0x3ddff6){return _0x28aa37(_0x323e74- -0x16e,_0x3ddff6);}_0x1857e5[_0x19da9a(-0x1be,-0x148)]=TextureMagnificationFilter$1[_0x35927f(0x1ed,0x1c2)];function _0x35927f(_0x34a79d,_0x1acd34){return _0x28aa37(_0x1acd34-0x17f,_0x34a79d);}const _0x380619={'context':this[_0x19da9a(-0x1f3,-0x23d)],'width':this[_0x19da9a(-0x1d0,-0x214)]['width'],'height':this['windData'][_0x35927f(0x12b,0x162)],'pixelFormat':PixelFormat$1[_0x19da9a(-0x16a,-0xfd)],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this['options'][_0x19da9a(-0x140,-0x186)]??![],'sampler':new Sampler$1(_0x1857e5)};this['windTextures']={'U':new Texture$1({..._0x380619,'source':{'arrayBufferView':new Float32Array(this[_0x35927f(0x19b,0x11d)]['u']['array'])}}),'V':new Texture$1({..._0x380619,'source':{'arrayBufferView':new Float32Array(this[_0x19da9a(-0x1d0,-0x153)]['v'][_0x35927f(0xce,0x13b)])}})};}['createParticlesTextures'](){function _0x385df4(_0x6f0555,_0x5dedf3){return _0x28aa37(_0x5dedf3-0x345,_0x6f0555);}const _0x25d733={};function _0x4654cd(_0x232fa2,_0x50744f){return _0x28aa37(_0x232fa2-0x311,_0x50744f);}_0x25d733[_0x385df4(0x2a0,0x2aa)]=TextureMinificationFilter$1[_0x4654cd(0x317,0x2f0)],_0x25d733['magnificationFilter']=TextureMagnificationFilter$1[_0x385df4(0x2e1,0x34b)];const _0x5851be={'context':this[_0x385df4(0x32b,0x2c0)],'width':this['options'][_0x4654cd(0x2b9,0x265)],'height':this['options']['particlesTextureSize'],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':![],'source':{'arrayBufferView':new Float32Array(this[_0x4654cd(0x2fa,0x348)]['particlesTextureSize']*this['options'][_0x385df4(0x353,0x2ed)]*0x4)[_0x4654cd(0x334,0x38c)](0x0)},'sampler':new Sampler$1(_0x25d733)};this[_0x4654cd(0x303,0x2bb)]={'previousParticlesPosition':new Texture$1(_0x5851be),'currentParticlesPosition':new Texture$1(_0x5851be),'nextParticlesPosition':new Texture$1(_0x5851be),'postProcessingPosition':new Texture$1(_0x5851be),'particlesSpeed':new Texture$1(_0x5851be)};}[_0x28aa37(0x3d,0x3)](){function _0x24edf2(_0x45ee25,_0x284f62){return _0x350367(_0x284f62,_0x45ee25-0x623);}function _0x2ce930(_0x5e51ba,_0x5ca167){return _0x28aa37(_0x5e51ba-0xaa,_0x5ca167);}Object['values'](this['particlesTextures'])[_0x2ce930(0xcc,0x86)](_0x533823=>_0x533823[_0x24edf2(0x593,0x5fc)]());}[_0x28aa37(-0x99,-0x72)](){function _0x5e5ec7(_0xee38a0,_0x9b1f42){return _0x28aa37(_0xee38a0-0x144,_0x9b1f42);}function _0x3891f8(_0x493615,_0x1ee903){return _0x28aa37(_0x493615-0x24d,_0x1ee903);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':_0x3891f8(0x24a,0x2ad),'uniformMap':{'U':()=>this[_0x3891f8(0x286,0x2d0)]['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this['windData']['u']['min'],this[_0x3891f8(0x1eb,0x1bf)]['u']['max']),'vRange':()=>new Cartesian2$1(this[_0x3891f8(0x1eb,0x178)]['v'][_0x3891f8(0x239,0x23a)],this['windData']['v']['max']),'speedRange':()=>new Cartesian2$1(this['windData']['speed'][_0x3891f8(0x239,0x296)],this[_0x5e5ec7(0xe2,0x157)][_0x3891f8(0x21a,0x260)][_0x3891f8(0x262,0x2a6)]),'currentParticlesPosition':()=>this['particlesTextures']['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x5c6c9f(_0x1fdcba,_0x5cda2a){return _0x5e5ec7(_0x1fdcba-0x392,_0x5cda2a);}function _0x4980b9(_0x5245ff,_0x5525d2){return _0x5e5ec7(_0x5525d2-0x441,_0x5245ff);}return(this[_0x5c6c9f(0x4e2,0x559)]['pixelSize']+0x32)*this[_0x5c6c9f(0x4bf,0x51c)]['speedFactor'];},'frameRateAdjustment':()=>this[_0x3891f8(0x1f2,0x1ef)],'dimension':()=>new Cartesian2$1(this[_0x5e5ec7(0xe2,0xf0)][_0x3891f8(0x1da,0x171)],this['windData']['height']),'minimum':()=>new Cartesian2$1(this[_0x5e5ec7(0xe2,0x8b)]['bounds'][_0x5e5ec7(0x151,0x1b5)],this[_0x3891f8(0x1eb,0x19f)]['bounds'][_0x3891f8(0x229,0x1fe)]),'maximum':()=>new Cartesian2$1(this['windData'][_0x5e5ec7(0x17c,0x1c4)][_0x3891f8(0x25e,0x27e)],this[_0x5e5ec7(0xe2,0x74)]['bounds']['north'])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{const _0x4d5b4f=this['particlesTextures']['previousParticlesPosition'];function _0x238953(_0x2ed52e,_0x20fe62){return _0x3891f8(_0x20fe62- -0x15d,_0x2ed52e);}function _0x506f86(_0x931b90,_0x55b016){return _0x3891f8(_0x931b90- -0x1a4,_0x55b016);}this[_0x238953(0x14a,0xe2)][_0x238953(0x80,0x50)]=this['particlesTextures'][_0x506f86(0x31,0x2f)],this[_0x506f86(0x9b,0x3b)]['currentParticlesPosition']=this['particlesTextures']['postProcessingPosition'],this['particlesTextures']['postProcessingPosition']=_0x4d5b4f,this[_0x238953(0x10a,0x110)]['calculateSpeed'][_0x238953(0xf0,0xbc)]&&(this['primitives']['calculateSpeed']['commandToExecute'][_0x238953(0xa1,0xa3)]=this['particlesTextures']['particlesSpeed']);},'isDynamic':()=>this['options'][_0x3891f8(0x1c7,0x19c)]}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this['particlesTextures']['currentParticlesPosition'],'particlesSpeed':()=>this['particlesTextures']['particlesSpeed']},'fragmentShaderSource':ShaderManager['getUpdatePositionShader'](),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':()=>{function _0x54f8cc(_0x4422e8,_0x52417d){return _0x5e5ec7(_0x52417d- -0x138,_0x4422e8);}function _0x3fc82c(_0x4046d9,_0x390e66){return _0x3891f8(_0x4046d9- -0x170,_0x390e66);}this['primitives'][_0x54f8cc(-0xc0,-0x3f)]['commandToExecute']&&(this['primitives']['updatePosition']['commandToExecute'][_0x54f8cc(-0x33,-0x41)]=this[_0x54f8cc(0x55,-0x2)]['nextParticlesPosition']);},'isDynamic':()=>this[_0x3891f8(0x236,0x229)]['dynamic']}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x3891f8(0x24a,0x23b),'uniformMap':{'nextParticlesPosition':()=>this['particlesTextures'][_0x3891f8(0x27a,0x228)],'particlesSpeed':()=>this[_0x5e5ec7(0x136,0x102)][_0x3891f8(0x297,0x2af)],'lonRange':()=>this[_0x5e5ec7(0x150,0x15b)][_0x3891f8(0x1df,0x182)],'latRange':()=>this[_0x5e5ec7(0x150,0x187)]['latRange'],'dataLonRange':()=>new Cartesian2$1(this['windData']['bounds'][_0x5e5ec7(0x151,0x1a1)],this['windData']['bounds']['east']),'dataLatRange':()=>new Cartesian2$1(this[_0x3891f8(0x1eb,0x219)][_0x3891f8(0x285,0x21f)]['south'],this[_0x3891f8(0x1eb,0x17a)][_0x5e5ec7(0x17c,0x10b)][_0x5e5ec7(0x94,0x26)]),'randomCoefficient':function(){return Math['random']();},'dropRate':()=>this['options'][_0x5e5ec7(0x170,0x1da)],'dropRateBump':()=>this[_0x5e5ec7(0x12d,0x172)]['dropRateBump'],'useViewerBounds':()=>this['options'][_0x5e5ec7(0xa5,0xb8)]},'fragmentShaderSource':ShaderManager[_0x5e5ec7(0x15e,0x1ca)](),'outputTexture':this[_0x5e5ec7(0x136,0x16e)]['postProcessingPosition'],'preExecute':()=>{function _0x3bc5a7(_0x3f6293,_0x32f73c){return _0x3891f8(_0x3f6293- -0x3ae,_0x32f73c);}function _0x447b74(_0x37d30d,_0x32d355){return _0x3891f8(_0x32d355- -0x1c8,_0x37d30d);}this[_0x447b74(0x9a,0xa5)][_0x447b74(-0x3d,-0x1e)]['commandToExecute']&&(this['primitives']['postProcessingPosition']['commandToExecute']['outputTexture']=this['particlesTextures'][_0x447b74(0x32,-0x1e)]);},'isDynamic':()=>this['options'][_0x5e5ec7(0xbe,0xf1)]})};}['reCreateWindTextures'](){function _0x3c2b9e(_0x1f5b8a,_0x8383de){return _0x350367(_0x8383de,_0x1f5b8a-0x502);}this[_0x195a18(0x1b0,0x146)]['U']['destroy'](),this['windTextures']['V']['destroy']();function _0x195a18(_0x22d6d3,_0x4d7449){return _0x350367(_0x4d7449,_0x22d6d3-0x231);}this[_0x195a18(0x18d,0x1f2)]();}['updateWindData'](_0x1a5569){this[_0x361e96(-0x9b,-0x33)]=_0x1a5569;function _0x446d23(_0x410dbb,_0x8e69e4){return _0x350367(_0x8e69e4,_0x410dbb-0x1d);}function _0x361e96(_0x49b5ae,_0x32764c){return _0x350367(_0x32764c,_0x49b5ae-0x81);}this[_0x361e96(-0xc8,-0x50)]();}['updateOptions'](_0x297867){function _0xf96fca(_0x10de3c,_0x29cdd8){return _0x350367(_0x29cdd8,_0x10de3c-0x440);}const _0x50b98a=_0x297867['flipY']!==undefined&&_0x297867[_0xf96fca(0x3b4,0x378)]!==this[_0xf96fca(0x36f,0x3bf)]['flipY'];function _0x3138e8(_0x1c5a3f,_0x2918f1){return _0x350367(_0x2918f1,_0x1c5a3f-0x4a2);}this[_0xf96fca(0x36f,0x3c7)]=deepMerge(_0x297867,this[_0xf96fca(0x36f,0x304)]),_0x50b98a&&this[_0xf96fca(0x2f7,0x30c)]();}['processWindData'](_0x94b519){const {array:_0x3365e6}=_0x94b519;let {min:_0x57dd59,max:_0x28e591}=_0x94b519;const _0x51e48a=new Float32Array(_0x3365e6['length']);_0x57dd59===undefined&&(console[_0x158472(-0x14f,-0xea)](_0x158472(-0xb4,-0xde)),_0x57dd59=Math[_0x1747b5(0x3d2,0x406)](..._0x3365e6));function _0x1747b5(_0xc69417,_0x1d21f5){return _0x350367(_0x1d21f5,_0xc69417-0x4a0);}_0x28e591===undefined&&(console['warn'](_0x1747b5(0x365,0x369)),_0x28e591=Math['max'](..._0x3365e6));const _0x46364d=Math['max'](Math[_0x1747b5(0x388,0x360)](_0x57dd59),Math[_0x158472(-0x178,-0x141)](_0x28e591));for(let _0x2f65b4=0x0;_0x2f65b4<_0x3365e6[_0x1747b5(0x33a,0x33d)];_0x2f65b4++){const _0x47eab1=_0x3365e6[_0x2f65b4]/_0x46364d;_0x51e48a[_0x2f65b4]=_0x47eab1;}function _0x158472(_0x32da9a,_0x5ec765){return _0x28aa37(_0x5ec765- -0xe3,_0x32da9a);}return _0x51e48a;}[_0x350367(-0xdd,-0x90)](){function _0x25b532(_0x47fa51,_0x4dac5b){return _0x28aa37(_0x4dac5b-0x11f,_0x47fa51);}Object['values'](this['windTextures'])[_0x274ed4(0x4ff,0x576)](_0x499adb=>_0x499adb['destroy']()),Object['values'](this['particlesTextures'])['forEach'](_0x5e89ef=>_0x5e89ef['destroy']());function _0x274ed4(_0x2a8385,_0x30fffa){return _0x350367(_0x30fffa,_0x2a8385-0x597);}Object['values'](this['primitives'])['forEach'](_0x1b1277=>_0x1b1277['destroy']()),this[_0x274ed4(0x496,0x47b)]['destroy']();}}function _0x28aa37(_0x186bee,_0x2f3dbc){return _0x5aa4(_0x186bee- -0x19d,_0x2f3dbc);}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace[_0x350367(-0xd5,-0x137)];class WindParticlesRendering{constructor(_0x51587d,_0x4b0cb0,_0x30564a,_0x1231fc){function _0x386e32(_0x4bb30a,_0xbfc882){return _0x28aa37(_0xbfc882- -0x10e,_0x4bb30a);}this[_0x386e32(-0x147,-0x193)]=_0x51587d,this['options']=_0x4b0cb0,this[_0x386e32(-0xf3,-0x102)]=_0x30564a,this[_0x3ecbe4(-0x29a,-0x2f0)]=_0x1231fc;function _0x3ecbe4(_0x14d1cc,_0x35940e){return _0x350367(_0x14d1cc,_0x35940e- -0x185);}(typeof this['options']['particlesTextureSize']!=='number'||this[_0x3ecbe4(-0x283,-0x256)]['particlesTextureSize']<=0x0)&&(console['error']('Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.'),this['options']['particlesTextureSize']=0x100),this['colorTable']=this[_0x3ecbe4(-0x20a,-0x205)](),this['textures']=this[_0x386e32(-0x18e,-0x1a4)](),this[_0x386e32(-0x69,-0xc2)]=this['createRenderingFramebuffers'](),this['primitives']=this['createPrimitives']();}['createRenderingTextures'](){const _0x3dee6f={};function _0x3a47f2(_0x46ca74,_0x1dd593){return _0x350367(_0x46ca74,_0x1dd593- -0x17b);}function _0x5b16cc(_0x3c5cf9,_0x54f5eb){return _0x350367(_0x3c5cf9,_0x54f5eb-0x40c);}_0x3dee6f[_0x3a47f2(-0x2bc,-0x2ba)]=this[_0x5b16cc(0x250,0x2cd)],_0x3dee6f['width']=this[_0x3a47f2(-0x33a,-0x2ba)]['drawingBufferWidth'],_0x3dee6f[_0x5b16cc(0x33b,0x335)]=this[_0x3a47f2(-0x245,-0x2ba)]['drawingBufferHeight'],_0x3dee6f['pixelFormat']=PixelFormat['RGBA'],_0x3dee6f['pixelDatatype']=PixelDatatype[_0x5b16cc(0x360,0x365)];const _0x2d67c8=_0x3dee6f,_0x6116d9={};_0x6116d9['context']=this[_0x3a47f2(-0x325,-0x2ba)],_0x6116d9[_0x5b16cc(0x28e,0x2df)]=this['context']['drawingBufferWidth'],_0x6116d9['height']=this[_0x5b16cc(0x2e4,0x2cd)]['drawingBufferHeight'],_0x6116d9['pixelFormat']=PixelFormat['DEPTH_COMPONENT'],_0x6116d9['pixelDatatype']=PixelDatatype['UNSIGNED_INT'];const _0x3fc5c9=_0x6116d9;return{'segmentsColor':new Texture(_0x2d67c8),'segmentsDepth':new Texture(_0x3fc5c9)};}['createRenderingFramebuffers'](){const _0x3b91b8={};_0x3b91b8['context']=this['context'];function _0x474fc2(_0x17e573,_0x57bb88){return _0x350367(_0x57bb88,_0x17e573-0x1b9);}_0x3b91b8[_0x474fc2(0xfd,0x131)]=[this['textures']['segmentsColor']];function _0x25f0c2(_0x1b6171,_0x198542){return _0x28aa37(_0x198542-0x529,_0x1b6171);}return _0x3b91b8[_0x474fc2(0xc7,0x13f)]=this['textures']['segmentsDepth'],{'segments':new Framebuffer(_0x3b91b8)};}['destoryRenderingFramebuffers'](){function _0x33ff17(_0x349bcb,_0x184641){return _0x28aa37(_0x349bcb-0x7e,_0x184641);}function _0x2b5fa7(_0x273cba,_0x2435cd){return _0x350367(_0x2435cd,_0x273cba-0x4e3);}Object[_0x33ff17(0x27,0x44)](this[_0x2b5fa7(0x475,0x4d3)])['forEach'](_0x4b736e=>{_0x4b736e['destroy']();});}['createColorTableTexture'](){const _0x7a2ff1=new Float32Array(this[_0x95ffd9(0x17f,0x1a9)]['colors']['flatMap'](_0x1de841=>{function _0x232c4c(_0xf308ca,_0xfac347){return _0x95ffd9(_0xf308ca,_0xfac347-0x296);}const _0x5081d6=Color$1['fromCssColorString'](_0x1de841);return[_0x5081d6['red'],_0x5081d6['green'],_0x5081d6[_0x232c4c(0x48f,0x46a)],_0x5081d6['alpha']];})),_0x44ce9e={};_0x44ce9e['minificationFilter']=TextureMinificationFilter[_0x4ee56f(0x505,0x513)],_0x44ce9e['magnificationFilter']=TextureMagnificationFilter['LINEAR'];function _0x95ffd9(_0x15f89d,_0x33a046){return _0x350367(_0x15f89d,_0x33a046-0x27a);}_0x44ce9e['wrapS']=TextureWrap[_0x4ee56f(0x42e,0x4af)],_0x44ce9e['wrapT']=TextureWrap[_0x95ffd9(0x177,0x19f)];function _0x4ee56f(_0x349d9a,_0x175cb5){return _0x350367(_0x349d9a,_0x175cb5-0x58a);}return new Texture({'context':this['context'],'width':this['options']['colors']['length'],'height':0x1,'pixelFormat':PixelFormat['RGBA'],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x44ce9e),'source':{'width':this['options']['colors']['length'],'height':0x1,'arrayBufferView':_0x7a2ff1}});}['createSegmentsGeometry'](){const _0x163928=0x4;function _0xd7be02(_0x2eab13,_0x1f1ff2){return _0x350367(_0x1f1ff2,_0x2eab13-0x35c);}const _0xcb64e4=this[_0x234e6b(0x359,0x350)]['particlesTextureSize'];function _0x234e6b(_0x3a2970,_0x23b0c2){return _0x350367(_0x3a2970,_0x23b0c2-0x421);}let _0xbc42aa=[];for(let _0x495746=0x0;_0x495746<_0xcb64e4;_0x495746++){for(let _0x3634b2=0x0;_0x3634b2<_0xcb64e4;_0x3634b2++){for(let _0x467ae8=0x0;_0x467ae8<_0x163928;_0x467ae8++){_0xbc42aa['push'](_0x495746/_0xcb64e4),_0xbc42aa[_0xd7be02(0x212,0x1e9)](_0x3634b2/_0xcb64e4);}}}_0xbc42aa=new Float32Array(_0xbc42aa);const _0x29a933=this[_0xd7be02(0x28b,0x285)]['particlesTextureSize']**0x2;let _0x1a2e6d=[];for(let _0x5034e3=0x0;_0x5034e3<_0x29a933;_0x5034e3++){_0x1a2e6d[_0xd7be02(0x212,0x201)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x1a2e6d=new Float32Array(_0x1a2e6d);let _0xf7cf3b=[];for(let _0x1ff7ce=0x0,_0x3bbbcb=0x0;_0x1ff7ce<_0x29a933;_0x1ff7ce++){_0xf7cf3b[_0x234e6b(0x314,0x2d7)](_0x3bbbcb+0x0,_0x3bbbcb+0x1,_0x3bbbcb+0x2,_0x3bbbcb+0x2,_0x3bbbcb+0x1,_0x3bbbcb+0x3),_0x3bbbcb+=_0x163928;}_0xf7cf3b=new Uint32Array(_0xf7cf3b);const _0x4d65b0={};_0x4d65b0[_0xd7be02(0x2d9,0x275)]=ComponentDatatype['FLOAT'],_0x4d65b0[_0x234e6b(0x25e,0x2db)]=0x2,_0x4d65b0[_0xd7be02(0x24b,0x28f)]=_0xbc42aa;const _0x5e3838={};_0x5e3838[_0xd7be02(0x2d9,0x32b)]=ComponentDatatype[_0x234e6b(0x38b,0x3ac)],_0x5e3838[_0xd7be02(0x216,0x25a)]=0x3,_0x5e3838['values']=_0x1a2e6d;const _0x3b4c61=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x4d65b0),'normal':new GeometryAttribute(_0x5e3838)}),'indices':_0xf7cf3b});return _0x3b4c61;}['createRawRenderState'](_0x7ecb7f){const _0x4ea0e4={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x7ecb7f};function _0x2d4932(_0x1a84e5,_0x398624){return _0x28aa37(_0x1a84e5- -0xbf,_0x398624);}return Appearance[_0x2d4932(-0xe9,-0x12b)](!![],![],_0x4ea0e4);}[_0x350367(-0x115,-0x14e)](){const _0xdca24d={};_0xdca24d['st']=0x0;function _0x536fd5(_0x24bc7b,_0x4600c7){return _0x350367(_0x4600c7,_0x24bc7b-0x1f2);}_0xdca24d[_0x537114(0x17b,0x143)]=0x1;const _0x4b5b9c={};function _0x537114(_0x472fe7,_0x53f6c0){return _0x350367(_0x472fe7,_0x53f6c0-0x1e0);}_0x4b5b9c['enabled']=!![];const _0x3a05d5={};_0x3a05d5[_0x536fd5(0x15d,0x12b)]=!![],_0x3a05d5['blendEquation']=WebGLRenderingContext['FUNC_ADD'],_0x3a05d5['blendFuncSource']=WebGLRenderingContext['SRC_ALPHA'],_0x3a05d5['blendFuncDestination']=WebGLRenderingContext[_0x536fd5(0x11d,0xcc)];const _0x1832cf={};_0x1832cf['viewport']=undefined,_0x1832cf['depthTest']=_0x4b5b9c,_0x1832cf['depthMask']=!![],_0x1832cf['blending']=_0x3a05d5;const _0x280386=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0xdca24d,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType[_0x537114(0x83,0x95)],'uniformMap':{'previousParticlesPosition':()=>this[_0x537114(0x45,0x75)][_0x537114(0x160,0x118)]['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing']['particlesTextures'][_0x536fd5(0xc0,0xe5)],'postProcessingPosition':()=>this['computing']['particlesTextures']['postProcessingPosition'],'particlesSpeed':()=>this['computing']['particlesTextures'][_0x536fd5(0x182,0x150)],'frameRateAdjustment':()=>this['computing']['frameRateAdjustment'],'colorTable':()=>this[_0x536fd5(0x186,0x1fe)],'domain':()=>{function _0x407fd9(_0x422953,_0x57534b){return _0x536fd5(_0x422953-0x4c,_0x57534b);}var _0x129c49,_0x28d104;const _0x25e935=new Cartesian2(((_0x129c49=this[_0x27ff42(0x47d,0x465)]['domain'])===null||_0x129c49===void 0x0?void 0x0:_0x129c49[_0x407fd9(0x170,0x194)])??this[_0x27ff42(0x3a5,0x3cb)]['windData']['speed']['min'],((_0x28d104=this['options']['domain'])===null||_0x28d104===void 0x0?void 0x0:_0x28d104['max'])??this['computing']['windData']['speed']['max']);function _0x27ff42(_0xc39dec,_0x21b6c0){return _0x537114(_0xc39dec,_0x21b6c0-0x356);}return _0x25e935;},'displayRange':()=>{function _0x3364c1(_0x2bebca,_0x43765f){return _0x536fd5(_0x43765f- -0x3b,_0x2bebca);}var _0x5661b3,_0x101e35;function _0x2da0e9(_0x22973a,_0x404153){return _0x536fd5(_0x22973a-0x1c3,_0x404153);}const _0x5deb75=new Cartesian2(((_0x5661b3=this['options']['displayRange'])===null||_0x5661b3===void 0x0?void 0x0:_0x5661b3['min'])??this[_0x3364c1(-0x2e,0x4c)]['windData'][_0x2da0e9(0x2c8,0x2bf)]['min'],((_0x101e35=this['options']['displayRange'])===null||_0x101e35===void 0x0?void 0x0:_0x101e35['max'])??this['computing'][_0x2da0e9(0x299,0x244)][_0x2da0e9(0x2c8,0x257)]['max']);return _0x5deb75;},'particleHeight':()=>this[_0x537114(0x120,0x10f)]['fixedHeight']||0x0,'aspect':()=>this['context'][_0x536fd5(0x178,0xfd)]/this[_0x537114(0xf6,0xa1)]['drawingBufferHeight'],'pixelSize':()=>this['viewerParameters']['pixelSize'],'lineWidth':()=>{const _0x1998c9={};function _0x162826(_0x197dd1,_0x2029ca){return _0x537114(_0x197dd1,_0x2029ca- -0x1d0);}_0x1998c9['min']=0x1,_0x1998c9[_0x162826(-0x42,-0x95)]=0x2;const _0x431674=this[_0x3c309d(0x21c,0x29e)]['lineWidth']||_0x1998c9;function _0x3c309d(_0x251d07,_0x155378){return _0x536fd5(_0x155378-0x17d,_0x251d07);}return new Cartesian2(_0x431674['min'],_0x431674['max']);},'lineLength':()=>{const _0x432745={};_0x432745['min']=0x14,_0x432745['max']=0x64;const _0x1550cb=this['options'][_0x1e2323(-0x117,-0xa1)]||_0x432745;function _0x1e2323(_0x530c13,_0x528cc2){return _0x537114(_0x528cc2,_0x530c13- -0x203);}return new Cartesian2(_0x1550cb['min'],_0x1550cb['max']);},'is3D':()=>this[_0x536fd5(0x144,0x158)][_0x537114(0x9,0x7f)]===SceneMode['SCENE3D'],'segmentsDepthTexture':()=>this[_0x536fd5(0x142,0x163)][_0x537114(0x17c,0x135)]},'vertexShaderSource':ShaderManager[_0x537114(0x8a,0xaa)](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this[_0x537114(0xa4,0x9c)](_0x1832cf)}),_0x36269a={};return _0x36269a[_0x536fd5(0x8d,0xc6)]=_0x280386,_0x36269a;}['onParticlesTextureSizeChange'](){const _0x1c30f7=this[_0x384bed(0x480,0x458)]();this[_0x384bed(0x4bc,0x4c2)][_0x384bed(0x425,0x3f7)][_0x27bda3(0x39f,0x358)]=_0x1c30f7;const _0x1e4b49={};function _0x27bda3(_0x319cc2,_0x25f565){return _0x28aa37(_0x25f565-0x394,_0x319cc2);}_0x1e4b49['context']=this['context'],_0x1e4b49['geometry']=_0x1c30f7;function _0x384bed(_0x3ed18d,_0x5ccc6f){return _0x28aa37(_0x5ccc6f-0x4a2,_0x3ed18d);}_0x1e4b49[_0x384bed(0x4ad,0x48c)]=this['primitives'][_0x27bda3(0x2ba,0x2e9)]['attributeLocations'],_0x1e4b49['bufferUsage']=BufferUsage[_0x384bed(0x4a1,0x4ca)];const _0x114b90=VertexArray[_0x384bed(0x3f3,0x438)](_0x1e4b49);this['primitives'][_0x27bda3(0x31a,0x2e9)][_0x27bda3(0x3d3,0x360)]&&(this['primitives'][_0x384bed(0x3b7,0x3f7)][_0x384bed(0x4b1,0x46e)][_0x27bda3(0x319,0x348)]=_0x114b90);}['onColorTableChange'](){this['colorTable']['destroy'](),this['colorTable']=this['createColorTableTexture']();}['updateOptions'](_0x2bcd38){const _0x13fa87=_0x2bcd38[_0x4b568d(0x204,0x1ec)]&&JSON['stringify'](_0x2bcd38['colors'])!==JSON['stringify'](this['options']['colors']);function _0x4b568d(_0x37ca72,_0x476db5){return _0x350367(_0x37ca72,_0x476db5-0x276);}this[_0x4b568d(0x215,0x1a5)]=deepMerge(_0x2bcd38,this['options']);function _0x7649cc(_0x46bad9,_0xe6e871){return _0x350367(_0x46bad9,_0xe6e871-0x34);}_0x13fa87&&this[_0x4b568d(0x148,0x17c)]();}[_0x28aa37(0x2a,0x41)](){Object[_0x4559ad(0xe1,0x13e)](this[_0x4559ad(0x169,0x1e1)])['forEach'](_0x213aaf=>{_0x213aaf['destroy']();});function _0x144140(_0x5caa6a,_0x457f7d){return _0x28aa37(_0x5caa6a-0x577,_0x457f7d);}function _0x4559ad(_0x48f99c,_0x2149a1){return _0x350367(_0x48f99c,_0x2149a1-0x24f);}Object['values'](this['primitives'])[_0x4559ad(0x1f1,0x1b7)](_0x510483=>{_0x510483['destroy']();}),this['colorTable']['destroy']();}}const {ClearCommand,Color,Pass}=mars3d__namespace[_0x350367(-0x111,-0x137)];function _0x5aa4(_0x5027ff,_0x32f143){const _0x2e2824=_0x2e28();return _0x5aa4=function(_0x5aa45f,_0x1f3ae7){_0x5aa45f=_0x5aa45f-0xea;let _0x2df0f0=_0x2e2824[_0x5aa45f];return _0x2df0f0;},_0x5aa4(_0x5027ff,_0x32f143);}class WindParticleSystem{constructor(_0x5239ef,_0x3d03d3,_0x4997aa,_0x173f6b,_0x4fe7e4){this['context']=_0x5239ef,this[_0x58e50c(0xa9,0x9b)]=_0x4997aa,this['viewerParameters']=_0x173f6b,this[_0x4c2608(-0x7c,-0xa8)]=new WindParticlesComputing(_0x5239ef,_0x3d03d3,_0x4997aa,_0x173f6b,_0x4fe7e4);function _0x4c2608(_0x270f74,_0x650e49){return _0x28aa37(_0x650e49-0x9,_0x270f74);}function _0x58e50c(_0x58e300,_0x2ac905){return _0x350367(_0x58e300,_0x2ac905-0x16c);}this['rendering']=new WindParticlesRendering(_0x5239ef,_0x4997aa,_0x173f6b,this[_0x58e50c(0x4,0x1)]),this['clearFramebuffers']();}[_0x28aa37(0x9,0x26)](){function _0x27bfd5(_0xf443e,_0x1b6e30){return _0x28aa37(_0xf443e- -0x1df,_0x1b6e30);}const _0x725b0f=[this['computing'][_0x2e8e3a(0x2e5,0x355)]['calculateSpeed'],this['computing']['primitives'][_0x27bfd5(-0x22a,-0x260)],this['computing']['primitives'][_0x27bfd5(-0x282,-0x2f8)],this[_0x2e8e3a(0x2c0,0x262)]['primitives']['segments']];function _0x2e8e3a(_0x2f0465,_0x292ae3){return _0x28aa37(_0x2f0465-0x2c5,_0x292ae3);}return _0x725b0f;}['clearFramebuffers'](){const _0x10e1aa=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});function _0x5cae6e(_0x4f6043,_0x3e4bd3){return _0x350367(_0x4f6043,_0x3e4bd3-0x564);}function _0x1229bb(_0x20955b,_0x3206d3){return _0x28aa37(_0x3206d3-0xa3,_0x20955b);}Object[_0x5cae6e(0x474,0x404)](this[_0x1229bb(0x7c,0x9e)]['framebuffers'])[_0x1229bb(0xab,0xc5)](_0x106dd5=>{function _0x59cf09(_0x3a387a,_0x3d1874){return _0x1229bb(_0x3d1874,_0x3a387a- -0x197);}_0x10e1aa[_0x48a10b(0x299,0x319)]=this[_0x48a10b(0x2bc,0x24c)]['framebuffers'][_0x106dd5];function _0x48a10b(_0x7fd080,_0x263151){return _0x1229bb(_0x263151,_0x7fd080-0x21e);}_0x10e1aa['execute'](this[_0x59cf09(-0x179,-0x16d)]);});}['changeOptions'](_0x1066ae){let _0x582928=![];function _0x2b6c8e(_0x1216b1,_0x18afbd){return _0x28aa37(_0x1216b1-0x400,_0x18afbd);}_0x1066ae[_0x2b6c8e(0x3a8,0x3e6)]&&this[_0x2b6c8e(0x3e9,0x3fa)][_0x3ca2f5(-0x154,-0xdc)]!==_0x1066ae['particlesTextureSize']&&(_0x582928=!![]);const _0x5e6f09=deepMerge(_0x1066ae,this['options']);if(_0x5e6f09['particlesTextureSize']<0x1)throw new Error(_0x3ca2f5(-0x1af,-0x1b3));this[_0x3ca2f5(-0x113,-0xeb)]=_0x5e6f09;function _0x3ca2f5(_0x1b603d,_0x3fcfde){return _0x350367(_0x3fcfde,_0x1b603d- -0x42);}this['rendering']['updateOptions'](_0x1066ae),this[_0x3ca2f5(-0x1ad,-0x211)]['updateOptions'](_0x1066ae),_0x582928&&(this['computing']['destroyParticlesTextures'](),this[_0x3ca2f5(-0x1ad,-0x202)][_0x2b6c8e(0x40e,0x3c2)](),this[_0x2b6c8e(0x3fb,0x400)]['onParticlesTextureSizeChange']());}['applyViewerParameters'](_0x5ab95d){function _0x18ebf8(_0x5091aa,_0x294efb){return _0x28aa37(_0x294efb-0xc2,_0x5091aa);}function _0x29b223(_0x12b5ef,_0x4fcc4e){return _0x350367(_0x4fcc4e,_0x12b5ef-0x154);}this[_0x29b223(0xa6,0xfa)]=_0x5ab95d,this[_0x29b223(-0x17,-0x64)]['viewerParameters']=_0x5ab95d,this[_0x29b223(0x95,0x69)]['viewerParameters']=_0x5ab95d;}[_0x28aa37(0x2a,0x8a)](){this['computing'][_0x4c55eb(0x82,0xbc)]();function _0xc2fa95(_0x2ae387,_0x117f63){return _0x350367(_0x117f63,_0x2ae387-0x47d);}function _0x4c55eb(_0x3c3270,_0x1ca058){return _0x350367(_0x3c3270,_0x1ca058-0x14c);}this[_0x4c55eb(0x96,0x8d)]['destroy']();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x31befc={};_0x31befc['min']=0x1,_0x31befc[_0x350367(-0xb9,-0xa5)]=0x2;const _0x230f86={};_0x230f86[_0x28aa37(-0x14,-0x40)]=0x14,_0x230f86['max']=0x64;const _0x427ae0={};_0x427ae0['particlesTextureSize']=0x64,_0x427ae0[_0x350367(-0x115,-0x12b)]=0x0,_0x427ae0[_0x28aa37(-0x67,-0x8a)]=_0x31befc,_0x427ae0[_0x28aa37(-0x3a,-0xba)]=_0x230f86,_0x427ae0['speedFactor']=0x1,_0x427ae0['dropRate']=0.003,_0x427ae0['dropRateBump']=0.001,_0x427ae0[_0x350367(-0x84,-0x8a)]=['rgb(206,255,255)'],_0x427ae0['flipY']=![],_0x427ae0['dynamic']=!![];const DEF_OPTIONS=_0x427ae0;class WindLayer extends BaseLayer$1{constructor(_0x1d3aeb={}){_0x1d3aeb={...DEF_OPTIONS,..._0x1d3aeb},super(_0x1d3aeb),this['_setOptionsHook'](_0x1d3aeb,_0x1d3aeb);}get['layer'](){return this['primitives'];}get[_0x28aa37(-0x30,0x32)](){function _0x3cd458(_0x6b8804,_0x3c785b){return _0x28aa37(_0x6b8804-0x176,_0x3c785b);}return this[_0x3cd458(0x15f,0xe5)]['data'];}set['data'](_0x3e6629){function _0x3819bd(_0x55f083,_0x2cf938){return _0x28aa37(_0x2cf938-0x4f,_0x55f083);}this[_0x165a38(-0xd8,-0x115)]['data']=_0x3e6629;function _0x165a38(_0x2e4381,_0x46a715){return _0x350367(_0x46a715,_0x2e4381- -0x7);}this[_0x3819bd(0x3c,0x9c)](_0x3e6629);}get[_0x28aa37(0x30,0x15)](){function _0x32f45b(_0x1ebd2b,_0xcd3147){return _0x350367(_0x1ebd2b,_0xcd3147-0x2d7);}return this['options'][_0x32f45b(0x227,0x24d)];}set['colors'](_0x1f2223){function _0x122d14(_0x1bb120,_0x434117){return _0x350367(_0x434117,_0x1bb120-0x319);}this[_0x30933b(-0x1b7,-0x135)]['colors']=_0x1f2223;function _0x30933b(_0xe1399,_0x3676d5){return _0x28aa37(_0xe1399- -0x1a0,_0x3676d5);}const _0xfdef83={};_0xfdef83[_0x30933b(-0x170,-0xf9)]=_0x1f2223,this['_setOptionsHook'](this[_0x30933b(-0x1b7,-0x161)],_0xfdef83);}['_showHook'](_0x31ec65){function _0x3352b0(_0x18ac05,_0xb27c1c){return _0x28aa37(_0x18ac05- -0x64,_0xb27c1c);}_0x31ec65?this['_addedHook']():this[_0x3352b0(-0x33,0x4a)]();}['_mountedHook'](){}[_0x350367(-0xf5,-0xef)](){this['scene']=this[_0x412b22(0x4d4,0x517)][_0x412b22(0x4fd,0x4b2)];function _0x412b22(_0x128f41,_0x550cfb){return _0x28aa37(_0x550cfb-0x527,_0x128f41);}this[_0x412b22(0x4cc,0x4b5)]=this['_map']['camera'];this[_0x450bbd(0x20c,0x24f)]['data']&&this[_0x450bbd(0x270,0x24e)](this['options'][_0x412b22(0x51e,0x4f7)]);if(!this['windData']||!this['show'])return;this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](-0xb4,0xb4),'latRange':new Cesium$1[(_0x450bbd(0x21d,0x1f3))](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this['scene']['mode']},this['updateViewerParameters'](),this['particleSystem']=new WindParticleSystem(this[_0x412b22(0x462,0x4b2)]['context'],this['windData'],this['options'],this[_0x412b22(0x5af,0x533)],this[_0x450bbd(0x1ae,0x16f)]),this['primitives']=this[_0x412b22(0x52e,0x505)][_0x412b22(0x4b5,0x530)](),this['primitives'][_0x412b22(0x4f1,0x549)](_0x321fc8=>{function _0x1d7d31(_0x4e7732,_0x11f6bb){return _0x412b22(_0x11f6bb,_0x4e7732- -0x657);}this['scene'][_0x1d7d31(-0x110,-0x18d)]['add'](_0x321fc8);}),this['camera'][_0x450bbd(0x176,0x1d3)]=0.01,this['camera']['changed'][_0x412b22(0x4e3,0x492)](this[_0x450bbd(0x1bd,0x18d)][_0x450bbd(0x195,0x1ae)](this));function _0x450bbd(_0x40d64e,_0x24c833){return _0x350367(_0x24c833,_0x40d64e-0x2dd);}this['scene']['morphComplete'][_0x450bbd(0x18e,0x1f8)](this['updateViewerParameters']['bind'](this)),window['addEventListener']('resize',this[_0x412b22(0x454,0x4c1)]['bind'](this));}['_removedHook'](){this[_0x4cee6b(-0xb9,-0x70)][_0x4cee6b(0x33,-0x37)][_0x2123c4(0x379,0x32b)](this['updateViewerParameters'][_0x2123c4(0x312,0x33c)](this)),this['scene'][_0x2123c4(0x33d,0x2c7)][_0x4cee6b(-0x8b,-0x25)](this['updateViewerParameters'][_0x4cee6b(-0x20,-0x8c)](this)),window[_0x4cee6b(-0x2f,-0x25)](_0x4cee6b(0x6d,0x5),this['updateViewerParameters']['bind'](this));function _0x4cee6b(_0x11c5dc,_0x5a82ad){return _0x350367(_0x11c5dc,_0x5a82ad-0xbc);}this[_0x2123c4(0x3c0,0x3e0)]&&(this[_0x2123c4(0x3c0,0x427)][_0x4cee6b(0x72,0x24)](_0x49a59a=>{this['scene']['primitives']['remove'](_0x49a59a);}),delete this['primitives']);function _0x2123c4(_0x49d301,_0x785046){return _0x350367(_0x785046,_0x49d301-0x45a);}this[_0x2123c4(0x37e,0x335)]&&(this[_0x4cee6b(0x4b,-0x20)]['destroy'](),delete this['particleSystem']);}['setData'](_0x7a3480,_0x1ff463){this['windData']=this[_0x4b0f40(0x48e,0x4b5)](_0x7a3480);if(_0x1ff463){this[_0x4b0f40(0x4dd,0x51d)](),this['_addedHook']();return;}function _0x3316b4(_0x490acf,_0x2b3724){return _0x28aa37(_0x2b3724- -0xa1,_0x490acf);}function _0x4b0f40(_0x3cef2a,_0xe75414){return _0x350367(_0x3cef2a,_0xe75414-0x5a6);}this['particleSystem']?(this[_0x4b0f40(0x4df,0x4ca)]['computing']['updateWindData'](this[_0x4b0f40(0x480,0x48a)]),this[_0x4b0f40(0x485,0x477)]['requestRender']()):this['_addedHook']();}['_setOptionsHook'](_0x483b9f,_0x23e0fd){function _0x22b994(_0xde06eb,_0x585eb8){return _0x350367(_0x585eb8,_0xde06eb-0x4d5);}function _0x616696(_0xb5c841,_0x5a8d33){return _0x28aa37(_0xb5c841-0x91,_0x5a8d33);}this['particleSystem']&&(this[_0x22b994(0x3f9,0x3f9)]['changeOptions'](_0x23e0fd),this['scene'][_0x616696(0x30,-0x2b)]());}['processWindData'](_0x2bee12){var _0x1e9afb,_0x4d71af;const _0x53bf06={..._0x2bee12},_0x4b7c0a=_0x53bf06;function _0x503d14(_0x4181d0,_0x4a369a){return _0x28aa37(_0x4181d0- -0x6d,_0x4a369a);}!_0x4b7c0a[_0xf5a77d(-0x121,-0x113)]&&_0x4b7c0a['rows']&&(_0x4b7c0a[_0xf5a77d(-0xda,-0x113)]=_0x4b7c0a['rows']);!_0x4b7c0a['width']&&_0x4b7c0a['cols']&&(_0x4b7c0a['width']=_0x4b7c0a[_0xf5a77d(-0x1b6,-0x14f)]);function _0xf5a77d(_0xfac30e,_0x40ea42){return _0x350367(_0xfac30e,_0x40ea42- -0x3c);}!_0x4b7c0a['bounds']&&(_0x4b7c0a['bounds']={'west':_0x4b7c0a['xmin'],'south':_0x4b7c0a[_0x503d14(-0x78,-0xa9)],'east':_0x4b7c0a[_0x503d14(-0x75,-0x2)],'north':_0x4b7c0a['ymax']});if(!_0x4b7c0a['u']){const _0x4be13e={};_0x4be13e[_0xf5a77d(-0xd1,-0x13a)]=_0x2bee12['udata'],_0x4be13e['min']=_0x2bee12['umin'],_0x4be13e[_0xf5a77d(-0x15d,-0xe1)]=_0x2bee12['umax'],_0x4b7c0a['u']=_0x4be13e;}if(!_0x4b7c0a['v']){const _0x54214a={};_0x54214a['array']=_0x2bee12['vdata'],_0x54214a['min']=_0x2bee12[_0xf5a77d(-0x169,-0x15f)],_0x54214a['max']=_0x2bee12['vmax'],_0x4b7c0a['v']=_0x54214a;}if(((_0x1e9afb=_0x4b7c0a[_0x503d14(-0xa0,-0x8c)])===null||_0x1e9afb===void 0x0?void 0x0:_0x1e9afb['min'])===undefined||((_0x4d71af=_0x4b7c0a[_0x503d14(-0xa0,-0xa1)])===null||_0x4d71af===void 0x0?void 0x0:_0x4d71af['max'])===undefined||_0x4b7c0a['speed'][_0xf5a77d(-0x119,-0x13a)]===undefined){const _0x1ae6fe={'array':new Float32Array(_0x4b7c0a['u']['array'][_0x503d14(-0x119,-0x149)]),'min':Number[_0x503d14(-0x7e,-0xfe)],'max':Number['MIN_VALUE']};for(let _0x3aff63=0x0;_0x3aff63<_0x4b7c0a['u'][_0x503d14(-0xb1,-0x86)]['length'];_0x3aff63++){_0x1ae6fe['array'][_0x3aff63]=Math['sqrt'](_0x4b7c0a['u']['array'][_0x3aff63]*_0x4b7c0a['u'][_0x503d14(-0xb1,-0xa2)][_0x3aff63]+_0x4b7c0a['v'][_0xf5a77d(-0x1a2,-0x13a)][_0x3aff63]*_0x4b7c0a['v']['array'][_0x3aff63]),_0x1ae6fe['array'][_0x3aff63]!==0x0&&(_0x1ae6fe['min']=Math[_0x503d14(-0x81,-0xfd)](_0x1ae6fe[_0xf5a77d(-0xb3,-0x10a)],_0x1ae6fe['array'][_0x3aff63]),_0x1ae6fe['max']=Math['max'](_0x1ae6fe[_0xf5a77d(-0x12f,-0xe1)],_0x1ae6fe['array'][_0x3aff63]));}_0x4b7c0a['speed']=_0x1ae6fe;}return _0x4b7c0a;}[_0x350367(-0x16f,-0x120)](){var _0x5cb4b0;const _0x309258=this[_0x121837(-0x13d,-0x1ae)];if(!_0x309258)return;const _0xdd2df2=_0x309258['canvas'],_0x172ac1={};_0x172ac1['x']=0x0,_0x172ac1['y']=0x0;const _0x141356={};_0x141356['x']=0x0,_0x141356['y']=_0xdd2df2[_0x44dc01(0x2d7,0x2f0)];const _0x4e855a={};_0x4e855a['x']=_0xdd2df2['clientWidth'],_0x4e855a['y']=0x0;const _0x32d5cb={};function _0x44dc01(_0x2af5e3,_0x4e7b48){return _0x350367(_0x2af5e3,_0x4e7b48-0x36b);}_0x32d5cb['x']=_0xdd2df2['clientWidth'],_0x32d5cb['y']=_0xdd2df2['clientHeight'];const _0x4db942=[_0x172ac1,_0x141356,_0x4e855a,_0x32d5cb];let _0x26f175=0xb4,_0x4a0d3d=-0xb4;function _0x121837(_0x58a6a6,_0x3dfabc){return _0x350367(_0x3dfabc,_0x58a6a6- -0xe);}let _0x4254d5=0x5a,_0x33ec9b=-0x5a,_0x25cbce=![];for(const _0x5d9eba of _0x4db942){const _0x290e84=_0x309258[_0x44dc01(0x1d0,0x23f)]['pickEllipsoid'](new Cesium$1[(_0x121837(-0xce,-0xe1))](_0x5d9eba['x'],_0x5d9eba['y']),_0x309258['globe'][_0x44dc01(0x300,0x2b8)]);if(!_0x290e84){_0x25cbce=!![];break;}const _0x2dc500=_0x309258[_0x121837(-0x17a,-0x1a3)][_0x44dc01(0x2ec,0x2b8)]['cartesianToCartographic'](_0x290e84),_0x32b269=Cesium$1['Math'][_0x44dc01(0x1d6,0x22a)](_0x2dc500['longitude']),_0x576b04=Cesium$1[_0x121837(-0xc8,-0x7c)][_0x121837(-0x14f,-0x125)](_0x2dc500[_0x121837(-0xaa,-0xc7)]);_0x26f175=Math[_0x121837(-0xdc,-0xd0)](_0x26f175,_0x32b269),_0x4a0d3d=Math['max'](_0x4a0d3d,_0x32b269),_0x4254d5=Math['min'](_0x4254d5,_0x576b04),_0x33ec9b=Math['max'](_0x33ec9b,_0x576b04);}if(!_0x25cbce){const _0x1f58d3=new Cesium$1['Cartesian2'](Math[_0x44dc01(0x305,0x2c6)](this['windData'][_0x121837(-0x90,-0x102)]['west'],_0x26f175),Math['min'](this['windData'][_0x121837(-0x90,-0x76)][_0x44dc01(0x283,0x2c2)],_0x4a0d3d)),_0x386f62=new Cesium$1['Cartesian2'](Math['max'](this[_0x44dc01(0x1d3,0x24f)]['bounds']['south'],_0x4254d5),Math['min'](this['windData']['bounds'][_0x121837(-0x178,-0x121)],_0x33ec9b)),_0x1dc77c=(_0x1f58d3['y']-_0x1f58d3['x'])*0.05,_0x5e6fd5=(_0x386f62['y']-_0x386f62['x'])*0.05;_0x1f58d3['x']=Math[_0x44dc01(0x248,0x2c6)](this['windData']['bounds']['west'],_0x1f58d3['x']-_0x1dc77c),_0x1f58d3['y']=Math['min'](this['windData'][_0x121837(-0x90,-0xa8)]['east'],_0x1f58d3['y']+_0x1dc77c),_0x386f62['x']=Math['max'](this[_0x121837(-0x12a,-0xad)]['bounds'][_0x44dc01(0x2d3,0x28d)],_0x386f62['x']-_0x5e6fd5),_0x386f62['y']=Math['min'](this[_0x44dc01(0x1f7,0x24f)]['bounds']['north'],_0x386f62['y']+_0x5e6fd5),this['viewerParameters']['lonRange']=_0x1f58d3,this['viewerParameters']['latRange']=_0x386f62;const _0x4e6539=this['windData'][_0x44dc01(0x321,0x2e9)][_0x44dc01(0x309,0x2c2)]-this[_0x121837(-0x12a,-0x107)]['bounds'][_0x121837(-0xbb,-0x79)],_0x3b86c0=this['windData']['bounds'][_0x121837(-0x178,-0x1a1)]-this['windData'][_0x121837(-0x90,-0x5e)]['south'],_0x5a5354=(_0x1f58d3['y']-_0x1f58d3['x'])/_0x4e6539,_0x2de80e=(_0x386f62['y']-_0x386f62['x'])/_0x3b86c0,_0xb766ce=Math['min'](_0x5a5354,_0x2de80e),_0x4adf49=0x3e8*_0xb766ce;_0x4adf49>0x0&&(this[_0x121837(-0xbc,-0xd6)]['pixelSize']=Math['max'](0x0,Math['min'](0x3e8,_0x4adf49)));}this['viewerParameters']['sceneMode']=this[_0x121837(-0x13d,-0x160)][_0x121837(-0xc6,-0x57)],(_0x5cb4b0=this['particleSystem'])===null||_0x5cb4b0===void 0x0||_0x5cb4b0[_0x44dc01(0x29c,0x2b0)](this['viewerParameters']);}['getDataAtLonLat'](_0x1f3338,_0x1dd35c){const {bounds:_0x595c2c,width:_0x29d5a5,height:_0x1ac34d,u:_0x59e3fe,v:_0x18982e,speed:_0x90975f}=this['windData'],{flipY:_0x877b1a}=this[_0x44aebe(0x310,0x2e0)];if(_0x1f3338<_0x595c2c['west']||_0x1f3338>_0x595c2c['east']||_0x1dd35c<_0x595c2c['south']||_0x1dd35c>_0x595c2c[_0x1f509b(-0x15,0x3)])return null;const _0x5e0498=(_0x1f3338-_0x595c2c['west'])/(_0x595c2c['east']-_0x595c2c['west'])*(_0x29d5a5-0x1);let _0x404492=(_0x1dd35c-_0x595c2c[_0x44aebe(0x303,0x2bd)])/(_0x595c2c['north']-_0x595c2c['south'])*(_0x1ac34d-0x1);_0x877b1a&&(_0x404492=_0x1ac34d-0x1-_0x404492);const _0x4a122f=Math['floor'](_0x5e0498),_0x27a5b4=Math['floor'](_0x404492),_0x2b95c5=Math['floor'](_0x5e0498);function _0x1f509b(_0x32904c,_0x115c50){return _0x350367(_0x115c50,_0x32904c-0x155);}function _0x44aebe(_0x1bc8be,_0x4c3534){return _0x350367(_0x4c3534,_0x1bc8be-0x3e1);}const _0x4f4876=Math['min'](_0x2b95c5+0x1,_0x29d5a5-0x1),_0x2af889=Math[_0x44aebe(0x363,0x301)](_0x404492),_0x4f1e45=Math['min'](_0x2af889+0x1,_0x1ac34d-0x1),_0x1ff698=_0x5e0498-_0x2b95c5,_0x421223=_0x404492-_0x2af889,_0x1274bd=_0x27a5b4*_0x29d5a5+_0x4a122f,_0x594a48=_0x2af889*_0x29d5a5+_0x2b95c5,_0x5ba542=_0x2af889*_0x29d5a5+_0x4f4876,_0x40de6c=_0x4f1e45*_0x29d5a5+_0x2b95c5,_0x3b3800=_0x4f1e45*_0x29d5a5+_0x4f4876,_0xfbb9b9=_0x59e3fe['array'][_0x594a48],_0x55394b=_0x59e3fe['array'][_0x5ba542],_0x117d27=_0x59e3fe[_0x1f509b(0x57,0x57)][_0x40de6c],_0x35053d=_0x59e3fe[_0x44aebe(0x2e3,0x288)][_0x3b3800],_0x2fe2b2=(0x1-_0x1ff698)*(0x1-_0x421223)*_0xfbb9b9+_0x1ff698*(0x1-_0x421223)*_0x55394b+(0x1-_0x1ff698)*_0x421223*_0x117d27+_0x1ff698*_0x421223*_0x35053d,_0x16031f=_0x18982e[_0x44aebe(0x2e3,0x32e)][_0x594a48],_0x3e909e=_0x18982e['array'][_0x5ba542],_0x4c7123=_0x18982e['array'][_0x40de6c],_0x1117b9=_0x18982e['array'][_0x3b3800],_0x3b769f=(0x1-_0x1ff698)*(0x1-_0x421223)*_0x16031f+_0x1ff698*(0x1-_0x421223)*_0x3e909e+(0x1-_0x1ff698)*_0x421223*_0x4c7123+_0x1ff698*_0x421223*_0x1117b9,_0x3cd717=Math[_0x1f509b(0x6f,0x80)](_0x2fe2b2*_0x2fe2b2+_0x3b769f*_0x3b769f),_0x38c843={};_0x38c843['u']=_0x59e3fe['array'][_0x1274bd],_0x38c843['v']=_0x18982e['array'][_0x1274bd],_0x38c843['speed']=_0x90975f['array'][_0x1274bd];const _0x41b487={};_0x41b487['u']=_0x2fe2b2,_0x41b487['v']=_0x3b769f,_0x41b487[_0x44aebe(0x2f4,0x302)]=_0x3cd717;const _0x463ddc={};return _0x463ddc[_0x1f509b(0x20,0x55)]=_0x38c843,_0x463ddc['interpolated']=_0x41b487,_0x463ddc;}}mars3d__namespace['LayerUtil']['register'](_0x28aa37(-0x9a,-0xba),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){function _0x4d9245(_0x944509,_0x3a6f48){return _0x350367(_0x3a6f48,_0x944509-0x4c0);}this['lng']=null;function _0x6fea95(_0x116794,_0x506319){return _0x350367(_0x116794,_0x506319- -0x160);}this[_0x4d9245(0x3b3,0x396)]=null,this['tlng']=null,this[_0x4d9245(0x3fd,0x391)]=null,this[_0x6fea95(-0x223,-0x233)]=null,this[_0x6fea95(-0x21c,-0x24d)]=null;}['destroy'](){for(const _0x1e539d in this){delete this[_0x1e539d];}}}class CanvasWindField{constructor(_0x4bb8cf){this['setOptions'](_0x4bb8cf);}get['speedRate'](){function _0x3c3eb9(_0x53ecd8,_0x4584d0){return _0x350367(_0x4584d0,_0x53ecd8-0x327);}return this[_0x3c3eb9(0x24a,0x2af)];}set[_0x28aa37(0x33,-0x2d)](_0x478b91){this['_speedRate']=(0x64-(_0x478b91>0x63?0x63:_0x478b91))*0x64;function _0x587aa2(_0x33103d,_0x210c6b){return _0x28aa37(_0x210c6b-0x56d,_0x33103d);}function _0x4c8b95(_0x31b0f4,_0x45cd82){return _0x28aa37(_0x31b0f4- -0xa4,_0x45cd82);}this[_0x587aa2(0x52f,0x4cb)]=[(this[_0x587aa2(0x548,0x565)]-this['xmin'])/this[_0x4c8b95(-0xc7,-0x99)],(this[_0x4c8b95(-0xca,-0x83)]-this[_0x4c8b95(-0xaf,-0xe9)])/this['_speedRate']];}get['maxAge'](){return this['_maxAge'];}set[_0x28aa37(0x48,-0x21)](_0xf97c98){function _0x5c896f(_0x5ac39b,_0x12d742){return _0x350367(_0x5ac39b,_0x12d742-0x614);}this[_0x5c896f(0x4d7,0x504)]=_0xf97c98;}['setOptions'](_0x33df10){this['options']=_0x33df10,this['maxAge']=_0x33df10[_0x2692e0(0x541,0x4c2)]||0x78,this['speedRate']=_0x33df10['speedRate']||0x32,this[_0x2692e0(0x476,0x45d)]=[];const _0x2c5a3b=_0x33df10[_0x2692e0(0x4ca,0x499)]||0x1000;function _0x2692e0(_0x5459bd,_0x41b525){return _0x350367(_0x41b525,_0x5459bd-0x5b3);}function _0x46e153(_0x337d09,_0x226991){return _0x28aa37(_0x337d09-0x45,_0x226991);}for(let _0x297b42=0x0;_0x297b42<_0x2c5a3b;_0x297b42++){const _0x2cf481=this[_0x46e153(-0x65,0x2)](new CanvasParticle());this['particles']['push'](_0x2cf481);}}['setDate'](_0x4e573f){this['rows']=_0x4e573f[_0x501a1c(-0x114,-0x17c)],this['cols']=_0x4e573f[_0x501a1c(-0x14d,-0xee)],this[_0x5e65d0(0xa6,0x6f)]=_0x4e573f[_0x501a1c(-0x159,-0x117)],this['xmax']=_0x4e573f['xmax'];function _0x5e65d0(_0x32c771,_0x37dc19){return _0x350367(_0x37dc19,_0x32c771-0x1c5);}this['ymin']=_0x4e573f['ymin'],this[_0x501a1c(-0x11a,-0xb0)]=_0x4e573f[_0x501a1c(-0x11a,-0x168)],this['grid']=[];const _0x31fb36=_0x4e573f[_0x501a1c(-0x18b,-0x199)],_0x109a44=_0x4e573f['vdata'];let _0x547e20=![];_0x31fb36[_0x501a1c(-0x1a0,-0x171)]===this[_0x501a1c(-0x114,-0xff)]&&_0x31fb36[0x0]['length']===this['cols']&&(_0x547e20=!![]);let _0x4f2c2b=0x0,_0x1f222c=null,_0x4f9d3d=null;function _0x501a1c(_0x4ae23c,_0x48fecf){return _0x350367(_0x48fecf,_0x4ae23c- -0x3a);}for(let _0x4388dc=0x0;_0x4388dc<this['rows'];_0x4388dc++){_0x1f222c=[];for(let _0x173992=0x0;_0x173992<this['cols'];_0x173992++,_0x4f2c2b++){_0x547e20?_0x4f9d3d=this[_0x501a1c(-0x195,-0x174)](_0x31fb36[_0x4388dc][_0x173992],_0x109a44[_0x4388dc][_0x173992]):_0x4f9d3d=this[_0x501a1c(-0x195,-0x13a)](_0x31fb36[_0x4f2c2b],_0x109a44[_0x4f2c2b]),_0x1f222c[_0x501a1c(-0x184,-0x13c)](_0x4f9d3d);}this[_0x501a1c(-0x151,-0x1d3)][_0x501a1c(-0x184,-0x1d8)](_0x1f222c);}!this['options']['flipY']&&this[_0x501a1c(-0x151,-0x1b2)][_0x501a1c(-0x161,-0x191)]();}[_0x350367(-0xaf,-0x11a)](){delete this['rows'],delete this['cols'],delete this['xmin'];function _0x1a2067(_0x433ec7,_0x551fd1){return _0x350367(_0x433ec7,_0x551fd1-0x29b);}delete this['xmax'];function _0x31d6f9(_0x31fae8,_0x83fc6c){return _0x28aa37(_0x31fae8-0x36c,_0x83fc6c);}delete this['ymin'],delete this[_0x31d6f9(0x346,0x2e5)],delete this[_0x31d6f9(0x30f,0x38c)],delete this['particles'];}[_0x28aa37(-0x82,-0xab)](_0x3f243b,_0x425f04){const _0x1efebc=(_0x3f243b-this[_0x24757c(-0x100,-0x165)])/(this[_0x25a6b3(0x395,0x3b1)]-this['xmin'])*(this[_0x25a6b3(0x2f0,0x360)]-0x1);function _0x25a6b3(_0x450885,_0x3a8671){return _0x350367(_0x450885,_0x3a8671-0x473);}const _0x4002d8=(this[_0x25a6b3(0x335,0x393)]-_0x425f04)/(this[_0x25a6b3(0x3a3,0x393)]-this[_0x24757c(-0xa6,-0xbf)])*(this['rows']-0x1);function _0x24757c(_0x4007ef,_0x1d4bcd){return _0x28aa37(_0x4007ef- -0x9b,_0x1d4bcd);}return[_0x1efebc,_0x4002d8];}[_0x28aa37(-0x79,-0x82)](_0x3e2380,_0x1713c2){if(_0x3e2380<0x0||_0x3e2380>=this['cols']||_0x1713c2>=this['rows'])return[0x0,0x0,0x0];const _0x4debf4=Math[_0x503399(-0x17b,-0x11a)](_0x3e2380),_0x1f17eb=Math[_0x3c0acc(0x2fc,0x287)](_0x1713c2);if(_0x4debf4===_0x3e2380&&_0x1f17eb===_0x1713c2)return this[_0x503399(-0x19e,-0x1b3)][_0x1713c2][_0x3e2380];const _0x5b6b49=_0x4debf4+0x1;function _0x3c0acc(_0x2d5e3e,_0x491786){return _0x28aa37(_0x491786-0x24b,_0x2d5e3e);}const _0x51074a=_0x1f17eb+0x1,_0x272316=this['getUVByXY'](_0x4debf4,_0x1f17eb),_0x46815e=this[_0x503399(-0x16e,-0x1cf)](_0x5b6b49,_0x1f17eb),_0x2929b9=this[_0x3c0acc(0x1a9,0x1d2)](_0x4debf4,_0x51074a);function _0x503399(_0x2e2fcd,_0x1ca9d7){return _0x28aa37(_0x1ca9d7- -0x156,_0x2e2fcd);}const _0x116ec3=this[_0x503399(-0x1e6,-0x1cf)](_0x5b6b49,_0x51074a);let _0x45c324=null;try{_0x45c324=this['_bilinearInterpolation'](_0x3e2380-_0x4debf4,_0x1713c2-_0x1f17eb,_0x272316,_0x46815e,_0x2929b9,_0x116ec3);}catch(_0x356cc4){console[_0x3c0acc(0x1cb,0x1cc)](_0x3e2380,_0x1713c2);}return _0x45c324;}[_0x350367(-0x51,-0xcd)](_0x148b75,_0x4c941c,_0x8b7403,_0x50324d,_0x4e1b03,_0x2b9920){const _0x4d6376=0x1-_0x148b75,_0x540ded=0x1-_0x4c941c,_0x37d19f=_0x4d6376*_0x540ded,_0x5a271a=_0x148b75*_0x540ded,_0x58cf42=_0x4d6376*_0x4c941c,_0x29094a=_0x148b75*_0x4c941c,_0x4459d2=_0x8b7403[0x0]*_0x37d19f+_0x50324d[0x0]*_0x5a271a+_0x4e1b03[0x0]*_0x58cf42+_0x2b9920[0x0]*_0x29094a,_0x55bfe5=_0x8b7403[0x1]*_0x37d19f+_0x50324d[0x1]*_0x5a271a+_0x4e1b03[0x1]*_0x58cf42+_0x2b9920[0x1]*_0x29094a;return this['_calcUV'](_0x4459d2,_0x55bfe5);}[_0x350367(-0x102,-0x15b)](_0x5cf43b,_0x563cd0){function _0x58b0f4(_0x1e1aad,_0x17a7ac){return _0x28aa37(_0x1e1aad-0x464,_0x17a7ac);}return[+_0x5cf43b,+_0x563cd0,Math[_0x58b0f4(0x438,0x42e)](_0x5cf43b*_0x5cf43b+_0x563cd0*_0x563cd0)];}['getUVByPoint'](_0x48feda,_0x435061){if(!this['isInExtent'](_0x48feda,_0x435061))return null;const _0x2b4050=this['toGridXY'](_0x48feda,_0x435061),_0x440133=this['getUVByXY'](_0x2b4050[0x0],_0x2b4050[0x1]);return _0x440133;}[_0x28aa37(0x41,0x87)](_0x223cfe,_0xdb69af){function _0x46776e(_0x2ade3c,_0x2c1a9a){return _0x28aa37(_0x2c1a9a-0x3c2,_0x2ade3c);}return _0x223cfe>=this[_0x46776e(0x2e7,0x35d)]&&_0x223cfe<=this['xmax']&&_0xdb69af>=this['ymin']&&_0xdb69af<=this['ymax']?!![]:![];}['getRandomLatLng'](){function _0x1eab31(_0x3f5ae9,_0x37fbc4){return _0x28aa37(_0x37fbc4-0x3b4,_0x3f5ae9);}const _0x58b03e=fRandomByfloat(this['xmin'],this[_0x1eab31(0x32c,0x3ac)]),_0x58edb6=fRandomByfloat(this[_0xf9e57b(0x110,0xd6)],this['ymax']),_0x1fca7a={};function _0xf9e57b(_0x1617f3,_0x1b8978){return _0x28aa37(_0x1b8978-0xe1,_0x1617f3);}return _0x1fca7a['lat']=_0x58edb6,_0x1fca7a['lng']=_0x58b03e,_0x1fca7a;}['getParticles'](){function _0x58f9bb(_0x4721b0,_0x4031ec){return _0x350367(_0x4031ec,_0x4721b0- -0x95);}let _0x47facc,_0x3f6959,_0xfdc2c;function _0x560a53(_0x3a87be,_0x56c23a){return _0x28aa37(_0x3a87be-0x28f,_0x56c23a);}for(let _0x11c7ff=0x0,_0x3cfcb9=this[_0x560a53(0x20c,0x271)]['length'];_0x11c7ff<_0x3cfcb9;_0x11c7ff++){let _0x58aae4=this['particles'][_0x11c7ff];_0x58aae4[_0x560a53(0x276,0x2d5)]<=0x0&&(_0x58aae4=this['_randomParticle'](_0x58aae4));if(_0x58aae4['age']>0x0){const _0x4bc225=_0x58aae4[_0x58f9bb(-0x1cd,-0x1b3)],_0x28736b=_0x58aae4[_0x560a53(0x286,0x272)];_0xfdc2c=this[_0x58f9bb(-0x19d,-0x20e)](_0x4bc225,_0x28736b),_0xfdc2c?(_0x47facc=_0x4bc225+this[_0x560a53(0x1ed,0x1d0)][0x0]*_0xfdc2c[0x0],_0x3f6959=_0x28736b+this[_0x560a53(0x1ed,0x215)][0x1]*_0xfdc2c[0x1],_0x58aae4[_0x58f9bb(-0x1cf,-0x212)]=_0x4bc225,_0x58aae4['lat']=_0x28736b,_0x58aae4['tlng']=_0x47facc,_0x58aae4['tlat']=_0x3f6959,_0x58aae4['speed']=_0xfdc2c[0x2],_0x58aae4['age']--):_0x58aae4[_0x58f9bb(-0x168,-0x189)]=0x0;}}return this[_0x560a53(0x20c,0x1eb)];}['_randomParticle'](_0x4f5e54){function _0x3e9eeb(_0x430815,_0x246158){return _0x28aa37(_0x246158-0x190,_0x430815);}let _0x3bd8d8,_0x4dcfe8;for(let _0x129b43=0x0;_0x129b43<0x1e;_0x129b43++){_0x3bd8d8=this[_0x3e9eeb(0x1d6,0x18c)](),_0x4dcfe8=this[_0xc26fd2(-0x153,-0x15f)](_0x3bd8d8['lng'],_0x3bd8d8[_0x3e9eeb(0x18c,0x13d)]);if(_0x4dcfe8&&_0x4dcfe8[0x2]>0x0)break;}function _0xc26fd2(_0x21e81d,_0x38066b){return _0x350367(_0x21e81d,_0x38066b- -0x57);}if(!_0x4dcfe8)return _0x4f5e54;const _0x2f80c7=_0x3bd8d8['lng']+this['_calc_speedRate'][0x0]*_0x4dcfe8[0x0],_0x1ed6ac=_0x3bd8d8[_0xc26fd2(-0x1a9,-0x164)]+this['_calc_speedRate'][0x1]*_0x4dcfe8[0x1];return _0x4f5e54['lng']=_0x3bd8d8['lng'],_0x4f5e54['lat']=_0x3bd8d8['lat'],_0x4f5e54['tlng']=_0x2f80c7,_0x4f5e54['tlat']=_0x1ed6ac,_0x4f5e54['age']=Math['round'](0xa+Math[_0x3e9eeb(0x1f7,0x1c6)]()*this[_0xc26fd2(-0xb0,-0xc9)]),_0x4f5e54[_0xc26fd2(-0xf1,-0x144)]=_0x4dcfe8[0x2],_0x4f5e54;}['destroy'](){for(const _0x1618a2 in this){delete this[_0x1618a2];}}}function fRandomByfloat(_0x5d7f05,_0x5e74f8){function _0x2d7eb0(_0x1520fb,_0xf4b304){return _0x350367(_0xf4b304,_0x1520fb-0x57d);}return _0x5d7f05+Math[_0x2d7eb0(0x4f9,0x55b)]()*(_0x5e74f8-_0x5d7f05);}const Cesium=mars3d__namespace[_0x28aa37(-0x7d,-0x62)],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0xff27b5={}){super(_0xff27b5);function _0x405dbc(_0x57e4a3,_0x3c3234){return _0x350367(_0x3c3234,_0x57e4a3-0xa4);}this['_setOptionsHook'](_0xff27b5),this['canvas']=null;function _0x4e2560(_0x45732a,_0x36df3d){return _0x350367(_0x36df3d,_0x45732a-0x173);}_0xff27b5[_0x4e2560(0xe9,0x70)]&&_0xff27b5[_0x4e2560(0xe8,0xd9)]&&(this['_colorRamp']=new mars3d__namespace['ColorRamp'](_0xff27b5));}['_setOptionsHook'](_0x3fa5b4,_0x59379c){this['frameTime']=0x3e8/(_0x3fa5b4[_0x84fc75(-0xe3,-0x159)]||0xa);function _0x84fc75(_0x54941e,_0x376247){return _0x28aa37(_0x376247- -0x172,_0x54941e);}function _0x36fb48(_0x2f610d,_0x432970){return _0x28aa37(_0x2f610d-0x3ca,_0x432970);}this['_pointerEvents']=this[_0x36fb48(0x3b3,0x382)][_0x84fc75(-0x1b3,-0x20a)]??![],this['color']=_0x3fa5b4['color']||'#ffffff',this['lineWidth']=_0x3fa5b4['lineWidth']||0x1,this[_0x36fb48(0x359,0x398)]=_0x3fa5b4['fixedHeight']??0x0,this['flipY']=_0x3fa5b4[_0x84fc75(-0x16f,-0x144)]??![],this['windField']&&this['windField']['setOptions'](_0x3fa5b4);}get[_0x28aa37(0x35,-0xf)](){function _0x5f58f6(_0x10b63b,_0x4704fb){return _0x28aa37(_0x4704fb-0x2a6,_0x10b63b);}return this[_0x5f58f6(0x2c0,0x24c)];}get['canvasWidth'](){function _0x2db4a3(_0x71107,_0x192fa6){return _0x28aa37(_0x192fa6- -0xec,_0x71107);}return this['_map'][_0x2db4a3(-0x161,-0x161)]['canvas']['clientWidth'];}get['canvasHeight'](){function _0x31ec85(_0x1838c1,_0x306776){return _0x350367(_0x1838c1,_0x306776- -0xf5);}return this['_map']['scene'][_0x31ec85(-0x21d,-0x209)]['clientHeight'];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x28aa37(-0x98,-0x53)](_0x31920a){this[_0x547f17(-0x28e,-0x2f1)]=_0x31920a;function _0x547f17(_0xbab8bf,_0x2f79fb){return _0x350367(_0x2f79fb,_0xbab8bf- -0x15d);}if(!this['canvas'])return;function _0x1c23de(_0x14f254,_0x402d56){return _0x350367(_0x14f254,_0x402d56- -0xa6);}_0x31920a?this[_0x1c23de(-0x1a4,-0x1ba)][_0x1c23de(-0x16c,-0x16d)][_0x547f17(-0x27b,-0x2b6)]=_0x1c23de(-0x17b,-0x1a1):this[_0x1c23de(-0x230,-0x1ba)]['style']['pointer-events']=_0x1c23de(-0x1e9,-0x178);}get['particlesNumber'](){return this['options']['particlesNumber'];}set[_0x28aa37(-0x2f,0x13)](_0x44bf5a){this['options']['particlesNumber']=_0x44bf5a,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(()=>{function _0xa6170a(_0x5d6199,_0x192a6f){return _0x5aa4(_0x5d6199- -0x3d5,_0x192a6f);}this[_0xa6170a(-0x25d,-0x2c9)]();},0x1f4);}get[_0x28aa37(0x33,-0x2c)](){function _0x5a83ab(_0x142eb6,_0x4950ea){return _0x28aa37(_0x4950ea-0x209,_0x142eb6);}return this['options'][_0x5a83ab(0x269,0x23c)];}set[_0x28aa37(0x33,0x7d)](_0x1796ad){function _0x16dbc0(_0xff4b64,_0x16361c){return _0x28aa37(_0x16361c- -0x170,_0xff4b64);}function _0x2c51d5(_0x4f75cb,_0x4723ff){return _0x350367(_0x4723ff,_0x4f75cb-0x518);}this['options'][_0x16dbc0(-0x136,-0x13d)]=_0x1796ad,this['windField']&&(this['windField'][_0x2c51d5(0x491,0x445)]=_0x1796ad);}get[_0x28aa37(0x48,0x16)](){function _0x467b24(_0xf4f5a8,_0x28f635){return _0x350367(_0x28f635,_0xf4f5a8- -0x6a);}return this[_0x467b24(-0x13b,-0x183)]['maxAge'];}set[_0x350367(-0x9c,-0x72)](_0x153a7d){function _0x5c6821(_0x162a91,_0x1403b8){return _0x350367(_0x1403b8,_0x162a91-0x2f4);}this[_0x5c6821(0x223,0x1c1)]['maxAge']=_0x153a7d,this['windField']&&(this['windField']['maxAge']=_0x153a7d);}get[_0x350367(-0x71,-0xea)](){return this['windData'];}set['data'](_0x58d403){this['setData'](_0x58d403);}get['rectangle'](){let _0x17f8a6=this['windData'][_0x57e7e0(0x211,0x1f1)],_0x9288b4=this[_0x57e7e0(0x1c2,0x1f4)][_0x42a3db(0xa0,0xaa)],_0x4a4c8e=this['windData']['ymin'],_0x35be5e=this[_0x42a3db(0x46,0x4d)][_0x42a3db(0x82,0x5)];_0x9288b4>=0x167&&_0x17f8a6===0x0&&(_0x17f8a6=-0xb4,_0x9288b4=0xb4);_0x17f8a6=Math[_0x57e7e0(0x251,0x26b)](_0x17f8a6,-0xb4);function _0x42a3db(_0x386ebf,_0x1661a9){return _0x350367(_0x1661a9,_0x386ebf-0x162);}function _0x57e7e0(_0x1b19a5,_0x339ee4){return _0x350367(_0x1b19a5,_0x339ee4-0x310);}return _0x9288b4=Math['min'](_0x9288b4,0xb4),_0x4a4c8e=Math['max'](_0x4a4c8e,-0x5a),_0x35be5e=Math['min'](_0x35be5e,0x5a),Cesium['Rectangle']['fromDegrees'](_0x17f8a6,_0x4a4c8e,_0x9288b4,_0x35be5e);}[_0x350367(-0xf8,-0x94)](_0x2c4c4f){function _0x337f9a(_0x4020aa,_0x367165){return _0x350367(_0x4020aa,_0x367165-0x123);}function _0x2de746(_0x2c73a3,_0x4a88cb){return _0x28aa37(_0x4a88cb- -0x1a6,_0x2c73a3);}_0x2c4c4f?this[_0x2de746(-0x248,-0x1db)]():(this[_0x337f9a(-0x23,0x7)]&&(this['options']['data']=this[_0x2de746(-0x1d3,-0x208)]),this[_0x337f9a(0x94,0x9a)]());}['_mountedHook'](){function _0x52d9d0(_0x871411,_0x35a408){return _0x28aa37(_0x871411- -0xf6,_0x35a408);}function _0x1964ed(_0x540d62,_0x5c1a61){return _0x350367(_0x5c1a61,_0x540d62-0x32c);}this['options'][_0x52d9d0(-0x124,-0x187)]?this['initWorker']():this[_0x1964ed(0x20a,0x28b)]=new CanvasWindField(this[_0x1964ed(0x25b,0x233)]);}['_addedHook'](){this[_0x560705(0xbe,0x119)]=this['_createCanvas']();function _0x582788(_0x4ae544,_0x543580){return _0x350367(_0x4ae544,_0x543580-0x633);}function _0x560705(_0x545bb8,_0x20f4d5){return _0x28aa37(_0x20f4d5-0x173,_0x545bb8);}const _0x212e69={};_0x212e69['willReadFrequently']=!![],this['canvasContext']=this[_0x582788(0x4f4,0x51f)]['getContext']('2d',_0x212e69),this['bindEvent'](),this[_0x560705(0x192,0x15c)][_0x560705(0x11c,0x143)]&&this['setData'](this['options']['data']);}['_removedHook'](){function _0x9e3d83(_0x6bd442,_0x167cf6){return _0x350367(_0x167cf6,_0x6bd442- -0xd3);}this[_0x3da538(0x7f,0x51)]();function _0x3da538(_0x81ed55,_0x3949aa){return _0x350367(_0x3949aa,_0x81ed55-0x199);}this['unbindEvent'](),this[_0x3da538(0x85,0xa8)]&&(this[_0x9e3d83(-0x19d,-0x162)][_0x3da538(0x30,0x97)][_0x3da538(0x57,0x3)](this[_0x3da538(0x85,0x1c)]),delete this['canvas']);}['_createCanvas'](){const _0x3efb4a=mars3d__namespace['DomUtil'][_0x1b0a93(0x39c,0x3c3)](_0x1b0a93(0x38b,0x314),_0x444488(0x113,0xa5),this[_0x444488(0x73,0x7e)]['container']);_0x3efb4a['style'][_0x1b0a93(0x3ed,0x36f)]='absolute',_0x3efb4a['style']['top']='0px',_0x3efb4a['style']['left']='0px',_0x3efb4a[_0x1b0a93(0x3d8,0x440)]['width']=this['_map']['scene']['canvas'][_0x1b0a93(0x37a,0x3ce)]+'px';function _0x1b0a93(_0x5742ee,_0x194bb2){return _0x350367(_0x194bb2,_0x5742ee-0x49f);}function _0x444488(_0x320b4a,_0xfa3c1){return _0x350367(_0x320b4a,_0xfa3c1-0x148);}return _0x3efb4a[_0x1b0a93(0x3d8,0x435)]['height']=this['_map'][_0x444488(0x3,0x19)][_0x444488(0x30,0x34)][_0x444488(0x96,0xcd)]+'px',_0x3efb4a[_0x444488(0xba,0x81)]['pointerEvents']=this['_pointerEvents']?_0x1b0a93(0x430,0x4a9):_0x444488(-0x5,0x76),_0x3efb4a['style'][_0x1b0a93(0x35a,0x3c8)]=this[_0x1b0a93(0x3ce,0x382)][_0x1b0a93(0x35a,0x3d9)]??0x9,_0x3efb4a['width']=this['_map']['scene'][_0x444488(0x25,0x34)]['clientWidth'],_0x3efb4a['height']=this['_map']['scene']['canvas'][_0x1b0a93(0x424,0x491)],_0x3efb4a;}['resize'](){function _0x35c64a(_0x211efe,_0x586ea2){return _0x350367(_0x586ea2,_0x211efe-0x15);}function _0x1db300(_0x188955,_0x2fd1cc){return _0x28aa37(_0x188955-0x2c6,_0x2fd1cc);}this['canvas']&&(this['canvas'][_0x1db300(0x2b9,0x31b)]['width']=this[_0x1db300(0x2b6,0x2e8)]['scene']['canvas'][_0x1db300(0x25b,0x20c)]+'px',this[_0x35c64a(-0xff,-0x13c)]['style'][_0x1db300(0x2a9,0x2f9)]=this[_0x1db300(0x2b6,0x30b)]['scene'][_0x35c64a(-0xff,-0xb8)][_0x1db300(0x305,0x341)]+'px',this['canvas']['width']=this['_map'][_0x1db300(0x251,0x25b)]['canvas'][_0x1db300(0x25b,0x2a2)],this[_0x35c64a(-0xff,-0x175)][_0x35c64a(-0xc2,-0xbc)]=this['_map']['scene']['canvas']['clientHeight']);}[_0x28aa37(-0x3b,0x8)](){const _0x421f47=this;function _0x34162e(_0x5b90ff,_0x9cea8){return _0x350367(_0x5b90ff,_0x9cea8- -0x123);}let _0x479bed=Date['now']();(function _0x57c059(){if(_0x421f47['isDestroy'])return;function _0x4647aa(_0x512204,_0xf76ed8){return _0x5aa4(_0xf76ed8- -0x277,_0x512204);}_0x421f47['_animateFrame']=window['requestAnimationFrame'](_0x57c059);function _0x161b12(_0x57daf2,_0x2438a3){return _0x5aa4(_0x57daf2- -0x358,_0x2438a3);}if(_0x421f47['show']&&_0x421f47[_0x161b12(-0x223,-0x1ab)]){const _0x212816=Date[_0x4647aa(-0x150,-0x105)](),_0x90c1a8=_0x212816-_0x479bed;_0x90c1a8>_0x421f47[_0x161b12(-0x1fd,-0x1c2)]&&(_0x479bed=_0x212816-_0x90c1a8%_0x421f47['frameTime'],_0x421f47['update']());}}(),window[_0x34162e(-0x21b,-0x272)]('resize',this[_0x2c43d1(-0x11e,-0x19a)]['bind'](this),![]),this[_0x34162e(-0x1f9,-0x223)]=![],this['mouse_move']=![]);function _0x2c43d1(_0x3a46a3,_0x4c0100){return _0x28aa37(_0x4c0100- -0x19d,_0x3a46a3);}this['options'][_0x34162e(-0x212,-0x1c5)]&&(this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace[_0x2c43d1(-0x1b0,-0x1e2)]['mouseDown'],this[_0x2c43d1(-0x266,-0x221)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x34162e(-0x1f2,-0x1e7)],this));}['unbindEvent'](){window['cancelAnimationFrame'](this['_animateFrame']);function _0x4a846d(_0xe36d70,_0x4d3555){return _0x350367(_0x4d3555,_0xe36d70-0x52a);}function _0x2a4e36(_0x51cb9c,_0x48e48d){return _0x350367(_0x51cb9c,_0x48e48d- -0x16b);}delete this['_animateFrame'],window['removeEventListener']('resize',this['resize']),this['options'][_0x2a4e36(-0x226,-0x20d)]&&(this[_0x2a4e36(-0x24f,-0x235)]['off'](mars3d__namespace['EventType'][_0x2a4e36(-0x212,-0x1dc)],this[_0x4a846d(0x3d4,0x3ff)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseDown'],this[_0x4a846d(0x3ec,0x442)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this[_0x2a4e36(-0x1cf,-0x22f)],this),this[_0x4a846d(0x460,0x4cb)][_0x4a846d(0x482,0x405)](mars3d__namespace[_0x4a846d(0x42b,0x3f3)][_0x2a4e36(-0x2da,-0x295)],this['_onMouseMoveEvent'],this));}['_onMapWhellEvent'](_0x229b0b){function _0x5c4cd5(_0x2ee851,_0x1cfcdf){return _0x350367(_0x1cfcdf,_0x2ee851-0x62);}clearTimeout(this['refreshTimer']);function _0x13a566(_0x23339c,_0x5724be){return _0x28aa37(_0x23339c-0x15,_0x5724be);}if(!this[_0x5c4cd5(-0x3c,0x3c)]||!this['canvas'])return;this['canvas'][_0x13a566(0x8,-0x59)]['visibility']='hidden',this['refreshTimer']=setTimeout(()=>{function _0x274f87(_0x5e56aa,_0x5e5e68){return _0x5c4cd5(_0x5e5e68-0x17,_0x5e56aa);}function _0x1efbc6(_0xdba858,_0x251ec6){return _0x5c4cd5(_0x251ec6-0x162,_0xdba858);}if(!this['show'])return;this['redraw'](),this['canvas'][_0x1efbc6(0xc7,0xfd)][_0x274f87(-0x82,-0x1a)]='visible';},0xc8);}['_onMouseDownEvent'](_0x3aa1a1){function _0x576ccb(_0x1c0be7,_0x11c128){return _0x350367(_0x11c128,_0x1c0be7- -0xff);}this['mouse_down']=!![],this['_map'][_0x576ccb(-0x1a7,-0x1d3)](mars3d__namespace[_0x576ccb(-0x1fe,-0x1ba)]['mouseMove'],this[_0xe06717(0x19e,0x1fa)],this);function _0xe06717(_0x102c2b,_0x9de007){return _0x350367(_0x102c2b,_0x9de007-0x265);}this['_map']['on'](mars3d__namespace['EventType'][_0x576ccb(-0x229,-0x276)],this['_onMouseMoveEvent'],this);}[_0x350367(-0xc4,-0x6b)](_0x5157ef){function _0x4eca4f(_0x446c74,_0x3bd416){return _0x350367(_0x3bd416,_0x446c74-0x10b);}if(!this['show']||!this[_0x4eca4f(-0x9,-0x36)])return;function _0x56bc17(_0x42754f,_0x31ecb6){return _0x350367(_0x42754f,_0x31ecb6-0x54f);}this['mouse_down']&&(this[_0x56bc17(0x43d,0x43b)]['style'][_0x56bc17(0x526,0x4bc)]='hidden',this[_0x4eca4f(-0xe,-0x9)]=!![]);}['_onMouseUpEvent'](_0x10dc58){if(!this['show']||!this['canvas'])return;function _0x375556(_0x593eba,_0x21e32f){return _0x28aa37(_0x21e32f-0x105,_0x593eba);}this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);function _0x26d7e0(_0x12485e,_0x46b3f7){return _0x350367(_0x46b3f7,_0x12485e-0x5d5);}this[_0x26d7e0(0x4d5,0x496)]&&this['mouse_move']&&this['redraw'](),this[_0x26d7e0(0x4c1,0x4e8)]['style'][_0x375556(0x19a,0x12c)]='visible',this[_0x375556(0x97,0xbf)]=![],this['mouse_move']=![];}[_0x350367(-0x24,-0x6d)](_0x5e78ab){this['clear'](),this['windData']=_0x5e78ab,this['windField']['setDate'](_0x5e78ab),this['redraw']();}['redraw'](){if(!this[_0x38df61(0x4b5,0x4dc)])return;function _0x15600e(_0x2c4cf1,_0x5e8d23){return _0x28aa37(_0x2c4cf1-0x3d,_0x5e8d23);}this[_0x15600e(-0x2b,-0x66)][_0x38df61(0x4ce,0x483)](this[_0x15600e(0x26,0x3b)]);function _0x38df61(_0x5a64db,_0x22ce86){return _0x28aa37(_0x22ce86-0x4c0,_0x5a64db);}this['update']();}['update'](){function _0xf3c1eb(_0x28a7e8,_0x164abc){return _0x350367(_0x164abc,_0x28a7e8-0x352);}if(this['_updateIng'])return;this[_0xea22eb(0x314,0x364)]=!![];if(this['worker'])this['windField']['update']();else{const _0xdba5bb=this['windField'][_0xf3c1eb(0x27e,0x24d)]();this[_0xea22eb(0x311,0x2cd)](_0xdba5bb);}function _0xea22eb(_0x168cec,_0xeae8c6){return _0x28aa37(_0x168cec-0x380,_0xeae8c6);}this[_0xea22eb(0x314,0x37b)]=![];}[_0x350367(-0xc4,-0x129)](_0x30453e){function _0x415828(_0x2e9d9a,_0x371941){return _0x350367(_0x2e9d9a,_0x371941- -0x29);}function _0x37f210(_0x17146a,_0x16e3cd){return _0x350367(_0x17146a,_0x16e3cd-0x3c7);}this['_canvasParticles']=_0x30453e,this['canvasContext'][_0x37f210(0x2ec,0x27b)]='destination-in',this['canvasContext']['fillRect'](0x0,0x0,this[_0x415828(-0x16e,-0x13f)],this[_0x37f210(0x2b2,0x2bc)]),this['canvasContext'][_0x37f210(0x267,0x27b)]='lighter',this['canvasContext']['globalAlpha']=0.9;const _0x33207a=this[_0x415828(-0x9b,-0xf3)][_0x415828(-0x18e,-0x158)][_0x415828(-0xab,-0xe1)]!==Cesium['SceneMode'][_0x415828(-0x47,-0xba)],_0x567761=this[_0x37f210(0x275,0x2b1)]*0.25;if(this['_colorRamp'])for(let _0x14dde6=0x0,_0x19adc8=_0x30453e['length'];_0x14dde6<_0x19adc8;_0x14dde6++){const _0x53e516=_0x30453e[_0x14dde6],_0x4fe291=this['_tomap'](_0x53e516,_0x53e516['lng'],_0x53e516['lat'],_0x53e516['alt']),_0x24c9fe=this['_tomap'](_0x53e516,_0x53e516['tlng'],_0x53e516[_0x37f210(0x322,0x304)],_0x53e516['talt']);if(!_0x4fe291||!_0x24c9fe)continue;if(_0x33207a&&Math['abs'](_0x4fe291[0x0]-_0x24c9fe[0x0])>=_0x567761)continue;this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['_colorRamp']['getColor'](_0x53e516['speed']),this[_0x415828(-0xb4,-0x122)][_0x37f210(0x2cd,0x2e0)](_0x4fe291[0x0],_0x4fe291[0x1]),this['canvasContext']['lineTo'](_0x24c9fe[0x0],_0x24c9fe[0x1]),this['canvasContext']['stroke']();}else{this['canvasContext'][_0x415828(-0x7a,-0xa8)](),this[_0x415828(-0xe6,-0x122)]['lineWidth']=this['lineWidth'],this[_0x37f210(0x26f,0x2ce)][_0x415828(-0x139,-0x119)]=this[_0x415828(-0x6b,-0xd3)];for(let _0x20183f=0x0,_0x36e58c=_0x30453e['length'];_0x20183f<_0x36e58c;_0x20183f++){const _0x1afa74=_0x30453e[_0x20183f],_0x4a53bd=this[_0x415828(-0xe0,-0xf2)](_0x1afa74,_0x1afa74[_0x37f210(0x23b,0x28d)],_0x1afa74[_0x415828(-0x1ab,-0x136)],_0x1afa74['alt']),_0x25d0bd=this[_0x37f210(0x280,0x2fe)](_0x1afa74,_0x1afa74[_0x415828(-0x13f,-0x161)],_0x1afa74['tlat'],_0x1afa74['talt']);if(!_0x4a53bd||!_0x25d0bd)continue;if(_0x33207a&&Math['abs'](_0x4a53bd[0x0]-_0x25d0bd[0x0])>=_0x567761)continue;this['canvasContext']['moveTo'](_0x4a53bd[0x0],_0x4a53bd[0x1]),this[_0x37f210(0x328,0x2ce)][_0x37f210(0x2e5,0x2fb)](_0x25d0bd[0x0],_0x25d0bd[0x1]);}this[_0x37f210(0x292,0x2ce)][_0x37f210(0x304,0x2f8)]();}}['_tomap'](_0x3fdd2c,_0xeef421,_0x240a0c,_0xa93ee3){const _0xb345b3=Cesium['Cartesian3']['fromDegrees'](_0xeef421,_0x240a0c,_0xa93ee3??this[_0x39cb42(-0x1e,0x8)]),_0x30cc49=this['_map'][_0x39cb42(-0x22,-0x66)];if(_0x30cc49['mode']===Cesium['SceneMode'][_0x39cb42(0x7c,0x44)]){const _0x3c601f=new Cesium['EllipsoidalOccluder'](_0x30cc49['globe']['ellipsoid'],_0x30cc49['camera']['positionWC']),_0x4fc136=_0x3c601f['isPointVisible'](_0xb345b3);if(!_0x4fc136)return _0x3fdd2c[_0x39cb42(0x3a,0x52)]=0x0,null;}function _0x342043(_0x352609,_0xe2099c){return _0x28aa37(_0x352609-0x70,_0xe2099c);}function _0x39cb42(_0x1e1c36,_0x2a0e7d){return _0x28aa37(_0x1e1c36-0x53,_0x2a0e7d);}const _0x2c0220=mars3d__namespace['PointTrans']['toWindowCoordinates'](this[_0x39cb42(0x43,0x8b)]['scene'],_0xb345b3);return _0x2c0220?[_0x2c0220['x'],_0x2c0220['y']]:null;}[_0x350367(-0x101,-0x11a)](){function _0x411a81(_0x583118,_0x4de400){return _0x350367(_0x583118,_0x4de400-0x2df);}this[_0x411a81(0x1ec,0x1bd)][_0x4ff056(-0xe6,-0x79)]();function _0x4ff056(_0x46f49b,_0x499586){return _0x350367(_0x46f49b,_0x499586-0xa1);}delete this['windData'];}['initWorker'](){this['worker']=new Worker(this['options']['worker']);function _0x246269(_0x59e224,_0x18d17e){return _0x350367(_0x59e224,_0x18d17e-0xd4);}this['worker']['onmessage']=_0x998d4b=>{this[_0x352fb8(-0x69,-0x49)](_0x998d4b[_0x2ffcbe(-0x1,-0x70)]['particles']);function _0x2ffcbe(_0x4bebe4,_0x561959){return _0x5aa4(_0x561959- -0x1dd,_0x4bebe4);}function _0x352fb8(_0x412cca,_0x32637a){return _0x5aa4(_0x32637a- -0x177,_0x412cca);}this['_updateIng2']=![];},this['windField']={'init':_0x46c2f6=>{const _0xeb3acc={};_0xeb3acc['type']='init',_0xeb3acc['options']=_0x46c2f6,this['worker']['postMessage'](_0xeb3acc);},'setOptions':_0x46f40f=>{function _0x102ddb(_0x4f49fe,_0xc7c42d){return _0x5aa4(_0x4f49fe-0x161,_0xc7c42d);}const _0x3fa04a={};_0x3fa04a[_0x102ddb(0x250,0x2a4)]=_0x318c06(-0xdb,-0x115);function _0x318c06(_0x8b3a10,_0x2f6330){return _0x5aa4(_0x2f6330- -0x275,_0x8b3a10);}_0x3fa04a['options']=_0x46f40f,this[_0x102ddb(0x2d0,0x2fb)]['postMessage'](_0x3fa04a);},'setDate':_0x2dd8cb=>{const _0x13cfb4={};_0x13cfb4['type']='setDate',_0x13cfb4['data']=_0x2dd8cb,this['worker']['postMessage'](_0x13cfb4);},'update':()=>{function _0x145953(_0x2c5bb5,_0x258f0a){return _0x5aa4(_0x258f0a-0x137,_0x2c5bb5);}if(this['_updateIng2'])return;this[_0x145953(0x257,0x2d5)]=!![];const _0x3b9812={};function _0xd7fa4b(_0x50386c,_0x39c44d){return _0x5aa4(_0x50386c-0x1ae,_0x39c44d);}_0x3b9812[_0xd7fa4b(0x29d,0x2af)]='update',this[_0x145953(0x2fe,0x2a6)]['postMessage'](_0x3b9812);},'clear':()=>{function _0x254b17(_0x263ba0,_0x56c854){return _0x5aa4(_0x263ba0-0x12b,_0x56c854);}const _0x11668a={};_0x11668a[_0x4e4785(-0x6d,-0x87)]='clear';function _0x4e4785(_0x297a8a,_0x562b8c){return _0x5aa4(_0x562b8c- -0x176,_0x297a8a);}this[_0x254b17(0x29a,0x2de)][_0x4e4785(-0x47,-0x7d)](_0x11668a);}};function _0x157bf0(_0x2baca8,_0xa1a286){return _0x28aa37(_0x2baca8-0x160,_0xa1a286);}this[_0x246269(0x25,-0x4e)][_0x246269(0x33,-0x29)](this['options']);}}mars3d__namespace[_0x28aa37(-0x8d,-0xb)]['register']('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['Log'][_0x28aa37(-0x93,-0x24)]('mars3d-wind插件\x20注册成功'),mars3d__namespace['WindUtil']=WindUtil,exports[_0x350367(-0xbf,-0x86)]=CanvasWindField,exports[_0x350367(-0x7e,-0xc6)]=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil;const _0x590145={};_0x590145['value']=!![],Object['defineProperty'](exports,'__esModule',_0x590145);
}));
