/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.10.4
 * 编译日期：2025-09-03 20:32
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-07-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x3a4ee4,_0xdb920){const _0x154b0c=_0x3a4ee4();function _0x4ea709(_0x163d15,_0x5892f4){return _0x5a39(_0x163d15-0x3a7,_0x5892f4);}function _0x7eac70(_0x4983c0,_0x33cb64){return _0x5a39(_0x4983c0- -0x21e,_0x33cb64);}while(!![]){try{const _0x4f6945=parseInt(_0x4ea709(0x4ad,0x44f))/0x1*(parseInt(_0x4ea709(0x4b9,0x45f))/0x2)+parseInt(_0x7eac70(-0x87,-0x27))/0x3+-parseInt(_0x4ea709(0x594,0x5c7))/0x4+parseInt(_0x4ea709(0x540,0x506))/0x5*(-parseInt(_0x4ea709(0x5b2,0x5ef))/0x6)+parseInt(_0x4ea709(0x535,0x557))/0x7+parseInt(_0x7eac70(-0x28,0x4a))/0x8*(-parseInt(_0x7eac70(-0x38,-0x3c))/0x9)+parseInt(_0x4ea709(0x4f2,0x4eb))/0xa;if(_0x4f6945===_0xdb920)break;else _0x154b0c['push'](_0x154b0c['shift']());}catch(_0x35c0bc){_0x154b0c['push'](_0x154b0c['shift']());}}}(_0x2476,0x1f1fc));function _interopNamespace(_0x368f09){function _0x45834c(_0x398acc,_0x527cf6){return _0x5a39(_0x398acc-0x3c,_0x527cf6);}if(_0x368f09&&_0x368f09['__esModule'])return _0x368f09;var _0x2f0351=Object['create'](null);return _0x368f09&&Object[_0x45834c(0x24a,0x293)](_0x368f09)['forEach'](function(_0xea6cd3){function _0x74e934(_0x22e5a4,_0x48cc94){return _0x45834c(_0x48cc94-0x35d,_0x22e5a4);}if(_0xea6cd3!==_0x74e934(0x571,0x537)){var _0x183755=Object['getOwnPropertyDescriptor'](_0x368f09,_0xea6cd3);Object['defineProperty'](_0x2f0351,_0xea6cd3,_0x183755['get']?_0x183755:{'enumerable':!![],'get':function(){return _0x368f09[_0xea6cd3];}});}}),_0x2f0351['default']=_0x368f09,_0x2f0351;}function _0x383bfc(_0x24086d,_0x4df7d0){return _0x5a39(_0x4df7d0-0x205,_0x24086d);}function _0x5a39(_0x33d0d8,_0x3b31da){const _0x2476d3=_0x2476();return _0x5a39=function(_0x5a39c9,_0x3fb1e3){_0x5a39c9=_0x5a39c9-0x103;let _0x352947=_0x2476d3[_0x5a39c9];return _0x352947;},_0x5a39(_0x33d0d8,_0x3b31da);}var mars3d__namespace=_interopNamespace(mars3d);function _0x158252(_0x145864,_0x438d10){return _0x5a39(_0x438d10-0x39a,_0x145864);}const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x44a13d,_0x42104f){const _0x55c3c4=_0x44a13d*Math['cos'](Cesium$2['Math']['toRadians'](_0x42104f));return _0x55c3c4;}function getV(_0x317fe9,_0x140f19){const _0x15960f=_0x317fe9*Math[_0x2e2843(-0xff,-0x140)](Cesium$2['Math']['toRadians'](_0x140f19));function _0x2e2843(_0x556f98,_0x26eb7a){return _0x5a39(_0x26eb7a- -0x266,_0x556f98);}return _0x15960f;}function getSpeed(_0x4eb5d0,_0x1d8dcf){function _0xf04201(_0x199db3,_0x45598a){return _0x5a39(_0x45598a- -0x2c4,_0x199db3);}const _0x33adc9=Math['sqrt'](Math['pow'](_0x4eb5d0,0x2)+Math[_0xf04201(-0x218,-0x1a3)](_0x1d8dcf,0x2));return _0x33adc9;}function getDirection(_0x3892d0,_0x4d2ccb){let _0x296cf8=Cesium$2['Math']['toDegrees'](Math['atan2'](_0x4d2ccb,_0x3892d0));return _0x296cf8+=_0x296cf8<0x0?0x168:0x0,_0x296cf8;}const _0x36570c={};_0x36570c['__proto__']=null,_0x36570c['getU']=getU,_0x36570c['getV']=getV,_0x36570c['getSpeed']=getSpeed,_0x36570c[_0x383bfc(0x312,0x31a)]=getDirection;var WindUtil=_0x36570c,updatePositionShader=_0x383bfc(0x342,0x3b9),calculateSpeedShader=_0x158252(0x575,0x583),postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader=_0x158252(0x4e5,0x509),renderParticlesVertexShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a';const {ShaderSource:ShaderSource$1}=mars3d__namespace[_0x158252(0x564,0x4e4)];class ShaderManager{static['getCalculateSpeedShader'](){const _0x4278dd={};return _0x4278dd['sources']=[calculateSpeedShader],new ShaderSource$1(_0x4278dd);}static[_0x383bfc(0x314,0x31e)](){const _0x1a7868={};function _0x44f5bd(_0x493cbe,_0x234cf7){return _0x158252(_0x493cbe,_0x234cf7- -0x1fc);}return _0x1a7868[_0x44f5bd(0x2fc,0x31f)]=[updatePositionShader],new ShaderSource$1(_0x1a7868);}static['getSegmentDrawVertexShader'](){const _0x35ceb4={};function _0x4fc4f6(_0x162611,_0xdef0f2){return _0x383bfc(_0xdef0f2,_0x162611-0x18f);}return _0x35ceb4[_0x4fc4f6(0x515,0x571)]=[renderParticlesVertexShader],new ShaderSource$1(_0x35ceb4);}static['getSegmentDrawFragmentShader'](){const _0x5e96f1={};return _0x5e96f1['sources']=[renderParticlesFragmentShader],new ShaderSource$1(_0x5e96f1);}static['getPostProcessingPositionShader'](){const _0x119da0={};_0x119da0[_0x444e09(0x404,0x457)]=[postProcessingPositionFragmentShader];function _0x444e09(_0x7c5b95,_0x33e0ac){return _0x383bfc(_0x7c5b95,_0x33e0ac-0xd1);}return new ShaderSource$1(_0x119da0);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace[_0x158252(0x4eb,0x4e4)];class CustomPrimitive{constructor(_0x2913a4){this[_0x48ea98(0x35f,0x3d0)]=_0x2913a4[_0x48ea98(0x3ba,0x3d0)],this[_0x138eed(0x14f,0xf7)]=_0x2913a4[_0x48ea98(0x3c3,0x3be)],this[_0x48ea98(0x43a,0x416)]=_0x2913a4['attributeLocations'],this['primitiveType']=_0x2913a4['primitiveType'];function _0x48ea98(_0x4e431d,_0x404ad5){return _0x383bfc(_0x4e431d,_0x404ad5-0x9e);}this[_0x138eed(0x145,0x10b)]=_0x2913a4['uniformMap']||{},this[_0x48ea98(0x3da,0x43b)]=_0x2913a4['vertexShaderSource'],this['fragmentShaderSource']=_0x2913a4[_0x48ea98(0x468,0x460)],this[_0x48ea98(0x44f,0x485)]=_0x2913a4['rawRenderState'],this['framebuffer']=_0x2913a4['framebuffer'],this[_0x48ea98(0x3dc,0x3da)]=_0x2913a4[_0x48ea98(0x44c,0x3da)],this['autoClear']=_0x2913a4['autoClear']??![],this[_0x138eed(0x13f,0xe3)]=_0x2913a4['preExecute'];function _0x138eed(_0x1dc4bd,_0x2d912c){return _0x158252(_0x1dc4bd,_0x2d912c- -0x3be);}this['show']=!![],this[_0x48ea98(0x480,0x40e)]=undefined,this['clearCommand']=undefined,this['isDynamic']=_0x2913a4[_0x48ea98(0x4cd,0x455)]??(()=>!![]),this[_0x138eed(0x109,0xe9)]&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x138eed(0x12f,0x114)],'pass':Pass$1[_0x48ea98(0x49a,0x442)]}));}['createCommand'](_0x5c4ba7){function _0x3cbd14(_0x41a0a8,_0x2c4e44){return _0x383bfc(_0x41a0a8,_0x2c4e44- -0x514);}function _0x4b5659(_0x3c7749,_0x381f26){return _0x383bfc(_0x381f26,_0x3c7749-0x62);}if(this['commandType']===_0x4b5659(0x444,0x411)){const _0x197bcb={};_0x197bcb['context']=_0x5c4ba7,_0x197bcb['geometry']=this['geometry'],_0x197bcb['attributeLocations']=this['attributeLocations'],_0x197bcb['bufferUsage']=BufferUsage$1['STATIC_DRAW'];const _0x1e3903=VertexArray$1['fromGeometry'](_0x197bcb),_0x541ec8={};_0x541ec8['context']=_0x5c4ba7,_0x541ec8['vertexShaderSource']=this['vertexShaderSource'],_0x541ec8[_0x4b5659(0x424,0x476)]=this['fragmentShaderSource'],_0x541ec8['attributeLocations']=this['attributeLocations'];const _0x286c1c=ShaderProgram['fromCache'](_0x541ec8),_0x5056a7=RenderState['fromCache'](this['rawRenderState']),_0x1e2f33={};return _0x1e2f33['owner']=this,_0x1e2f33['vertexArray']=_0x1e3903,_0x1e2f33['primitiveType']=this['primitiveType'],_0x1e2f33['modelMatrix']=Matrix4[_0x4b5659(0x416,0x42c)],_0x1e2f33[_0x4b5659(0x46d,0x438)]=_0x5056a7,_0x1e2f33['shaderProgram']=_0x286c1c,_0x1e2f33[_0x4b5659(0x39f,0x3fa)]=this[_0x4b5659(0x39f,0x3ef)],_0x1e2f33['uniformMap']=this[_0x4b5659(0x396,0x390)],_0x1e2f33[_0x4b5659(0x43e,0x458)]=Pass$1['OPAQUE'],new DrawCommand(_0x1e2f33);}else{if(this[_0x4b5659(0x394,0x333)]==='Compute'){const _0x109e34={};return _0x109e34[_0x3cbd14(-0x1f2,-0x205)]=this,_0x109e34['fragmentShaderSource']=this['fragmentShaderSource'],_0x109e34[_0x3cbd14(-0x1c9,-0x1e0)]=this['uniformMap'],_0x109e34['outputTexture']=this['outputTexture'],_0x109e34[_0x3cbd14(-0x154,-0x15e)]=!![],new ComputeCommand(_0x109e34);}else throw new Error(_0x3cbd14(-0x1dd,-0x1db));}}['setGeometry'](_0x16261c,_0x254e47){function _0xe27b45(_0x3b5bcc,_0x451df9){return _0x383bfc(_0x451df9,_0x3b5bcc- -0x4da);}this[_0xe27b45(-0x1ba,-0x1f6)]=_0x254e47;function _0x371077(_0x548ce1,_0xec8df8){return _0x158252(_0xec8df8,_0x548ce1- -0x283);}defined(this['commandToExecute'])&&(this[_0x371077(0x282,0x2e7)][_0x371077(0x225,0x280)]=VertexArray$1['fromGeometry']({'context':_0x16261c,'geometry':this[_0x371077(0x232,0x252)],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1[_0xe27b45(-0x17b,-0x16a)]}));}['update'](_0x463184){if(!this[_0x69c9e5(0x4ae,0x427)]())return;if(!this[_0x3c454a(0x491,0x435)]||!defined(_0x463184))return;!defined(this[_0x69c9e5(0x467,0x44c)])&&(this['commandToExecute']=this[_0x3c454a(0x516,0x4da)](_0x463184['context']));function _0x3c454a(_0x45ab3e,_0x287207){return _0x158252(_0x287207,_0x45ab3e- -0x49);}defined(this[_0x69c9e5(0x403,0x40a)])&&this[_0x3c454a(0x458,0x3d1)]();if(!_0x463184[_0x69c9e5(0x50c,0x56a)]){console['warn']('frameState.commandList\x20is\x20undefined');return;}function _0x69c9e5(_0x46de3d,_0x3c92a3){return _0x383bfc(_0x3c92a3,_0x46de3d-0xf7);}defined(this['clearCommand'])&&_0x463184[_0x69c9e5(0x50c,0x543)]['push'](this['clearCommand']),defined(this['commandToExecute'])&&_0x463184[_0x3c454a(0x561,0x554)]['push'](this['commandToExecute']);}['isDestroyed'](){return![];}['destroy'](){function _0xaac70b(_0x694fc5,_0x1ca2b9){return _0x158252(_0x1ca2b9,_0x694fc5- -0x5a8);}if(defined(this[_0x57b2bf(-0x86,-0x38)])){var _0x2b9710;(_0x2b9710=this['commandToExecute'][_0xaac70b(-0xae,-0x137)])===null||_0x2b9710===void 0x0||_0x2b9710['destroy'](),this[_0xaac70b(-0xa3,-0xc2)]['shaderProgram']=undefined;}function _0x57b2bf(_0x5e3f64,_0x90e8d2){return _0x158252(_0x5e3f64,_0x90e8d2- -0x53d);}return destroyObject(this);}}function deepMerge(_0x416861,_0x320261){if(!_0x416861)return _0x320261;if(!_0x320261)return _0x416861;function _0x2e68d3(_0x30f5d3,_0x311f74){return _0x158252(_0x30f5d3,_0x311f74- -0x576);}const _0x45e1d7={..._0x320261},_0x28f95e=_0x45e1d7;for(const _0x30c0cb in _0x416861){if(Object['prototype']['hasOwnProperty'][_0x2e68d3(-0xfe,-0xc0)](_0x416861,_0x30c0cb)){const _0x5e6915=_0x416861[_0x30c0cb],_0x3bfef4=_0x320261[_0x30c0cb];if(Array['isArray'](_0x5e6915)){_0x28f95e[_0x30c0cb]=_0x5e6915['slice']();continue;}if(_0x5e6915&&typeof _0x5e6915==='object'){_0x28f95e[_0x30c0cb]=deepMerge(_0x5e6915,_0x3bfef4||{});continue;}_0x5e6915!==undefined&&(_0x28f95e[_0x30c0cb]=_0x5e6915);}}return _0x28f95e;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace[_0x158252(0x49a,0x4e4)];class WindParticlesComputing{constructor(_0x33d76e,_0x3264a9,_0x2698e2,_0x49cd42,_0x176837){this['context']=_0x33d76e,this['options']=_0x2698e2,this[_0x5651ff(0x37c,0x34a)]=_0x49cd42,this['windData']=_0x3264a9;function _0x5651ff(_0x32269a,_0x19bd4f){return _0x383bfc(_0x19bd4f,_0x32269a-0x3d);}function _0x23112b(_0x28f397,_0x15a731){return _0x383bfc(_0x15a731,_0x28f397- -0x5dc);}this['frameRate']=0x3c,this['frameRateAdjustment']=0x1;const _0xf92913={};_0xf92913[_0x23112b(-0x2c4,-0x2c6)]=_0x176837,_0xf92913[_0x23112b(-0x24c,-0x209)]=0x1,_0xf92913['quietPeriod']=0x0,this[_0x23112b(-0x24b,-0x285)]=new FrameRateMonitor(_0xf92913),this[_0x23112b(-0x1ca,-0x1e7)](),this['createWindTextures'](),this[_0x23112b(-0x27c,-0x256)](),this[_0x23112b(-0x26b,-0x2cb)]();}[_0x383bfc(0x3f7,0x412)](){const _0x690726=()=>{function _0x2cb929(_0x87c2dc,_0x878b83){return _0x5a39(_0x878b83- -0x3c,_0x87c2dc);}function _0x14af86(_0x276551,_0x538422){return _0x5a39(_0x276551- -0x298,_0x538422);}this[_0x14af86(-0x10c,-0x196)][_0x14af86(-0xeb,-0x8c)]>0x14&&(this['frameRate']=this[_0x14af86(-0x10c,-0x15f)][_0x2cb929(0x173,0x171)],this['frameRateAdjustment']=0x3c/Math['max'](this['frameRate'],0x1));};function _0x5d1541(_0x558a88,_0x2abea1){return _0x383bfc(_0x2abea1,_0x558a88- -0xc6);}_0x690726();const _0x274933=setInterval(_0x690726,0x3e8),_0x26a172=this['destroy']['bind'](this);this[_0x5d1541(0x2d2,0x265)]=()=>{clearInterval(_0x274933),_0x26a172();};}['createWindTextures'](){function _0x5450cb(_0x55ab8f,_0x5a5207){return _0x158252(_0x55ab8f,_0x5a5207- -0x437);}const _0xedea6c={};_0xedea6c[_0x337c78(0x336,0x39a)]=TextureMinificationFilter$1[_0x337c78(0x370,0x3c5)],_0xedea6c[_0x337c78(0x3d4,0x409)]=TextureMagnificationFilter$1['LINEAR'];function _0x337c78(_0x371516,_0x32c758){return _0x383bfc(_0x32c758,_0x371516-0x5);}const _0x579d0a={'context':this['context'],'width':this['windData'][_0x5450cb(0x121,0x113)],'height':this['windData'][_0x5450cb(0x35,0xab)],'pixelFormat':PixelFormat$1['RED'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this['options'][_0x5450cb(0x124,0xda)]??![],'sampler':new Sampler$1(_0xedea6c)};this['windTextures']={'U':new Texture$1({..._0x579d0a,'source':{'arrayBufferView':new Float32Array(this['windData']['u'][_0x337c78(0x3d9,0x448)])}}),'V':new Texture$1({..._0x579d0a,'source':{'arrayBufferView':new Float32Array(this[_0x337c78(0x3d1,0x385)]['v']['array'])}})};}[_0x158252(0x503,0x4f5)](){const _0x4845c6={};function _0x4f40e9(_0x4eacec,_0x25de58){return _0x383bfc(_0x25de58,_0x4eacec- -0x3f5);}_0x4845c6[_0x5490de(-0x17c,-0x119)]=TextureMinificationFilter$1[_0x5490de(-0x154,-0xe0)];function _0x5490de(_0x56aa1a,_0x4e2969){return _0x158252(_0x56aa1a,_0x4e2969- -0x5df);}_0x4845c6['magnificationFilter']=TextureMagnificationFilter$1['NEAREST'];const _0x23b5d6={'context':this[_0x4f40e9(-0x92,-0xf)],'width':this[_0x4f40e9(-0x9f,-0x69)]['particlesTextureSize'],'height':this[_0x4f40e9(-0x9f,-0x100)][_0x5490de(-0x149,-0xe3)],'pixelFormat':PixelFormat$1[_0x4f40e9(-0x45,-0x19)],'pixelDatatype':PixelDatatype$1[_0x4f40e9(0x23,0x6f)],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options']['particlesTextureSize']*this['options']['particlesTextureSize']*0x4)[_0x4f40e9(-0x9e,-0xb6)](0x0)},'sampler':new Sampler$1(_0x4845c6)};this['particlesTextures']={'previousParticlesPosition':new Texture$1(_0x23b5d6),'currentParticlesPosition':new Texture$1(_0x23b5d6),'nextParticlesPosition':new Texture$1(_0x23b5d6),'postProcessingPosition':new Texture$1(_0x23b5d6),'particlesSpeed':new Texture$1(_0x23b5d6)};}['destroyParticlesTextures'](){function _0x3b4f17(_0x15a83f,_0x489d69){return _0x158252(_0x15a83f,_0x489d69- -0x72);}Object[_0x3b4f17(0x47f,0x4a8)](this['particlesTextures'])['forEach'](_0x1272d=>_0x1272d['destroy']());}['createComputingPrimitives'](){function _0x23a94c(_0x32761c,_0x279989){return _0x383bfc(_0x279989,_0x32761c- -0x1b6);}function _0x5e5b7b(_0x8b6241,_0x2124e2){return _0x383bfc(_0x2124e2,_0x8b6241- -0x161);}this[_0x23a94c(0x181,0x1f5)]={'calculateSpeed':new CustomPrimitive({'commandType':_0x5e5b7b(0x2b8,0x239),'uniformMap':{'U':()=>this[_0x5e5b7b(0x296,0x2ea)]['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this[_0x5e5b7b(0x26b,0x1fb)]['u'][_0x23a94c(0x1c1,0x14f)],this[_0x5e5b7b(0x26b,0x239)]['u']['max']),'vRange':()=>new Cartesian2$1(this[_0x5e5b7b(0x26b,0x2d1)]['v']['min'],this[_0x23a94c(0x216,0x287)]['v'][_0x5e5b7b(0x20e,0x19b)]),'speedRange':()=>new Cartesian2$1(this['windData']['speed']['min'],this['windData']['speed']['max']),'currentParticlesPosition':()=>this['particlesTextures']['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x23f124(_0x5dc15a,_0x480ab5){return _0x5e5b7b(_0x5dc15a- -0x173,_0x480ab5);}function _0x2f9a1c(_0x5a0314,_0x25a4b4){return _0x23a94c(_0x25a4b4- -0x1fd,_0x5a0314);}return(this[_0x2f9a1c(-0x22,-0x74)][_0x2f9a1c(-0x21,-0x4d)]+0x32)*this['options']['speedFactor'];},'frameRateAdjustment':()=>this['frameRateAdjustment'],'dimension':()=>new Cartesian2$1(this['windData'][_0x5e5b7b(0x254,0x20a)],this['windData']['height']),'minimum':()=>new Cartesian2$1(this['windData'][_0x23a94c(0x15f,0x1a7)][_0x5e5b7b(0x218,0x1d4)],this['windData']['bounds'][_0x5e5b7b(0x2b5,0x31d)]),'maximum':()=>new Cartesian2$1(this[_0x23a94c(0x216,0x239)]['bounds']['east'],this['windData']['bounds'][_0x23a94c(0x160,0x1ce)])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{const _0x274ec4=this[_0x8be90c(-0x19e,-0x127)][_0x151a60(-0x56,0x2e)];function _0x8be90c(_0x59baec,_0x55d19c){return _0x23a94c(_0x55d19c- -0x2ec,_0x59baec);}function _0x151a60(_0x79fc51,_0x5b689a){return _0x5e5b7b(_0x5b689a- -0x1ac,_0x79fc51);}this[_0x151a60(0x8d,0x6e)]['previousParticlesPosition']=this['particlesTextures']['currentParticlesPosition'],this['particlesTextures']['currentParticlesPosition']=this['particlesTextures'][_0x151a60(0xfc,0xc0)],this['particlesTextures'][_0x8be90c(-0xe8,-0xd5)]=_0x274ec4,this[_0x8be90c(-0xf4,-0x16b)][_0x8be90c(-0x12b,-0xb8)][_0x151a60(0x76,0x63)]&&(this['primitives'][_0x151a60(0x15c,0xdd)]['commandToExecute'][_0x151a60(0x80,0x2f)]=this['particlesTextures'][_0x8be90c(-0x18b,-0x156)]);},'isDynamic':()=>this[_0x23a94c(0x1a0,0x183)][_0x23a94c(0x250,0x27f)]}),'updatePosition':new CustomPrimitive({'commandType':_0x5e5b7b(0x2b8,0x29b),'uniformMap':{'currentParticlesPosition':()=>this['particlesTextures'][_0x5e5b7b(0x279,0x245)],'particlesSpeed':()=>this[_0x5e5b7b(0x21a,0x28e)]['particlesSpeed']},'fragmentShaderSource':ShaderManager['getUpdatePositionShader'](),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':()=>{function _0x1a12fb(_0x9d451a,_0x906e4){return _0x23a94c(_0x9d451a-0x123,_0x906e4);}function _0x4c944c(_0x446046,_0x39b779){return _0x5e5b7b(_0x446046-0x2cb,_0x39b779);}this['primitives']['updatePosition']['commandToExecute']&&(this[_0x1a12fb(0x2a4,0x326)]['updatePosition']['commandToExecute'][_0x4c944c(0x4a6,0x4e8)]=this['particlesTextures']['nextParticlesPosition']);},'isDynamic':()=>this['options'][_0x5e5b7b(0x2a5,0x2ee)]}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':()=>this['particlesTextures']['nextParticlesPosition'],'particlesSpeed':()=>this['particlesTextures']['particlesSpeed'],'lonRange':()=>this[_0x23a94c(0x189,0x11b)][_0x23a94c(0x195,0x156)],'latRange':()=>this['viewerParameters']['latRange'],'dataLonRange':()=>new Cartesian2$1(this[_0x23a94c(0x216,0x1a8)]['bounds']['west'],this[_0x5e5b7b(0x26b,0x263)]['bounds'][_0x5e5b7b(0x1b3,0x1ce)]),'dataLatRange':()=>new Cartesian2$1(this['windData']['bounds']['south'],this['windData']['bounds']['north']),'randomCoefficient':function(){return Math['random']();},'dropRate':()=>this[_0x5e5b7b(0x1f5,0x26d)][_0x5e5b7b(0x28c,0x2c0)],'dropRateBump':()=>this['options'][_0x5e5b7b(0x201,0x25e)],'useViewerBounds':()=>this[_0x23a94c(0x1a0,0x1ec)][_0x23a94c(0x180,0x1f3)]},'fragmentShaderSource':ShaderManager['getPostProcessingPositionShader'](),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':()=>{function _0x36c179(_0x5ead6c,_0x13315b){return _0x23a94c(_0x13315b-0x23c,_0x5ead6c);}function _0x2d7ca1(_0xba0d8f,_0x2ed697){return _0x23a94c(_0x2ed697- -0x16f,_0xba0d8f);}this[_0x2d7ca1(-0x10,0x12)][_0x36c179(0x3cc,0x453)][_0x36c179(0x43a,0x3f6)]&&(this[_0x2d7ca1(0x26,0x12)]['postProcessingPosition']['commandToExecute'][_0x2d7ca1(0x84,0x17)]=this[_0x36c179(0x489,0x401)]['postProcessingPosition']);},'isDynamic':()=>this['options']['dynamic']})};}['reCreateWindTextures'](){function _0x560eb2(_0x1a43e0,_0x1f9fff){return _0x158252(_0x1f9fff,_0x1a43e0- -0x22);}this['windTextures']['U']['destroy'](),this['windTextures']['V']['destroy'](),this[_0x560eb2(0x4e5,0x46f)]();}['updateWindData'](_0x5505d7){this[_0x32143c(0x280,0x224)]=_0x5505d7;function _0x32143c(_0x4506a6,_0x15dab6){return _0x158252(_0x4506a6,_0x15dab6- -0x33d);}this['reCreateWindTextures']();}[_0x158252(0x531,0x4fe)](_0x275885){function _0x133369(_0x2d2d64,_0x2ee4e6){return _0x383bfc(_0x2ee4e6,_0x2d2d64- -0xff);}const _0x25d694=_0x275885[_0x133369(0x27d,0x2bc)]!==undefined&&_0x275885[_0x133369(0x27d,0x24f)]!==this[_0x133369(0x257,0x1e2)][_0x3c130c(0x31d,0x312)];this[_0x133369(0x257,0x284)]=deepMerge(_0x275885,this[_0x133369(0x257,0x22a)]);function _0x3c130c(_0x452c77,_0x20f9c0){return _0x158252(_0x20f9c0,_0x452c77- -0x1f4);}_0x25d694&&this['reCreateWindTextures']();}['processWindData'](_0x1e7427){const {array:_0x1a00bd}=_0x1e7427;let {min:_0x244bf9,max:_0x30c062}=_0x1e7427;const _0x14a463=new Float32Array(_0x1a00bd['length']);function _0x26e198(_0xf51d7d,_0x3b6abe){return _0x383bfc(_0xf51d7d,_0x3b6abe- -0x490);}function _0x4e17e3(_0x3f428f,_0x40a2e6){return _0x158252(_0x3f428f,_0x40a2e6- -0x457);}_0x244bf9===undefined&&(console[_0x26e198(-0x39,-0xba)](_0x26e198(-0x128,-0x107)),_0x244bf9=Math['min'](..._0x1a00bd));_0x30c062===undefined&&(console['warn']('max\x20is\x20undefined,\x20calculate\x20max'),_0x30c062=Math['max'](..._0x1a00bd));const _0x5b1b26=Math[_0x4e17e3(0x5b,0xad)](Math['abs'](_0x244bf9),Math['abs'](_0x30c062));for(let _0x35dff1=0x0;_0x35dff1<_0x1a00bd['length'];_0x35dff1++){const _0x3a3c60=_0x1a00bd[_0x35dff1]/_0x5b1b26;_0x14a463[_0x35dff1]=_0x3a3c60;}return _0x14a463;}[_0x383bfc(0x3a7,0x398)](){Object[_0xbeac0c(0x485,0x504)](this[_0xbeac0c(0x5f9,0x576)])['forEach'](_0x134a8d=>_0x134a8d['destroy']()),Object[_0x408a25(0x146,0xcf)](this['particlesTextures'])[_0xbeac0c(0x50f,0x573)](_0x59a2d0=>_0x59a2d0[_0xbeac0c(0x59b,0x517)]());function _0xbeac0c(_0x4af542,_0x58111f){return _0x158252(_0x4af542,_0x58111f- -0x16);}Object['values'](this[_0xbeac0c(0x4a7,0x4b6)])['forEach'](_0x4326d9=>_0x4326d9[_0xbeac0c(0x4b6,0x517)]());function _0x408a25(_0x357212,_0x3e1c9c){return _0x383bfc(_0x357212,_0x3e1c9c- -0x2b6);}this['frameRateMonitor'][_0x408a25(0x110,0xe2)]();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace[_0x158252(0x477,0x4e4)];class WindParticlesRendering{constructor(_0x57d14d,_0x445ad7,_0x312044,_0x2cad23){this['context']=_0x57d14d,this[_0x879b01(-0x256,-0x29b)]=_0x445ad7;function _0x879b01(_0x3475fa,_0xd32bec){return _0x383bfc(_0xd32bec,_0x3475fa- -0x5ac);}this[_0x879b01(-0x26d,-0x2a7)]=_0x312044,this[_0x879b01(-0x1e9,-0x1ee)]=_0x2cad23;(typeof this[_0x4afc9f(0x4f7,0x4c5)]['particlesTextureSize']!==_0x879b01(-0x251,-0x1cb)||this['options'][_0x4afc9f(0x508,0x4d4)]<=0x0)&&(console['error'](_0x879b01(-0x21a,-0x19c)),this[_0x4afc9f(0x4f7,0x543)]['particlesTextureSize']=0x100);this['colorTable']=this['createColorTableTexture'](),this['textures']=this[_0x879b01(-0x24e,-0x290)](),this['framebuffers']=this['createRenderingFramebuffers']();function _0x4afc9f(_0x4c83b1,_0x419eb5){return _0x383bfc(_0x419eb5,_0x4c83b1-0x1a1);}this['primitives']=this[_0x879b01(-0x29f,-0x283)]();}['createRenderingTextures'](){const _0x3be98f={};_0x3be98f['context']=this['context'],_0x3be98f['width']=this[_0x3169dd(0x4b8,0x4a2)]['drawingBufferWidth'],_0x3be98f['height']=this['context'][_0x5b274c(-0x149,-0x1bc)],_0x3be98f[_0x3169dd(0x49f,0x528)]=PixelFormat[_0x3169dd(0x505,0x497)],_0x3be98f['pixelDatatype']=PixelDatatype['UNSIGNED_BYTE'];const _0x538db6=_0x3be98f,_0x14a51d={};function _0x5b274c(_0x335947,_0x2bd752){return _0x158252(_0x335947,_0x2bd752- -0x731);}_0x14a51d['context']=this['context'],_0x14a51d['width']=this['context'][_0x5b274c(-0x286,-0x24a)],_0x14a51d['height']=this['context'][_0x3169dd(0x535,0x56f)],_0x14a51d[_0x3169dd(0x49f,0x426)]=PixelFormat[_0x5b274c(-0x25c,-0x26f)],_0x14a51d['pixelDatatype']=PixelDatatype['UNSIGNED_INT'];const _0x4b67ce=_0x14a51d;function _0x3169dd(_0x3b720c,_0x424ff4){return _0x158252(_0x424ff4,_0x3b720c- -0x40);}return{'segmentsColor':new Texture(_0x538db6),'segmentsDepth':new Texture(_0x4b67ce)};}[_0x383bfc(0x45c,0x40d)](){const _0xf25a3={};function _0x16a7e4(_0x2102d7,_0x22d6be){return _0x158252(_0x22d6be,_0x2102d7- -0x3a6);}_0xf25a3['context']=this['context'];function _0x2bdf86(_0x3f54fc,_0x1afb60){return _0x158252(_0x1afb60,_0x3f54fc- -0x75f);}return _0xf25a3['colorTextures']=[this[_0x2bdf86(-0x1cb,-0x197)][_0x2bdf86(-0x288,-0x2d4)]],_0xf25a3['depthTexture']=this['textures']['segmentsDepth'],{'segments':new Framebuffer(_0xf25a3)};}['destoryRenderingFramebuffers'](){Object['values'](this['framebuffers'])['forEach'](_0x2ed0fc=>{function _0xd133b2(_0x33f73f,_0x1199d9){return _0x5a39(_0x1199d9-0x99,_0x33f73f);}_0x2ed0fc[_0xd133b2(0x273,0x22c)]();});}['createColorTableTexture'](){function _0x1ccaf2(_0x1bf65b,_0x417e92){return _0x158252(_0x1bf65b,_0x417e92- -0x75d);}const _0x4198fd=new Float32Array(this['options']['colors']['flatMap'](_0x42b520=>{const _0x4e2950=Color$1['fromCssColorString'](_0x42b520);function _0x1dc897(_0x57ff7f,_0x5b3c67){return _0x5a39(_0x5b3c67- -0x350,_0x57ff7f);}return[_0x4e2950['red'],_0x4e2950['green'],_0x4e2950[_0x1dc897(-0x166,-0x17c)],_0x4e2950['alpha']];})),_0x2b7561={};_0x2b7561['minificationFilter']=TextureMinificationFilter['LINEAR'],_0x2b7561[_0x1ccaf2(-0x1f6,-0x1f9)]=TextureMagnificationFilter[_0x1ccaf2(-0x2bc,-0x25d)];function _0x1da1db(_0x38893c,_0x4612bb){return _0x383bfc(_0x4612bb,_0x38893c- -0xeb);}return _0x2b7561['wrapS']=TextureWrap['CLAMP_TO_EDGE'],_0x2b7561[_0x1ccaf2(-0x1e2,-0x240)]=TextureWrap['CLAMP_TO_EDGE'],new Texture({'context':this['context'],'width':this['options'][_0x1da1db(0x263,0x21f)]['length'],'height':0x1,'pixelFormat':PixelFormat['RGBA'],'pixelDatatype':PixelDatatype[_0x1ccaf2(-0x184,-0x1b0)],'sampler':new Sampler(_0x2b7561),'source':{'width':this['options']['colors']['length'],'height':0x1,'arrayBufferView':_0x4198fd}});}['createSegmentsGeometry'](){const _0x27c130=0x4,_0x3e01b4=this['options'][_0x13eb79(0x61,0xac)];let _0x485567=[];for(let _0x407558=0x0;_0x407558<_0x3e01b4;_0x407558++){for(let _0x1c0e75=0x0;_0x1c0e75<_0x3e01b4;_0x1c0e75++){for(let _0x2a304b=0x0;_0x2a304b<_0x27c130;_0x2a304b++){_0x485567[_0x158b27(0x505,0x4da)](_0x407558/_0x3e01b4),_0x485567['push'](_0x1c0e75/_0x3e01b4);}}}_0x485567=new Float32Array(_0x485567);const _0x197b42=this['options']['particlesTextureSize']**0x2;let _0x1c1ce0=[];for(let _0x3658ce=0x0;_0x3658ce<_0x197b42;_0x3658ce++){_0x1c1ce0[_0x158b27(0x505,0x506)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x1c1ce0=new Float32Array(_0x1c1ce0);let _0x574f58=[];for(let _0x1bc0b9=0x0,_0x2f51d5=0x0;_0x1bc0b9<_0x197b42;_0x1bc0b9++){_0x574f58['push'](_0x2f51d5+0x0,_0x2f51d5+0x1,_0x2f51d5+0x2,_0x2f51d5+0x2,_0x2f51d5+0x1,_0x2f51d5+0x3),_0x2f51d5+=_0x27c130;}_0x574f58=new Uint32Array(_0x574f58);const _0xc34fb3={};_0xc34fb3[_0x13eb79(0xa1,0x10e)]=ComponentDatatype['FLOAT'],_0xc34fb3['componentsPerAttribute']=0x2,_0xc34fb3['values']=_0x485567;const _0x399d4e={};function _0x158b27(_0x51a5e6,_0x3c8135){return _0x383bfc(_0x3c8135,_0x51a5e6-0x122);}_0x399d4e[_0x158b27(0x4c9,0x4fe)]=ComponentDatatype['FLOAT'],_0x399d4e[_0x13eb79(0xf6,0xee)]=0x3;function _0x13eb79(_0x28073f,_0x391018){return _0x158252(_0x391018,_0x28073f- -0x49b);}_0x399d4e[_0x158b27(0x4a7,0x488)]=_0x1c1ce0;const _0x58b448=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0xc34fb3),'normal':new GeometryAttribute(_0x399d4e)}),'indices':_0x574f58});return _0x58b448;}[_0x158252(0x5d6,0x555)](_0x4ff301){function _0x2c8e8e(_0x5a657c,_0x336061){return _0x383bfc(_0x5a657c,_0x336061-0x1a8);}const _0x170f53={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x4ff301};return Appearance[_0x2c8e8e(0x4f6,0x54d)](!![],![],_0x170f53);}['createPrimitives'](){const _0x4e0e49={};_0x4e0e49['st']=0x0,_0x4e0e49['normal']=0x1;const _0x5d91ea={};_0x5d91ea[_0x386eba(-0x8f,-0x10a)]=!![];const _0xd0e70e={};_0xd0e70e['enabled']=!![],_0xd0e70e['blendEquation']=WebGLRenderingContext['FUNC_ADD'],_0xd0e70e['blendFuncSource']=WebGLRenderingContext['SRC_ALPHA'],_0xd0e70e[_0x6805e6(0x1d6,0x1bc)]=WebGLRenderingContext[_0x6805e6(0x267,0x25b)];const _0x138851={};function _0x386eba(_0x29731b,_0x4289cb){return _0x158252(_0x29731b,_0x4289cb- -0x6a1);}_0x138851['viewport']=undefined,_0x138851['depthTest']=_0x5d91ea,_0x138851['depthMask']=!![],_0x138851['blending']=_0xd0e70e;const _0x3e2e49=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x4e0e49,'geometry':this[_0x6805e6(0x14d,0x1b8)](),'primitiveType':PrimitiveType[_0x386eba(-0x1f9,-0x1b3)],'uniformMap':{'previousParticlesPosition':()=>this['computing']['particlesTextures']['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing']['particlesTextures'][_0x6805e6(0x207,0x263)],'postProcessingPosition':()=>this['computing']['particlesTextures']['postProcessingPosition'],'particlesSpeed':()=>this[_0x6805e6(0x24e,0x24c)][_0x6805e6(0x211,0x204)][_0x386eba(-0x1b4,-0x1c0)],'frameRateAdjustment':()=>this['computing']['frameRateAdjustment'],'colorTable':()=>this['colorTable'],'domain':()=>{var _0x2c6e9c,_0x3b091f;const _0x49ff32=new Cartesian2(((_0x2c6e9c=this['options']['domain'])===null||_0x2c6e9c===void 0x0?void 0x0:_0x2c6e9c[_0x547282(0x4b5,0x52e)])??this['computing'][_0x1cd909(0x21c,0x1d7)]['speed']['min'],((_0x3b091f=this[_0x547282(0x4a9,0x50d)]['domain'])===null||_0x3b091f===void 0x0?void 0x0:_0x3b091f[_0x547282(0x4dd,0x526)])??this['computing'][_0x1cd909(0x21c,0x25c)]['speed'][_0x547282(0x5a8,0x526)]);function _0x1cd909(_0x146471,_0x2f456b){return _0x386eba(_0x2f456b,_0x146471-0x35c);}function _0x547282(_0x1ec423,_0x1e0527){return _0x6805e6(_0x1ec423,_0x1e0527-0x32e);}return _0x49ff32;},'displayRange':()=>{function _0x3edb2e(_0x2635c9,_0x583591){return _0x6805e6(_0x2635c9,_0x583591- -0x314);}function _0xba0b6d(_0x453e95,_0x79e3f4){return _0x6805e6(_0x79e3f4,_0x453e95- -0x25b);}var _0x2deb2f,_0x88ae6e;const _0x4c678f=new Cartesian2(((_0x2deb2f=this[_0x3edb2e(-0x114,-0x135)]['displayRange'])===null||_0x2deb2f===void 0x0?void 0x0:_0x2deb2f['min'])??this['computing']['windData']['speed'][_0xba0b6d(-0x5b,-0x19)],((_0x88ae6e=this['options']['displayRange'])===null||_0x88ae6e===void 0x0?void 0x0:_0x88ae6e[_0x3edb2e(-0xe1,-0x11c)])??this['computing']['windData'][_0xba0b6d(-0x92,-0x70)][_0x3edb2e(-0x194,-0x11c)]);return _0x4c678f;},'particleHeight':()=>this['options']['fixedHeight']||0x0,'aspect':()=>this['context']['drawingBufferWidth']/this[_0x386eba(-0x223,-0x1a9)]['drawingBufferHeight'],'pixelSize':()=>this['viewerParameters'][_0x386eba(-0x148,-0x1a6)],'lineWidth':()=>{const _0x41fe9f={};_0x41fe9f[_0x5db960(0x17d,0x134)]=0x1,_0x41fe9f[_0x5db960(0x10e,0x12c)]=0x2;const _0x146d58=this['options']['lineWidth']||_0x41fe9f;function _0x251a5f(_0x266351,_0x2b30e5){return _0x386eba(_0x266351,_0x2b30e5-0x6b3);}function _0x5db960(_0x13ad42,_0x41600e){return _0x6805e6(_0x13ad42,_0x41600e- -0xcc);}return new Cartesian2(_0x146d58[_0x5db960(0x1a2,0x134)],_0x146d58[_0x5db960(0x121,0x12c)]);},'lineLength':()=>{const _0x5e3ae2={};_0x5e3ae2[_0x2c4fed(0x440,0x3e1)]=0x14;function _0x2c4fed(_0x4ad748,_0x4deeb2){return _0x386eba(_0x4ad748,_0x4deeb2-0x576);}_0x5e3ae2['max']=0x64;function _0x1734d3(_0x12ca05,_0x2833da){return _0x386eba(_0x2833da,_0x12ca05-0x6aa);}const _0x4a2e6a=this['options'][_0x2c4fed(0x374,0x3eb)]||_0x5e3ae2;return new Cartesian2(_0x4a2e6a['min'],_0x4a2e6a[_0x2c4fed(0x461,0x3d9)]);},'is3D':()=>this[_0x386eba(-0x233,-0x1cd)]['sceneMode']===SceneMode[_0x6805e6(0x156,0x1ca)],'segmentsDepthTexture':()=>this[_0x6805e6(0x2b8,0x288)]['segmentsDepth']},'vertexShaderSource':ShaderManager[_0x386eba(-0x213,-0x1ef)](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this['createRawRenderState'](_0x138851)});function _0x6805e6(_0x5d7418,_0x3b7a2f){return _0x158252(_0x5d7418,_0x3b7a2f- -0x30c);}const _0x98f9b1={};return _0x98f9b1[_0x6805e6(0x1b0,0x22a)]=_0x3e2e49,_0x98f9b1;}[_0x158252(0x4a8,0x52a)](){function _0x245be8(_0x4529c3,_0x2e769c){return _0x383bfc(_0x4529c3,_0x2e769c-0x17);}const _0x2f78af=this[_0x245be8(0x35f,0x346)]();this['primitives'][_0x245be8(0x423,0x3b8)]['geometry']=_0x2f78af;const _0x44e1f3={};_0x44e1f3[_0x58f915(0x59,0xbf)]=this['context'],_0x44e1f3[_0x245be8(0x2f3,0x337)]=_0x2f78af,_0x44e1f3[_0x58f915(0x82,0xd4)]=this['primitives'][_0x58f915(0x110,0xfd)][_0x245be8(0x311,0x38f)],_0x44e1f3['bufferUsage']=BufferUsage['STATIC_DRAW'];const _0x4b6375=VertexArray['fromGeometry'](_0x44e1f3);function _0x58f915(_0x4fdbf4,_0x411140){return _0x158252(_0x4fdbf4,_0x411140- -0x439);}this[_0x245be8(0x39b,0x34e)]['segments']['commandToExecute']&&(this[_0x58f915(0x83,0x93)]['segments'][_0x58f915(0xca,0xcc)]['vertexArray']=_0x4b6375);}[_0x383bfc(0x3d4,0x3d5)](){function _0xed53ab(_0x2f82ee,_0x536426){return _0x158252(_0x2f82ee,_0x536426- -0x656);}function _0x14db56(_0x3efd12,_0x350867){return _0x158252(_0x350867,_0x3efd12- -0x23a);}this['colorTable'][_0x14db56(0x2f3,0x370)](),this[_0xed53ab(-0xdb,-0xdc)]=this['createColorTableTexture']();}[_0x383bfc(0x333,0x369)](_0x4a3966){function _0x602d(_0x595323,_0x526721){return _0x383bfc(_0x595323,_0x526721- -0x177);}const _0x26216f=_0x4a3966['colors']&&JSON['stringify'](_0x4a3966['colors'])!==JSON['stringify'](this[_0x602d(0x180,0x1df)]['colors']);this['options']=deepMerge(_0x4a3966,this['options']),_0x26216f&&this['onColorTableChange']();}[_0x158252(0x546,0x52d)](){Object['values'](this[_0x7f2ba4(-0x141,-0x13d)])['forEach'](_0x34b995=>{_0x34b995['destroy']();});function _0x39c709(_0x548924,_0x258f10){return _0x158252(_0x258f10,_0x548924- -0x9);}Object[_0x7f2ba4(-0xf4,-0x168)](this['primitives'])['forEach'](_0x12eba8=>{function _0x4a925c(_0x570451,_0x467bd){return _0x7f2ba4(_0x467bd-0x636,_0x570451);}_0x12eba8[_0x4a925c(0x522,0x555)]();});function _0x7f2ba4(_0x362953,_0x19d761){return _0x383bfc(_0x19d761,_0x362953- -0x479);}this[_0x39c709(0x571,0x4f5)][_0x7f2ba4(-0xe1,-0xa3)]();}}const {ClearCommand,Color,Pass}=mars3d__namespace['Cesium'];class WindParticleSystem{constructor(_0x2295d5,_0x409404,_0x1b5831,_0x189e81,_0x5e2b07){function _0x49a754(_0x5de890,_0x429cdc){return _0x383bfc(_0x5de890,_0x429cdc- -0x2ad);}this['context']=_0x2295d5,this['options']=_0x1b5831,this['viewerParameters']=_0x189e81,this[_0x49a754(0x11b,0x116)]=new WindParticlesComputing(_0x2295d5,_0x409404,_0x1b5831,_0x189e81,_0x5e2b07),this['rendering']=new WindParticlesRendering(_0x2295d5,_0x1b5831,_0x189e81,this['computing']),this['clearFramebuffers']();}['getPrimitives'](){const _0x101975=[this['computing'][_0x14dd29(0x2fd,0x341)]['calculateSpeed'],this[_0x21f549(0x105,0x145)][_0x14dd29(0x338,0x341)][_0x14dd29(0x33f,0x3a0)],this['computing'][_0x21f549(0x79,0xc3)]['postProcessingPosition'],this['rendering']['primitives'][_0x21f549(0xe3,0xa0)]];function _0x21f549(_0x41feb1,_0x39d575){return _0x158252(_0x39d575,_0x41feb1- -0x453);}function _0x14dd29(_0x3c758f,_0x199449){return _0x158252(_0x3c758f,_0x199449- -0x18b);}return _0x101975;}['clearFramebuffers'](){function _0x4a8be0(_0x707597,_0x7e0fe7){return _0x158252(_0x7e0fe7,_0x707597- -0x5c8);}const _0x188456=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});Object['keys'](this['rendering'][_0x4a8be0(-0xfb,-0x171)])['forEach'](_0x1a75de=>{function _0xde396f(_0xf1bcad,_0x3f8e88){return _0x4a8be0(_0x3f8e88-0x1d9,_0xf1bcad);}_0x188456['framebuffer']=this['rendering']['framebuffers'][_0x1a75de],_0x188456[_0xde396f(0xb3,0xc2)](this['context']);});}[_0x158252(0x4e2,0x552)](_0x210918){let _0x5d57aa=![];function _0x14d1ee(_0x3fc279,_0x4b0778){return _0x383bfc(_0x4b0778,_0x3fc279- -0x2cc);}_0x210918['particlesTextureSize']&&this[_0x2f5b1d(0x217,0x207)][_0x14d1ee(0x9b,0xf5)]!==_0x210918['particlesTextureSize']&&(_0x5d57aa=!![]);const _0xe6495b=deepMerge(_0x210918,this['options']);if(_0xe6495b[_0x2f5b1d(0x228,0x1c7)]<0x1)throw new Error(_0x2f5b1d(0x2db,0x30f));this['options']=_0xe6495b,this[_0x2f5b1d(0x26d,0x1fc)][_0x14d1ee(0x9d,0xf9)](_0x210918);function _0x2f5b1d(_0x1571e1,_0x257157){return _0x158252(_0x257157,_0x1571e1- -0x2d4);}this[_0x2f5b1d(0x284,0x2a0)][_0x2f5b1d(0x22a,0x240)](_0x210918),_0x5d57aa&&(this[_0x14d1ee(0xf7,0x84)]['destroyParticlesTextures'](),this['computing'][_0x2f5b1d(0x221,0x273)](),this[_0x14d1ee(0xe0,0xfa)][_0x14d1ee(0xc9,0xa8)]());}[_0x158252(0x522,0x4dc)](_0x24c80a){this['viewerParameters']=_0x24c80a;function _0x3c5977(_0x1c2e8f,_0x74ef29){return _0x383bfc(_0x1c2e8f,_0x74ef29- -0x5ec);}this[_0x3c5977(-0x29d,-0x229)]['viewerParameters']=_0x24c80a,this['rendering']['viewerParameters']=_0x24c80a;}[_0x383bfc(0x392,0x398)](){function _0x291836(_0x457e52,_0x5043ee){return _0x158252(_0x5043ee,_0x457e52- -0x78);}this[_0x3cad20(0x56b,0x533)]['destroy']();function _0x3cad20(_0x4ef08d,_0xee2ffc){return _0x383bfc(_0x4ef08d,_0xee2ffc-0x170);}this['rendering'][_0x291836(0x4b5,0x433)]();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x40e39d={};_0x40e39d['min']=0x1,_0x40e39d['max']=0x2;const _0x169fe3={};_0x169fe3['min']=0x14,_0x169fe3[_0x383bfc(0x3bb,0x36f)]=0x64;const _0x5a7810={};_0x5a7810['particlesTextureSize']=0x64,_0x5a7810['fixedHeight']=0x0,_0x5a7810['lineWidth']=_0x40e39d,_0x5a7810['lineLength']=_0x169fe3,_0x5a7810['speedFactor']=0x1,_0x5a7810['dropRate']=0.003,_0x5a7810[_0x158252(0x542,0x4f7)]=0.001,_0x5a7810[_0x158252(0x4c2,0x4e3)]=[_0x383bfc(0x407,0x384)],_0x5a7810['flipY']=![],_0x5a7810['dynamic']=!![];const DEF_OPTIONS=_0x5a7810;class WindLayer extends BaseLayer$1{constructor(_0x5805d2={}){_0x5805d2={...DEF_OPTIONS,..._0x5805d2},super(_0x5805d2);function _0x894426(_0x193533,_0x57227b){return _0x158252(_0x57227b,_0x193533- -0xd3);}this[_0x894426(0x3d2,0x3bc)](_0x5805d2,_0x5805d2);}get[_0x383bfc(0x38e,0x3ab)](){return this['primitives'];}get['data'](){return this['options']['data'];}set['data'](_0x3cfeaa){this[_0x41e936(-0x282,-0x1fb)][_0x33a236(-0x115,-0xe3)]=_0x3cfeaa;function _0x41e936(_0x513008,_0x41e3b6){return _0x158252(_0x513008,_0x41e3b6- -0x6e6);}function _0x33a236(_0x2358b3,_0x2945e9){return _0x383bfc(_0x2945e9,_0x2358b3- -0x504);}this['setData'](_0x3cfeaa);}get['colors'](){function _0x270c99(_0x211d30,_0x2ad186){return _0x383bfc(_0x211d30,_0x2ad186- -0x3e5);}function _0xeaf92e(_0x21b4f9,_0x2dcbcc){return _0x158252(_0x2dcbcc,_0x21b4f9- -0x37c);}return this[_0x270c99(-0x3e,-0x8f)][_0x270c99(-0x68,-0x97)];}set['colors'](_0xfb592a){function _0x36fa11(_0x19cb21,_0x254c41){return _0x158252(_0x19cb21,_0x254c41- -0x3bf);}function _0x45762b(_0x5520b9,_0x22830c){return _0x383bfc(_0x5520b9,_0x22830c- -0x5e6);}this[_0x36fa11(0x12d,0x12c)][_0x45762b(-0x219,-0x298)]=_0xfb592a;const _0x223257={};_0x223257[_0x45762b(-0x247,-0x298)]=_0xfb592a,this[_0x36fa11(0xda,0xe6)](this['options'],_0x223257);}['_showHook'](_0x20586b){function _0x512a6c(_0x2b4a6c,_0x415fd7){return _0x383bfc(_0x2b4a6c,_0x415fd7- -0x5a8);}_0x20586b?this[_0x512a6c(-0x278,-0x22a)]():this['_removedHook']();}['_mountedHook'](){}[_0x158252(0x518,0x513)](){this[_0x39b7c0(-0x14d,-0xf1)]=this[_0x260c2c(-0x103,-0x94)]['scene'],this[_0x260c2c(-0x86,-0xf7)]=this['_map'][_0x39b7c0(-0x25,-0x86)];this[_0x260c2c(-0x19d,-0x124)]['data']&&this['setData'](this[_0x39b7c0(-0x3d,-0xb3)][_0x39b7c0(0x11,-0x1a)]);function _0x39b7c0(_0x506945,_0x18d7a5){return _0x383bfc(_0x506945,_0x18d7a5- -0x409);}if(!this[_0x260c2c(-0x50,-0xae)]||!this[_0x39b7c0(-0xb3,-0xc4)])return;this[_0x39b7c0(-0x4d,-0xca)]={'lonRange':new Cesium$1['Cartesian2'](-0xb4,0xb4),'latRange':new Cesium$1['Cartesian2'](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this['scene']['mode']},this['updateViewerParameters'](),this['particleSystem']=new WindParticleSystem(this['scene']['context'],this[_0x260c2c(-0xcd,-0xae)],this[_0x260c2c(-0x17d,-0x124)],this[_0x39b7c0(-0x124,-0xca)],this[_0x260c2c(-0x18f,-0x162)]);function _0x260c2c(_0x552ce3,_0x3a7b85){return _0x383bfc(_0x552ce3,_0x3a7b85- -0x47a);}this['primitives']=this['particleSystem'][_0x39b7c0(-0x56,-0x69)](),this['primitives'][_0x39b7c0(-0x5,-0x15)](_0x31639e=>{function _0xeadc1d(_0x421f83,_0x1e6f24){return _0x260c2c(_0x421f83,_0x1e6f24-0x48);}this['scene']['primitives'][_0xeadc1d(0x7,-0x5f)](_0x31639e);}),this['camera'][_0x39b7c0(-0xac,-0xad)]=0.01,this[_0x260c2c(-0x120,-0xf7)][_0x260c2c(-0x7a,-0xcd)]['addEventListener'](this[_0x39b7c0(0x29,-0x18)]['bind'](this)),this['scene']['morphComplete'][_0x39b7c0(-0x23,-0x2a)](this[_0x39b7c0(-0x9c,-0x18)]['bind'](this)),window[_0x260c2c(-0x115,-0x9b)]('resize',this['updateViewerParameters']['bind'](this));}['_removedHook'](){function _0x3022c4(_0x528833,_0x43223d){return _0x158252(_0x528833,_0x43223d- -0x1c2);}this[_0x2bd5bb(0x176,0x191)]['changed']['removeEventListener'](this['updateViewerParameters']['bind'](this)),this[_0x2bd5bb(0xbd,0x126)]['morphComplete'][_0x3022c4(0x2e7,0x311)](this['updateViewerParameters']['bind'](this)),window['removeEventListener'](_0x3022c4(0x388,0x349),this[_0x3022c4(0x34f,0x3c4)][_0x2bd5bb(0xfe,0x116)](this));this[_0x2bd5bb(0x127,0x145)]&&(this[_0x3022c4(0x2b8,0x30a)][_0x2bd5bb(0x234,0x202)](_0x473755=>{function _0x1f024f(_0x6d9d2,_0x46be08){return _0x3022c4(_0x6d9d2,_0x46be08-0x1f5);}this['scene'][_0x1f024f(0x4b5,0x4ff)]['remove'](_0x473755);}),delete this[_0x3022c4(0x2dc,0x30a)]);function _0x2bd5bb(_0x1dccf6,_0x2b8752){return _0x158252(_0x1dccf6,_0x2b8752- -0x387);}this['particleSystem']&&(this[_0x3022c4(0x396,0x398)][_0x2bd5bb(0x1d6,0x1a6)](),delete this['particleSystem']);}[_0x158252(0x5bc,0x570)](_0x1cf143,_0x29ad48){function _0x1f7159(_0x2fd907,_0x3a6986){return _0x158252(_0x2fd907,_0x3a6986- -0x417);}this['windData']=this['processWindData'](_0x1cf143);if(_0x29ad48){this['_removedHook'](),this['_addedHook']();return;}function _0x359eea(_0x402884,_0x5c45e0){return _0x158252(_0x402884,_0x5c45e0- -0x35);}this['particleSystem']?(this[_0x1f7159(0x119,0x143)][_0x359eea(0x592,0x523)]['updateWindData'](this['windData']),this['scene']['requestRender']()):this['_addedHook']();}[_0x383bfc(0x292,0x310)](_0x301fd4,_0xb7a9cc){function _0x1dc8eb(_0x37ae84,_0x170cf6){return _0x158252(_0x37ae84,_0x170cf6- -0x421);}function _0x1961ae(_0x2a411,_0x58632e){return _0x383bfc(_0x58632e,_0x2a411- -0x277);}this[_0x1dc8eb(0x1ba,0x139)]&&(this[_0x1dc8eb(0xbe,0x139)][_0x1dc8eb(0x1a9,0x131)](_0xb7a9cc),this[_0x1961ae(0xa1,0x8f)]['requestRender']());}['processWindData'](_0x1a8fb7){var _0x26b5e9,_0x3d104f;const _0x4c4cc9={..._0x1a8fb7},_0x1ae8c9=_0x4c4cc9;function _0x9203e0(_0x46cce0,_0x240a17){return _0x158252(_0x46cce0,_0x240a17- -0x749);}!_0x1ae8c9['height']&&_0x1ae8c9['rows']&&(_0x1ae8c9[_0x9203e0(-0x1f8,-0x267)]=_0x1ae8c9[_0x35adcd(0x45a,0x47b)]);!_0x1ae8c9['width']&&_0x1ae8c9['cols']&&(_0x1ae8c9['width']=_0x1ae8c9['cols']);function _0x35adcd(_0x262804,_0x5587e7){return _0x383bfc(_0x5587e7,_0x262804-0xa7);}!_0x1ae8c9[_0x9203e0(-0x2ce,-0x29f)]&&(_0x1ae8c9['bounds']={'west':_0x1ae8c9[_0x9203e0(-0x267,-0x203)],'south':_0x1ae8c9['ymin'],'east':_0x1ae8c9['xmax'],'north':_0x1ae8c9[_0x35adcd(0x44d,0x472)]});if(!_0x1ae8c9['u']){const _0x2e8834={};_0x2e8834['array']=_0x1a8fb7['udata'],_0x2e8834[_0x35adcd(0x41e,0x3a3)]=_0x1a8fb7['umin'],_0x2e8834[_0x9203e0(-0x1e6,-0x245)]=_0x1a8fb7['umax'],_0x1ae8c9['u']=_0x2e8834;}if(!_0x1ae8c9['v']){const _0x1af8f1={};_0x1af8f1[_0x9203e0(-0x1d2,-0x1e0)]=_0x1a8fb7[_0x35adcd(0x3d7,0x396)],_0x1af8f1['min']=_0x1a8fb7['vmin'],_0x1af8f1[_0x9203e0(-0x1cc,-0x245)]=_0x1a8fb7['vmax'],_0x1ae8c9['v']=_0x1af8f1;}if(((_0x26b5e9=_0x1ae8c9[_0x35adcd(0x3e7,0x38b)])===null||_0x26b5e9===void 0x0?void 0x0:_0x26b5e9['min'])===undefined||((_0x3d104f=_0x1ae8c9[_0x9203e0(-0x1fb,-0x274)])===null||_0x3d104f===void 0x0?void 0x0:_0x3d104f['max'])===undefined||_0x1ae8c9['speed'][_0x9203e0(-0x159,-0x1e0)]===undefined){const _0x1d5290={'array':new Float32Array(_0x1ae8c9['u']['array'][_0x35adcd(0x49d,0x44b)]),'min':Number[_0x35adcd(0x3fb,0x474)],'max':Number['MIN_VALUE']};for(let _0x12b5cd=0x0;_0x12b5cd<_0x1ae8c9['u'][_0x35adcd(0x47b,0x496)][_0x35adcd(0x49d,0x454)];_0x12b5cd++){_0x1d5290['array'][_0x12b5cd]=Math[_0x9203e0(-0x23d,-0x205)](_0x1ae8c9['u'][_0x35adcd(0x47b,0x4e1)][_0x12b5cd]*_0x1ae8c9['u']['array'][_0x12b5cd]+_0x1ae8c9['v']['array'][_0x12b5cd]*_0x1ae8c9['v']['array'][_0x12b5cd]),_0x1d5290[_0x35adcd(0x47b,0x41c)][_0x12b5cd]!==0x0&&(_0x1d5290['min']=Math['min'](_0x1d5290[_0x9203e0(-0x1fa,-0x23d)],_0x1d5290[_0x9203e0(-0x204,-0x1e0)][_0x12b5cd]),_0x1d5290[_0x9203e0(-0x29a,-0x245)]=Math[_0x9203e0(-0x25a,-0x245)](_0x1d5290['max'],_0x1d5290['array'][_0x12b5cd]));}_0x1ae8c9['speed']=_0x1d5290;}return _0x1ae8c9;}[_0x158252(0x5ed,0x586)](){var _0x1862d5;const _0x5e5534=this['scene'];if(!_0x5e5534)return;const _0x4dc3ed=_0x5e5534['canvas'],_0x5e8116={};_0x5e8116['x']=0x0,_0x5e8116['y']=0x0;const _0x78d32c={};_0x78d32c['x']=0x0,_0x78d32c['y']=_0x4dc3ed[_0x279a9b(0x1c5,0x211)];const _0x34956a={};_0x34956a['x']=_0x4dc3ed[_0x279a9b(0x215,0x202)],_0x34956a['y']=0x0;const _0x236394={};_0x236394['x']=_0x4dc3ed['clientWidth'],_0x236394['y']=_0x4dc3ed['clientHeight'];const _0xafe3ed=[_0x5e8116,_0x78d32c,_0x34956a,_0x236394];function _0x472eef(_0x5db6cb,_0x45ae8a){return _0x158252(_0x45ae8a,_0x5db6cb- -0xa6);}let _0x438439=0xb4;function _0x279a9b(_0x11d811,_0x1dd719){return _0x158252(_0x11d811,_0x1dd719- -0x301);}let _0x16a4b7=-0xb4,_0x47c386=0x5a,_0x3ecef2=-0x5a,_0x12fe8d=![];for(const _0xd3fa6b of _0xafe3ed){const _0xf21b45=_0x5e5534[_0x279a9b(0x1e3,0x217)]['pickEllipsoid'](new Cesium$1[(_0x472eef(0x4f2,0x4e5))](_0xd3fa6b['x'],_0xd3fa6b['y']),_0x5e5534['globe'][_0x279a9b(0x2ac,0x275)]);if(!_0xf21b45){_0x12fe8d=!![];break;}const _0x883ed0=_0x5e5534['globe']['ellipsoid']['cartesianToCartographic'](_0xf21b45),_0x172f18=Cesium$1['Math'][_0x472eef(0x4ab,0x44c)](_0x883ed0[_0x279a9b(0x265,0x1fc)]),_0x13db15=Cesium$1['Math']['toDegrees'](_0x883ed0[_0x472eef(0x432,0x3ea)]);_0x438439=Math['min'](_0x438439,_0x172f18),_0x16a4b7=Math['max'](_0x16a4b7,_0x172f18),_0x47c386=Math['min'](_0x47c386,_0x13db15),_0x3ecef2=Math[_0x472eef(0x45e,0x4b9)](_0x3ecef2,_0x13db15);}if(!_0x12fe8d){const _0x198260=new Cesium$1['Cartesian2'](Math[_0x472eef(0x45e,0x405)](this['windData'][_0x472eef(0x404,0x3c5)]['west'],_0x438439),Math[_0x472eef(0x466,0x4d3)](this['windData']['bounds']['east'],_0x16a4b7)),_0x392069=new Cesium$1['Cartesian2'](Math[_0x472eef(0x45e,0x48d)](this[_0x279a9b(0x29c,0x260)]['bounds']['south'],_0x47c386),Math[_0x279a9b(0x213,0x20b)](this[_0x472eef(0x4bb,0x4fe)]['bounds']['north'],_0x3ecef2)),_0x34560e=(_0x198260['y']-_0x198260['x'])*0.05,_0x1e7c38=(_0x392069['y']-_0x392069['x'])*0.05;_0x198260['x']=Math['max'](this[_0x279a9b(0x2e1,0x260)]['bounds']['west'],_0x198260['x']-_0x34560e),_0x198260['y']=Math['min'](this['windData'][_0x472eef(0x404,0x458)][_0x472eef(0x403,0x3db)],_0x198260['y']+_0x34560e),_0x392069['x']=Math[_0x472eef(0x45e,0x438)](this[_0x472eef(0x4bb,0x4b6)]['bounds']['south'],_0x392069['x']-_0x1e7c38),_0x392069['y']=Math[_0x279a9b(0x216,0x20b)](this['windData'][_0x472eef(0x404,0x3e2)]['north'],_0x392069['y']+_0x1e7c38),this['viewerParameters']['lonRange']=_0x198260,this[_0x279a9b(0x22a,0x1d3)]['latRange']=_0x392069;const _0x2ade05=this['windData']['bounds']['east']-this[_0x279a9b(0x2c4,0x260)]['bounds'][_0x279a9b(0x24c,0x20d)],_0x43b16c=this['windData']['bounds']['north']-this[_0x472eef(0x4bb,0x4f9)]['bounds'][_0x472eef(0x505,0x525)],_0x843f6b=(_0x198260['y']-_0x198260['x'])/_0x2ade05,_0x1c9989=(_0x392069['y']-_0x392069['x'])/_0x43b16c,_0x29e372=Math[_0x472eef(0x466,0x474)](_0x843f6b,_0x1c9989),_0x4cb2ee=0x3e8*_0x29e372;_0x4cb2ee>0x0&&(this['viewerParameters'][_0x472eef(0x455,0x4bd)]=Math[_0x472eef(0x45e,0x4cd)](0x0,Math[_0x472eef(0x466,0x435)](0x3e8,_0x4cb2ee)));}this[_0x279a9b(0x188,0x1d3)][_0x279a9b(0x133,0x19e)]=this['scene']['mode'],(_0x1862d5=this['particleSystem'])===null||_0x1862d5===void 0x0||_0x1862d5['applyViewerParameters'](this['viewerParameters']);}['getDataAtLonLat'](_0x4f4b74,_0x8a70f6){const {bounds:_0x5c1a82,width:_0x8549fa,height:_0x34daa1,u:_0x3a9026,v:_0x5777e2,speed:_0x1f2332}=this['windData'],{flipY:_0x5d8909}=this['options'];if(_0x4f4b74<_0x5c1a82[_0x390acb(0x1c0,0x13b)]||_0x4f4b74>_0x5c1a82[_0x390acb(0x15b,0x11e)]||_0x8a70f6<_0x5c1a82[_0x390acb(0x25d,0x21d)]||_0x8a70f6>_0x5c1a82['north'])return null;const _0x4b8ff2=(_0x4f4b74-_0x5c1a82['west'])/(_0x5c1a82[_0x390acb(0x15b,0x124)]-_0x5c1a82['west'])*(_0x8549fa-0x1);let _0x39889a=(_0x8a70f6-_0x5c1a82[_0x390acb(0x25d,0x2e5)])/(_0x5c1a82['north']-_0x5c1a82['south'])*(_0x34daa1-0x1);_0x5d8909&&(_0x39889a=_0x34daa1-0x1-_0x39889a);const _0x2201ed=Math['floor'](_0x4b8ff2),_0x29b312=Math[_0x390acb(0x1d6,0x191)](_0x39889a),_0x54cb69=Math['floor'](_0x4b8ff2);function _0x390acb(_0x5a8dc1,_0x5a2e9b){return _0x158252(_0x5a2e9b,_0x5a8dc1- -0x34e);}const _0x1a5128=Math['min'](_0x54cb69+0x1,_0x8549fa-0x1),_0x4e8bc4=Math[_0x2897d0(0x2cb,0x31d)](_0x39889a),_0x5a40d0=Math['min'](_0x4e8bc4+0x1,_0x34daa1-0x1),_0x378f2d=_0x4b8ff2-_0x54cb69,_0x313fa3=_0x39889a-_0x4e8bc4,_0x158619=_0x29b312*_0x8549fa+_0x2201ed,_0x34f15a=_0x4e8bc4*_0x8549fa+_0x54cb69,_0x120c1a=_0x4e8bc4*_0x8549fa+_0x1a5128,_0x2ec622=_0x5a40d0*_0x8549fa+_0x54cb69,_0x43434e=_0x5a40d0*_0x8549fa+_0x1a5128,_0x2ace16=_0x3a9026['array'][_0x34f15a],_0x1b8bcf=_0x3a9026['array'][_0x120c1a],_0x4a8fb9=_0x3a9026['array'][_0x2ec622],_0x1baaf1=_0x3a9026['array'][_0x43434e],_0x51a804=(0x1-_0x378f2d)*(0x1-_0x313fa3)*_0x2ace16+_0x378f2d*(0x1-_0x313fa3)*_0x1b8bcf+(0x1-_0x378f2d)*_0x313fa3*_0x4a8fb9+_0x378f2d*_0x313fa3*_0x1baaf1,_0x113ddb=_0x5777e2[_0x390acb(0x21b,0x24c)][_0x34f15a],_0x889d3e=_0x5777e2['array'][_0x120c1a],_0x3e0ccc=_0x5777e2[_0x2897d0(0x397,0x362)][_0x2ec622],_0x2636cd=_0x5777e2[_0x390acb(0x21b,0x1d4)][_0x43434e],_0x445bbe=(0x1-_0x378f2d)*(0x1-_0x313fa3)*_0x113ddb+_0x378f2d*(0x1-_0x313fa3)*_0x889d3e+(0x1-_0x378f2d)*_0x313fa3*_0x3e0ccc+_0x378f2d*_0x313fa3*_0x2636cd;function _0x2897d0(_0xb4cdf6,_0x1ed6a4){return _0x158252(_0xb4cdf6,_0x1ed6a4- -0x207);}const _0x27b98f=Math['sqrt'](_0x51a804*_0x51a804+_0x445bbe*_0x445bbe),_0x5fd3e1={};_0x5fd3e1['u']=_0x3a9026[_0x2897d0(0x2f8,0x362)][_0x158619],_0x5fd3e1['v']=_0x5777e2[_0x2897d0(0x2ee,0x362)][_0x158619],_0x5fd3e1['speed']=_0x1f2332[_0x390acb(0x21b,0x193)][_0x158619];const _0x1f6857={};_0x1f6857['u']=_0x51a804,_0x1f6857['v']=_0x445bbe,_0x1f6857[_0x390acb(0x187,0x1ac)]=_0x27b98f;const _0x1e3cb7={};return _0x1e3cb7['original']=_0x5fd3e1,_0x1e3cb7['interpolated']=_0x1f6857,_0x1e3cb7;}}mars3d__namespace['LayerUtil']['register']('wind',WindLayer),mars3d__namespace['layer'][_0x158252(0x563,0x596)]=WindLayer;class CanvasParticle{constructor(){function _0x1e53ba(_0x10f54d,_0x57f53a){return _0x158252(_0x57f53a,_0x10f54d- -0x472);}this['lng']=null,this['lat']=null,this['tlng']=null,this[_0x1e53ba(0x74,0x9a)]=null,this['age']=null,this['speed']=null;}['destroy'](){for(const _0x326eda in this){delete this[_0x326eda];}}}class CanvasWindField{constructor(_0x177cd9){this['setOptions'](_0x177cd9);}get['speedRate'](){return this['_speedRate'];}set[_0x383bfc(0x2d9,0x335)](_0xafc54e){function _0x3e215c(_0x34e97d,_0x1cdebe){return _0x383bfc(_0x1cdebe,_0x34e97d- -0x27c);}function _0x46990b(_0x514038,_0x5ad987){return _0x383bfc(_0x514038,_0x5ad987- -0x1e1);}this[_0x3e215c(0x16c,0x1c9)]=(0x64-(_0xafc54e>0x63?0x63:_0xafc54e))*0x64,this[_0x46990b(0x103,0x168)]=[(this['xmax']-this[_0x3e215c(0x135,0xe0)])/this[_0x3e215c(0x16c,0xfc)],(this['ymax']-this['ymin'])/this[_0x46990b(0x26f,0x207)]];}get['maxAge'](){function _0xac17be(_0x1ac7b0,_0xda0a75){return _0x383bfc(_0x1ac7b0,_0xda0a75- -0x5);}return this[_0xac17be(0x3a8,0x368)];}set[_0x158252(0x4c6,0x537)](_0x401f8b){this['_maxAge']=_0x401f8b;}['setOptions'](_0x57a1d8){this['options']=_0x57a1d8,this['maxAge']=_0x57a1d8['maxAge']||0x78,this['speedRate']=_0x57a1d8[_0x4702d9(0x1ed,0x230)]||0x32;function _0x4702d9(_0x4ba27c,_0x2da363){return _0x158252(_0x4ba27c,_0x2da363- -0x29a);}this[_0x44596d(-0x150,-0x104)]=[];const _0x4faff0=_0x57a1d8[_0x44596d(-0x153,-0x14c)]||0x1000;function _0x44596d(_0x1fc5b3,_0x4b9b24){return _0x383bfc(_0x4b9b24,_0x1fc5b3- -0x55f);}for(let _0x14b74a=0x0;_0x14b74a<_0x4faff0;_0x14b74a++){const _0x416cef=this[_0x4702d9(0x379,0x2f3)](new CanvasParticle());this[_0x4702d9(0x2d7,0x30a)][_0x44596d(-0x17c,-0x119)](_0x416cef);}}[_0x158252(0x4c8,0x521)](_0x5ecbd){this['rows']=_0x5ecbd['rows'],this[_0x3eacfb(0x3dd,0x39f)]=_0x5ecbd['cols'],this[_0x3c4fd7(0x4b8,0x468)]=_0x5ecbd[_0x3eacfb(0x46b,0x4ec)],this['xmax']=_0x5ecbd[_0x3c4fd7(0x406,0x431)];function _0x3eacfb(_0x33298b,_0x4ca6a9){return _0x158252(_0x4ca6a9,_0x33298b- -0xdb);}this['ymin']=_0x5ecbd['ymin'],this[_0x3c4fd7(0x4ba,0x45d)]=_0x5ecbd[_0x3eacfb(0x460,0x4d0)],this[_0x3eacfb(0x475,0x45b)]=[];const _0x228f46=_0x5ecbd[_0x3c4fd7(0x48b,0x441)];function _0x3c4fd7(_0x78e43f,_0x310418){return _0x158252(_0x78e43f,_0x310418- -0xde);}const _0xfd9349=_0x5ecbd[_0x3eacfb(0x3ea,0x3e8)];let _0x4df551=![];_0x228f46[_0x3eacfb(0x4b0,0x505)]===this['rows']&&_0x228f46[0x0][_0x3c4fd7(0x4b6,0x4ad)]===this[_0x3eacfb(0x3dd,0x36e)]&&(_0x4df551=!![]);let _0x14cf8f=0x0,_0x28feb9=null,_0x2f71f2=null;for(let _0x4f445c=0x0;_0x4f445c<this[_0x3c4fd7(0x46d,0x46a)];_0x4f445c++){_0x28feb9=[];for(let _0x4069c5=0x0;_0x4069c5<this[_0x3c4fd7(0x39b,0x3da)];_0x4069c5++,_0x14cf8f++){_0x4df551?_0x2f71f2=this['_calcUV'](_0x228f46[_0x4f445c][_0x4069c5],_0xfd9349[_0x4f445c][_0x4069c5]):_0x2f71f2=this['_calcUV'](_0x228f46[_0x14cf8f],_0xfd9349[_0x14cf8f]),_0x28feb9['push'](_0x2f71f2);}this['grid'][_0x3c4fd7(0x4e1,0x49a)](_0x28feb9);}!this['options']['flipY']&&this[_0x3eacfb(0x475,0x48f)][_0x3c4fd7(0x4d3,0x480)]();}['clear'](){delete this[_0x41a8ed(0x41c,0x411)],delete this['cols'],delete this['xmin'],delete this['xmax'],delete this['ymin'],delete this['ymax'];function _0x41a8ed(_0x131bcd,_0x4f26e5){return _0x383bfc(_0x4f26e5,_0x131bcd-0x69);}delete this['grid'],delete this['particles'];}['toGridXY'](_0x4ad48e,_0x46e012){const _0x4f2a0f=(_0x4ad48e-this['xmin'])/(this[_0x282b24(-0x70,-0xe2)]-this[_0x43a0d1(0x492,0x449)])*(this['cols']-0x1);function _0x43a0d1(_0x5735f3,_0x208b55){return _0x158252(_0x208b55,_0x5735f3- -0xb4);}function _0x282b24(_0x4a6385,_0x58b22a){return _0x158252(_0x4a6385,_0x58b22a- -0x5f1);}const _0x416a61=(this[_0x43a0d1(0x487,0x503)]-_0x46e012)/(this['ymax']-this[_0x282b24(-0x12b,-0x114)])*(this['rows']-0x1);return[_0x4f2a0f,_0x416a61];}[_0x383bfc(0x370,0x35a)](_0x3ee71f,_0x1bfec0){if(_0x3ee71f<0x0||_0x3ee71f>=this['cols']||_0x1bfec0>=this['rows'])return[0x0,0x0,0x0];const _0x60ee91=Math[_0x5271f2(0x2cd,0x25e)](_0x3ee71f),_0x57c59c=Math['floor'](_0x1bfec0);function _0x5b07d1(_0x18ec54,_0x177570){return _0x383bfc(_0x177570,_0x18ec54- -0x5dc);}if(_0x60ee91===_0x3ee71f&&_0x57c59c===_0x1bfec0)return this[_0x5b07d1(-0x221,-0x290)][_0x1bfec0][_0x3ee71f];const _0x52518a=_0x60ee91+0x1,_0x5a337d=_0x57c59c+0x1,_0x464ac0=this['getUVByXY'](_0x60ee91,_0x57c59c),_0x522806=this['getUVByXY'](_0x52518a,_0x57c59c);function _0x5271f2(_0x12c2be,_0x55ba17){return _0x383bfc(_0x12c2be,_0x55ba17- -0x131);}const _0x234b50=this[_0x5271f2(0x226,0x229)](_0x60ee91,_0x5a337d),_0x219483=this['getUVByXY'](_0x52518a,_0x5a337d);let _0x17a5ff=null;try{_0x17a5ff=this['_bilinearInterpolation'](_0x3ee71f-_0x60ee91,_0x1bfec0-_0x57c59c,_0x464ac0,_0x522806,_0x234b50,_0x219483);}catch(_0x5a7957){console['log'](_0x3ee71f,_0x1bfec0);}return _0x17a5ff;}[_0x383bfc(0x341,0x358)](_0x492d02,_0x20af8e,_0x5861e6,_0x2aacef,_0x599f9c,_0x4faac7){const _0x389e40=0x1-_0x492d02,_0x1b9d57=0x1-_0x20af8e,_0x228357=_0x389e40*_0x1b9d57,_0x5df5f8=_0x492d02*_0x1b9d57,_0x19065f=_0x389e40*_0x20af8e,_0x30981f=_0x492d02*_0x20af8e,_0x5b6c79=_0x5861e6[0x0]*_0x228357+_0x2aacef[0x0]*_0x5df5f8+_0x599f9c[0x0]*_0x19065f+_0x4faac7[0x0]*_0x30981f,_0x8cb6c9=_0x5861e6[0x1]*_0x228357+_0x2aacef[0x1]*_0x5df5f8+_0x599f9c[0x1]*_0x19065f+_0x4faac7[0x1]*_0x30981f;return this['_calcUV'](_0x5b6c79,_0x8cb6c9);}['_calcUV'](_0x31c99b,_0x148b2b){function _0x26da40(_0x31abeb,_0x45e923){return _0x158252(_0x45e923,_0x31abeb- -0x539);}return[+_0x31c99b,+_0x148b2b,Math[_0x26da40(0xb,-0x58)](_0x31c99b*_0x31c99b+_0x148b2b*_0x148b2b)];}['getUVByPoint'](_0x5bc4b4,_0x4cced8){if(!this[_0x5791ae(0x5,0x4)](_0x5bc4b4,_0x4cced8))return null;const _0x4c6fcd=this[_0x5791ae(0x87,0x93)](_0x5bc4b4,_0x4cced8);function _0x5791ae(_0x5120ce,_0x27fb51){return _0x158252(_0x27fb51,_0x5120ce- -0x503);}function _0x13bdc6(_0x32dd6e,_0x17df09){return _0x383bfc(_0x17df09,_0x32dd6e-0x38);}const _0x562707=this['getUVByXY'](_0x4c6fcd[0x0],_0x4c6fcd[0x1]);return _0x562707;}[_0x383bfc(0x3c9,0x373)](_0x220f70,_0x219b7f){function _0xce8725(_0x4a51ee,_0x394d27){return _0x158252(_0x4a51ee,_0x394d27- -0x6c1);}function _0x23f631(_0x4e652d,_0x505780){return _0x383bfc(_0x4e652d,_0x505780- -0x1a5);}return _0x220f70>=this['xmin']&&_0x220f70<=this[_0x23f631(0x252,0x1d5)]&&_0x219b7f>=this[_0x23f631(0x1b3,0x1a3)]&&_0x219b7f<=this[_0xce8725(-0x120,-0x186)]?!![]:![];}['getRandomLatLng'](){function _0x1ce725(_0x1d4ef6,_0x214ffa){return _0x383bfc(_0x214ffa,_0x1d4ef6- -0x368);}const _0x323b94=fRandomByfloat(this['xmin'],this['xmax']),_0x2e55f5=fRandomByfloat(this[_0x1ce725(-0x20,-0x64)],this[_0x1ce725(0x3e,0x72)]),_0x373c6d={};_0x373c6d[_0x57d200(0x3f6,0x44b)]=_0x2e55f5,_0x373c6d[_0x57d200(0x3f4,0x37f)]=_0x323b94;function _0x57d200(_0x1aee67,_0x24fed2){return _0x158252(_0x24fed2,_0x1aee67- -0x149);}return _0x373c6d;}['getParticles'](){let _0x5be467,_0x2422a2,_0x81b35e;for(let _0x4360af=0x0,_0x181dfb=this['particles'][_0x1f375a(0x7b,0x102)];_0x4360af<_0x181dfb;_0x4360af++){let _0x58081a=this['particles'][_0x4360af];_0x58081a['age']<=0x0&&(_0x58081a=this[_0x5c2690(0x203,0x211)](_0x58081a));if(_0x58081a[_0x1f375a(0x101,0x113)]>0x0){const _0x94f51e=_0x58081a['tlng'],_0x59988d=_0x58081a[_0x1f375a(0xca,0x5d)];_0x81b35e=this[_0x1f375a(0xde,0xea)](_0x94f51e,_0x59988d),_0x81b35e?(_0x5be467=_0x94f51e+this[_0x5c2690(0x154,0x128)][0x0]*_0x81b35e[0x0],_0x2422a2=_0x59988d+this['_calc_speedRate'][0x1]*_0x81b35e[0x1],_0x58081a['lng']=_0x94f51e,_0x58081a['lat']=_0x59988d,_0x58081a[_0x1f375a(0x23,0x81)]=_0x5be467,_0x58081a['tlat']=_0x2422a2,_0x58081a['speed']=_0x81b35e[0x2],_0x58081a[_0x5c2690(0x212,0x207)]--):_0x58081a['age']=0x0;}}function _0x5c2690(_0x11c150,_0xdc9f8){return _0x158252(_0xdc9f8,_0x11c150- -0x38a);}function _0x1f375a(_0x35b40c,_0x34ab52){return _0x383bfc(_0x35b40c,_0x34ab52- -0x2f4);}return this[_0x5c2690(0x21a,0x1d8)];}[_0x158252(0x508,0x58d)](_0x5f5ae0){let _0x5c5411,_0x3d903c;for(let _0x1f0712=0x0;_0x1f0712<0x1e;_0x1f0712++){_0x5c5411=this[_0x323595(0x81,0x24)](),_0x3d903c=this['getUVByPoint'](_0x5c5411['lng'],_0x5c5411[_0x323595(0x92,0xb3)]);if(_0x3d903c&&_0x3d903c[0x2]>0x0)break;}if(!_0x3d903c)return _0x5f5ae0;const _0xa4460c=_0x5c5411[_0x5380c5(0x201,0x287)]+this[_0x5380c5(0x1cb,0x228)][0x0]*_0x3d903c[0x0];function _0x5380c5(_0x1d42da,_0x26af22){return _0x158252(_0x1d42da,_0x26af22- -0x2b6);}const _0x42bcbe=_0x5c5411['lat']+this['_calc_speedRate'][0x1]*_0x3d903c[0x1];_0x5f5ae0['lng']=_0x5c5411['lng'],_0x5f5ae0[_0x323595(0x92,0x1d)]=_0x5c5411['lat'],_0x5f5ae0[_0x5380c5(0x1fe,0x254)]=_0xa4460c,_0x5f5ae0[_0x5380c5(0x259,0x230)]=_0x42bcbe;function _0x323595(_0x2b50f4,_0x450c30){return _0x383bfc(_0x450c30,_0x2b50f4- -0x318);}return _0x5f5ae0['age']=Math['round'](0xa+Math['random']()*this[_0x323595(0x8a,0xd3)]),_0x5f5ae0[_0x5380c5(0x240,0x21f)]=_0x3d903c[0x2],_0x5f5ae0;}['destroy'](){for(const _0x2f4187 in this){delete this[_0x2f4187];}}}function fRandomByfloat(_0x379e74,_0x45240b){return _0x379e74+Math['random']()*(_0x45240b-_0x379e74);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0x5e0ff3={}){super(_0x5e0ff3),this[_0x244e55(-0xf2,-0xcd)](_0x5e0ff3);function _0xb5c579(_0x10a688,_0x3a568a){return _0x158252(_0x3a568a,_0x10a688- -0x3e1);}this[_0xb5c579(0x184,0x108)]=null;function _0x244e55(_0x2293e9,_0x27b18f){return _0x383bfc(_0x2293e9,_0x27b18f- -0x3dd);}_0x5e0ff3['colors']&&_0x5e0ff3['steps']&&(this['_colorRamp']=new mars3d__namespace[(_0xb5c579(0x172,0x1d9))](_0x5e0ff3));}['_setOptionsHook'](_0x195ea1,_0x9d92d){function _0x59dcc7(_0x539c39,_0x1a0e4e){return _0x158252(_0x539c39,_0x1a0e4e- -0x57a);}this[_0x2053d5(-0x1c0,-0x14c)]=0x3e8/(_0x195ea1['frameRate']||0xa),this['_pointerEvents']=this[_0x59dcc7(-0x6b,-0x8f)]['pointerEvents']??![],this[_0x2053d5(-0x22a,-0x265)]=_0x195ea1['color']||'#ffffff',this['lineWidth']=_0x195ea1['lineWidth']||0x1;function _0x2053d5(_0x55b44c,_0x1db8b8){return _0x158252(_0x1db8b8,_0x55b44c- -0x741);}this['fixedHeight']=_0x195ea1[_0x59dcc7(0x94,0x25)]??0x0,this[_0x59dcc7(-0x72,-0x69)]=_0x195ea1[_0x2053d5(-0x230,-0x2af)]??![],this[_0x2053d5(-0x1a3,-0x1c5)]&&this[_0x59dcc7(-0x5b,0x24)]['setOptions'](_0x195ea1);}get['layer'](){function _0x55a066(_0x547765,_0xd610d1){return _0x158252(_0x547765,_0xd610d1- -0x67d);}return this[_0x55a066(-0xa8,-0x118)];}get['canvasWidth'](){return this['_map']['scene']['canvas']['clientWidth'];}get[_0x158252(0x565,0x514)](){function _0x2d2cde(_0x285154,_0x5834b3){return _0x158252(_0x285154,_0x5834b3- -0x25d);}function _0x2b8801(_0xab10f2,_0x4d3e67){return _0x383bfc(_0xab10f2,_0x4d3e67- -0x459);}return this[_0x2b8801(-0xf2,-0x73)][_0x2b8801(-0x158,-0x141)]['canvas']['clientHeight'];}get[_0x158252(0x4ce,0x4c1)](){return this['_pointerEvents'];}set['pointerEvents'](_0x21014e){function _0x18bb2f(_0xae13cb,_0x390a0b){return _0x158252(_0x390a0b,_0xae13cb- -0x4d8);}this[_0x217f51(0x2bf,0x29f)]=_0x21014e;function _0x217f51(_0x1bac7c,_0x3c31f7){return _0x383bfc(_0x3c31f7,_0x1bac7c- -0x105);}if(!this['canvas'])return;_0x21014e?this['canvas']['style'][_0x18bb2f(0x7c,0x11)]=_0x217f51(0x296,0x240):this['canvas'][_0x18bb2f(0x95,0xc6)][_0x18bb2f(0x7c,0x88)]='none';}get['particlesNumber'](){function _0xcbe128(_0x35f6ab,_0x49bacb){return _0x158252(_0x35f6ab,_0x49bacb- -0x6db);}function _0x193480(_0x471a16,_0x5c4a9e){return _0x383bfc(_0x5c4a9e,_0x471a16- -0x171);}return this[_0x193480(0x1e5,0x255)][_0x193480(0x29b,0x313)];}set['particlesNumber'](_0x5602de){function _0x569226(_0x2f38f8,_0x52c245){return _0x158252(_0x2f38f8,_0x52c245- -0x136);}this[_0x569226(0x3ac,0x3b5)]['particlesNumber']=_0x5602de,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(()=>{this['redraw']();},0x1f4);}get['speedRate'](){return this['options']['speedRate'];}set[_0x158252(0x4a2,0x4ca)](_0x11c650){this['options']['speedRate']=_0x11c650,this['windField']&&(this['windField']['speedRate']=_0x11c650);}get[_0x158252(0x4e2,0x537)](){function _0xaaf73(_0x24b914,_0x501f87){return _0x383bfc(_0x501f87,_0x24b914- -0x24f);}return this['options'][_0xaaf73(0x153,0xf7)];}set['maxAge'](_0x5372e0){function _0x1462ed(_0x21764f,_0x4130b2){return _0x383bfc(_0x4130b2,_0x21764f- -0x4a0);}this[_0x2f5d07(0x51f,0x4d4)]['maxAge']=_0x5372e0;function _0x2f5d07(_0x1a3534,_0x4e044b){return _0x158252(_0x4e044b,_0x1a3534-0x34);}this[_0x2f5d07(0x5d2,0x5fb)]&&(this[_0x1462ed(-0x97,-0xb9)]['maxAge']=_0x5372e0);}get[_0x383bfc(0x3a3,0x3ef)](){function _0x428c63(_0x179491,_0x4961a7){return _0x383bfc(_0x4961a7,_0x179491- -0x567);}return this[_0x428c63(-0x19b,-0x209)];}set['data'](_0x2afa42){this['setData'](_0x2afa42);}get[_0x158252(0x52e,0x4bc)](){let _0x2ed39d=this['windData']['xmin'],_0x45ccae=this['windData'][_0x1a5e19(-0x164,-0x1c7)];function _0x1a5e19(_0x2a1c8f,_0x35e736){return _0x383bfc(_0x35e736,_0x2a1c8f- -0x4de);}let _0x39a2a8=this[_0x1a5e19(-0x112,-0x88)][_0x1a5e19(-0x196,-0x139)],_0x1af9c9=this[_0x28a703(0x2ef,0x269)][_0x1a5e19(-0x138,-0x16e)];_0x45ccae>=0x167&&_0x2ed39d===0x0&&(_0x2ed39d=-0xb4,_0x45ccae=0xb4);_0x2ed39d=Math['max'](_0x2ed39d,-0xb4),_0x45ccae=Math[_0x1a5e19(-0x167,-0x1c3)](_0x45ccae,0xb4);function _0x28a703(_0x2bbb8b,_0x3776e3){return _0x383bfc(_0x3776e3,_0x2bbb8b- -0xdd);}return _0x39a2a8=Math['max'](_0x39a2a8,-0x5a),_0x1af9c9=Math[_0x1a5e19(-0x167,-0x12a)](_0x1af9c9,0x5a),Cesium['Rectangle'][_0x28a703(0x2b1,0x27c)](_0x2ed39d,_0x39a2a8,_0x45ccae,_0x1af9c9);}[_0x383bfc(0x414,0x3f0)](_0x2b20d3){function _0x3ed4c6(_0x4decd6,_0x498586){return _0x158252(_0x4decd6,_0x498586- -0x324);}function _0x2f7231(_0x516f0e,_0x1622ff){return _0x158252(_0x516f0e,_0x1622ff- -0x4e9);}_0x2b20d3?this[_0x2f7231(0x30,0x2a)]():(this['windData']&&(this['options'][_0x3ed4c6(0x1e5,0x260)]=this[_0x2f7231(0xc,0x78)]),this['_removedHook']());}[_0x158252(0x56a,0x592)](){function _0x109ce9(_0x4d2e46,_0x4219be){return _0x383bfc(_0x4d2e46,_0x4219be- -0x80);}function _0x595b53(_0x4b030f,_0x4a0c13){return _0x158252(_0x4a0c13,_0x4b030f- -0xc);}this['options'][_0x595b53(0x58d,0x593)]?this['initWorker']():this[_0x109ce9(0x365,0x389)]=new CanvasWindField(this['options']);}[_0x158252(0x587,0x513)](){function _0x4a7343(_0x23b1a1,_0x5b0383){return _0x383bfc(_0x5b0383,_0x23b1a1- -0x3d4);}this['canvas']=this['_createCanvas']();const _0x5600ff={};_0x5600ff['willReadFrequently']=!![],this[_0x4a7343(-0x4d,-0x70)]=this['canvas']['getContext']('2d',_0x5600ff),this[_0x1ae406(0x453,0x469)]();function _0x1ae406(_0x18fdf8,_0x2b9c76){return _0x383bfc(_0x18fdf8,_0x2b9c76-0xde);}this[_0x4a7343(-0x7e,-0xd0)]['data']&&this[_0x4a7343(0x7,0x2a)](this['options'][_0x1ae406(0x51d,0x4cd)]);}['_removedHook'](){this[_0x49ce0e(0x9,0x31)]();function _0x49ce0e(_0x362ddd,_0x5901ce){return _0x158252(_0x5901ce,_0x362ddd- -0x4a5);}function _0x48c814(_0x401c31,_0x134c74){return _0x158252(_0x134c74,_0x401c31- -0x45);}this['unbindEvent'](),this[_0x48c814(0x520,0x4f0)]&&(this[_0x48c814(0x536,0x59c)]['container']['removeChild'](this[_0x48c814(0x520,0x55e)]),delete this['canvas']);}['_createCanvas'](){const _0x384b3b=mars3d__namespace['DomUtil']['create']('canvas',_0x1c061c(0x173,0x1f4),this['_map'][_0x1c061c(0x311,0x29d)]);_0x384b3b['style'][_0x1c061c(0x1bf,0x210)]='absolute',_0x384b3b['style'][_0x1c061c(0x275,0x2a9)]=_0x1c061c(0x18d,0x1fa),_0x384b3b[_0x3e4c82(-0xf,-0x83)][_0x1c061c(0x2cf,0x297)]='0px',_0x384b3b['style']['width']=this['_map']['scene'][_0x3e4c82(-0x17,0x5a)][_0x3e4c82(-0x79,-0xc3)]+'px';function _0x3e4c82(_0x2799d2,_0x3af894){return _0x383bfc(_0x3af894,_0x2799d2- -0x3e7);}_0x384b3b['style'][_0x3e4c82(-0x9a,-0xc4)]=this['_map']['scene'][_0x3e4c82(-0x17,0x12)]['clientHeight']+'px';function _0x1c061c(_0x13eac3,_0x7e7dc4){return _0x158252(_0x13eac3,_0x7e7dc4- -0x2c9);}return _0x384b3b[_0x3e4c82(-0xf,0x58)]['pointerEvents']=this[_0x3e4c82(-0x23,-0x3c)]?'auto':'none',_0x384b3b[_0x1c061c(0x2e9,0x2a4)]['zIndex']=this[_0x1c061c(0x1e1,0x222)]['zIndex']??0x9,_0x384b3b['width']=this[_0x3e4c82(-0x1,-0x45)][_0x1c061c(0x1ca,0x1e4)]['canvas'][_0x1c061c(0x225,0x23a)],_0x384b3b['height']=this[_0x3e4c82(-0x1,-0x19)][_0x1c061c(0x215,0x1e4)]['canvas']['clientHeight'],_0x384b3b;}['resize'](){function _0x2f5457(_0x18e0cf,_0x121a2f){return _0x158252(_0x18e0cf,_0x121a2f- -0x276);}function _0xbe586c(_0x3fd079,_0x190a01){return _0x158252(_0x3fd079,_0x190a01- -0x529);}this['canvas']&&(this['canvas']['style'][_0x2f5457(0x314,0x2d4)]=this['_map']['scene'][_0xbe586c(-0x2a,0x3c)][_0xbe586c(0x28,-0x26)]+'px',this[_0x2f5457(0x361,0x2ef)][_0xbe586c(0xbc,0x44)][_0x2f5457(0x218,0x26c)]=this['_map']['scene'][_0xbe586c(-0x29,0x3c)]['clientHeight']+'px',this['canvas']['width']=this['_map']['scene'][_0xbe586c(0x33,0x3c)]['clientWidth'],this['canvas']['height']=this['_map'][_0x2f5457(0x225,0x237)][_0xbe586c(0x45,0x3c)][_0x2f5457(0x267,0x29c)]);}[_0x158252(0x5a0,0x520)](){const _0x4b42df=this;function _0x1d3206(_0x42452f,_0x42e8ad){return _0x158252(_0x42452f,_0x42e8ad- -0x221);}let _0x5e8cdb=Date['now']();(function _0x13a91c(){if(_0x4b42df['isDestroy'])return;function _0x56cdef(_0xdf4751,_0x26a136){return _0x5a39(_0xdf4751- -0xf3,_0x26a136);}_0x4b42df['_animateFrame']=window[_0x56cdef(0x102,0x17b)](_0x13a91c);function _0x15fe99(_0x2a0fda,_0x2b982f){return _0x5a39(_0x2b982f-0x171,_0x2a0fda);}if(_0x4b42df['show']&&_0x4b42df['windField']){const _0x348e3a=Date['now'](),_0x3bfe36=_0x348e3a-_0x5e8cdb;_0x3bfe36>_0x4b42df[_0x56cdef(0xf4,0xd3)]&&(_0x5e8cdb=_0x348e3a-_0x3bfe36%_0x4b42df[_0x56cdef(0xf4,0x8c)],_0x4b42df[_0x56cdef(0x5d,0x9b)]());}}(),window[_0x1d3206(0x3a2,0x353)](_0x1d3206(0x266,0x2ea),this['resize'][_0x3e3d82(0xce,0x55)](this),![]),this[_0x3e3d82(0x19a,0x14d)]=![],this[_0x3e3d82(0x173,0x146)]=![]);function _0x3e3d82(_0x5a4b51,_0x3e965a){return _0x383bfc(_0x5a4b51,_0x3e965a- -0x2b3);}this['options'][_0x1d3206(0x2fa,0x29d)]&&(this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x3e3d82(0x129,0x15b)],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x3e3d82(0x1b0,0x136)],this));}[_0x158252(0x4dd,0x4bf)](){window['cancelAnimationFrame'](this['_animateFrame']);function _0x158934(_0x4c16f8,_0x2f9c1b){return _0x158252(_0x2f9c1b,_0x4c16f8- -0x5ac);}delete this[_0x3cda82(-0x2c,0x7)],window[_0x158934(-0xd9,-0xb8)]('resize',this[_0x158934(-0xa1,-0x10b)]);function _0x3cda82(_0x584a6d,_0x2fc20f){return _0x158252(_0x584a6d,_0x2fc20f- -0x4f2);}this['options']['mouseHidden']&&(this[_0x158934(-0x31,-0x9c)]['off'](mars3d__namespace[_0x3cda82(0x17,0x71)][_0x158934(-0x8a,-0x71)],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace[_0x158934(-0x49,-0x47)][_0x158934(-0x9,-0x64)],this['_onMouseDownEvent'],this),this[_0x158934(-0x31,0x29)][_0x158934(-0x10e,-0x15d)](mars3d__namespace[_0x3cda82(0xa1,0x71)][_0x3cda82(0x8a,0xb4)],this[_0x3cda82(0x95,0x8c)],this),this['_map']['off'](mars3d__namespace['EventType'][_0x3cda82(0x36,0xba)],this['_onMouseMoveEvent'],this));}['_onMapWhellEvent'](_0x14858d){clearTimeout(this['refreshTimer']);if(!this[_0x509c6c(0xad,0xc4)]||!this[_0x509c6c(0xc7,0x14f)])return;function _0x44039e(_0x4acedb,_0x54c4d8){return _0x383bfc(_0x4acedb,_0x54c4d8-0x120);}this['canvas'][_0x509c6c(0x1c2,0x157)][_0x509c6c(0x133,0x187)]='hidden';function _0x509c6c(_0x36f482,_0x225fbc){return _0x158252(_0x36f482,_0x225fbc- -0x416);}this[_0x44039e(0x3bc,0x43b)]=setTimeout(()=>{function _0xc39adf(_0x48e770,_0x4f0644){return _0x509c6c(_0x48e770,_0x4f0644-0x109);}if(!this['show'])return;this['redraw'](),this['canvas']['style'][_0xc39adf(0x2a5,0x290)]='visible';},0xc8);}[_0x383bfc(0x379,0x380)](_0x1090a6){this[_0xfba72a(-0x7d,-0x83)]=!![],this[_0xfba72a(-0x97,-0x18)]['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);function _0xfba72a(_0x1fd5f5,_0x507b8b){return _0x158252(_0x507b8b,_0x1fd5f5- -0x612);}function _0x23db36(_0x538881,_0x188986){return _0x158252(_0x188986,_0x538881- -0x119);}this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);}['_onMouseMoveEvent'](_0x237bbf){if(!this['show']||!this['canvas'])return;function _0x44f805(_0x36ac30,_0x3f8492){return _0x383bfc(_0x36ac30,_0x3f8492-0x4a);}function _0x220272(_0x5cf656,_0x55e42d){return _0x383bfc(_0x55e42d,_0x5cf656- -0x118);}this['mouse_down']&&(this[_0x44f805(0x3d4,0x41a)][_0x220272(0x2c0,0x336)]['visibility']='hidden',this['mouse_move']=!![]);}['_onMouseUpEvent'](_0x4da142){function _0x23c886(_0x2a1545,_0x40626a){return _0x158252(_0x2a1545,_0x40626a- -0x193);}if(!this[_0x225535(0x29c,0x232)]||!this['canvas'])return;this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x23c886(0x390,0x3b0)],this);function _0x225535(_0x372a04,_0x40ac2e){return _0x383bfc(_0x372a04,_0x40ac2e- -0x113);}this['mouse_down']&&this[_0x23c886(0x3d4,0x3fb)]&&this[_0x225535(0x30a,0x2c4)](),this['canvas'][_0x23c886(0x3ef,0x3da)]['visibility']='visible',this['mouse_down']=![],this[_0x225535(0x340,0x2e6)]=![];}[_0x158252(0x5ac,0x570)](_0x13d379){this['clear'](),this['windData']=_0x13d379,this[_0x5b192e(0x23d,0x230)]['setDate'](_0x13d379);function _0x5b192e(_0x33a69b,_0x15508f){return _0x158252(_0x33a69b,_0x15508f- -0x36e);}this['redraw']();}['redraw'](){if(!this['show'])return;this['windField'][_0x22733f(0x339,0x2b9)](this['options']);function _0x22733f(_0x235efe,_0x19125e){return _0x158252(_0x235efe,_0x19125e- -0x2a4);}this['update']();}['update'](){function _0x5a028c(_0x247756,_0x3f96a3){return _0x383bfc(_0x3f96a3,_0x247756- -0x450);}if(this['_updateIng'])return;this['_updateIng']=!![];if(this['worker'])this['windField']['update']();else{const _0x5b3f67=this['windField']['getParticles']();this['_drawLines'](_0x5b3f67);}this[_0x5a028c(-0x142,-0x187)]=![];}[_0x158252(0x48b,0x4b4)](_0x578ca6){this[_0x574e0f(0x4ec,0x526)]=_0x578ca6,this['canvasContext'][_0x50f74d(0x1ff,0x284)]='destination-in',this['canvasContext'][_0x574e0f(0x539,0x500)](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this[_0x50f74d(0x181,0x1b1)]['globalCompositeOperation']=_0x574e0f(0x436,0x472);function _0x50f74d(_0x396b3c,_0x3ebf49){return _0x383bfc(_0x3ebf49,_0x396b3c- -0x206);}this['canvasContext']['globalAlpha']=0.9;function _0x574e0f(_0x40cf85,_0x5dba21){return _0x383bfc(_0x5dba21,_0x40cf85-0x125);}const _0x17864e=this['_map']['scene'][_0x50f74d(0x15b,0x1d0)]!==Cesium['SceneMode'][_0x574e0f(0x466,0x49b)],_0x5ad054=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0x4cc897=0x0,_0x27cf17=_0x578ca6[_0x50f74d(0x1f0,0x19a)];_0x4cc897<_0x27cf17;_0x4cc897++){const _0x3246ab=_0x578ca6[_0x4cc897],_0x2a395f=this[_0x574e0f(0x491,0x510)](_0x3246ab,_0x3246ab[_0x574e0f(0x4cd,0x4c4)],_0x3246ab[_0x574e0f(0x4cf,0x4c9)],_0x3246ab[_0x574e0f(0x4c4,0x47d)]),_0x119366=this[_0x50f74d(0x166,0xdf)](_0x3246ab,_0x3246ab[_0x50f74d(0x16f,0x1a3)],_0x3246ab['tlat'],_0x3246ab[_0x50f74d(0x1a3,0x1c4)]);if(!_0x2a395f||!_0x119366)continue;if(_0x17864e&&Math[_0x50f74d(0x1f8,0x27e)](_0x2a395f[0x0]-_0x119366[0x0])>=_0x5ad054)continue;this[_0x50f74d(0x181,0x112)]['beginPath'](),this['canvasContext']['lineWidth']=this[_0x50f74d(0x11e,0x9e)],this[_0x50f74d(0x181,0x150)]['strokeStyle']=this[_0x50f74d(0x194,0x1e2)]['getColor'](_0x3246ab['speed']),this[_0x574e0f(0x4ac,0x45e)]['moveTo'](_0x2a395f[0x0],_0x2a395f[0x1]),this['canvasContext']['lineTo'](_0x119366[0x0],_0x119366[0x1]),this[_0x574e0f(0x4ac,0x508)]['stroke']();}else{this[_0x50f74d(0x181,0x1e3)][_0x50f74d(0x1bb,0x207)](),this['canvasContext'][_0x574e0f(0x449,0x3e1)]=this['lineWidth'],this[_0x50f74d(0x181,0x10f)][_0x574e0f(0x447,0x48c)]=this[_0x574e0f(0x4a7,0x4f9)];for(let _0x297849=0x0,_0x380d32=_0x578ca6['length'];_0x297849<_0x380d32;_0x297849++){const _0x4072ea=_0x578ca6[_0x297849],_0x34fca8=this['_tomap'](_0x4072ea,_0x4072ea[_0x574e0f(0x4cd,0x4d2)],_0x4072ea['lat'],_0x4072ea[_0x50f74d(0x199,0x1f3)]),_0x210963=this[_0x574e0f(0x491,0x462)](_0x4072ea,_0x4072ea['tlng'],_0x4072ea[_0x574e0f(0x476,0x3ee)],_0x4072ea[_0x574e0f(0x4ce,0x489)]);if(!_0x34fca8||!_0x210963)continue;if(_0x17864e&&Math['abs'](_0x34fca8[0x0]-_0x210963[0x0])>=_0x5ad054)continue;this['canvasContext']['moveTo'](_0x34fca8[0x0],_0x34fca8[0x1]),this[_0x50f74d(0x181,0x1aa)]['lineTo'](_0x210963[0x0],_0x210963[0x1]);}this['canvasContext'][_0x50f74d(0x1ed,0x1bc)]();}}[_0x158252(0x49c,0x501)](_0x2b4c64,_0x2422cd,_0x553e6d,_0x392e4c){const _0x5aa8f6=Cesium[_0x18d9c5(-0x133,-0xe8)][_0x224ff1(-0x173,-0x1c7)](_0x2422cd,_0x553e6d,_0x392e4c??this[_0x18d9c5(0x82,-0x3)]),_0xa90757=this['_map'][_0x224ff1(-0x210,-0x23d)];function _0x224ff1(_0x38c5ce,_0x5eb49f){return _0x383bfc(_0x38c5ce,_0x5eb49f- -0x555);}function _0x18d9c5(_0x1e1b0d,_0x2ff4e5){return _0x383bfc(_0x1e1b0d,_0x2ff4e5- -0x40d);}if(_0xa90757[_0x224ff1(-0x279,-0x1f4)]===Cesium['SceneMode']['SCENE3D']){const _0x4d0de3=new Cesium[(_0x18d9c5(-0x10e,-0xd3))](_0xa90757['globe']['ellipsoid'],_0xa90757[_0x18d9c5(-0x64,-0x8a)]['positionWC']),_0x2ff6ba=_0x4d0de3['isPointVisible'](_0x5aa8f6);if(!_0x2ff6ba)return _0x2b4c64[_0x224ff1(-0x107,-0x14e)]=0x0,null;}const _0x315184=mars3d__namespace['PointTrans'][_0x224ff1(-0x1ea,-0x1c1)](this[_0x224ff1(-0x12f,-0x16f)]['scene'],_0x5aa8f6);return _0x315184?[_0x315184['x'],_0x315184['y']]:null;}['clear'](){this['windField']['clear'](),delete this['windData'];}['initWorker'](){this['worker']=new Worker(this['options'][_0x710afa(0x9c,0x102)]),this['worker'][_0x710afa(0x1d,0x44)]=_0x293a53=>{this['_drawLines'](_0x293a53['data']['particles']);function _0x50659f(_0x4b0b89,_0x2c0ff5){return _0x39c10b(_0x2c0ff5,_0x4b0b89- -0xaf);}this[_0x50659f(-0x55,-0x5c)]=![];},this['windField']={'init':_0x57ab44=>{const _0x2b4478={};_0x2b4478[_0x505d1d(0x159,0x154)]='init';function _0x505d1d(_0x11ec95,_0x5256d4){return _0x39c10b(_0x5256d4,_0x11ec95-0xde);}function _0x5be993(_0xb235c,_0x39053e){return _0x710afa(_0xb235c,_0x39053e-0x152);}_0x2b4478['options']=_0x57ab44,this[_0x5be993(0x2c9,0x254)][_0x5be993(0x20b,0x1a3)](_0x2b4478);},'setOptions':_0x1d76b7=>{function _0x108c45(_0x59c933,_0x4d2c24){return _0x39c10b(_0x4d2c24,_0x59c933-0x433);}const _0x406b84={};_0x406b84[_0x108c45(0x4ae,0x441)]='setOptions';function _0x30e071(_0x2a3b2a,_0x33a8db){return _0x39c10b(_0x33a8db,_0x2a3b2a-0x40c);}_0x406b84[_0x108c45(0x44c,0x473)]=_0x1d76b7,this['worker']['postMessage'](_0x406b84);},'setDate':_0x2a9ea4=>{function _0x5188ed(_0x490c58,_0x2e7554){return _0x710afa(_0x490c58,_0x2e7554- -0x112);}const _0x42a83e={};_0x42a83e[_0x1ed49b(0x5ab,0x53c)]='setDate';function _0x1ed49b(_0x5103aa,_0x4bb1b7){return _0x710afa(_0x5103aa,_0x4bb1b7-0x486);}_0x42a83e[_0x5188ed(-0x49,-0x25)]=_0x2a9ea4,this['worker']['postMessage'](_0x42a83e);},'update':()=>{function _0x4c34eb(_0x463cf6,_0x1647ba){return _0x39c10b(_0x463cf6,_0x1647ba-0x48);}if(this['_updateIng2'])return;this['_updateIng2']=!![];const _0x3ab533={};function _0x21ecfa(_0x1aec2f,_0x3d8ca0){return _0x39c10b(_0x1aec2f,_0x3d8ca0- -0x235);}_0x3ab533['type']='update',this[_0x4c34eb(0xdb,0x10f)][_0x4c34eb(0x7e,0x5e)](_0x3ab533);},'clear':()=>{const _0x96af6={};_0x96af6[_0x356d7e(0x363,0x2dc)]='clear';function _0x356d7e(_0x18a616,_0x212ba5){return _0x710afa(_0x212ba5,_0x18a616-0x2ad);}this['worker']['postMessage'](_0x96af6);}};function _0x710afa(_0x23e849,_0x2caa57){return _0x383bfc(_0x23e849,_0x2caa57- -0x302);}function _0x39c10b(_0x13e053,_0x3f2b9c){return _0x158252(_0x13e053,_0x3f2b9c- -0x4d2);}this[_0x710afa(0x183,0x107)]['init'](this[_0x39c10b(-0x60,0x19)]);}}function _0x2476(){const _0x46758d=['ymax','componentDatatype','lng','talt','lat','layer','rendering','changed','_onMouseMoveEvent','sqrt','RGBA','xmin','lastFramesPerSecond','rows','IDENTITY','width','persists','isDynamic','type','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a','logInfo','grid','toDegrees','changeOptions','ColorRamp','pointer-events','createRawRenderState','beginPath','fragmentShaderSource','computing','_pointerEvents','particleSystem','WindUtil','_canvasParticles','setOptions','reverse','createCommand','left','windData','postProcessingPosition','EventType','magnificationFilter','canvas','container','ONE_MINUS_SRC_ALPHA','add','array','onColorTableChange','warn','redraw','style','blue','currentParticlesPosition','setData','pass','top','getUVByPoint','addEventListener','drawingBufferHeight','ellipsoid','Draw','push','mars3d-wind插件\x20注册成功','colorTable','_map','rawRenderState','_speedRate','_onMouseUpEvent','calculateSpeed','18uqShvh','frameTime','dropRate','#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a','data','_showHook','updateViewerParameters','395296NwKHOi','stroke','forEach','toGridXY','length','windTextures','_randomParticle','mouse_move','requestAnimationFrame','401632blLhYi','componentsPerAttribute','_mountedHook','abs','textures','mouse_down','WindLayer','enabled','Cartesian2','worker','globalCompositeOperation','dynamic','age','visibility','windField','fixedHeight','renderState','particlesNumber','createRenderingFramebuffers','mouseDown','particles','42owBGSI','mouseUp','initFrameRate','keys','fillRect','commandList','south','mouseMove','FLOAT','Compute','particlesTextureSize\x20must\x20be\x20greater\x20than\x200','bind','off','sceneMode','242MWEELp','preExecute','createPrimitives','_updateIng','owner','_setOptionsHook','lighter','autoClear','vertexArray','east','bounds','north','218dKsSXc','scene','clear','getDirection','refreshTimer','execute','getSegmentDrawVertexShader','getUpdatePositionShader','_drawLines','geometry','call','strokeStyle','cols','lineWidth','Cartesian3','pow','rectangle','mars3d-canvasWind','mouseHidden','unbindEvent','sin','pointerEvents','DEPTH_COMPONENT','0px','createSegmentsGeometry','vdata','minificationFilter','commandType','blendFuncDestination','uniformMap','speedRate','useViewerBounds','primitives','framebuffers','Unknown\x20command\x20type','EllipsoidalOccluder','previousParticlesPosition','outputTexture','framebuffer','removeEventListener','viewerParameters','speed','SCENE3D','segmentsColor','latitude','position','show','onmessage','applyViewerParameters','ymin','_calc_speedRate','pixelFormat','lonRange','particlesSpeed','height','colors','Cesium','1723450bBELmS','tlat','drawingBufferWidth','postMessage','MAX_VALUE','update','options','fill','_bilinearInterpolation','TRIANGLES','getUVByXY','number','percentageChanged','CanvasWindField','createRenderingTextures','STATIC_DRAW','createParticlesTextures','mode','dropRateBump','context','_animateFrame','shaderProgram','pixelSize','particlesTextureSize','longitude','updateOptions','NEAREST','LINEAR','_tomap','_maxAge','clientWidth','max','commandToExecute','createComputingPrimitives','createWindTextures','isInExtent','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a','tlng','resize','min','attributeLocations','west','xmax','particlesTextures','flipY','clientHeight','_addedHook','canvasHeight','_onMouseDownEvent','lineLength','color','camera','rgb(206,255,255)','values','sources','canvasContext','wrapT','min\x20is\x20undefined,\x20calculate\x20min','udata','bindEvent','setDate','wheel','fromDegrees','floor','samplingWindow','frameRateMonitor','Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.','787990uYlvhh','toWindowCoordinates','onParticlesTextureSizeChange','updatePosition','_updateIng2','destroy','getRandomLatLng','_colorRamp','all','374100wndiyu','vertexShaderSource','78055AgMKfh','alt','getPrimitives','segments','maxAge','default','OPAQUE','getDefaultRenderState'];_0x2476=function(){return _0x46758d;};return _0x2476();}mars3d__namespace['LayerUtil']['register']('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace[_0x383bfc(0x2fd,0x35d)]=CanvasWindField,mars3d__namespace['Log'][_0x383bfc(0x3b8,0x3ba)](_0x158252(0x5e2,0x579)),mars3d__namespace[_0x158252(0x5ca,0x55b)]=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports[_0x383bfc(0x445,0x401)]=WindLayer,exports[_0x383bfc(0x37e,0x3c6)]=WindUtil;const _0x5162de={};_0x5162de['value']=!![],Object['defineProperty'](exports,'__esModule',_0x5162de);
}));
