/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.10.6
 * 编译日期：2025-10-11 10:36
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-07-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x40e240,_0x1d8d73){function _0x3c7cd2(_0x555061,_0x4a22ff){return _0x5d99(_0x4a22ff-0x214,_0x555061);}function _0x296838(_0x37b8b7,_0x42f970){return _0x5d99(_0x42f970-0x144,_0x37b8b7);}const _0x30ba9a=_0x40e240();while(!![]){try{const _0x1cdd14=-parseInt(_0x3c7cd2(0x35f,0x33e))/0x1*(parseInt(_0x296838(0x1d0,0x1f0))/0x2)+parseInt(_0x3c7cd2(0x2b5,0x2b9))/0x3+parseInt(_0x296838(0x232,0x26c))/0x4+-parseInt(_0x3c7cd2(0x395,0x3a4))/0x5+parseInt(_0x296838(0x1f5,0x21f))/0x6*(parseInt(_0x3c7cd2(0x374,0x30b))/0x7)+-parseInt(_0x296838(0x192,0x1ed))/0x8*(parseInt(_0x296838(0x24a,0x23e))/0x9)+-parseInt(_0x3c7cd2(0x2cb,0x2bf))/0xa;if(_0x1cdd14===_0x1d8d73)break;else _0x30ba9a['push'](_0x30ba9a['shift']());}catch(_0x397e30){_0x30ba9a['push'](_0x30ba9a['shift']());}}}(_0x3b05,0xb1cd8));function _interopNamespace(_0x910336){if(_0x910336&&_0x910336[_0x29ea3c(-0x25c,-0x206)])return _0x910336;var _0x1ca915=Object['create'](null);_0x910336&&Object['keys'](_0x910336)['forEach'](function(_0x1a2c04){if(_0x1a2c04!=='default'){var _0xa673c3=Object['getOwnPropertyDescriptor'](_0x910336,_0x1a2c04);Object['defineProperty'](_0x1ca915,_0x1a2c04,_0xa673c3['get']?_0xa673c3:{'enumerable':!![],'get':function(){return _0x910336[_0x1a2c04];}});}});function _0x29ea3c(_0x5c3ac0,_0x107148){return _0x5d99(_0x5c3ac0- -0x38b,_0x107148);}return _0x1ca915['default']=_0x910336,_0x1ca915;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x1372d6,_0x27facb){const _0x3735b2=_0x1372d6*Math['cos'](Cesium$2['Math'][_0x29a5d5(-0xfd,-0x10b)](_0x27facb));function _0x29a5d5(_0x4649e8,_0x251bfb){return _0x5d99(_0x4649e8- -0x256,_0x251bfb);}return _0x3735b2;}function getV(_0x1181ea,_0x5b4ed1){const _0x49c8a6=_0x1181ea*Math[_0x48e0cb(-0x50,0x33)](Cesium$2[_0xf750e9(0x332,0x39d)]['toRadians'](_0x5b4ed1));function _0xf750e9(_0x30809b,_0x580c49){return _0x5d99(_0x30809b-0x1aa,_0x580c49);}function _0x48e0cb(_0x3faeee,_0xe8f4d1){return _0x5d99(_0xe8f4d1- -0x162,_0x3faeee);}return _0x49c8a6;}function getSpeed(_0x2fb36c,_0x59bf33){const _0x2676b2=Math[_0x21adde(0x1a6,0x151)](Math[_0x30ad15(0x16a,0x176)](_0x2fb36c,0x2)+Math[_0x21adde(0x17e,0x1bf)](_0x59bf33,0x2));function _0x30ad15(_0x38ad48,_0x46191c){return _0x5d99(_0x38ad48-0x5b,_0x46191c);}function _0x21adde(_0x1c08f0,_0x23d1b2){return _0x5d99(_0x23d1b2-0xb0,_0x1c08f0);}return _0x2676b2;}function getDirection(_0x4ddb74,_0xca5dc8){let _0x36acdb=Cesium$2[_0x4dd7d3(-0x131,-0x102)]['toDegrees'](Math[_0x4dd7d3(-0x164,-0x1bd)](_0xca5dc8,_0x4ddb74));function _0x4dd7d3(_0x5ce656,_0x2100f7){return _0x5d99(_0x5ce656- -0x2b9,_0x2100f7);}_0x36acdb+=_0x36acdb<0x0?0x168:0x0;function _0x33a483(_0x502627,_0x59f9e0){return _0x5d99(_0x502627-0x1cf,_0x59f9e0);}return _0x36acdb;}const _0x2856d2={};_0x2856d2['__proto__']=null,_0x2856d2['getU']=getU,_0x2856d2[_0x4ba7a1(0x80,0x61)]=getV,_0x2856d2[_0x4ba7a1(0xa6,0xae)]=getSpeed,_0x2856d2['getDirection']=getDirection;var WindUtil=_0x2856d2,updatePositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a',calculateSpeedShader=_0x4ba7a1(0xae,0x67),postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',renderParticlesVertexShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a';const {ShaderSource:ShaderSource$1}=mars3d__namespace['Cesium'];class ShaderManager{static[_0x473f5b(-0xa8,-0xbb)](){const _0x3e7473={};return _0x3e7473['sources']=[calculateSpeedShader],new ShaderSource$1(_0x3e7473);}static[_0x473f5b(-0x91,-0x111)](){const _0x41d1da={};return _0x41d1da['sources']=[updatePositionShader],new ShaderSource$1(_0x41d1da);}static[_0x473f5b(-0x13e,-0x13e)](){const _0x9070a6={};_0x9070a6[_0x2be04a(-0x300,-0x281)]=[renderParticlesVertexShader];function _0x2be04a(_0x169f5b,_0x967aa5){return _0x473f5b(_0x967aa5,_0x169f5b- -0x1a3);}return new ShaderSource$1(_0x9070a6);}static[_0x473f5b(-0x1ac,-0x151)](){const _0x1f502a={};function _0x79e59(_0xc99964,_0x13a150){return _0x4ba7a1(_0x13a150- -0x2da,_0xc99964);}return _0x1f502a[_0x79e59(-0x2fb,-0x28e)]=[renderParticlesFragmentShader],new ShaderSource$1(_0x1f502a);}static['getPostProcessingPositionShader'](){const _0x5d86fb={};function _0x2dde31(_0x4242c9,_0x1b69ef){return _0x473f5b(_0x1b69ef,_0x4242c9-0x20c);}return _0x5d86fb[_0x2dde31(0xaf,0xf2)]=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x5d86fb);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x476989){this['commandType']=_0x476989[_0x570015(0x3e2,0x436)],this['geometry']=_0x476989[_0x30f1ac(0x94,0xfb)],this['attributeLocations']=_0x476989['attributeLocations'],this[_0x30f1ac(0x87,0xfa)]=_0x476989['primitiveType'],this['uniformMap']=_0x476989['uniformMap']||{},this[_0x570015(0x3f8,0x43a)]=_0x476989['vertexShaderSource'],this[_0x30f1ac(0x135,0x1b1)]=_0x476989[_0x570015(0x4a2,0x517)],this['rawRenderState']=_0x476989['rawRenderState'],this['framebuffer']=_0x476989[_0x570015(0x4f4,0x476)],this['outputTexture']=_0x476989['outputTexture'],this[_0x30f1ac(0xda,0xbd)]=_0x476989[_0x570015(0x438,0x423)]??![];function _0x570015(_0x3bfb8e,_0x424fae){return _0x473f5b(_0x3bfb8e,_0x424fae-0x573);}function _0x30f1ac(_0x18ca25,_0x204fd4){return _0x4ba7a1(_0x204fd4-0x64,_0x18ca25);}this['preExecute']=_0x476989['preExecute'],this[_0x30f1ac(0x22d,0x1ad)]=!![],this[_0x570015(0x4b9,0x4ef)]=undefined,this[_0x30f1ac(0x210,0x193)]=undefined,this['isDynamic']=_0x476989[_0x570015(0x524,0x4c1)]??(()=>!![]),this[_0x570015(0x426,0x423)]&&(this[_0x570015(0x522,0x4f9)]=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Pass$1['OPAQUE']}));}[_0x473f5b(-0xc4,-0x6b)](_0xdf814c){function _0x22cf22(_0x47e3d7,_0x510a9c){return _0x4ba7a1(_0x47e3d7- -0x1f9,_0x510a9c);}function _0x30c18b(_0x46be94,_0x5deb36){return _0x473f5b(_0x5deb36,_0x46be94-0x389);}if(this['commandType']==='Draw'){const _0x3e7489={};_0x3e7489[_0x30c18b(0x2f0,0x2ee)]=_0xdf814c,_0x3e7489['geometry']=this[_0x22cf22(-0x162,-0x15f)],_0x3e7489['attributeLocations']=this['attributeLocations'],_0x3e7489[_0x30c18b(0x285,0x236)]=BufferUsage$1['STATIC_DRAW'];const _0x4319d6=VertexArray$1[_0x22cf22(-0x11c,-0xc6)](_0x3e7489),_0x49c11b={};_0x49c11b['context']=_0xdf814c,_0x49c11b[_0x22cf22(-0x189,-0x1d2)]=this['vertexShaderSource'],_0x49c11b['fragmentShaderSource']=this['fragmentShaderSource'],_0x49c11b['attributeLocations']=this[_0x30c18b(0x2dd,0x2e4)];const _0x5cd4fc=ShaderProgram['fromCache'](_0x49c11b),_0x40e692=RenderState[_0x22cf22(-0x16b,-0x132)](this['rawRenderState']),_0x179238={};return _0x179238[_0x30c18b(0x2b8,0x2ac)]=this,_0x179238[_0x22cf22(-0xdc,-0x66)]=_0x4319d6,_0x179238['primitiveType']=this['primitiveType'],_0x179238['modelMatrix']=Matrix4[_0x22cf22(-0x1a9,-0x1b5)],_0x179238[_0x30c18b(0x2b4,0x273)]=_0x40e692,_0x179238['shaderProgram']=_0x5cd4fc,_0x179238[_0x30c18b(0x28c,0x300)]=this['framebuffer'],_0x179238['uniformMap']=this[_0x22cf22(-0x1a2,-0x178)],_0x179238['pass']=Pass$1['OPAQUE'],new DrawCommand(_0x179238);}else{if(this['commandType']==='Compute'){const _0x4a31fb={};return _0x4a31fb['owner']=this,_0x4a31fb['fragmentShaderSource']=this[_0x22cf22(-0xac,-0xde)],_0x4a31fb['uniformMap']=this[_0x30c18b(0x237,0x1c1)],_0x4a31fb[_0x22cf22(-0x14c,-0x15d)]=this['outputTexture'],_0x4a31fb['persists']=!![],new ComputeCommand(_0x4a31fb);}else throw new Error('Unknown\x20command\x20type');}}['setGeometry'](_0x416ceb,_0x3b028e){this[_0x4b6d14(0x298,0x29b)]=_0x3b028e;function _0x2b38e8(_0x27c3aa,_0x4d6831){return _0x4ba7a1(_0x27c3aa- -0xeb,_0x4d6831);}function _0x4b6d14(_0x33717d,_0xa2d6e1){return _0x473f5b(_0xa2d6e1,_0x33717d-0x3aa);}defined(this['commandToExecute'])&&(this['commandToExecute'][_0x2b38e8(0x32,0x47)]=VertexArray$1['fromGeometry']({'context':_0x416ceb,'geometry':this[_0x4b6d14(0x298,0x272)],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1['STATIC_DRAW']}));}[_0x4ba7a1(0x134,0x12e)](_0x5c26b9){if(!this[_0x252c36(0x27b,0x26d)]())return;if(!this['show']||!defined(_0x5c26b9))return;function _0x431770(_0x5707a3,_0xa5adff){return _0x473f5b(_0x5707a3,_0xa5adff-0x3bc);}function _0x252c36(_0x5d7c3d,_0x574de3){return _0x473f5b(_0x5d7c3d,_0x574de3-0x31f);}!defined(this['commandToExecute'])&&(this[_0x252c36(0x2de,0x29b)]=this[_0x431770(0x39b,0x351)](_0x5c26b9['context']));defined(this[_0x252c36(0x27d,0x265)])&&this[_0x252c36(0x298,0x265)]();if(!_0x5c26b9['commandList']){console[_0x431770(0x28c,0x2e2)](_0x252c36(0x2a8,0x297));return;}defined(this[_0x431770(0x2da,0x342)])&&_0x5c26b9['commandList']['push'](this[_0x252c36(0x2ad,0x2a5)]),defined(this[_0x252c36(0x244,0x29b)])&&_0x5c26b9['commandList']['push'](this[_0x431770(0x349,0x338)]);}[_0x473f5b(-0x102,-0xe6)](){return![];}['destroy'](){function _0x2f0500(_0x162a8e,_0xcaecd8){return _0x473f5b(_0x162a8e,_0xcaecd8-0x353);}function _0x5f2754(_0x43566e,_0x43f9df){return _0x473f5b(_0x43566e,_0x43f9df-0x24);}if(defined(this[_0x2f0500(0x31f,0x2cf)])){var _0x3d30a0;(_0x3d30a0=this[_0x2f0500(0x2f1,0x2cf)][_0x2f0500(0x2ba,0x24e)])===null||_0x3d30a0===void 0x0||_0x3d30a0['destroy'](),this[_0x2f0500(0x30a,0x2cf)][_0x5f2754(-0xb9,-0xe1)]=undefined;}return destroyObject(this);}}function deepMerge(_0x4a487d,_0x3f7476){if(!_0x4a487d)return _0x3f7476;if(!_0x3f7476)return _0x4a487d;const _0x4b55b9={..._0x3f7476},_0x3858b0=_0x4b55b9;function _0x166bd3(_0xebcc59,_0x48fe62){return _0x473f5b(_0x48fe62,_0xebcc59-0x554);}for(const _0x248d11 in _0x4a487d){if(Object['prototype']['hasOwnProperty']['call'](_0x4a487d,_0x248d11)){const _0xb3137=_0x4a487d[_0x248d11],_0x6ce724=_0x3f7476[_0x248d11];if(Array['isArray'](_0xb3137)){_0x3858b0[_0x248d11]=_0xb3137[_0x166bd3(0x4bf,0x4e5)]();continue;}if(_0xb3137&&typeof _0xb3137==='object'){_0x3858b0[_0x248d11]=deepMerge(_0xb3137,_0x6ce724||{});continue;}_0xb3137!==undefined&&(_0x3858b0[_0x248d11]=_0xb3137);}}return _0x3858b0;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace['Cesium'];class WindParticlesComputing{constructor(_0x15a135,_0x472ae5,_0x377f81,_0x5366cb,_0x335454){this[_0x3c4ac3(0x271,0x234)]=_0x15a135;function _0x3c4ac3(_0x533ed0,_0x1a8728){return _0x4ba7a1(_0x533ed0-0x161,_0x1a8728);}this['options']=_0x377f81,this['viewerParameters']=_0x5366cb;function _0x165d1c(_0x51033f,_0x1150c3){return _0x473f5b(_0x51033f,_0x1150c3-0xab);}this['windData']=_0x472ae5,this['frameRate']=0x3c,this[_0x3c4ac3(0x1e8,0x227)]=0x1;const _0x451902={};_0x451902[_0x3c4ac3(0x26a,0x2ce)]=_0x335454,_0x451902['samplingWindow']=0x1,_0x451902['quietPeriod']=0x0,this['frameRateMonitor']=new FrameRateMonitor(_0x451902),this[_0x165d1c(-0xa5,-0x75)](),this[_0x3c4ac3(0x1d0,0x233)](),this[_0x165d1c(-0x45,-0x74)](),this[_0x165d1c(-0x29,0x4a)]();}[_0x4ba7a1(0x89,0x2e)](){function _0x54d5dc(_0x53eea1,_0x55f7b9){return _0x4ba7a1(_0x53eea1- -0x270,_0x55f7b9);}const _0x3555f7=()=>{function _0x5a09af(_0xc19f2f,_0x2120f8){return _0x5d99(_0xc19f2f-0x136,_0x2120f8);}function _0x8aa542(_0x1598c1,_0x3d4874){return _0x5d99(_0x1598c1-0x199,_0x3d4874);}this[_0x5a09af(0x27c,0x2a5)]['lastFramesPerSecond']>0x14&&(this['frameRate']=this[_0x8aa542(0x2df,0x347)]['lastFramesPerSecond'],this['frameRateAdjustment']=0x3c/Math[_0x5a09af(0x244,0x1bf)](this[_0x8aa542(0x2a2,0x289)],0x1));};_0x3555f7();const _0x1bb259=setInterval(_0x3555f7,0x3e8),_0x103345=this['destroy'][_0x54d5dc(-0x11f,-0x141)](this);this['destroy']=()=>{clearInterval(_0x1bb259),_0x103345();};}['createWindTextures'](){const _0xf0c931={};function _0x385d99(_0x4e1687,_0x5c9160){return _0x4ba7a1(_0x5c9160- -0xde,_0x4e1687);}_0xf0c931['minificationFilter']=TextureMinificationFilter$1[_0x4706d0(0x4b,0x87)],_0xf0c931['magnificationFilter']=TextureMagnificationFilter$1['LINEAR'];const _0xa82158={'context':this['context'],'width':this['windData']['width'],'height':this['windData']['height'],'pixelFormat':PixelFormat$1[_0x385d99(-0x70,-0x28)],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this['options'][_0x4706d0(0x6,0x41)]??![],'sampler':new Sampler$1(_0xf0c931)};function _0x4706d0(_0x41a01e,_0x3f4a01){return _0x473f5b(_0x3f4a01,_0x41a01e-0x161);}this['windTextures']={'U':new Texture$1({..._0xa82158,'source':{'arrayBufferView':new Float32Array(this[_0x385d99(-0xd4,-0x69)]['u']['array'])}}),'V':new Texture$1({..._0xa82158,'source':{'arrayBufferView':new Float32Array(this[_0x385d99(-0xc3,-0x69)]['v']['array'])}})};}['createParticlesTextures'](){const _0x19ab41={};function _0x521c37(_0x8e0c45,_0x1b5a89){return _0x473f5b(_0x1b5a89,_0x8e0c45-0x4c7);}_0x19ab41['minificationFilter']=TextureMinificationFilter$1['NEAREST'];function _0x250fcf(_0x5225e4,_0x77e419){return _0x473f5b(_0x77e419,_0x5225e4- -0xf8);}_0x19ab41[_0x250fcf(-0x219,-0x249)]=TextureMagnificationFilter$1['NEAREST'];const _0x135c70={'context':this['context'],'width':this[_0x250fcf(-0x1b0,-0x16a)][_0x250fcf(-0x196,-0x218)],'height':this['options']['particlesTextureSize'],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1[_0x521c37(0x3d8,0x3d9)],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options'][_0x521c37(0x429,0x3ce)]*this['options'][_0x250fcf(-0x196,-0x118)]*0x4)['fill'](0x0)},'sampler':new Sampler$1(_0x19ab41)};this[_0x250fcf(-0x1c5,-0x15d)]={'previousParticlesPosition':new Texture$1(_0x135c70),'currentParticlesPosition':new Texture$1(_0x135c70),'nextParticlesPosition':new Texture$1(_0x135c70),'postProcessingPosition':new Texture$1(_0x135c70),'particlesSpeed':new Texture$1(_0x135c70)};}[_0x473f5b(-0x5d,-0xdb)](){function _0xdf715a(_0x4eed1c,_0x408e33){return _0x4ba7a1(_0x408e33-0x421,_0x4eed1c);}Object['values'](this[_0xdf715a(0x51b,0x4fd)])['forEach'](_0x247ee2=>_0x247ee2['destroy']());}['createComputingPrimitives'](){function _0x547655(_0x9c0752,_0x3e2929){return _0x473f5b(_0x3e2929,_0x9c0752-0x3f4);}function _0x4aa60d(_0x12e582,_0x48aa53){return _0x4ba7a1(_0x12e582-0x2b3,_0x48aa53);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':()=>this['windTextures']['U'],'V':()=>this[_0x547655(0x2b9,0x30d)]['V'],'uRange':()=>new Cartesian2$1(this[_0x4aa60d(0x328,0x2bf)]['u'][_0x4aa60d(0x3b4,0x3a5)],this['windData']['u']['max']),'vRange':()=>new Cartesian2$1(this['windData']['v'][_0x547655(0x34c,0x337)],this[_0x4aa60d(0x328,0x360)]['v'][_0x4aa60d(0x37f,0x318)]),'speedRange':()=>new Cartesian2$1(this[_0x4aa60d(0x328,0x364)]['speed'][_0x4aa60d(0x3b4,0x384)],this[_0x4aa60d(0x328,0x2a2)]['speed'][_0x4aa60d(0x37f,0x343)]),'currentParticlesPosition':()=>this['particlesTextures'][_0x547655(0x369,0x32a)],'speedScaleFactor':()=>{return(this['viewerParameters']['pixelSize']+0x32)*this['options']['speedFactor'];},'frameRateAdjustment':()=>this['frameRateAdjustment'],'dimension':()=>new Cartesian2$1(this['windData']['width'],this['windData']['height']),'minimum':()=>new Cartesian2$1(this[_0x547655(0x2c0,0x345)]['bounds'][_0x4aa60d(0x309,0x36f)],this['windData']['bounds'][_0x547655(0x2b0,0x298)]),'maximum':()=>new Cartesian2$1(this['windData'][_0x547655(0x2e9,0x292)]['east'],this['windData']['bounds'][_0x4aa60d(0x3a8,0x411)])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{const _0x5c654b=this['particlesTextures'][_0x814b5c(0x216,0x278)];function _0x4c0fef(_0x459a44,_0x43e7ea){return _0x4aa60d(_0x459a44- -0x176,_0x43e7ea);}this[_0x814b5c(0x28e,0x2e3)][_0x814b5c(0x2ba,0x278)]=this[_0x814b5c(0x279,0x2e3)]['currentParticlesPosition'],this['particlesTextures'][_0x4c0fef(0x25b,0x2a5)]=this['particlesTextures']['postProcessingPosition'];function _0x814b5c(_0x29f2d8,_0x3eae21){return _0x547655(_0x3eae21- -0x44,_0x29f2d8);}this[_0x814b5c(0x27b,0x2e3)]['postProcessingPosition']=_0x5c654b,this['primitives']['calculateSpeed']['commandToExecute']&&(this['primitives']['calculateSpeed'][_0x814b5c(0x32b,0x32c)]['outputTexture']=this[_0x4c0fef(0x219,0x1cf)][_0x814b5c(0x31c,0x329)]);},'isDynamic':()=>this['options']['dynamic']}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this['particlesTextures']['currentParticlesPosition'],'particlesSpeed':()=>this[_0x4aa60d(0x38f,0x411)]['particlesSpeed']},'fragmentShaderSource':ShaderManager['getUpdatePositionShader'](),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':()=>{function _0x362369(_0xda1a8a,_0x4e1cac){return _0x4aa60d(_0x4e1cac- -0x233,_0xda1a8a);}function _0x4ebe04(_0xcc3515,_0x5983b3){return _0x4aa60d(_0xcc3515- -0x588,_0x5983b3);}this['primitives'][_0x4ebe04(-0x1c9,-0x1eb)]['commandToExecute']&&(this['primitives']['updatePosition'][_0x4ebe04(-0x1b0,-0x15f)]['outputTexture']=this['particlesTextures']['nextParticlesPosition']);},'isDynamic':()=>this['options'][_0x547655(0x2ca,0x33e)]}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':()=>this[_0x547655(0x327,0x311)][_0x547655(0x29a,0x2d3)],'particlesSpeed':()=>this[_0x4aa60d(0x38f,0x3ba)]['particlesSpeed'],'lonRange':()=>this['viewerParameters']['lonRange'],'latRange':()=>this['viewerParameters'][_0x547655(0x30b,0x290)],'dataLonRange':()=>new Cartesian2$1(this['windData'][_0x547655(0x2e9,0x366)][_0x4aa60d(0x309,0x292)],this['windData'][_0x547655(0x2e9,0x2c0)]['east']),'dataLatRange':()=>new Cartesian2$1(this[_0x547655(0x2c0,0x278)][_0x4aa60d(0x351,0x37c)][_0x547655(0x2b0,0x2e4)],this['windData'][_0x4aa60d(0x351,0x31c)]['north']),'randomCoefficient':function(){return Math['random']();},'dropRate':()=>this[_0x547655(0x33c,0x371)]['dropRate'],'dropRateBump':()=>this[_0x547655(0x33c,0x310)][_0x547655(0x343,0x3c6)],'useViewerBounds':()=>this['options'][_0x4aa60d(0x3ac,0x381)]},'fragmentShaderSource':ShaderManager[_0x547655(0x2d1,0x259)](),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':()=>{function _0x93fc6d(_0x26d25a,_0x3dd75d){return _0x4aa60d(_0x26d25a- -0x31,_0x3dd75d);}function _0x106a28(_0x221a21,_0x5718d1){return _0x547655(_0x221a21- -0x11e,_0x5718d1);}this[_0x93fc6d(0x393,0x31a)]['postProcessingPosition'][_0x93fc6d(0x3a7,0x3d4)]&&(this['primitives']['postProcessingPosition']['commandToExecute'][_0x106a28(0x1da,0x232)]=this['particlesTextures']['postProcessingPosition']);},'isDynamic':()=>this['options']['dynamic']})};}[_0x473f5b(-0x15b,-0x14e)](){function _0x413452(_0x2d2580,_0x963da4){return _0x473f5b(_0x2d2580,_0x963da4- -0x150);}function _0x4736aa(_0xf67f8d,_0x4175c6){return _0x4ba7a1(_0xf67f8d- -0x90,_0x4175c6);}this[_0x413452(-0x2d0,-0x28b)]['U']['destroy'](),this[_0x4736aa(-0x22,0xe)]['V']['destroy'](),this['createWindTextures']();}['updateWindData'](_0x59ab11){this['windData']=_0x59ab11,this['reCreateWindTextures']();}[_0x473f5b(-0x102,-0xf0)](_0x31dc6d){function _0x386d79(_0xd8cb5a,_0x1d03ba){return _0x473f5b(_0x1d03ba,_0xd8cb5a- -0x14a);}function _0x279a43(_0xce2a24,_0xb82c7){return _0x473f5b(_0xb82c7,_0xce2a24- -0x196);}const _0x22febe=_0x31dc6d['flipY']!==undefined&&_0x31dc6d['flipY']!==this['options']['flipY'];this[_0x279a43(-0x24e,-0x274)]=deepMerge(_0x31dc6d,this[_0x386d79(-0x202,-0x230)]),_0x22febe&&this[_0x279a43(-0x2e4,-0x2a3)]();}[_0x473f5b(-0x96,-0xb6)](_0x68aca8){const {array:_0x4cc5dc}=_0x68aca8;let {min:_0x60a8fb,max:_0x227239}=_0x68aca8;function _0x6cf4c7(_0x48b997,_0x2b4371){return _0x473f5b(_0x2b4371,_0x48b997-0x2ff);}const _0x4d1a5b=new Float32Array(_0x4cc5dc['length']);function _0x48a80b(_0x50cd60,_0x409faf){return _0x4ba7a1(_0x50cd60-0xe0,_0x409faf);}_0x60a8fb===undefined&&(console['warn'](_0x6cf4c7(0x1a7,0x1d2)),_0x60a8fb=Math[_0x48a80b(0x1e1,0x1f3)](..._0x4cc5dc));_0x227239===undefined&&(console[_0x48a80b(0x1af,0x210)](_0x6cf4c7(0x260,0x1de)),_0x227239=Math['max'](..._0x4cc5dc));const _0x2f55a9=Math[_0x48a80b(0x1ac,0x192)](Math[_0x6cf4c7(0x281,0x26e)](_0x60a8fb),Math[_0x6cf4c7(0x281,0x296)](_0x227239));for(let _0x453796=0x0;_0x453796<_0x4cc5dc[_0x6cf4c7(0x1c9,0x1dc)];_0x453796++){const _0x4e3aa6=_0x4cc5dc[_0x453796]/_0x2f55a9;_0x4d1a5b[_0x453796]=_0x4e3aa6;}return _0x4d1a5b;}['destroy'](){Object['values'](this['windTextures'])['forEach'](_0x94ec72=>_0x94ec72['destroy']()),Object[_0x2df2ce(-0x157,-0x1da)](this[_0x1e075b(-0x1ea,-0x198)])['forEach'](_0x59d996=>_0x59d996[_0x1e075b(-0x139,-0x14c)]());function _0x1e075b(_0x35e65f,_0x16f810){return _0x4ba7a1(_0x16f810- -0x274,_0x35e65f);}function _0x2df2ce(_0x94a8bf,_0x16f1df){return _0x4ba7a1(_0x16f1df- -0x325,_0x94a8bf);}Object[_0x2df2ce(-0x19d,-0x1da)](this[_0x1e075b(-0x1c4,-0x163)])[_0x2df2ce(-0x20a,-0x25d)](_0x349fdd=>_0x349fdd['destroy']()),this[_0x1e075b(-0x107,-0x170)]['destroy']();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace['Cesium'];class WindParticlesRendering{constructor(_0x674321,_0x3b4357,_0x14cb6b,_0x10bc06){this[_0x59c1ed(0xb5,0x61)]=_0x674321,this[_0x59c1ed(-0x12,0x42)]=_0x3b4357,this['viewerParameters']=_0x14cb6b,this['computing']=_0x10bc06;(typeof this['options']['particlesTextureSize']!==_0x59c1ed(-0x49,0x1b)||this['options']['particlesTextureSize']<=0x0)&&(console['error'](_0x59c1ed(-0x50,-0x39)),this[_0x59c1ed(0x88,0x42)]['particlesTextureSize']=0x100);function _0x59c1ed(_0x45efdb,_0x15160e){return _0x4ba7a1(_0x15160e- -0xaf,_0x45efdb);}this['colorTable']=this['createColorTableTexture'](),this['textures']=this['createRenderingTextures'](),this['framebuffers']=this['createRenderingFramebuffers']();function _0x2f4bc6(_0x553a4c,_0x2542ac){return _0x4ba7a1(_0x553a4c- -0x225,_0x2542ac);}this['primitives']=this['createPrimitives']();}[_0x473f5b(-0x53,-0xae)](){const _0x563d4d={};_0x563d4d[_0x2f57af(0x1b8,0x1e7)]=this['context'],_0x563d4d['width']=this['context'][_0x3b27ce(0x3b6,0x3f7)];function _0x3b27ce(_0x4c1a23,_0x265ccd){return _0x4ba7a1(_0x265ccd-0x37a,_0x4c1a23);}_0x563d4d['height']=this['context']['drawingBufferHeight'],_0x563d4d['pixelFormat']=PixelFormat[_0x2f57af(0x143,0xdc)],_0x563d4d[_0x3b27ce(0x3bc,0x42a)]=PixelDatatype['UNSIGNED_BYTE'];const _0x50b783=_0x563d4d,_0x2865a8={};_0x2865a8['context']=this[_0x3b27ce(0x486,0x48a)];function _0x2f57af(_0x16d53d,_0x3e320f){return _0x473f5b(_0x3e320f,_0x16d53d-0x251);}_0x2865a8[_0x2f57af(0x16a,0x153)]=this[_0x2f57af(0x1b8,0x197)]['drawingBufferWidth'],_0x2865a8['height']=this[_0x2f57af(0x1b8,0x235)]['drawingBufferHeight'],_0x2865a8['pixelFormat']=PixelFormat['DEPTH_COMPONENT'],_0x2865a8['pixelDatatype']=PixelDatatype[_0x2f57af(0x1ad,0x20e)];const _0x57b42c=_0x2865a8;return{'segmentsColor':new Texture(_0x50b783),'segmentsDepth':new Texture(_0x57b42c)};}['createRenderingFramebuffers'](){function _0xf28194(_0x3f07e3,_0x547a94){return _0x473f5b(_0x547a94,_0x3f07e3-0x3e8);}function _0x419c78(_0x5f46ee,_0x56c168){return _0x473f5b(_0x56c168,_0x5f46ee-0x3d);}const _0x191f10={};return _0x191f10['context']=this[_0x419c78(-0x5c,-0x9e)],_0x191f10[_0xf28194(0x31d,0x308)]=[this[_0x419c78(-0xd0,-0x58)][_0xf28194(0x32f,0x2e1)]],_0x191f10['depthTexture']=this[_0xf28194(0x2db,0x303)]['segmentsDepth'],{'segments':new Framebuffer(_0x191f10)};}['destoryRenderingFramebuffers'](){function _0x3a0dba(_0x1f2ab9,_0x5095ca){return _0x4ba7a1(_0x5095ca- -0x1fe,_0x1f2ab9);}Object['values'](this['framebuffers'])[_0x3a0dba(-0x180,-0x136)](_0x46537c=>{_0x46537c['destroy']();});}['createColorTableTexture'](){const _0x4d4797=new Float32Array(this['options']['colors'][_0xb9316e(0x40b,0x3f6)](_0x5b27a2=>{function _0x152367(_0x11a203,_0x4f61ed){return _0xb9316e(_0x4f61ed- -0x3a9,_0x11a203);}const _0x28671a=Color$1['fromCssColorString'](_0x5b27a2);return[_0x28671a['red'],_0x28671a[_0x152367(0x61,-0x2)],_0x28671a['blue'],_0x28671a['alpha']];})),_0x1b7a23={};_0x1b7a23['minificationFilter']=TextureMinificationFilter['LINEAR'],_0x1b7a23['magnificationFilter']=TextureMagnificationFilter[_0x174759(0x16,-0x38)];function _0xb9316e(_0x26f53b,_0x434c7c){return _0x473f5b(_0x434c7c,_0x26f53b-0x4de);}_0x1b7a23['wrapS']=TextureWrap['CLAMP_TO_EDGE'],_0x1b7a23['wrapT']=TextureWrap['CLAMP_TO_EDGE'];function _0x174759(_0xbd1adb,_0x230e2a){return _0x4ba7a1(_0x230e2a- -0xcb,_0xbd1adb);}return new Texture({'context':this[_0x174759(0xc5,0x45)],'width':this[_0xb9316e(0x426,0x3ed)]['colors']['length'],'height':0x1,'pixelFormat':PixelFormat['RGBA'],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x1b7a23),'source':{'width':this[_0xb9316e(0x426,0x3b6)][_0x174759(-0x48,-0x7)][_0x174759(-0xb,-0x58)],'height':0x1,'arrayBufferView':_0x4d4797}});}['createSegmentsGeometry'](){const _0x3b64e7=0x4,_0xc4a7d8=this['options'][_0xedbf62(-0x1af,-0x1b7)];let _0x333e47=[];function _0xedbf62(_0x245eb8,_0x837a2b){return _0x473f5b(_0x245eb8,_0x837a2b- -0x119);}for(let _0x38e166=0x0;_0x38e166<_0xc4a7d8;_0x38e166++){for(let _0x4b70a0=0x0;_0x4b70a0<_0xc4a7d8;_0x4b70a0++){for(let _0x5c344b=0x0;_0x5c344b<_0x3b64e7;_0x5c344b++){_0x333e47[_0x360dbb(0x4fe,0x483)](_0x38e166/_0xc4a7d8),_0x333e47[_0xedbf62(-0x219,-0x1b5)](_0x4b70a0/_0xc4a7d8);}}}_0x333e47=new Float32Array(_0x333e47);const _0x2eb085=this['options']['particlesTextureSize']**0x2;let _0x201803=[];for(let _0x457b12=0x0;_0x457b12<_0x2eb085;_0x457b12++){_0x201803[_0xedbf62(-0x223,-0x1b5)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x201803=new Float32Array(_0x201803);let _0x27c96a=[];for(let _0x3b8c63=0x0,_0x311bab=0x0;_0x3b8c63<_0x2eb085;_0x3b8c63++){_0x27c96a[_0x360dbb(0x4fe,0x4ab)](_0x311bab+0x0,_0x311bab+0x1,_0x311bab+0x2,_0x311bab+0x2,_0x311bab+0x1,_0x311bab+0x3),_0x311bab+=_0x3b64e7;}_0x27c96a=new Uint32Array(_0x27c96a);const _0x2ae0ef={};function _0x360dbb(_0x3583fe,_0x3e9e3a){return _0x4ba7a1(_0x3583fe-0x3f1,_0x3e9e3a);}_0x2ae0ef[_0xedbf62(-0x266,-0x1fd)]=ComponentDatatype[_0xedbf62(-0x269,-0x208)],_0x2ae0ef[_0x360dbb(0x46b,0x440)]=0x2,_0x2ae0ef['values']=_0x333e47;const _0x56aba5={};_0x56aba5[_0xedbf62(-0x26d,-0x1fd)]=ComponentDatatype['FLOAT'],_0x56aba5['componentsPerAttribute']=0x3,_0x56aba5['values']=_0x201803;const _0xaa1e9d=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x2ae0ef),'normal':new GeometryAttribute(_0x56aba5)}),'indices':_0x27c96a});return _0xaa1e9d;}['createRawRenderState'](_0x257229){const _0x45f9af={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x257229};return Appearance['getDefaultRenderState'](!![],![],_0x45f9af);}['createPrimitives'](){const _0x23e7b1={};_0x23e7b1['st']=0x0,_0x23e7b1[_0x457f39(-0x149,-0x194)]=0x1;const _0x1067a1={};_0x1067a1['enabled']=!![];const _0x59ad7a={};function _0xa4eee1(_0x1e91e6,_0x31b2f9){return _0x473f5b(_0x31b2f9,_0x1e91e6-0x371);}_0x59ad7a[_0x457f39(-0x148,-0xcb)]=!![],_0x59ad7a['blendEquation']=WebGLRenderingContext[_0x457f39(-0x60,-0x67)],_0x59ad7a['blendFuncSource']=WebGLRenderingContext['SRC_ALPHA'],_0x59ad7a[_0x457f39(-0x61,-0x71)]=WebGLRenderingContext[_0x457f39(-0xb1,-0x58)];const _0x3437b7={};function _0x457f39(_0x116ee7,_0x15815a){return _0x473f5b(_0x15815a,_0x116ee7-0x18);}_0x3437b7[_0xa4eee1(0x287,0x228)]=undefined,_0x3437b7['depthTest']=_0x1067a1,_0x3437b7['depthMask']=!![],_0x3437b7['blending']=_0x59ad7a;const _0x2bee74=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x23e7b1,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType[_0xa4eee1(0x317,0x2b8)],'uniformMap':{'previousParticlesPosition':()=>this['computing']['particlesTextures'][_0x457f39(-0x120,-0x108)],'currentParticlesPosition':()=>this['computing']['particlesTextures']['currentParticlesPosition'],'postProcessingPosition':()=>this['computing'][_0xa4eee1(0x2a4,0x28a)]['postProcessingPosition'],'particlesSpeed':()=>this['computing']['particlesTextures']['particlesSpeed'],'frameRateAdjustment':()=>this[_0xa4eee1(0x305,0x2fc)][_0x457f39(-0x10a,-0x119)],'colorTable':()=>this[_0xa4eee1(0x2de,0x2d0)],'domain':()=>{var _0x5bd9be,_0x5da993;function _0xc9a15c(_0x1f2bb2,_0x3d87c5){return _0x457f39(_0x3d87c5-0x275,_0x1f2bb2);}function _0x403a20(_0x2abf36,_0x15efb9){return _0xa4eee1(_0x2abf36- -0x4ce,_0x15efb9);}const _0x4debf1=new Cartesian2(((_0x5bd9be=this[_0x403a20(-0x215,-0x257)][_0xc9a15c(0x1f0,0x1a5)])===null||_0x5bd9be===void 0x0?void 0x0:_0x5bd9be[_0x403a20(-0x205,-0x1ab)])??this[_0xc9a15c(0x28d,0x221)][_0x403a20(-0x291,-0x217)]['speed']['min'],((_0x5da993=this[_0xc9a15c(0x19b,0x1d5)]['domain'])===null||_0x5da993===void 0x0?void 0x0:_0x5da993[_0xc9a15c(0x229,0x1b0)])??this['computing']['windData']['speed'][_0x403a20(-0x23a,-0x200)]);return _0x4debf1;},'displayRange':()=>{var _0x3c3cfc,_0x400104;function _0x133c17(_0x371b1a,_0x143280){return _0x457f39(_0x371b1a-0x4e7,_0x143280);}function _0x3e1016(_0xb6122c,_0x589755){return _0xa4eee1(_0xb6122c- -0x4d6,_0x589755);}const _0x293ac6=new Cartesian2(((_0x3c3cfc=this['options']['displayRange'])===null||_0x3c3cfc===void 0x0?void 0x0:_0x3c3cfc['min'])??this['computing'][_0x3e1016(-0x299,-0x29f)]['speed']['min'],((_0x400104=this[_0x133c17(0x447,0x3c5)]['displayRange'])===null||_0x400104===void 0x0?void 0x0:_0x400104['max'])??this['computing']['windData'][_0x133c17(0x413,0x453)][_0x133c17(0x422,0x47a)]);return _0x293ac6;},'particleHeight':()=>this['options']['fixedHeight']||0x0,'aspect':()=>this['context'][_0xa4eee1(0x245,0x1d8)]/this[_0x457f39(-0x81,-0x6b)]['drawingBufferHeight'],'pixelSize':()=>this['viewerParameters'][_0x457f39(-0x83,-0x14)],'lineWidth':()=>{const _0x39d055={};_0x39d055[_0x1b25d3(-0x20d,-0x1cc)]=0x1,_0x39d055[_0x1b25d3(-0x20c,-0x201)]=0x2;function _0x49ba08(_0x5af3f6,_0x5e44c7){return _0xa4eee1(_0x5e44c7- -0x4e9,_0x5af3f6);}const _0x341455=this[_0x49ba08(-0x275,-0x230)]['lineWidth']||_0x39d055;function _0x1b25d3(_0x349972,_0x161fd8){return _0x457f39(_0x161fd8- -0x13c,_0x349972);}return new Cartesian2(_0x341455['min'],_0x341455['max']);},'lineLength':()=>{function _0x2f2b5a(_0x376e57,_0x5d20d9){return _0x457f39(_0x5d20d9-0x1c6,_0x376e57);}const _0x4fb63e={};function _0x1b9908(_0x59081a,_0x1f4924){return _0xa4eee1(_0x1f4924-0x1db,_0x59081a);}_0x4fb63e['min']=0x14,_0x4fb63e[_0x2f2b5a(0xea,0x101)]=0x64;const _0x5b286c=this['options'][_0x2f2b5a(0xf5,0x121)]||_0x4fb63e;return new Cartesian2(_0x5b286c[_0x1b9908(0x442,0x4a4)],_0x5b286c['max']);},'is3D':()=>this[_0xa4eee1(0x2ab,0x24f)][_0xa4eee1(0x271,0x25f)]===SceneMode[_0x457f39(-0x64,-0xa)],'segmentsDepthTexture':()=>this[_0x457f39(-0xf5,-0x170)]['segmentsDepth']},'vertexShaderSource':ShaderManager['getSegmentDrawVertexShader'](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this['createRawRenderState'](_0x3437b7)}),_0x145b1f={};return _0x145b1f['segments']=_0x2bee74,_0x145b1f;}[_0x4ba7a1(0xfc,0xac)](){const _0x331d0e=this['createSegmentsGeometry']();function _0x241d81(_0x24ef2a,_0x34673e){return _0x4ba7a1(_0x34673e- -0x2c0,_0x24ef2a);}this[_0x241d81(-0x147,-0x1af)]['segments']['geometry']=_0x331d0e;const _0x4253ef={};_0x4253ef['context']=this[_0x241d81(-0x194,-0x1b0)];function _0x39d902(_0x1fdea9,_0x37c772){return _0x4ba7a1(_0x37c772- -0x374,_0x1fdea9);}_0x4253ef['geometry']=_0x331d0e,_0x4253ef[_0x241d81(-0x15b,-0x1c3)]=this['primitives']['segments']['attributeLocations'],_0x4253ef['bufferUsage']=BufferUsage['STATIC_DRAW'];const _0x4efabb=VertexArray['fromGeometry'](_0x4253ef);this['primitives'][_0x39d902(-0x343,-0x317)]['commandToExecute']&&(this['primitives'][_0x241d81(-0x24a,-0x263)]['commandToExecute']['vertexArray']=_0x4efabb);}['onColorTableChange'](){this['colorTable'][_0x465d8c(0x180,0x15a)]();function _0x441538(_0x594129,_0x4846ea){return _0x473f5b(_0x594129,_0x4846ea-0x4d9);}function _0x465d8c(_0x19ebfb,_0x43c5f2){return _0x473f5b(_0x43c5f2,_0x19ebfb-0x201);}this[_0x441538(0x3fd,0x446)]=this['createColorTableTexture']();}[_0x473f5b(-0x77,-0xf0)](_0x3f1fd7){function _0x5cde35(_0xb40dcf,_0x59ccb7){return _0x4ba7a1(_0x59ccb7- -0x285,_0xb40dcf);}const _0x2764f5=_0x3f1fd7[_0x1e9371(-0xe,0x12)]&&JSON[_0x5cde35(-0x259,-0x230)](_0x3f1fd7[_0x5cde35(-0x229,-0x1c1)])!==JSON[_0x1e9371(-0xae,-0x5d)](this['options']['colors']);function _0x1e9371(_0x56a9d8,_0x364b32){return _0x473f5b(_0x56a9d8,_0x364b32-0xf7);}this[_0x5cde35(-0x1c4,-0x194)]=deepMerge(_0x3f1fd7,this[_0x1e9371(0xc0,0x3f)]),_0x2764f5&&this['onColorTableChange']();}['destroy'](){function _0x498326(_0x2c9745,_0x517c8e){return _0x4ba7a1(_0x2c9745-0x2e9,_0x517c8e);}Object['values'](this['framebuffers'])['forEach'](_0x5658f4=>{function _0x2e83e0(_0x41cbbf,_0x104753){return _0x5d99(_0x104753-0x1ef,_0x41cbbf);}_0x5658f4[_0x2e83e0(0x333,0x359)]();}),Object['values'](this['primitives'])['forEach'](_0x517e68=>{_0x517e68['destroy']();}),this['colorTable'][_0x498326(0x411,0x3f5)]();}}const {ClearCommand,Color,Pass}=mars3d__namespace['Cesium'];class WindParticleSystem{constructor(_0x5e07f8,_0x58057d,_0x2a2041,_0x5d8f6f,_0x5a35ad){this[_0x22474f(0x42f,0x412)]=_0x5e07f8;function _0x22474f(_0x3417fa,_0x595c9b){return _0x4ba7a1(_0x3417fa-0x31f,_0x595c9b);}this['options']=_0x2a2041,this['viewerParameters']=_0x5d8f6f;function _0x5d6bf(_0x28a7a6,_0x273aad){return _0x4ba7a1(_0x28a7a6- -0x333,_0x273aad);}this['computing']=new WindParticlesComputing(_0x5e07f8,_0x58057d,_0x2a2041,_0x5d8f6f,_0x5a35ad),this['rendering']=new WindParticlesRendering(_0x5e07f8,_0x2a2041,_0x5d8f6f,this['computing']),this[_0x22474f(0x45a,0x481)]();}['getPrimitives'](){const _0x2e4ab0=[this['computing']['primitives']['calculateSpeed'],this['computing'][_0x5877ce(0x33c,0x2fa)][_0x5081b8(0x268,0x1fc)],this['computing']['primitives'][_0x5081b8(0x153,0x16e)],this[_0x5081b8(0x2b5,0x23a)]['primitives'][_0x5877ce(0x1e9,0x246)]];function _0x5877ce(_0x4c5215,_0x3b3457){return _0x473f5b(_0x4c5215,_0x3b3457-0x392);}function _0x5081b8(_0x137975,_0x185cff){return _0x473f5b(_0x137975,_0x185cff-0x299);}return _0x2e4ab0;}['clearFramebuffers'](){const _0x73a422=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass[_0x262af4(0x33e,0x3b2)]});function _0x262af4(_0x33412d,_0x120c26){return _0x473f5b(_0x33412d,_0x120c26-0x425);}function _0x37e38f(_0x2f34cc,_0x573119){return _0x473f5b(_0x573119,_0x2f34cc-0x160);}Object['keys'](this['rendering'][_0x37e38f(0x1b,-0x2e)])[_0x37e38f(0x7f,0x24)](_0x56fa70=>{_0x73a422[_0x5a0dde(0x276,0x2e6)]=this['rendering'][_0x5a0dde(0x287,0x29e)][_0x56fa70];function _0x28df5f(_0x39c048,_0x20f43b){return _0x262af4(_0x39c048,_0x20f43b- -0x60e);}function _0x5a0dde(_0x3eb3ae,_0x31cf2c){return _0x262af4(_0x3eb3ae,_0x31cf2c- -0x42);}_0x73a422[_0x28df5f(-0x35b,-0x2f0)](this[_0x28df5f(-0x28d,-0x282)]);});}['changeOptions'](_0x5b8722){let _0x4f772e=![];_0x5b8722[_0x485ae8(0x135,0xc7)]&&this[_0x110f41(-0x26,-0x26)][_0x485ae8(0x135,0x165)]!==_0x5b8722['particlesTextureSize']&&(_0x4f772e=!![]);const _0x2b69e6=deepMerge(_0x5b8722,this['options']);if(_0x2b69e6['particlesTextureSize']<0x1)throw new Error('particlesTextureSize\x20must\x20be\x20greater\x20than\x200');function _0x485ae8(_0x1895b6,_0x12cce9){return _0x4ba7a1(_0x1895b6-0x2a,_0x12cce9);}this[_0x110f41(-0x1e,-0x26)]=_0x2b69e6,this['rendering'][_0x485ae8(0xe3,0x81)](_0x5b8722);function _0x110f41(_0x4d59b8,_0x44db66){return _0x4ba7a1(_0x44db66- -0x117,_0x4d59b8);}this[_0x110f41(-0x55,0x26)]['updateOptions'](_0x5b8722),_0x4f772e&&(this[_0x485ae8(0x167,0x1ac)]['destroyParticlesTextures'](),this[_0x485ae8(0x167,0xf5)][_0x485ae8(0xb4,0x99)](),this[_0x485ae8(0x174,0x1c3)][_0x485ae8(0x126,0x160)]());}[_0x4ba7a1(0x120,0x143)](_0x215b0b){function _0x256d57(_0x44ce6c,_0x36a7a4){return _0x473f5b(_0x44ce6c,_0x36a7a4-0x3aa);}this[_0x256d57(0x2be,0x2e4)]=_0x215b0b;function _0x11b010(_0x13db45,_0x50ce2f){return _0x473f5b(_0x50ce2f,_0x13db45-0x3b2);}this[_0x256d57(0x3c4,0x33e)]['viewerParameters']=_0x215b0b,this['rendering'][_0x11b010(0x2ec,0x26a)]=_0x215b0b;}['destroy'](){this['computing']['destroy'](),this['rendering']['destroy']();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x54f885={};_0x54f885[_0x4ba7a1(0x101,0x99)]=0x1,_0x54f885['max']=0x2;const _0x297fac={};function _0x4ba7a1(_0x3a14e6,_0x614c6c){return _0x5d99(_0x3a14e6- -0x42,_0x614c6c);}_0x297fac['min']=0x14,_0x297fac[_0x473f5b(-0x13d,-0xdd)]=0x64;const _0x4d14fc={};_0x4d14fc[_0x4ba7a1(0x10b,0xf5)]=0x64,_0x4d14fc['fixedHeight']=0x0,_0x4d14fc['lineWidth']=_0x54f885,_0x4d14fc['lineLength']=_0x297fac,_0x4d14fc['speedFactor']=0x1,_0x4d14fc['dropRate']=0.003,_0x4d14fc['dropRateBump']=0.001,_0x4d14fc['colors']=['rgb(206,255,255)'],_0x4d14fc['flipY']=![],_0x4d14fc[_0x4ba7a1(0x7f,0x31)]=!![];const DEF_OPTIONS=_0x4d14fc;function _0x5d99(_0x231499,_0x1373f3){const _0x3b05a1=_0x3b05();return _0x5d99=function(_0x5d9909,_0x5a7f58){_0x5d9909=_0x5d9909-0x8a;let _0x1024cc=_0x3b05a1[_0x5d9909];return _0x1024cc;},_0x5d99(_0x231499,_0x1373f3);}class WindLayer extends BaseLayer$1{constructor(_0x5b87df={}){_0x5b87df={...DEF_OPTIONS,..._0x5b87df},super(_0x5b87df),this['_setOptionsHook'](_0x5b87df,_0x5b87df);}get[_0x4ba7a1(0x7b,0x60)](){function _0x16a7aa(_0x120f53,_0x140e25){return _0x4ba7a1(_0x120f53-0x15d,_0x140e25);}return this[_0x16a7aa(0x26e,0x1f4)];}get['data'](){return this['options']['data'];}set['data'](_0x25d6fb){this['options']['data']=_0x25d6fb;function _0x4bd587(_0x4bf67d,_0xdcd9d9){return _0x4ba7a1(_0xdcd9d9-0x396,_0x4bf67d);}this[_0x4bd587(0x452,0x49d)](_0x25d6fb);}get['colors'](){function _0x24a132(_0x211b5c,_0x2a8a22){return _0x4ba7a1(_0x211b5c- -0x2fa,_0x2a8a22);}function _0x27f8a4(_0x9b9cbc,_0x5f4a9b){return _0x473f5b(_0x5f4a9b,_0x9b9cbc- -0x8b);}return this[_0x24a132(-0x209,-0x27e)][_0x27f8a4(-0x170,-0x14f)];}set['colors'](_0x4d2c13){this['options']['colors']=_0x4d2c13;function _0x24a23d(_0x5c8395,_0xad1364){return _0x473f5b(_0x5c8395,_0xad1364-0x3a1);}const _0xa06713={};_0xa06713[_0x2b1568(0x1f,0x96)]=_0x4d2c13;function _0x2b1568(_0x1de7ae,_0x23e1ef){return _0x4ba7a1(_0x1de7ae- -0xa5,_0x23e1ef);}this['_setOptionsHook'](this[_0x24a23d(0x2b1,0x2e9)],_0xa06713);}['_showHook'](_0x3149e1){_0x3149e1?this['_addedHook']():this['_removedHook']();}['_mountedHook'](){}[_0x473f5b(-0xb2,-0x11c)](){function _0x23d4d4(_0x2e2d50,_0x4a9134){return _0x4ba7a1(_0x2e2d50-0x37b,_0x4a9134);}this['scene']=this['_map']['scene'],this['camera']=this['_map']['camera'];this['options']['data']&&this['setData'](this['options']['data']);if(!this['windData']||!this[_0x23ff79(0x38a,0x304)])return;this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](-0xb4,0xb4),'latRange':new Cesium$1[(_0x23ff79(0x2d0,0x294))](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this[_0x23d4d4(0x484,0x4a3)]['mode']},this['updateViewerParameters'](),this[_0x23ff79(0x386,0x3fe)]=new WindParticleSystem(this[_0x23ff79(0x34a,0x3c8)][_0x23ff79(0x351,0x2db)],this[_0x23d4d4(0x3f0,0x453)],this['options'],this['viewerParameters'],this[_0x23d4d4(0x484,0x406)]),this['primitives']=this[_0x23d4d4(0x4c0,0x4ad)]['getPrimitives'](),this[_0x23d4d4(0x48c,0x510)]['forEach'](_0x35b499=>{function _0x5012b8(_0x149951,_0x38b77f){return _0x23ff79(_0x38b77f- -0x44c,_0x149951);}this['scene'][_0x5012b8(-0x136,-0xfa)]['add'](_0x35b499);});function _0x23ff79(_0x50ec30,_0x52b5c5){return _0x473f5b(_0x52b5c5,_0x50ec30-0x3ea);}this['camera']['percentageChanged']=0.01,this['camera'][_0x23ff79(0x36a,0x32c)][_0x23d4d4(0x436,0x3cc)](this['updateViewerParameters']['bind'](this)),this[_0x23d4d4(0x484,0x4ef)]['morphComplete'][_0x23ff79(0x2fc,0x362)](this['updateViewerParameters']['bind'](this)),window[_0x23d4d4(0x436,0x492)]('resize',this[_0x23d4d4(0x483,0x483)]['bind'](this));}['_removedHook'](){function _0x243d76(_0x4d3281,_0x1d47ea){return _0x473f5b(_0x1d47ea,_0x4d3281-0x305);}this['camera']['changed']['removeEventListener'](this[_0x243d76(0x264,0x20e)][_0x23f64f(0x1ac,0x1e7)](this)),this[_0x23f64f(0x164,0x137)]['morphComplete']['removeEventListener'](this[_0x23f64f(0x163,0xe0)]['bind'](this)),window[_0x23f64f(0x10c,0x18f)]('resize',this[_0x23f64f(0x163,0xf4)]['bind'](this));this[_0x23f64f(0x16c,0x1aa)]&&(this['primitives']['forEach'](_0x45d761=>{this['scene']['primitives']['remove'](_0x45d761);}),delete this[_0x23f64f(0x16c,0x1d8)]);function _0x23f64f(_0x441aaf,_0x665e1c){return _0x4ba7a1(_0x441aaf-0x5b,_0x665e1c);}this[_0x243d76(0x2a1,0x2e7)]&&(this['particleSystem']['destroy'](),delete this['particleSystem']);}['setData'](_0xf2b8b8,_0x4df16a){this['windData']=this['processWindData'](_0xf2b8b8);if(_0x4df16a){this['_removedHook'](),this['_addedHook']();return;}function _0x3b9890(_0xfcd54e,_0x4e7de9){return _0x473f5b(_0xfcd54e,_0x4e7de9-0x575);}function _0x3f16c1(_0x2a7e70,_0x2170f0){return _0x473f5b(_0x2170f0,_0x2a7e70- -0xfb);}this['particleSystem']?(this['particleSystem']['computing']['updateWindData'](this[_0x3b9890(0x408,0x441)]),this['scene']['requestRender']()):this[_0x3b9890(0x436,0x459)]();}[_0x4ba7a1(0x144,0xfe)](_0x494392,_0x307010){function _0x2671fc(_0x29c424,_0x30ec80){return _0x473f5b(_0x29c424,_0x30ec80- -0xe8);}function _0x29a9cb(_0x3b234c,_0x256b55){return _0x4ba7a1(_0x3b234c- -0x233,_0x256b55);}this[_0x29a9cb(-0xee,-0x8a)]&&(this[_0x29a9cb(-0xee,-0x99)][_0x29a9cb(-0x1e6,-0x16d)](_0x307010),this['scene'][_0x2671fc(-0x1dc,-0x1b7)]());}[_0x473f5b(-0x79,-0xb6)](_0x44386d){var _0x5e185d,_0x249dbe;function _0x435b9d(_0x51a271,_0x1ba6b8){return _0x473f5b(_0x1ba6b8,_0x51a271-0xbf);}const _0x42db6a={..._0x44386d};function _0x1de63b(_0x337377,_0xb977bd){return _0x4ba7a1(_0xb977bd- -0x36e,_0x337377);}const _0x11b77d=_0x42db6a;!_0x11b77d[_0x1de63b(-0x2d7,-0x31a)]&&_0x11b77d[_0x1de63b(-0x201,-0x235)]&&(_0x11b77d[_0x435b9d(-0x96,-0xae)]=_0x11b77d[_0x1de63b(-0x286,-0x235)]);!_0x11b77d['width']&&_0x11b77d['cols']&&(_0x11b77d[_0x1de63b(-0x238,-0x2ac)]=_0x11b77d['cols']);!_0x11b77d[_0x1de63b(-0x2de,-0x2d0)]&&(_0x11b77d['bounds']={'west':_0x11b77d[_0x1de63b(-0x268,-0x2ed)],'south':_0x11b77d['ymin'],'east':_0x11b77d[_0x1de63b(-0x2ff,-0x284)],'north':_0x11b77d[_0x435b9d(-0x38,-0x98)]});if(!_0x11b77d['u']){const _0x3ebd6d={};_0x3ebd6d['array']=_0x44386d['udata'],_0x3ebd6d['min']=_0x44386d['umin'],_0x3ebd6d[_0x1de63b(-0x2ab,-0x2a2)]=_0x44386d[_0x1de63b(-0x364,-0x314)],_0x11b77d['u']=_0x3ebd6d;}if(!_0x11b77d['v']){const _0xaf5d4={};_0xaf5d4['array']=_0x44386d['vdata'],_0xaf5d4['min']=_0x44386d['vmin'],_0xaf5d4['max']=_0x44386d['vmax'],_0x11b77d['v']=_0xaf5d4;}if(((_0x5e185d=_0x11b77d['speed'])===null||_0x5e185d===void 0x0?void 0x0:_0x5e185d['min'])===undefined||((_0x249dbe=_0x11b77d[_0x1de63b(-0x232,-0x2b1)])===null||_0x249dbe===void 0x0?void 0x0:_0x249dbe['max'])===undefined||_0x11b77d[_0x1de63b(-0x335,-0x2b1)]['array']===undefined){const _0x566d22={'array':new Float32Array(_0x11b77d['u']['array']['length']),'min':Number[_0x435b9d(-0x11,0x72)],'max':Number[_0x435b9d(0x8,-0x1d)]};for(let _0x56e96e=0x0;_0x56e96e<_0x11b77d['u'][_0x1de63b(-0x251,-0x297)]['length'];_0x56e96e++){_0x566d22['array'][_0x56e96e]=Math[_0x435b9d(-0x8b,-0x21)](_0x11b77d['u']['array'][_0x56e96e]*_0x11b77d['u']['array'][_0x56e96e]+_0x11b77d['v']['array'][_0x56e96e]*_0x11b77d['v'][_0x1de63b(-0x287,-0x297)][_0x56e96e]),_0x566d22[_0x435b9d(-0x13,0x55)][_0x56e96e]!==0x0&&(_0x566d22[_0x1de63b(-0x23e,-0x26d)]=Math[_0x435b9d(0x17,0xe)](_0x566d22[_0x435b9d(0x17,0x55)],_0x566d22[_0x1de63b(-0x22a,-0x297)][_0x56e96e]),_0x566d22[_0x1de63b(-0x24d,-0x2a2)]=Math['max'](_0x566d22['max'],_0x566d22['array'][_0x56e96e]));}_0x11b77d['speed']=_0x566d22;}return _0x11b77d;}['updateViewerParameters'](){function _0x4a568a(_0x49194c,_0x432195){return _0x4ba7a1(_0x432195- -0x86,_0x49194c);}var _0x2cf696;const _0x35a3f7=this['scene'];if(!_0x35a3f7)return;const _0x3c568e=_0x35a3f7['canvas'],_0x121846={};_0x121846['x']=0x0,_0x121846['y']=0x0;const _0x557c3f={};_0x557c3f['x']=0x0,_0x557c3f['y']=_0x3c568e['clientHeight'];const _0x3fbb69={};_0x3fbb69['x']=_0x3c568e['clientWidth'],_0x3fbb69['y']=0x0;const _0x34b7fa={};_0x34b7fa['x']=_0x3c568e[_0x57687c(-0x63,-0x67)],_0x34b7fa['y']=_0x3c568e[_0x4a568a(0x74,0x7a)];const _0x2d89a4=[_0x121846,_0x557c3f,_0x3fbb69,_0x34b7fa];let _0x3eb93c=0xb4;function _0x57687c(_0x188bba,_0x21c420){return _0x473f5b(_0x21c420,_0x188bba-0x44);}let _0xbec283=-0xb4,_0x3bbf41=0x5a,_0xc14278=-0x5a,_0x48aec8=![];for(const _0xbb43c2 of _0x2d89a4){const _0x1018f1=_0x35a3f7['camera'][_0x4a568a(0x4,0x79)](new Cesium$1[(_0x57687c(-0xd6,-0x117))](_0xbb43c2['x'],_0xbb43c2['y']),_0x35a3f7[_0x4a568a(-0x6,0x5b)][_0x57687c(-0xcb,-0xfc)]);if(!_0x1018f1){_0x48aec8=!![];break;}const _0x5a3925=_0x35a3f7[_0x4a568a(0x6d,0x5b)]['ellipsoid']['cartesianToCartographic'](_0x1018f1),_0x21fb94=Cesium$1[_0x57687c(-0x1f,-0x32)][_0x4a568a(0x25,0x31)](_0x5a3925['longitude']),_0x2a636f=Cesium$1[_0x57687c(-0x1f,-0x3f)]['toDegrees'](_0x5a3925['latitude']);_0x3eb93c=Math['min'](_0x3eb93c,_0x21fb94),_0xbec283=Math['max'](_0xbec283,_0x21fb94),_0x3bbf41=Math[_0x57687c(-0x64,-0x6e)](_0x3bbf41,_0x2a636f),_0xc14278=Math[_0x57687c(-0x99,-0x54)](_0xc14278,_0x2a636f);}if(!_0x48aec8){const _0x55442d=new Cesium$1[(_0x57687c(-0xd6,-0xa2))](Math['max'](this['windData']['bounds']['west'],_0x3eb93c),Math[_0x57687c(-0x64,-0x2b)](this[_0x4a568a(0x34,-0x11)]['bounds']['east'],_0xbec283)),_0x340221=new Cesium$1['Cartesian2'](Math['max'](this[_0x57687c(-0xf0,-0x97)]['bounds'][_0x4a568a(-0x67,-0x21)],_0x3bbf41),Math[_0x57687c(-0x64,-0x78)](this['windData'][_0x4a568a(0x77,0x18)]['north'],_0xc14278)),_0x47a194=(_0x55442d['y']-_0x55442d['x'])*0.05,_0x5e5648=(_0x340221['y']-_0x340221['x'])*0.05;_0x55442d['x']=Math['max'](this[_0x57687c(-0xf0,-0x161)][_0x57687c(-0xc7,-0x49)][_0x57687c(-0x10f,-0xa0)],_0x55442d['x']-_0x47a194),_0x55442d['y']=Math['min'](this[_0x57687c(-0xf0,-0xf7)]['bounds']['east'],_0x55442d['y']+_0x47a194),_0x340221['x']=Math[_0x57687c(-0x99,-0x67)](this['windData']['bounds']['south'],_0x340221['x']-_0x5e5648),_0x340221['y']=Math['min'](this[_0x57687c(-0xf0,-0xb0)]['bounds']['north'],_0x340221['y']+_0x5e5648),this[_0x4a568a(0x7a,0x5d)][_0x57687c(-0x33,0x2)]=_0x55442d,this[_0x4a568a(0x86,0x5d)]['latRange']=_0x340221;const _0x199049=this['windData']['bounds']['east']-this['windData']['bounds']['west'],_0x41fa76=this[_0x57687c(-0xf0,-0x13d)][_0x57687c(-0xc7,-0x60)]['north']-this['windData']['bounds'][_0x4a568a(-0x6f,-0x21)],_0x3a239e=(_0x55442d['y']-_0x55442d['x'])/_0x199049,_0x325360=(_0x340221['y']-_0x340221['x'])/_0x41fa76,_0x22c3a1=Math['min'](_0x3a239e,_0x325360),_0x58cbb1=0x3e8*_0x22c3a1;_0x58cbb1>0x0&&(this['viewerParameters'][_0x4a568a(0x5e,0x88)]=Math['max'](0x0,Math[_0x57687c(-0x64,-0x2f)](0x3e8,_0x58cbb1)));}this[_0x4a568a(0x8f,0x5d)]['sceneMode']=this['scene']['mode'],(_0x2cf696=this['particleSystem'])===null||_0x2cf696===void 0x0||_0x2cf696[_0x57687c(-0x45,-0x12)](this['viewerParameters']);}['getDataAtLonLat'](_0x455392,_0x2a2a91){const {bounds:_0x411d28,width:_0x13a09c,height:_0x46fed5,u:_0x4ac19b,v:_0x44de26,speed:_0x5e02b0}=this['windData'],{flipY:_0x1e7b6c}=this[_0x4f0389(-0xdc,-0xae)];if(_0x455392<_0x411d28['west']||_0x455392>_0x411d28[_0x5afe6b(0x8,0x7b)]||_0x2a2a91<_0x411d28['south']||_0x2a2a91>_0x411d28['north'])return null;const _0x40cdd4=(_0x455392-_0x411d28[_0x5afe6b(-0x87,-0x27)])/(_0x411d28['east']-_0x411d28[_0x5afe6b(-0x87,-0x41)])*(_0x13a09c-0x1);let _0xec8d18=(_0x2a2a91-_0x411d28[_0x4f0389(-0x168,-0x128)])/(_0x411d28['north']-_0x411d28[_0x4f0389(-0x168,-0x114)])*(_0x46fed5-0x1);_0x1e7b6c&&(_0xec8d18=_0x46fed5-0x1-_0xec8d18);const _0x5119d8=Math['floor'](_0x40cdd4),_0xabdca9=Math['floor'](_0xec8d18),_0x5a42f8=Math[_0x4f0389(-0x7b,-0xc1)](_0x40cdd4),_0x4c1b22=Math['min'](_0x5a42f8+0x1,_0x13a09c-0x1),_0x246825=Math['floor'](_0xec8d18),_0x33eaa9=Math['min'](_0x246825+0x1,_0x46fed5-0x1),_0x216868=_0x40cdd4-_0x5a42f8,_0x28825b=_0xec8d18-_0x246825,_0x113f4f=_0xabdca9*_0x13a09c+_0x5119d8,_0x1f0af7=_0x246825*_0x13a09c+_0x5a42f8,_0x1c4e87=_0x246825*_0x13a09c+_0x4c1b22,_0x1215d4=_0x33eaa9*_0x13a09c+_0x5a42f8,_0x3cdcb3=_0x33eaa9*_0x13a09c+_0x4c1b22,_0x26177b=_0x4ac19b['array'][_0x1f0af7],_0x1ca7d8=_0x4ac19b['array'][_0x1c4e87],_0x1dc89c=_0x4ac19b[_0x4f0389(-0xf6,-0x144)][_0x1215d4],_0x2b619f=_0x4ac19b['array'][_0x3cdcb3],_0x1b5118=(0x1-_0x216868)*(0x1-_0x28825b)*_0x26177b+_0x216868*(0x1-_0x28825b)*_0x1ca7d8+(0x1-_0x216868)*_0x28825b*_0x1dc89c+_0x216868*_0x28825b*_0x2b619f,_0x3fe6e3=_0x44de26['array'][_0x1f0af7],_0x486b2d=_0x44de26['array'][_0x1c4e87],_0x38b315=_0x44de26['array'][_0x1215d4],_0x15754f=_0x44de26[_0x5afe6b(-0x6,-0x31)][_0x3cdcb3],_0x141bf2=(0x1-_0x216868)*(0x1-_0x28825b)*_0x3fe6e3+_0x216868*(0x1-_0x28825b)*_0x486b2d+(0x1-_0x216868)*_0x28825b*_0x38b315+_0x216868*_0x28825b*_0x15754f,_0x1b01ad=Math['sqrt'](_0x1b5118*_0x1b5118+_0x141bf2*_0x141bf2),_0x5a3ab7={};_0x5a3ab7['u']=_0x4ac19b['array'][_0x113f4f];function _0x4f0389(_0x5bcb27,_0x5ae9c9){return _0x4ba7a1(_0x5bcb27- -0x1cd,_0x5ae9c9);}_0x5a3ab7['v']=_0x44de26['array'][_0x113f4f];function _0x5afe6b(_0x4aeb82,_0x30ef9c){return _0x4ba7a1(_0x4aeb82- -0xdd,_0x30ef9c);}_0x5a3ab7['speed']=_0x5e02b0['array'][_0x113f4f];const _0x46680c={};_0x46680c['u']=_0x1b5118,_0x46680c['v']=_0x141bf2,_0x46680c['speed']=_0x1b01ad;const _0x4cd41c={};return _0x4cd41c['original']=_0x5a3ab7,_0x4cd41c['interpolated']=_0x46680c,_0x4cd41c;}}mars3d__namespace['LayerUtil']['register'](_0x4ba7a1(0xa7,0x101),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;class CanvasParticle{constructor(){function _0x147eef(_0x5dcc95,_0x18cd26){return _0x4ba7a1(_0x5dcc95- -0x287,_0x18cd26);}this[_0x147eef(-0x159,-0x18c)]=null;function _0x12216d(_0x3e1c13,_0x29d306){return _0x473f5b(_0x3e1c13,_0x29d306-0x457);}this[_0x12216d(0x441,0x3d4)]=null,this['tlng']=null,this[_0x147eef(-0x23c,-0x235)]=null,this[_0x147eef(-0x1f2,-0x16e)]=null,this[_0x12216d(0x386,0x36b)]=null;}['destroy'](){for(const _0x1016a7 in this){delete this[_0x1016a7];}}}function _0x3b05(){const _0x3903d3=['fromDegrees','clear','framebuffer','outputTexture','#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a','unbindEvent','pixelDatatype','removeEventListener','ymax','visible','canvasContext','410018eOQgNo','RED','toDegrees','153pYXkHO','updateOptions','FLOAT','addEventListener','grid','speed','mouse_move','viewport','latRange','domain','width','isDestroyed','colors','componentDatatype','refreshTimer','frameRate','forEach','_animateFrame','number','zIndex','max','pow','destroyParticlesTextures','warn','_calc_speedRate','hidden','isDestroy','removeChild','renderState','log','flatMap','array','owner','MAX_VALUE','requestRender','container','particlesTextures','fromGeometry','colorTextures','pointerEvents','ONE_MINUS_SRC_ALPHA','globe','register','viewerParameters','type','east','5358340PQujoC','_maxAge','20081MpmbDp','absolute','xmax','getParticles','lineLength','__esModule','getCalculateSpeedShader','preExecute','segmentsColor','options','MIN_VALUE','processWindData','visibility','north','CanvasWindField','isDynamic','dropRateBump','useViewerBounds','mouseHidden','createRenderingTextures','onParticlesTextureSizeChange','attributeLocations','_map','pickEllipsoid','clientHeight','min','clientWidth','init','frameRateMonitor','UNSIGNED_INT','resize','setData','updateViewerParameters','scene','max\x20is\x20undefined,\x20calculate\x20max','particlesTextureSize','updatePosition','push','pixelSize','getUVByPoint','context','primitives','cols','atan2','slice','tlng','colorTable','toRadians','setOptions','style','camera','wheel','worker','vertexArray','currentParticlesPosition','ymin','applyViewerParameters','frameState.commandList\x20is\x20undefined','particlesSpeed','_pointerEvents','speedRate','commandToExecute','lat','_speedRate','destroy','changed','canvasHeight','abs','0px','SCENE3D','lng','clearCommand','blendFuncDestination','FUNC_ADD','lonRange','strokeStyle','update','off','OPAQUE','mouseMove','_onMouseMoveEvent','rows','ColorRamp','clearFramebuffers','EventType','computing','createCommand','_drawLines','_mountedHook','color','data','particlesNumber','_setOptionsHook','particleSystem','Math','isInExtent','createComputingPrimitives','show','rendering','values','position','fragmentShaderSource','1898965lETlFh','TRIANGLES','getColor','bind','floor','sin','normal','enabled','lineTo','tlat','sources','changeOptions','flipY','nextParticlesPosition','IDENTITY','min\x20is\x20undefined,\x20calculate\x20min','round','_randomParticle','height','stringify','west','uniformMap','getSegmentDrawFragmentShader','autoClear','umax','reCreateWindTextures','canvasWidth','segments','frameTime','sqrt','_colorRamp','_updateIng','create','3399648mbvFtZ','framebuffers','south','mouse_down','30040ZkRJWz','top','5027130VnCjUb','132fTltRO','getSegmentDrawVertexShader','commandType','_tomap','windTextures','createWindTextures','vertexShaderSource','previousParticlesPosition','green','length','now','windData','Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.','bindEvent','SceneMode','CanvasWindLayer','componentsPerAttribute','layer','redraw','drawingBufferWidth','postProcessingPosition','dynamic','getV','xmin','moveTo','globalAlpha','_updateIng2','canvas','getPostProcessingPositionShader','frameRateAdjustment','magnificationFilter','initFrameRate','createParticlesTextures','getUVByXY','udata','_addedHook','fromCache','Cartesian2','postMessage','lineWidth','_onMouseUpEvent','LINEAR','initWorker','age','primitiveType','geometry','getUpdatePositionShader','54BhbATi','ellipsoid','RGBA','textures','windField','bounds','_onMapWhellEvent','toGridXY','Log','execute','steps','shaderProgram','bufferUsage','getSpeed','wind','maxAge','sceneMode'];_0x3b05=function(){return _0x3903d3;};return _0x3b05();}class CanvasWindField{constructor(_0x223a73){function _0x128bbb(_0x1db27d,_0x38a91e){return _0x473f5b(_0x38a91e,_0x1db27d-0x1ec);}this[_0x128bbb(0x15b,0x114)](_0x223a73);}get[_0x473f5b(-0xd5,-0x85)](){return this['_speedRate'];}set['speedRate'](_0x87f7e){function _0x52ca24(_0x637022,_0x4a5266){return _0x473f5b(_0x637022,_0x4a5266- -0x65);}function _0x4fc99d(_0x41576d,_0x10842e){return _0x473f5b(_0x41576d,_0x10842e-0x203);}this['_speedRate']=(0x64-(_0x87f7e>0x63?0x63:_0x87f7e))*0x64,this[_0x4fc99d(0xc3,0x12a)]=[(this['xmax']-this[_0x52ca24(-0x182,-0x18d)])/this['_speedRate'],(this[_0x4fc99d(0xe7,0x10c)]-this['ymin'])/this[_0x4fc99d(0x1c6,0x181)]];}get[_0x473f5b(-0x16e,-0x101)](){return this['_maxAge'];}set[_0x4ba7a1(0xa8,0x111)](_0x3b0531){function _0xba5867(_0xda8c23,_0x526918){return _0x4ba7a1(_0xda8c23-0x2c5,_0x526918);}this[_0xba5867(0x3ac,0x3c0)]=_0x3b0531;}['setOptions'](_0x3518cf){this[_0x2eaa0a(0x2b5,0x27a)]=_0x3518cf,this['maxAge']=_0x3518cf['maxAge']||0x78,this['speedRate']=_0x3518cf['speedRate']||0x32;function _0x4d73e4(_0x3a613d,_0x9d9238){return _0x473f5b(_0x3a613d,_0x9d9238-0xa8);}this['particles']=[];function _0x2eaa0a(_0x23addc,_0x423d23){return _0x473f5b(_0x23addc,_0x423d23-0x332);}const _0xb2d407=_0x3518cf['particlesNumber']||0x1000;for(let _0x2b330b=0x0;_0x2b330b<_0xb2d407;_0x2b330b++){const _0xd018fb=this[_0x4d73e4(-0x10f,-0xae)](new CanvasParticle());this['particles']['push'](_0xd018fb);}}['setDate'](_0x1f8e4f){function _0x5b55c2(_0x4bada9,_0x2b79b0){return _0x4ba7a1(_0x4bada9- -0x366,_0x2b79b0);}this[_0x5b55c2(-0x22d,-0x1b6)]=_0x1f8e4f[_0x5b55c2(-0x22d,-0x245)],this[_0x5b55c2(-0x254,-0x29d)]=_0x1f8e4f['cols'],this[_0x5b55c2(-0x2e5,-0x2a3)]=_0x1f8e4f['xmin'],this['xmax']=_0x1f8e4f['xmax'],this[_0xfed1ec(0x46f,0x465)]=_0x1f8e4f[_0xfed1ec(0x43b,0x465)],this['ymax']=_0x1f8e4f[_0xfed1ec(0x47b,0x3f8)],this['grid']=[];const _0x48f434=_0x1f8e4f[_0x5b55c2(-0x2da,-0x355)],_0x10e279=_0x1f8e4f['vdata'];let _0x29bbe8=![];function _0xfed1ec(_0x2e690a,_0x2bda60){return _0x473f5b(_0x2e690a,_0x2bda60-0x4ef);}_0x48f434['length']===this[_0xfed1ec(0x453,0x47f)]&&_0x48f434[0x0]['length']===this['cols']&&(_0x29bbe8=!![]);let _0x2c978a=0x0,_0x5de37b=null,_0xf40de9=null;for(let _0x4762ea=0x0;_0x4762ea<this[_0xfed1ec(0x421,0x47f)];_0x4762ea++){_0x5de37b=[];for(let _0x1b28b9=0x0;_0x1b28b9<this['cols'];_0x1b28b9++,_0x2c978a++){_0x29bbe8?_0xf40de9=this['_calcUV'](_0x48f434[_0x4762ea][_0x1b28b9],_0x10e279[_0x4762ea][_0x1b28b9]):_0xf40de9=this['_calcUV'](_0x48f434[_0x2c978a],_0x10e279[_0x2c978a]),_0x5de37b['push'](_0xf40de9);}this['grid'][_0xfed1ec(0x3f9,0x453)](_0x5de37b);}!this[_0x5b55c2(-0x275,-0x2f1)][_0xfed1ec(0x38d,0x394)]&&this[_0xfed1ec(0x40b,0x402)]['reverse']();}['clear'](){delete this[_0x1b2173(0x4fa,0x530)],delete this[_0x1c9b10(0x2a7,0x22c)],delete this['xmin'],delete this['xmax'],delete this['ymin'];function _0x1b2173(_0x22c598,_0x3868b7){return _0x4ba7a1(_0x3868b7-0x3f7,_0x22c598);}delete this['ymax'],delete this[_0x1b2173(0x490,0x4b3)];function _0x1c9b10(_0x1f63f6,_0x5c02fe){return _0x4ba7a1(_0x1f63f6-0x195,_0x5c02fe);}delete this['particles'];}[_0x4ba7a1(0xa0,0x39)](_0x31846b,_0x5431f3){const _0x33c0b4=(_0x31846b-this[_0x2b50d5(-0x1b9,-0x1d3)])/(this[_0x2b50d5(-0x150,-0x18d)]-this['xmin'])*(this[_0x2b50d5(-0x128,-0xfc)]-0x1),_0x45bec9=(this['ymax']-_0x5431f3)/(this[_0x2b50d5(-0x188,-0x206)]-this['ymin'])*(this['rows']-0x1);function _0x2b50d5(_0x2accef,_0x4d7dc8){return _0x473f5b(_0x4d7dc8,_0x2accef- -0x91);}function _0x357656(_0xca7016,_0x4e5708){return _0x4ba7a1(_0xca7016- -0x318,_0x4e5708);}return[_0x33c0b4,_0x45bec9];}[_0x473f5b(-0xdc,-0x11e)](_0x3caafe,_0x11c143){if(_0x3caafe<0x0||_0x3caafe>=this[_0xd4403(0xc0,0xf5)]||_0x11c143>=this['rows'])return[0x0,0x0,0x0];const _0x2c74cb=Math['floor'](_0x3caafe),_0x31a55d=Math[_0xd4403(0xb2,0x135)](_0x11c143);if(_0x2c74cb===_0x3caafe&&_0x31a55d===_0x11c143)return this['grid'][_0x11c143][_0x3caafe];const _0x52ac28=_0x2c74cb+0x1,_0x1130ac=_0x31a55d+0x1,_0x24699d=this['getUVByXY'](_0x2c74cb,_0x31a55d),_0x12ba83=this[_0x5d8b3d(0x403,0x432)](_0x52ac28,_0x31a55d);function _0xd4403(_0x4ba25a,_0xc145aa){return _0x4ba7a1(_0xc145aa- -0x1d,_0x4ba25a);}const _0x13779a=this['getUVByXY'](_0x2c74cb,_0x1130ac),_0x286da4=this[_0x5d8b3d(0x416,0x432)](_0x52ac28,_0x1130ac);let _0xdb4aad=null;try{_0xdb4aad=this['_bilinearInterpolation'](_0x3caafe-_0x2c74cb,_0x11c143-_0x31a55d,_0x24699d,_0x12ba83,_0x13779a,_0x286da4);}catch(_0x292f8d){console[_0xd4403(0xb2,0xb8)](_0x3caafe,_0x11c143);}function _0x5d8b3d(_0x2c6cf8,_0x1c69c1){return _0x4ba7a1(_0x1c69c1-0x3a7,_0x2c6cf8);}return _0xdb4aad;}['_bilinearInterpolation'](_0x426214,_0x1a3988,_0x201b2c,_0x38c773,_0x255887,_0x2ae9f6){const _0x265e20=0x1-_0x426214,_0x49f570=0x1-_0x1a3988,_0x31292e=_0x265e20*_0x49f570,_0x4ea294=_0x426214*_0x49f570,_0xba14b9=_0x265e20*_0x1a3988,_0x5617c4=_0x426214*_0x1a3988,_0x3c2728=_0x201b2c[0x0]*_0x31292e+_0x38c773[0x0]*_0x4ea294+_0x255887[0x0]*_0xba14b9+_0x2ae9f6[0x0]*_0x5617c4,_0x42014a=_0x201b2c[0x1]*_0x31292e+_0x38c773[0x1]*_0x4ea294+_0x255887[0x1]*_0xba14b9+_0x2ae9f6[0x1]*_0x5617c4;return this['_calcUV'](_0x3c2728,_0x42014a);}['_calcUV'](_0x5da637,_0x307c6d){return[+_0x5da637,+_0x307c6d,Math['sqrt'](_0x5da637*_0x5da637+_0x307c6d*_0x307c6d)];}['getUVByPoint'](_0x3db37f,_0xff5236){if(!this['isInExtent'](_0x3db37f,_0xff5236))return null;const _0x5fb0ef=this[_0x379784(-0x2ba,-0x262)](_0x3db37f,_0xff5236);function _0x379784(_0x151ecc,_0xc5ce12){return _0x4ba7a1(_0xc5ce12- -0x302,_0x151ecc);}const _0x16a921=this[_0x5b706a(0x1b1,0x22c)](_0x5fb0ef[0x0],_0x5fb0ef[0x1]);function _0x5b706a(_0x293c48,_0x4a6bbb){return _0x473f5b(_0x4a6bbb,_0x293c48-0x2cf);}return _0x16a921;}[_0x4ba7a1(0x147,0x187)](_0x4a47f0,_0x3f7855){function _0x50e7b0(_0x1ab6a1,_0x85377){return _0x473f5b(_0x1ab6a1,_0x85377- -0x13c);}return _0x4a47f0>=this[_0x50e7b0(-0x20f,-0x264)]&&_0x4a47f0<=this['xmax']&&_0x3f7855>=this['ymin']&&_0x3f7855<=this['ymax']?!![]:![];}['getRandomLatLng'](){const _0x27f577=fRandomByfloat(this['xmin'],this['xmax']),_0x4fab48=fRandomByfloat(this['ymin'],this['ymax']),_0x1a553c={};return _0x1a553c['lat']=_0x4fab48,_0x1a553c['lng']=_0x27f577,_0x1a553c;}[_0x4ba7a1(0xeb,0x85)](){let _0x24f0d6,_0x492b13,_0x149e48;function _0x5ea37e(_0x4e2abb,_0x3880a9){return _0x473f5b(_0x4e2abb,_0x3880a9-0x165);}function _0x4b5e48(_0x3bb7fb,_0x1865dd){return _0x4ba7a1(_0x1865dd-0x377,_0x3bb7fb);}for(let _0x3302df=0x0,_0x4e662d=this['particles']['length'];_0x3302df<_0x4e662d;_0x3302df++){let _0xb18657=this['particles'][_0x3302df];_0xb18657['age']<=0x0&&(_0xb18657=this['_randomParticle'](_0xb18657));if(_0xb18657[_0x4b5e48(0x3f5,0x40c)]>0x0){const _0xd2d97a=_0xb18657['tlng'],_0x2f51bc=_0xb18657['tlat'];_0x149e48=this[_0x4b5e48(0x4f2,0x486)](_0xd2d97a,_0x2f51bc),_0x149e48?(_0x24f0d6=_0xd2d97a+this[_0x5ea37e(0x3f,0x8c)][0x0]*_0x149e48[0x0],_0x492b13=_0x2f51bc+this[_0x4b5e48(0x4c2,0x447)][0x1]*_0x149e48[0x1],_0xb18657[_0x4b5e48(0x44c,0x4a5)]=_0xd2d97a,_0xb18657['lat']=_0x2f51bc,_0xb18657[_0x5ea37e(0x6d,0xd1)]=_0x24f0d6,_0xb18657['tlat']=_0x492b13,_0xb18657[_0x5ea37e(0x25,0x79)]=_0x149e48[0x2],_0xb18657[_0x5ea37e(0x76,0x51)]--):_0xb18657[_0x5ea37e(-0x2b,0x51)]=0x0;}}return this['particles'];}['_randomParticle'](_0x2d82a8){let _0x1b4573,_0x40374e;for(let _0x4c49d5=0x0;_0x4c49d5<0x1e;_0x4c49d5++){_0x1b4573=this['getRandomLatLng'](),_0x40374e=this['getUVByPoint'](_0x1b4573[_0x5af6eb(-0x1e5,-0x200)],_0x1b4573['lat']);if(_0x40374e&&_0x40374e[0x2]>0x0)break;}if(!_0x40374e)return _0x2d82a8;const _0x62d942=_0x1b4573['lng']+this[_0x5af6eb(-0x2af,-0x25e)][0x0]*_0x40374e[0x0],_0x5b967e=_0x1b4573['lat']+this[_0xdf049d(0x111,0x9a)][0x1]*_0x40374e[0x1];function _0xdf049d(_0x2645c3,_0x5b5d56){return _0x4ba7a1(_0x2645c3-0x41,_0x5b5d56);}_0x2d82a8['lng']=_0x1b4573['lng'],_0x2d82a8['lat']=_0x1b4573[_0x5af6eb(-0x1fc,-0x208)],_0x2d82a8[_0x5af6eb(-0x23f,-0x219)]=_0x62d942,_0x2d82a8[_0xdf049d(0x8c,0x6e)]=_0x5b967e;function _0x5af6eb(_0x46d3f4,_0x57e817){return _0x4ba7a1(_0x57e817- -0x32e,_0x46d3f4);}return _0x2d82a8['age']=Math[_0xdf049d(0x93,0x49)](0xa+Math['random']()*this[_0x5af6eb(-0x28b,-0x286)]),_0x2d82a8[_0x5af6eb(-0x2b8,-0x271)]=_0x40374e[0x2],_0x2d82a8;}[_0x473f5b(-0x21,-0x81)](){for(const _0x1ba413 in this){delete this[_0x1ba413];}}}function fRandomByfloat(_0x181151,_0x59c65d){return _0x181151+Math['random']()*(_0x59c65d-_0x181151);}function _0x473f5b(_0xd32f92,_0x4c9dc1){return _0x5d99(_0x4c9dc1- -0x1eb,_0xd32f92);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x473f5b(-0x194,-0x12e)]['BaseLayer'];class CanvasWindLayer extends BaseLayer{constructor(_0x2bcbf7={}){super(_0x2bcbf7);function _0x16d65f(_0x238a63,_0x40b0c9){return _0x4ba7a1(_0x238a63-0x24b,_0x40b0c9);}this['_setOptionsHook'](_0x2bcbf7),this['canvas']=null;function _0x364054(_0x597abc,_0x462953){return _0x4ba7a1(_0x597abc-0x17a,_0x462953);}_0x2bcbf7['colors']&&_0x2bcbf7[_0x364054(0x21d,0x251)]&&(this[_0x16d65f(0x2ab,0x2ca)]=new mars3d__namespace[(_0x16d65f(0x385,0x36b))](_0x2bcbf7));}['_setOptionsHook'](_0x3889ce,_0x2a7401){this[_0x4c7688(-0x30f,-0x2d2)]=0x3e8/(_0x3889ce['frameRate']||0xa),this[_0x113dd7(0x1ec,0x1be)]=this['options'][_0x4c7688(-0x1ce,-0x251)]??![];function _0x4c7688(_0x3aaf59,_0x293090){return _0x4ba7a1(_0x293090- -0x330,_0x3aaf59);}this[_0x113dd7(0x239,0x1dc)]=_0x3889ce['color']||'#ffffff',this[_0x113dd7(0x18a,0x12c)]=_0x3889ce['lineWidth']||0x1;function _0x113dd7(_0x1d3c7f,_0x4c890b){return _0x473f5b(_0x1d3c7f,_0x4c890b-0x244);}this['fixedHeight']=_0x3889ce['fixedHeight']??0x0,this[_0x4c7688(-0x28f,-0x2e2)]=_0x3889ce['flipY']??![],this[_0x4c7688(-0x2b6,-0x293)]&&this['windField'][_0x113dd7(0x233,0x1b3)](_0x3889ce);}get['layer'](){return this['canvas'];}get['canvasWidth'](){function _0x398ad1(_0x440a9,_0x4d87c1){return _0x473f5b(_0x440a9,_0x4d87c1-0xb2);}function _0x19b419(_0x598ead,_0x406bf2){return _0x473f5b(_0x406bf2,_0x598ead-0x42d);}return this['_map'][_0x398ad1(-0x50,0x12)][_0x19b419(0x309,0x2b8)]['clientWidth'];}get['canvasHeight'](){return this['_map']['scene']['canvas']['clientHeight'];}get['pointerEvents'](){function _0x55a330(_0x1849dc,_0x20920c){return _0x473f5b(_0x1849dc,_0x20920c-0x153);}return this[_0x55a330(0x55,0xcd)];}set['pointerEvents'](_0x297d5f){this[_0x2f95f2(-0x2f,-0x3f)]=_0x297d5f;if(!this[_0x382e2e(0x294,0x2ac)])return;function _0x382e2e(_0x18b7fd,_0x26b38a){return _0x473f5b(_0x18b7fd,_0x26b38a-0x3d0);}function _0x2f95f2(_0x252f8f,_0x3ef481){return _0x4ba7a1(_0x3ef481- -0x162,_0x252f8f);}_0x297d5f?this['canvas'][_0x2f95f2(-0x2c,-0x49)]['pointer-events']='all':this[_0x382e2e(0x303,0x2ac)][_0x382e2e(0x379,0x340)]['pointer-events']='none';}get['particlesNumber'](){function _0x48c6b0(_0x9ff1b5,_0x45772d){return _0x473f5b(_0x9ff1b5,_0x45772d-0x59e);}function _0x5a8ac6(_0x1ca7c1,_0x5a787c){return _0x473f5b(_0x1ca7c1,_0x5a787c-0x2a7);}return this[_0x5a8ac6(0x23a,0x1ef)][_0x5a8ac6(0x25e,0x241)];}set['particlesNumber'](_0x3e68ee){this['options']['particlesNumber']=_0x3e68ee,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(()=>{this['redraw']();},0x1f4);}get['speedRate'](){return this['options']['speedRate'];}set[_0x473f5b(-0x82,-0x85)](_0x5640f6){function _0x507421(_0x22ea41,_0x3d2fb4){return _0x4ba7a1(_0x3d2fb4- -0x1c,_0x22ea41);}function _0x578902(_0x1f9bee,_0x2a8daf){return _0x473f5b(_0x1f9bee,_0x2a8daf- -0x167);}this[_0x578902(-0x212,-0x21f)]['speedRate']=_0x5640f6,this[_0x507421(0xa0,0x81)]&&(this['windField'][_0x578902(-0x1e0,-0x1ec)]=_0x5640f6);}get[_0x473f5b(-0x123,-0x101)](){return this['options']['maxAge'];}set['maxAge'](_0x505e8d){function _0x2517f5(_0x4b1235,_0x665033){return _0x473f5b(_0x665033,_0x4b1235- -0x7f);}this['options']['maxAge']=_0x505e8d;function _0x193019(_0x1b8460,_0xfc245b){return _0x4ba7a1(_0xfc245b-0x12d,_0x1b8460);}this[_0x193019(0x1e1,0x1ca)]&&(this[_0x2517f5(-0x18b,-0x20f)]['maxAge']=_0x505e8d);}get[_0x4ba7a1(0x142,0xbd)](){return this['windData'];}set['data'](_0x2b9e94){this['setData'](_0x2b9e94);}get['rectangle'](){let _0x504f54=this[_0x3167f1(-0x1dc,-0x183)][_0x45d41e(-0x35,-0x54)];function _0x3167f1(_0x5e515d,_0x173f38){return _0x4ba7a1(_0x173f38- -0x1f8,_0x5e515d);}let _0x3d7e0c=this['windData'][_0x3167f1(-0x10a,-0x10e)],_0x411ce4=this['windData'][_0x45d41e(0x69,0x49)],_0xa74e4d=this['windData'][_0x45d41e(-0x4,0x13)];function _0x45d41e(_0x40e356,_0x300564){return _0x4ba7a1(_0x40e356- -0xb6,_0x300564);}return _0x3d7e0c>=0x167&&_0x504f54===0x0&&(_0x504f54=-0xb4,_0x3d7e0c=0xb4),_0x504f54=Math['max'](_0x504f54,-0xb4),_0x3d7e0c=Math[_0x45d41e(0x4b,-0x24)](_0x3d7e0c,0xb4),_0x411ce4=Math['max'](_0x411ce4,-0x5a),_0xa74e4d=Math[_0x45d41e(0x4b,0x21)](_0xa74e4d,0x5a),Cesium['Rectangle'][_0x45d41e(-0xc,0x6b)](_0x504f54,_0x411ce4,_0x3d7e0c,_0xa74e4d);}['_showHook'](_0x18030a){function _0x4f25b4(_0xb91d95,_0x49b21a){return _0x4ba7a1(_0xb91d95- -0x270,_0x49b21a);}function _0x526392(_0x48dc34,_0x2e3682){return _0x4ba7a1(_0x48dc34- -0x130,_0x2e3682);}_0x18030a?this[_0x526392(-0xa3,-0x125)]():(this['windData']&&(this[_0x4f25b4(-0x17f,-0x1ca)]['data']=this['windData']),this['_removedHook']());}[_0x4ba7a1(0x140,0x179)](){function _0x141dba(_0x492d7f,_0x2cfe88){return _0x4ba7a1(_0x492d7f-0xc1,_0x2cfe88);}function _0x226cbd(_0x393d7a,_0x1ffe79){return _0x4ba7a1(_0x393d7a- -0x133,_0x1ffe79);}this['options']['worker']?this[_0x226cbd(-0x9f,-0x53)]():this[_0x141dba(0x15e,0xed)]=new CanvasWindField(this['options']);}['_addedHook'](){this['canvas']=this['_createCanvas']();const _0x27af55={};_0x27af55['willReadFrequently']=!![],this['canvasContext']=this['canvas']['getContext']('2d',_0x27af55);function _0x20bdf7(_0x447e70,_0x3d3f32){return _0x4ba7a1(_0x3d3f32-0x38e,_0x447e70);}this['bindEvent'](),this[_0x20bdf7(0x4b2,0x47f)]['data']&&this['setData'](this['options']['data']);}['_removedHook'](){this[_0x214ce3(0x162,0x161)]();function _0x4068d9(_0x4df73e,_0x4edff3){return _0x473f5b(_0x4df73e,_0x4edff3-0x4b9);}this['unbindEvent']();function _0x214ce3(_0x10a804,_0x439cfb){return _0x473f5b(_0x439cfb,_0x10a804-0x260);}this['canvas']&&(this['_map']['container'][_0x214ce3(0x18a,0x180)](this['canvas']),delete this[_0x214ce3(0x13c,0x14c)]);}['_createCanvas'](){function _0x4e76f7(_0x4e990e,_0x20e298){return _0x473f5b(_0x20e298,_0x4e990e-0x1fb);}const _0x4d4197=mars3d__namespace['DomUtil'][_0x5247a3(0x117,0x176)]('canvas','mars3d-canvasWind',this['_map'][_0x5247a3(0x190,0x189)]);_0x4d4197['style'][_0x5247a3(0x201,0x1c3)]=_0x5247a3(0x19e,0x1f8),_0x4d4197['style'][_0x5247a3(0x11d,0x109)]=_0x4e76f7(0x17e,0x132),_0x4d4197[_0x4e76f7(0x16b,0x1a4)]['left']='0px',_0x4d4197[_0x5247a3(0x1ce,0x248)]['width']=this[_0x4e76f7(0x150,0x1c9)][_0x4e76f7(0x15b,0x199)]['canvas'][_0x4e76f7(0x154,0x109)]+'px',_0x4d4197['style'][_0x5247a3(0x109,0x11a)]=this['_map'][_0x5247a3(0x1be,0x150)]['canvas']['clientHeight']+'px';function _0x5247a3(_0x409d86,_0x44ddfe){return _0x473f5b(_0x44ddfe,_0x409d86-0x25e);}return _0x4d4197[_0x4e76f7(0x16b,0x145)][_0x4e76f7(0x131,0x138)]=this[_0x4e76f7(0x175,0x1d9)]?'auto':'none',_0x4d4197['style']['zIndex']=this['options'][_0x4e76f7(0x11d,0x185)]??0x9,_0x4d4197['width']=this['_map'][_0x5247a3(0x1be,0x15a)]['canvas'][_0x5247a3(0x1b7,0x199)],_0x4d4197['height']=this[_0x5247a3(0x1b3,0x22d)]['scene']['canvas'][_0x4e76f7(0x152,0x13c)],_0x4d4197;}['resize'](){function _0x50c68b(_0x1f8046,_0x4bc76c){return _0x473f5b(_0x4bc76c,_0x1f8046-0x1b);}function _0x466681(_0x2c541,_0x2846f3){return _0x4ba7a1(_0x2c541-0x342,_0x2846f3);}this['canvas']&&(this['canvas']['style']['width']=this['_map'][_0x50c68b(-0x85,-0xab)]['canvas'][_0x50c68b(-0x8c,-0x22)]+'px',this['canvas'][_0x466681(0x45b,0x46f)]['height']=this['_map']['scene']['canvas']['clientHeight']+'px',this['canvas']['width']=this['_map'][_0x466681(0x44b,0x46d)]['canvas'][_0x466681(0x444,0x42c)],this['canvas']['height']=this[_0x466681(0x440,0x3ef)][_0x50c68b(-0x85,-0xd2)]['canvas']['clientHeight']);}[_0x4ba7a1(0x77,0x86)](){function _0x48c4f7(_0xf95049,_0xd19e4f){return _0x473f5b(_0xf95049,_0xd19e4f-0x2a0);}const _0x5e6c82=this;let _0x1bdd20=Date['now']();function _0x51d406(_0x476d9a,_0x50864c){return _0x4ba7a1(_0x50864c- -0x32c,_0x476d9a);}(function _0x524f4a(){function _0x163868(_0x1f824b,_0xe37aae){return _0x5d99(_0xe37aae- -0x174,_0x1f824b);}if(_0x5e6c82[_0x163868(-0xcd,-0x60)])return;function _0x32ba68(_0x59bd66,_0x2d8e98){return _0x5d99(_0x59bd66-0x31e,_0x2d8e98);}_0x5e6c82['_animateFrame']=window['requestAnimationFrame'](_0x524f4a);if(_0x5e6c82['show']&&_0x5e6c82[_0x163868(-0x111,-0x95)]){const _0x161264=Date[_0x163868(-0x98,-0xbe)](),_0x46c6c5=_0x161264-_0x1bdd20;_0x46c6c5>_0x5e6c82['frameTime']&&(_0x1bdd20=_0x161264-_0x46c6c5%_0x5e6c82['frameTime'],_0x5e6c82['update']());}}(),window['addEventListener'](_0x51d406(-0x1c4,-0x226),this['resize'][_0x48c4f7(0x27d,0x248)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this[_0x48c4f7(0x243,0x1e8)]['mouseHidden']&&(this['_map']['on'](mars3d__namespace['EventType'][_0x51d406(-0x274,-0x211)],this[_0x48c4f7(0x11a,0x196)],this),this['_map']['on'](mars3d__namespace[_0x48c4f7(0x1c7,0x233)]['mouseDown'],this['_onMouseDownEvent'],this),this[_0x48c4f7(0x19f,0x1f5)]['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this)));}[_0x4ba7a1(0xaf,0xab)](){window['cancelAnimationFrame'](this['_animateFrame']),delete this[_0x2a32ab(0x27b,0x27a)];function _0x5bbcc3(_0x2b48a1,_0x674b38){return _0x473f5b(_0x674b38,_0x2b48a1-0x4a3);}function _0x2a32ab(_0xc72bde,_0x2ee26a){return _0x473f5b(_0x2ee26a,_0xc72bde-0x35b);}window['removeEventListener'](_0x5bbcc3(0x400,0x46f),this['resize']),this['options'][_0x2a32ab(0x2ac,0x2be)]&&(this[_0x2a32ab(0x2b0,0x2bc)][_0x2a32ab(0x2e7,0x2f4)](mars3d__namespace[_0x2a32ab(0x2ee,0x292)][_0x5bbcc3(0x415,0x41c)],this['_onMapWhellEvent'],this),this['_map'][_0x2a32ab(0x2e7,0x2dd)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map'][_0x2a32ab(0x2e7,0x324)](mars3d__namespace[_0x2a32ab(0x2ee,0x313)]['mouseUp'],this[_0x2a32ab(0x244,0x216)],this),this[_0x5bbcc3(0x3f8,0x465)][_0x2a32ab(0x2e7,0x2e8)](mars3d__namespace[_0x2a32ab(0x2ee,0x2e1)][_0x5bbcc3(0x431,0x4a3)],this[_0x2a32ab(0x2ea,0x366)],this));}[_0x473f5b(-0x147,-0x10a)](_0x60385e){function _0x33ed27(_0x216c6d,_0x274e30){return _0x4ba7a1(_0x216c6d- -0x137,_0x274e30);}function _0xa97583(_0x2fc48e,_0x44027a){return _0x4ba7a1(_0x44027a-0x7,_0x2fc48e);}clearTimeout(this['refreshTimer']);if(!this['show']||!this['canvas'])return;this['canvas'][_0x33ed27(-0x1e,-0x8)]['visibility']='hidden',this[_0x33ed27(-0x71,0xc)]=setTimeout(()=>{if(!this['show'])return;function _0x246d91(_0xefb356,_0x330f07){return _0xa97583(_0x330f07,_0xefb356-0x296);}this[_0x246d91(0x319,0x306)]();function _0x3eaef4(_0x5592f2,_0xcb6892){return _0xa97583(_0xcb6892,_0x5592f2- -0x124);}this['canvas'][_0x246d91(0x3b6,0x3df)]['visibility']=_0x3eaef4(-0x6a,-0xcb);},0xc8);}['_onMouseDownEvent'](_0x27005a){this[_0x32708c(0x1d3,0x220)]=!![];function _0x2c6380(_0x5b2038,_0x9d3ddc){return _0x473f5b(_0x5b2038,_0x9d3ddc-0x483);}this[_0x32708c(0x309,0x2b8)][_0x32708c(0x309,0x2ef)](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);function _0x32708c(_0x12b8a8,_0x3b1b72){return _0x4ba7a1(_0x3b1b72-0x1ba,_0x12b8a8);}this[_0x2c6380(0x3c7,0x3d8)]['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);}[_0x4ba7a1(0x138,0x134)](_0x15ead9){function _0x4bf793(_0x3aac3f,_0x4ec281){return _0x4ba7a1(_0x4ec281-0xde,_0x3aac3f);}if(!this[_0x2fab84(0x43a,0x3d6)]||!this['canvas'])return;function _0x2fab84(_0x5f2e89,_0x5da5e2){return _0x473f5b(_0x5f2e89,_0x5da5e2-0x436);}this['mouse_down']&&(this['canvas']['style']['visibility']=_0x4bf793(0x15c,0x1af),this[_0x4bf793(0x201,0x19c)]=!![]);}['_onMouseUpEvent'](_0x123429){if(!this['show']||!this[_0x43dc20(0x32,0x6a)])return;function _0x3c5304(_0x23093f,_0x3e68a0){return _0x473f5b(_0x23093f,_0x3e68a0-0x285);}this['_map']['off'](mars3d__namespace[_0x3c5304(0x231,0x218)]['mouseMove'],this[_0x43dc20(0xa7,0x11d)],this);this['mouse_down']&&this['mouse_move']&&this['redraw']();this[_0x43dc20(0xd,0x6a)]['style'][_0x3c5304(0x1ac,0x1d0)]='visible';function _0x43dc20(_0x3291d8,_0x15919e){return _0x473f5b(_0x3291d8,_0x15919e-0x18e);}this['mouse_down']=![],this['mouse_move']=![];}[_0x4ba7a1(0x107,0x177)](_0x1e63df){this[_0x21cdb3(0x3d2,0x3f5)](),this['windData']=_0x1e63df;function _0xae08f2(_0x5ed228,_0x41f6c1){return _0x473f5b(_0x5ed228,_0x41f6c1-0x315);}function _0x21cdb3(_0xdab6a4,_0x11c0f1){return _0x4ba7a1(_0x11c0f1-0x34a,_0xdab6a4);}this[_0x21cdb3(0x45d,0x3e7)]['setDate'](_0x1e63df),this['redraw']();}['redraw'](){function _0x185428(_0x155639,_0x37c52f){return _0x473f5b(_0x155639,_0x37c52f- -0xe);}if(!this['show'])return;function _0x3b31b0(_0xbcaf34,_0x28079a){return _0x4ba7a1(_0xbcaf34- -0x35f,_0x28079a);}this[_0x185428(-0x120,-0x11a)]['setOptions'](this[_0x185428(-0x6a,-0xc6)]),this[_0x3b31b0(-0x22b,-0x1da)]();}['update'](){function _0xee5329(_0x18c402,_0x1860f9){return _0x4ba7a1(_0x18c402- -0x349,_0x1860f9);}if(this['_updateIng'])return;this[_0xee5329(-0x2e8,-0x289)]=!![];if(this['worker'])this[_0xee5329(-0x2ac,-0x25a)][_0xee5329(-0x215,-0x286)]();else{const _0x49372c=this[_0x42de60(0x37d,0x35d)]['getParticles']();this[_0x42de60(0x3f9,0x3ff)](_0x49372c);}function _0x42de60(_0x2cd83e,_0x2c2190){return _0x4ba7a1(_0x2c2190-0x2c0,_0x2cd83e);}this[_0x42de60(0x310,0x321)]=![];}['_drawLines'](_0x2da4e7){this['_canvasParticles']=_0x2da4e7,this['canvasContext']['globalCompositeOperation']='destination-in',this[_0x1b66af(0x21,0x5b)]['fillRect'](0x0,0x0,this[_0x4ed23d(0xe5,0x76)],this[_0x4ed23d(0x1b3,0x1e3)]),this[_0x4ed23d(0x13d,0xb8)]['globalCompositeOperation']='lighter',this['canvasContext'][_0x1b66af(-0x10,-0x75)]=0.9;function _0x4ed23d(_0x4b4db4,_0x1dd89a){return _0x473f5b(_0x1dd89a,_0x4b4db4-0x232);}const _0x5827c1=this[_0x1b66af(0x6b,0x33)][_0x1b66af(0x76,0xf7)]['mode']!==Cesium[_0x1b66af(-0x1b,0x2d)]['SCENE3D'];function _0x1b66af(_0x5b1c26,_0x3c729a){return _0x4ba7a1(_0x5b1c26- -0x93,_0x3c729a);}const _0x14d760=this[_0x4ed23d(0xe5,0xf9)]*0.25;if(this['_colorRamp'])for(let _0x5532c6=0x0,_0x4d6978=_0x2da4e7['length'];_0x5532c6<_0x4d6978;_0x5532c6++){const _0x120c49=_0x2da4e7[_0x5532c6],_0x374a83=this[_0x4ed23d(0xf6,0x13b)](_0x120c49,_0x120c49['lng'],_0x120c49['lat'],_0x120c49['alt']),_0x113d07=this[_0x1b66af(-0x26,-0x3d)](_0x120c49,_0x120c49['tlng'],_0x120c49['tlat'],_0x120c49['talt']);if(!_0x374a83||!_0x113d07)continue;if(_0x5827c1&&Math[_0x1b66af(0x98,0xe4)](_0x374a83[0x0]-_0x113d07[0x0])>=_0x14d760)continue;this['canvasContext']['beginPath'](),this[_0x4ed23d(0x13d,0x188)][_0x1b66af(-0x2,-0x7)]=this['lineWidth'],this[_0x1b66af(0x21,0x7)][_0x1b66af(0xa0,0x58)]=this[_0x1b66af(-0x33,-0x53)][_0x4ed23d(0x1d9,0x18e)](_0x120c49['speed']),this[_0x1b66af(0x21,-0x5d)][_0x1b66af(-0x11,-0x8e)](_0x374a83[0x0],_0x374a83[0x1]),this[_0x4ed23d(0x13d,0xd8)][_0x1b66af(-0x49,-0x21)](_0x113d07[0x0],_0x113d07[0x1]),this[_0x1b66af(0x21,0x67)]['stroke']();}else{this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this[_0x4ed23d(0x13d,0x139)][_0x1b66af(0xa0,0x9e)]=this['color'];for(let _0x263910=0x0,_0x4a38e6=_0x2da4e7['length'];_0x263910<_0x4a38e6;_0x263910++){const _0x5a6588=_0x2da4e7[_0x263910],_0x73c1f=this[_0x4ed23d(0xf6,0xaa)](_0x5a6588,_0x5a6588['lng'],_0x5a6588['lat'],_0x5a6588['alt']),_0x1306a3=this[_0x1b66af(-0x26,-0xa)](_0x5a6588,_0x5a6588[_0x4ed23d(0x19e,0x163)],_0x5a6588[_0x1b66af(-0x48,-0x37)],_0x5a6588['talt']);if(!_0x73c1f||!_0x1306a3)continue;if(_0x5827c1&&Math['abs'](_0x73c1f[0x0]-_0x1306a3[0x0])>=_0x14d760)continue;this[_0x1b66af(0x21,0x65)][_0x1b66af(-0x11,-0x5e)](_0x73c1f[0x0],_0x73c1f[0x1]),this['canvasContext']['lineTo'](_0x1306a3[0x0],_0x1306a3[0x1]);}this[_0x1b66af(0x21,-0x5b)]['stroke']();}}['_tomap'](_0x3c90c8,_0x590114,_0x572ed6,_0xc9c926){const _0x596690=Cesium['Cartesian3'][_0x1cd09f(0x4a9,0x467)](_0x590114,_0x572ed6,_0xc9c926??this['fixedHeight']),_0x40135c=this['_map'][_0x1cd09f(0x4d0,0x4c6)];function _0x1cd09f(_0x2f431d,_0x5b5f3c){return _0x473f5b(_0x2f431d,_0x5b5f3c-0x566);}if(_0x40135c['mode']===Cesium['SceneMode'][_0x1cd09f(0x497,0x4ea)]){const _0x1c8aae=new Cesium['EllipsoidalOccluder'](_0x40135c[_0x4efd6c(0x45b,0x490)][_0x1cd09f(0x4c6,0x457)],_0x40135c[_0x4efd6c(0x494,0x44c)]['positionWC']),_0x2abb8c=_0x1c8aae['isPointVisible'](_0x596690);if(!_0x2abb8c)return _0x3c90c8['age']=0x0,null;}const _0x5d82f4=mars3d__namespace['PointTrans']['toWindowCoordinates'](this['_map'][_0x1cd09f(0x4d8,0x4c6)],_0x596690);function _0x4efd6c(_0x1d9e29,_0x4d92b2){return _0x473f5b(_0x4d92b2,_0x1d9e29-0x523);}return _0x5d82f4?[_0x5d82f4['x'],_0x5d82f4['y']]:null;}[_0x473f5b(-0xed,-0xfe)](){this['windField'][_0x5e1443(0x475,0x3f3)]();function _0x34fed5(_0x4d2a27,_0x54c6fd){return _0x4ba7a1(_0x4d2a27-0x344,_0x54c6fd);}function _0x5e1443(_0x1f17e2,_0x206456){return _0x473f5b(_0x206456,_0x1f17e2-0x573);}delete this[_0x5e1443(0x43f,0x3cd)];}[_0x473f5b(-0x123,-0x115)](){function _0xb27131(_0x52eaf6,_0x559baf){return _0x473f5b(_0x52eaf6,_0x559baf-0x390);}this[_0xb27131(0x28b,0x303)]=new Worker(this[_0x3ea1b6(-0x1c6,-0x1f1)]['worker']),this['worker']['onmessage']=_0x4a60de=>{this['_drawLines'](_0x4a60de[_0x1e82b5(0x3e,-0x29)]['particles']);function _0x54645d(_0x58242c,_0x38b19e){return _0x3ea1b6(_0x38b19e-0x3fa,_0x58242c);}function _0x1e82b5(_0x2e0e4d,_0x11b045){return _0x3ea1b6(_0x11b045-0x14c,_0x2e0e4d);}this[_0x54645d(0x17b,0x1c7)]=![];},this['windField']={'init':_0x5e35bb=>{function _0x466aad(_0x297945,_0x11e59b){return _0x3ea1b6(_0x11e59b-0x5c3,_0x297945);}const _0x5d7e84={};_0x5d7e84[_0x466aad(0x3d4,0x3f0)]='init',_0x5d7e84[_0x360348(0x200,0x188)]=_0x5e35bb;function _0x360348(_0x1febcf,_0x577353){return _0x3ea1b6(_0x577353-0x34e,_0x1febcf);}this[_0x360348(0x1bc,0x1b3)]['postMessage'](_0x5d7e84);},'setOptions':_0x4ad875=>{function _0x486330(_0x4e1d80,_0x561339){return _0x3ea1b6(_0x561339-0x3c5,_0x4e1d80);}const _0x3152e4={};function _0x269da4(_0x4f31bc,_0x2225ec){return _0x3ea1b6(_0x4f31bc-0xa1,_0x2225ec);}_0x3152e4[_0x486330(0x259,0x1f2)]='setOptions',_0x3152e4['options']=_0x4ad875,this[_0x486330(0x23f,0x22a)]['postMessage'](_0x3152e4);},'setDate':_0x4e8309=>{const _0x566a19={};function _0x240d67(_0x1981c3,_0x2d8b48){return _0xb27131(_0x1981c3,_0x2d8b48- -0x4a9);}_0x566a19['type']='setDate',_0x566a19[_0x240d67(-0x10a,-0x180)]=_0x4e8309,this['worker']['postMessage'](_0x566a19);},'update':()=>{function _0x4d8fc9(_0x367d01,_0xfe150c){return _0x3ea1b6(_0x367d01- -0xa6,_0xfe150c);}function _0x542b71(_0xe8f4d9,_0x2ed0e2){return _0x3ea1b6(_0x2ed0e2-0x615,_0xe8f4d9);}if(this['_updateIng2'])return;this['_updateIng2']=!![];const _0xf63c5d={};_0xf63c5d[_0x4d8fc9(-0x279,-0x241)]=_0x542b71(0x4a3,0x492),this['worker'][_0x4d8fc9(-0x2cd,-0x268)](_0xf63c5d);},'clear':()=>{function _0x3a9488(_0x18a85e,_0x314034){return _0x3ea1b6(_0x314034-0x24e,_0x18a85e);}const _0x33a500={};function _0x2a0e0d(_0x421804,_0x493f03){return _0x3ea1b6(_0x421804-0x47a,_0x493f03);}_0x33a500[_0x3a9488(0xdb,0x7b)]='clear',this['worker'][_0x3a9488(0x5e,0x27)](_0x33a500);}};function _0x3ea1b6(_0x583441,_0x1639e5){return _0x473f5b(_0x1639e5,_0x583441- -0x10e);}this[_0xb27131(0x268,0x284)][_0xb27131(0x283,0x2ea)](this['options']);}}mars3d__namespace['LayerUtil'][_0x473f5b(-0x102,-0xc7)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer'][_0x473f5b(-0x166,-0x130)]=CanvasWindLayer,mars3d__namespace[_0x4ba7a1(0xf6,0x139)]=CanvasWindField,mars3d__namespace[_0x4ba7a1(0xa1,0x30)]['logInfo']('mars3d-wind插件\x20注册成功'),mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports[_0x473f5b(-0x119,-0x130)]=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil;const _0x234891={};_0x234891['value']=!![],Object['defineProperty'](exports,'__esModule',_0x234891);
}));
