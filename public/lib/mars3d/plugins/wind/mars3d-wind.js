/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.9.12
 * 编译日期：2025-06-19 09:56
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-02-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x58cc55,_0x3ec62f){function _0x1a70cc(_0x205c65,_0x4d941b){return _0x24e3(_0x4d941b- -0x335,_0x205c65);}function _0x1805ca(_0x39a4d3,_0x18d083){return _0x24e3(_0x39a4d3-0x2e1,_0x18d083);}const _0x5c0990=_0x58cc55();while(!![]){try{const _0x521284=-parseInt(_0x1805ca(0x436,0x485))/0x1*(parseInt(_0x1a70cc(-0x171,-0x1a3))/0x2)+-parseInt(_0x1a70cc(-0xba,-0x13c))/0x3*(-parseInt(_0x1a70cc(-0x1f0,-0x1bb))/0x4)+parseInt(_0x1a70cc(-0x1a2,-0x183))/0x5*(-parseInt(_0x1a70cc(-0x1d1,-0x1a8))/0x6)+-parseInt(_0x1a70cc(-0x1c2,-0x152))/0x7+parseInt(_0x1805ca(0x505,0x4f6))/0x8+-parseInt(_0x1a70cc(-0x1cf,-0x16f))/0x9*(parseInt(_0x1a70cc(-0x74,-0xe8))/0xa)+parseInt(_0x1a70cc(-0x19d,-0x14a))/0xb;if(_0x521284===_0x3ec62f)break;else _0x5c0990['push'](_0x5c0990['shift']());}catch(_0x24f40d){_0x5c0990['push'](_0x5c0990['shift']());}}}(_0x1afb,0xf10ec));function _interopNamespace(_0x274076){if(_0x274076&&_0x274076['__esModule'])return _0x274076;var _0x51815f=Object['create'](null);return _0x274076&&Object['keys'](_0x274076)['forEach'](function(_0x537f76){function _0x215059(_0x3714d3,_0x7c76b7){return _0x24e3(_0x3714d3- -0x34b,_0x7c76b7);}function _0x4772f1(_0x356032,_0x55c52c){return _0x24e3(_0x356032- -0xda,_0x55c52c);}if(_0x537f76!=='default'){var _0x31c120=Object[_0x215059(-0x1d9,-0x1fa)](_0x274076,_0x537f76);Object[_0x4772f1(0x12d,0x170)](_0x51815f,_0x537f76,_0x31c120['get']?_0x31c120:{'enumerable':!![],'get':function(){return _0x274076[_0x537f76];}});}}),_0x51815f['default']=_0x274076,_0x51815f;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x4c783a,_0xc25ba9){const _0x39ecf6=_0x4c783a*Math['cos'](Cesium$2['Math']['toRadians'](_0xc25ba9));return _0x39ecf6;}function getV(_0x15de22,_0xb46aca){function _0x51ce6b(_0xb1d00c,_0x4805cb){return _0x24e3(_0xb1d00c- -0x20e,_0x4805cb);}function _0x34a60b(_0xf0cacd,_0x2e9684){return _0x24e3(_0xf0cacd- -0xd5,_0x2e9684);}const _0x20442b=_0x15de22*Math[_0x51ce6b(-0xa3,-0xa0)](Cesium$2[_0x51ce6b(-0x67,-0x4)][_0x51ce6b(-0xbe,-0x43)](_0xb46aca));return _0x20442b;}function getSpeed(_0x33f605,_0x2d1c88){const _0x559a85=Math['sqrt'](Math[_0x162911(0x565,0x568)](_0x33f605,0x2)+Math['pow'](_0x2d1c88,0x2));function _0x162911(_0x5ba1d2,_0x219b11){return _0x24e3(_0x5ba1d2-0x34e,_0x219b11);}return _0x559a85;}function _0x24e3(_0x3aff6a,_0x38184c){const _0x1afb1c=_0x1afb();return _0x24e3=function(_0x24e307,_0x4f20e8){_0x24e307=_0x24e307-0x144;let _0x4fbe13=_0x1afb1c[_0x24e307];return _0x4fbe13;},_0x24e3(_0x3aff6a,_0x38184c);}function getDirection(_0xc81434,_0x78de95){let _0x567001=Cesium$2['Math'][_0x5bfe9c(-0x15b,-0x1aa)](Math['atan2'](_0x78de95,_0xc81434));function _0x5bfe9c(_0x2ab50a,_0x23aeb4){return _0x24e3(_0x2ab50a- -0x33c,_0x23aeb4);}return _0x567001+=_0x567001<0x0?0x168:0x0,_0x567001;}const _0x3ba7c0={};_0x3ba7c0['__proto__']=null,_0x3ba7c0[_0x62ab23(-0x12d,-0x139)]=getU,_0x3ba7c0['getV']=getV,_0x3ba7c0['getSpeed']=getSpeed,_0x3ba7c0['getDirection']=getDirection;var WindUtil=_0x3ba7c0,updatePositionShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a',calculateSpeedShader='#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a',postProcessingPositionFragmentShader=_0x62ab23(-0x10a,-0x128),renderParticlesFragmentShader=_0x4f1b63(-0x130,-0x1aa),renderParticlesVertexShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a';const {ShaderSource:ShaderSource$1}=mars3d__namespace['Cesium'];class ShaderManager{static['getCalculateSpeedShader'](){const _0xd33584={};return _0xd33584['sources']=[calculateSpeedShader],new ShaderSource$1(_0xd33584);}static[_0x62ab23(-0x10e,-0x173)](){const _0x34c35c={};return _0x34c35c['sources']=[updatePositionShader],new ShaderSource$1(_0x34c35c);}static[_0x62ab23(-0x160,-0x160)](){const _0x4dd82e={};return _0x4dd82e['sources']=[renderParticlesVertexShader],new ShaderSource$1(_0x4dd82e);}static[_0x4f1b63(-0xd4,-0x79)](){const _0x5d0781={};function _0x32a99b(_0x591bf6,_0x52b916){return _0x62ab23(_0x591bf6-0x189,_0x52b916);}return _0x5d0781[_0x32a99b(0x2a,-0x57)]=[renderParticlesFragmentShader],new ShaderSource$1(_0x5d0781);}static[_0x62ab23(-0x18f,-0x139)](){const _0x4acb96={};_0x4acb96[_0x217a06(0x4e0,0x46f)]=[postProcessingPositionFragmentShader];function _0x217a06(_0x224fda,_0x3fad2d){return _0x62ab23(_0x3fad2d-0x5ce,_0x224fda);}return new ShaderSource$1(_0x4acb96);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace['Cesium'];class CustomPrimitive{constructor(_0x3fe7ce){this['commandType']=_0x3fe7ce[_0x5369a5(0xe8,0x158)],this[_0x4fcb9d(-0x109,-0x9f)]=_0x3fe7ce['geometry'],this['attributeLocations']=_0x3fe7ce['attributeLocations'],this['primitiveType']=_0x3fe7ce['primitiveType'],this['uniformMap']=_0x3fe7ce[_0x4fcb9d(-0xd3,-0x8e)]||{};function _0x5369a5(_0x5a67cd,_0x5b7e30){return _0x4f1b63(_0x5b7e30-0x2bc,_0x5a67cd);}this['vertexShaderSource']=_0x3fe7ce['vertexShaderSource'],this['fragmentShaderSource']=_0x3fe7ce['fragmentShaderSource'],this['rawRenderState']=_0x3fe7ce['rawRenderState'];function _0x4fcb9d(_0xf62789,_0x28b833){return _0x62ab23(_0x28b833-0xe7,_0xf62789);}this[_0x5369a5(0xf3,0x123)]=_0x3fe7ce[_0x5369a5(0x16c,0x123)],this[_0x5369a5(0xf7,0x137)]=_0x3fe7ce['outputTexture'],this[_0x4fcb9d(-0x50,-0xc7)]=_0x3fe7ce['autoClear']??![],this['preExecute']=_0x3fe7ce[_0x4fcb9d(-0xc3,-0x7b)],this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['isDynamic']=_0x3fe7ce[_0x5369a5(0xeb,0x134)]??(()=>!![]),this['autoClear']&&(this[_0x5369a5(0x218,0x1da)]=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Pass$1['OPAQUE']}));}[_0x4f1b63(-0xf0,-0xbb)](_0x4650c3){function _0x504117(_0x39fc80,_0x5f479f){return _0x4f1b63(_0x5f479f-0x206,_0x39fc80);}function _0xa9cf3e(_0x5d5915,_0x4db4ee){return _0x4f1b63(_0x5d5915- -0xb0,_0x4db4ee);}if(this['commandType']==='Draw'){const _0x28297e={};_0x28297e[_0x504117(0xd4,0x8a)]=_0x4650c3,_0x28297e['geometry']=this['geometry'],_0x28297e['attributeLocations']=this['attributeLocations'],_0x28297e['bufferUsage']=BufferUsage$1['STATIC_DRAW'];const _0x2ce848=VertexArray$1[_0xa9cf3e(-0x205,-0x27d)](_0x28297e),_0x23210d={};_0x23210d['context']=_0x4650c3,_0x23210d[_0xa9cf3e(-0x266,-0x2ae)]=this['vertexShaderSource'],_0x23210d[_0x504117(0xa6,0x80)]=this[_0x504117(-0xb,0x80)],_0x23210d[_0x504117(0x176,0x156)]=this['attributeLocations'];const _0x3716a0=ShaderProgram['fromCache'](_0x23210d),_0x163a01=RenderState['fromCache'](this[_0x504117(0x81,0x4f)]),_0x3c110f={};return _0x3c110f['owner']=this,_0x3c110f['vertexArray']=_0x2ce848,_0x3c110f['primitiveType']=this[_0xa9cf3e(-0x193,-0x192)],_0x3c110f['modelMatrix']=Matrix4[_0x504117(0x99,0xcc)],_0x3c110f[_0x504117(0x123,0x12f)]=_0x163a01,_0x3c110f['shaderProgram']=_0x3716a0,_0x3c110f[_0x504117(0xbe,0x6d)]=this['framebuffer'],_0x3c110f['uniformMap']=this['uniformMap'],_0x3c110f['pass']=Pass$1[_0x504117(0x1dd,0x15e)],new DrawCommand(_0x3c110f);}else{if(this['commandType']===_0xa9cf3e(-0x23d,-0x260)){const _0x27da39={};return _0x27da39['owner']=this,_0x27da39['fragmentShaderSource']=this['fragmentShaderSource'],_0x27da39['uniformMap']=this[_0x504117(0x29,0xaa)],_0x27da39['outputTexture']=this['outputTexture'],_0x27da39['persists']=!![],new ComputeCommand(_0x27da39);}else throw new Error(_0x504117(0xbe,0x4b));}}['setGeometry'](_0x12a286,_0xd6f743){this['geometry']=_0xd6f743;function _0x2c7583(_0x1f94d0,_0x38f55a){return _0x62ab23(_0x1f94d0-0x13d,_0x38f55a);}defined(this['commandToExecute'])&&(this['commandToExecute'][_0x2c7583(-0x33,-0x82)]=VertexArray$1['fromGeometry']({'context':_0x12a286,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1['STATIC_DRAW']}));}['update'](_0xd57ff8){if(!this[_0x2145bf(0x92,0xe8)]())return;if(!this[_0x2145bf(0xbd,0x73)]||!defined(_0xd57ff8))return;!defined(this['commandToExecute'])&&(this['commandToExecute']=this[_0x5c6ac8(0x343,0x34c)](_0xd57ff8[_0x2145bf(0x9e,0xcc)]));defined(this['preExecute'])&&this[_0x2145bf(0xd1,0x138)]();function _0x2145bf(_0x51630c,_0x437d7e){return _0x4f1b63(_0x51630c-0x21a,_0x437d7e);}function _0x5c6ac8(_0x5f1964,_0x49ffa1){return _0x4f1b63(_0x49ffa1-0x43c,_0x5f1964);}if(!_0xd57ff8[_0x5c6ac8(0x2b9,0x2c7)]){console['warn'](_0x2145bf(0x111,0xd1));return;}defined(this['clearCommand'])&&_0xd57ff8['commandList'][_0x5c6ac8(0x399,0x318)](this['clearCommand']),defined(this[_0x5c6ac8(0x251,0x2c4)])&&_0xd57ff8[_0x2145bf(0xa5,0xdc)]['push'](this[_0x2145bf(0xa2,0x4b)]);}['isDestroyed'](){return![];}['destroy'](){if(defined(this['commandToExecute'])){var _0x29c70f;(_0x29c70f=this['commandToExecute'][_0x196127(-0x187,-0x17a)])===null||_0x29c70f===void 0x0||_0x29c70f['destroy'](),this[_0x196127(-0x1ae,-0x1b5)]['shaderProgram']=undefined;}function _0x196127(_0x39dd6d,_0x53eb99){return _0x62ab23(_0x53eb99- -0x24,_0x39dd6d);}function _0x2fff96(_0x1a7409,_0xe23089){return _0x4f1b63(_0x1a7409-0x26b,_0xe23089);}return destroyObject(this);}}function deepMerge(_0x2639b7,_0x188b32){if(!_0x2639b7)return _0x188b32;if(!_0x188b32)return _0x2639b7;const _0x3eeb1b={..._0x188b32};function _0x9dfca5(_0x549046,_0x51f00f){return _0x4f1b63(_0x549046-0x1d3,_0x51f00f);}const _0x4593ed=_0x3eeb1b;function _0x20b87c(_0x395e0a,_0x3d151b){return _0x62ab23(_0x395e0a-0x396,_0x3d151b);}for(const _0xe7dc21 in _0x2639b7){if(Object[_0x20b87c(0x1ca,0x15b)]['hasOwnProperty']['call'](_0x2639b7,_0xe7dc21)){const _0x3e0a31=_0x2639b7[_0xe7dc21],_0x332e24=_0x188b32[_0xe7dc21];if(Array['isArray'](_0x3e0a31)){_0x4593ed[_0xe7dc21]=_0x3e0a31[_0x20b87c(0x290,0x235)]();continue;}if(_0x3e0a31&&typeof _0x3e0a31===_0x20b87c(0x2db,0x2f1)){_0x4593ed[_0xe7dc21]=deepMerge(_0x3e0a31,_0x332e24||{});continue;}_0x3e0a31!==undefined&&(_0x4593ed[_0xe7dc21]=_0x3e0a31);}}return _0x4593ed;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace[_0x4f1b63(-0x1a6,-0x1b9)];class WindParticlesComputing{constructor(_0x5bfa77,_0x4f0f53,_0x145eee,_0x78021,_0x491a5b){this['context']=_0x5bfa77;function _0x4d91e4(_0x6e1546,_0x351e75){return _0x4f1b63(_0x351e75-0x64e,_0x6e1546);}function _0x49dd94(_0x221e33,_0x413826){return _0x4f1b63(_0x413826-0x534,_0x221e33);}this[_0x49dd94(0x3a6,0x390)]=_0x145eee,this['viewerParameters']=_0x78021,this[_0x49dd94(0x438,0x462)]=_0x4f0f53,this['frameRate']=0x3c,this['frameRateAdjustment']=0x1;const _0xf5cb2f={};_0xf5cb2f['scene']=_0x491a5b,_0xf5cb2f[_0x4d91e4(0x50d,0x58b)]=0x1,_0xf5cb2f['quietPeriod']=0x0,this[_0x49dd94(0x458,0x45c)]=new FrameRateMonitor(_0xf5cb2f),this[_0x49dd94(0x319,0x37b)](),this['createWindTextures'](),this['createParticlesTextures'](),this['createComputingPrimitives']();}[_0x62ab23(-0x1d2,-0x154)](){const _0x50045d=()=>{function _0x5511da(_0x118886,_0x26531c){return _0x24e3(_0x118886- -0x277,_0x26531c);}function _0xe3bfd1(_0x249fe2,_0x1f182c){return _0x24e3(_0x1f182c- -0x193,_0x249fe2);}this[_0x5511da(-0x4e,-0x21)][_0xe3bfd1(0x43,0xb6)]>0x14&&(this['frameRate']=this[_0xe3bfd1(0x7f,0x96)]['lastFramesPerSecond'],this['frameRateAdjustment']=0x3c/Math['max'](this['frameRate'],0x1));};function _0x3075fd(_0x23d367,_0x11fc49){return _0x62ab23(_0x23d367-0x3f9,_0x11fc49);}_0x50045d();const _0x3db785=setInterval(_0x50045d,0x3e8),_0x5c63b3=this['destroy'][_0x3075fd(0x248,0x28d)](this);this['destroy']=()=>{clearInterval(_0x3db785),_0x5c63b3();};}[_0x4f1b63(-0x10d,-0x16f)](){function _0x56e19b(_0x14aa26,_0xb16fd9){return _0x62ab23(_0xb16fd9-0x48a,_0x14aa26);}const _0x5c55d0={};_0x5c55d0[_0x20bf49(0x4e0,0x536)]=TextureMinificationFilter$1[_0x56e19b(0x2ee,0x2d5)];function _0x20bf49(_0x4695ee,_0x7ba9c0){return _0x4f1b63(_0x7ba9c0-0x5ec,_0x4695ee);}_0x5c55d0['magnificationFilter']=TextureMagnificationFilter$1['LINEAR'];const _0x1373b2={'context':this[_0x20bf49(0x436,0x470)],'width':this['windData']['width'],'height':this['windData']['height'],'pixelFormat':PixelFormat$1['RED'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':this[_0x56e19b(0x301,0x2cd)]['flipY']??![],'sampler':new Sampler$1(_0x5c55d0)};this['windTextures']={'U':new Texture$1({..._0x1373b2,'source':{'arrayBufferView':new Float32Array(this[_0x56e19b(0x361,0x39f)]['u'][_0x56e19b(0x31a,0x2e5)])}}),'V':new Texture$1({..._0x1373b2,'source':{'arrayBufferView':new Float32Array(this[_0x56e19b(0x3ee,0x39f)]['v']['array'])}})};}[_0x62ab23(-0x1ba,-0x150)](){const _0xbaad39={};function _0x469897(_0xb5e331,_0x1deffa){return _0x62ab23(_0xb5e331-0x136,_0x1deffa);}_0xbaad39['minificationFilter']=TextureMinificationFilter$1['NEAREST'];function _0x137aa7(_0x45e8e9,_0x547d83){return _0x62ab23(_0x547d83-0x5d1,_0x45e8e9);}_0xbaad39['magnificationFilter']=TextureMagnificationFilter$1['NEAREST'];const _0x2e0a7f={'context':this['context'],'width':this['options']['particlesTextureSize'],'height':this[_0x137aa7(0x420,0x414)][_0x137aa7(0x3b7,0x435)],'pixelFormat':PixelFormat$1['RGBA'],'pixelDatatype':PixelDatatype$1['FLOAT'],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options'][_0x469897(-0x66,-0x8b)]*this['options']['particlesTextureSize']*0x4)['fill'](0x0)},'sampler':new Sampler$1(_0xbaad39)};this['particlesTextures']={'previousParticlesPosition':new Texture$1(_0x2e0a7f),'currentParticlesPosition':new Texture$1(_0x2e0a7f),'nextParticlesPosition':new Texture$1(_0x2e0a7f),'postProcessingPosition':new Texture$1(_0x2e0a7f),'particlesSpeed':new Texture$1(_0x2e0a7f)};}['destroyParticlesTextures'](){function _0x1945da(_0x16d768,_0x26897b){return _0x62ab23(_0x16d768-0x6e2,_0x26897b);}function _0x1962e0(_0x1e4ac5,_0x3bfeb9){return _0x4f1b63(_0x3bfeb9-0x409,_0x1e4ac5);}Object[_0x1962e0(0x37a,0x344)](this['particlesTextures'])[_0x1945da(0x573,0x5db)](_0x217ee1=>_0x217ee1[_0x1962e0(0x2ca,0x278)]());}[_0x4f1b63(-0xdc,-0xdf)](){function _0x3f960e(_0x21c425,_0x4b9d20){return _0x62ab23(_0x21c425-0x512,_0x4b9d20);}function _0x3a68de(_0x462eac,_0x5ccf8a){return _0x4f1b63(_0x5ccf8a-0xf8,_0x462eac);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':()=>this['windTextures']['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this['windData']['u'][_0x3a68de(-0xbc,-0xc5)],this[_0x3a68de(-0x1,0x26)]['u']['max']),'vRange':()=>new Cartesian2$1(this[_0x3f960e(0x427,0x3fc)]['v']['min'],this[_0x3a68de(0x7a,0x26)]['v']['max']),'speedRange':()=>new Cartesian2$1(this['windData']['speed']['min'],this[_0x3a68de(0x0,0x26)]['speed'][_0x3f960e(0x43f,0x488)]),'currentParticlesPosition':()=>this['particlesTextures']['currentParticlesPosition'],'speedScaleFactor':()=>{function _0x39ddc8(_0x2643b4,_0x95478e){return _0x3a68de(_0x2643b4,_0x95478e-0x455);}return(this['viewerParameters']['pixelSize']+0x32)*this[_0x39ddc8(0x353,0x3a9)]['speedFactor'];},'frameRateAdjustment':()=>this[_0x3f960e(0x402,0x394)],'dimension':()=>new Cartesian2$1(this['windData']['width'],this['windData'][_0x3f960e(0x414,0x491)]),'minimum':()=>new Cartesian2$1(this['windData']['bounds']['west'],this['windData']['bounds']['south']),'maximum':()=>new Cartesian2$1(this['windData']['bounds'][_0x3a68de(0x91,0x27)],this['windData']['bounds'][_0x3a68de(-0x5,0x37)])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{function _0x2176cc(_0x42d99e,_0x50e575){return _0x3a68de(_0x42d99e,_0x50e575-0x450);}const _0x18833a=this['particlesTextures'][_0x254c30(-0x8a,-0xde)];this['particlesTextures'][_0x254c30(-0xdd,-0xde)]=this['particlesTextures']['currentParticlesPosition'];function _0x254c30(_0x3ab0cf,_0x5f2d01){return _0x3a68de(_0x3ab0cf,_0x5f2d01- -0xcf);}this[_0x2176cc(0x42c,0x421)]['currentParticlesPosition']=this[_0x254c30(-0x82,-0xfe)]['postProcessingPosition'],this[_0x254c30(-0x164,-0xfe)]['postProcessingPosition']=_0x18833a,this['primitives']['calculateSpeed'][_0x254c30(-0x12e,-0x14f)]&&(this['primitives']['calculateSpeed']['commandToExecute'][_0x2176cc(0x33b,0x3c3)]=this['particlesTextures'][_0x2176cc(0x38a,0x3cd)]);},'isDynamic':()=>this[_0x3a68de(-0xb0,-0xac)]['dynamic']}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this[_0x3f960e(0x3d2,0x397)]['currentParticlesPosition'],'particlesSpeed':()=>this['particlesTextures']['particlesSpeed']},'fragmentShaderSource':ShaderManager['getUpdatePositionShader'](),'outputTexture':this[_0x3a68de(-0x48,-0x2f)][_0x3a68de(-0x15,-0x7f)],'preExecute':()=>{function _0x54b05a(_0x3ad3a4,_0xed9006){return _0x3f960e(_0x3ad3a4- -0x306,_0xed9006);}function _0x56bd69(_0x154762,_0x28462f){return _0x3a68de(_0x28462f,_0x154762-0xca);}this['primitives']['updatePosition']['commandToExecute']&&(this['primitives'][_0x54b05a(0x134,0x1a4)][_0x54b05a(0x7b,0x55)]['outputTexture']=this['particlesTextures']['nextParticlesPosition']);},'isDynamic':()=>this['options']['dynamic']}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':()=>this[_0x3a68de(0x47,-0x2f)][_0x3a68de(-0x32,-0x7f)],'particlesSpeed':()=>this[_0x3f960e(0x3d2,0x41c)]['particlesSpeed'],'lonRange':()=>this['viewerParameters'][_0x3f960e(0x3c0,0x444)],'latRange':()=>this['viewerParameters'][_0x3a68de(0xb9,0x3f)],'dataLonRange':()=>new Cartesian2$1(this[_0x3f960e(0x427,0x3ef)][_0x3a68de(-0x4,0x2b)]['west'],this['windData'][_0x3a68de(0xaf,0x2b)][_0x3a68de(0x5f,0x27)]),'dataLatRange':()=>new Cartesian2$1(this['windData']['bounds'][_0x3f960e(0x412,0x47e)],this['windData'][_0x3a68de(-0x45,0x2b)][_0x3a68de(0x43,0x37)]),'randomCoefficient':function(){function _0x439e2d(_0x53a194,_0x250252){return _0x3f960e(_0x53a194- -0x2ee,_0x250252);}return Math[_0x439e2d(0x118,0x113)]();},'dropRate':()=>this[_0x3a68de(-0x71,-0xac)][_0x3a68de(-0xf0,-0x63)],'dropRateBump':()=>this['options']['dropRateBump'],'useViewerBounds':()=>this[_0x3a68de(-0x7d,-0xac)]['useViewerBounds']},'fragmentShaderSource':ShaderManager[_0x3f960e(0x383,0x3f3)](),'outputTexture':this[_0x3a68de(-0x30,-0x2f)]['postProcessingPosition'],'preExecute':()=>{function _0x3a8d78(_0x562693,_0x5cbe7c){return _0x3f960e(_0x562693- -0x5a9,_0x5cbe7c);}function _0x4c6714(_0x4933c2,_0x524710){return _0x3a68de(_0x524710,_0x4933c2-0x2cf);}this['primitives']['postProcessingPosition']['commandToExecute']&&(this['primitives'][_0x4c6714(0x318,0x2d8)]['commandToExecute'][_0x3a8d78(-0x235,-0x1fc)]=this['particlesTextures']['postProcessingPosition']);},'isDynamic':()=>this[_0x3f960e(0x355,0x2d4)]['dynamic']})};}['reCreateWindTextures'](){function _0x2f321a(_0x4612d1,_0x47bd9e){return _0x62ab23(_0x47bd9e-0x1,_0x4612d1);}function _0x303fe5(_0xe0c0f5,_0x113b88){return _0x4f1b63(_0xe0c0f5-0x235,_0x113b88);}this[_0x303fe5(0x122,0x122)]['U']['destroy'](),this['windTextures']['V'][_0x2f321a(-0x22d,-0x1a9)](),this[_0x303fe5(0x128,0xdc)]();}[_0x62ab23(-0x150,-0x11f)](_0x4efc12){function _0x2a2586(_0x6da98b,_0x57361d){return _0x62ab23(_0x6da98b-0x647,_0x57361d);}this[_0x2a2586(0x55c,0x53e)]=_0x4efc12,this['reCreateWindTextures']();}['updateOptions'](_0x1b2300){function _0x45351e(_0x9a1d6a,_0x19d08c){return _0x4f1b63(_0x9a1d6a-0x22e,_0x19d08c);}const _0x531da1=_0x1b2300['flipY']!==undefined&&_0x1b2300[_0x45351e(0x8e,0x42)]!==this['options'][_0x45351e(0x8e,0xef)];function _0x29bf93(_0x52e4e5,_0x32b9e4){return _0x4f1b63(_0x32b9e4- -0x1f,_0x52e4e5);}this[_0x45351e(0x8a,0x12)]=deepMerge(_0x1b2300,this[_0x45351e(0x8a,0x9e)]),_0x531da1&&this['reCreateWindTextures']();}['processWindData'](_0x1f851f){const {array:_0x3791cc}=_0x1f851f;function _0x19540a(_0x2966a3,_0x2580cb){return _0x62ab23(_0x2580cb-0x2ae,_0x2966a3);}let {min:_0x1b20a6,max:_0x633540}=_0x1f851f;const _0x4d401e=new Float32Array(_0x3791cc['length']);_0x1b20a6===undefined&&(console[_0x43c1a4(-0xc2,-0x105)]('min\x20is\x20undefined,\x20calculate\x20min'),_0x1b20a6=Math[_0x19540a(0x13c,0xd8)](..._0x3791cc));_0x633540===undefined&&(console['warn']('max\x20is\x20undefined,\x20calculate\x20max'),_0x633540=Math['max'](..._0x3791cc));const _0x328b41=Math['max'](Math['abs'](_0x1b20a6),Math['abs'](_0x633540));function _0x43c1a4(_0x18c282,_0x3c829c){return _0x62ab23(_0x18c282-0xf6,_0x3c829c);}for(let _0x43e09c=0x0;_0x43e09c<_0x3791cc['length'];_0x43e09c++){const _0x4aa3c5=_0x3791cc[_0x43e09c]/_0x328b41;_0x4d401e[_0x43e09c]=_0x4aa3c5;}return _0x4d401e;}[_0x4f1b63(-0x191,-0x121)](){Object[_0x524556(0x3c1,0x3db)](this[_0x37dd28(0x35f,0x2d6)])['forEach'](_0x463383=>_0x463383['destroy']());function _0x524556(_0x5272a3,_0x1fcc30){return _0x62ab23(_0x5272a3-0x49f,_0x1fcc30);}function _0x37dd28(_0x4452ea,_0x4aafa9){return _0x62ab23(_0x4452ea-0x48b,_0x4aafa9);}Object[_0x37dd28(0x3ad,0x413)](this['particlesTextures'])['forEach'](_0x368be9=>_0x368be9[_0x37dd28(0x2e1,0x2ae)]()),Object['values'](this[_0x37dd28(0x36f,0x300)])[_0x37dd28(0x31c,0x2a0)](_0xab3a94=>_0xab3a94['destroy']()),this['frameRateMonitor'][_0x524556(0x2f5,0x354)]();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace[_0x4f1b63(-0x1a6,-0x1ce)];class WindParticlesRendering{constructor(_0x14f3de,_0x48480e,_0x382990,_0x13ce32){this['context']=_0x14f3de,this[_0x40372a(-0x242,-0x220)]=_0x48480e,this['viewerParameters']=_0x382990,this['computing']=_0x13ce32;(typeof this['options']['particlesTextureSize']!=='number'||this[_0x40372a(-0x242,-0x294)][_0x12c5a1(0x492,0x4f3)]<=0x0)&&(console['error']('Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.'),this['options'][_0x40372a(-0x221,-0x24d)]=0x100);function _0x12c5a1(_0x132414,_0x424896){return _0x4f1b63(_0x424896-0x676,_0x132414);}this['colorTable']=this['createColorTableTexture']();function _0x40372a(_0x1b813a,_0x4ee826){return _0x4f1b63(_0x1b813a- -0x9e,_0x4ee826);}this['textures']=this[_0x40372a(-0x196,-0x1ac)](),this[_0x12c5a1(0x5eb,0x5cc)]=this['createRenderingFramebuffers'](),this['primitives']=this['createPrimitives']();}[_0x4f1b63(-0xf8,-0x156)](){const _0x866b3={};_0x866b3['context']=this[_0x417190(0x375,0x370)],_0x866b3[_0x417190(0x419,0x3db)]=this['context'][_0x6f497c(0x5ca,0x5e5)],_0x866b3[_0x6f497c(0x5e1,0x5c4)]=this[_0x417190(0x3ac,0x370)][_0x6f497c(0x547,0x51f)],_0x866b3[_0x6f497c(0x58a,0x57e)]=PixelFormat[_0x417190(0x3d3,0x3b9)],_0x866b3[_0x417190(0x3cb,0x3e1)]=PixelDatatype[_0x417190(0x466,0x3ef)];function _0x6f497c(_0x104237,_0x2e5daf){return _0x62ab23(_0x2e5daf-0x6c2,_0x104237);}const _0x1551f7=_0x866b3;function _0x417190(_0x226ff5,_0xd4ed35){return _0x62ab23(_0xd4ed35-0x505,_0x226ff5);}const _0x5137c3={};_0x5137c3['context']=this['context'],_0x5137c3[_0x417190(0x36f,0x3db)]=this[_0x6f497c(0x571,0x52d)][_0x6f497c(0x58b,0x5e5)],_0x5137c3['height']=this['context'][_0x6f497c(0x4c6,0x51f)],_0x5137c3[_0x417190(0x434,0x3c1)]=PixelFormat['DEPTH_COMPONENT'],_0x5137c3['pixelDatatype']=PixelDatatype['UNSIGNED_INT'];const _0x56f958=_0x5137c3;return{'segmentsColor':new Texture(_0x1551f7),'segmentsDepth':new Texture(_0x56f958)};}[_0x62ab23(-0x182,-0x1f3)](){const _0x1f022a={};function _0x82b775(_0x3549e0,_0x58c829){return _0x62ab23(_0x58c829-0x22e,_0x3549e0);}_0x1f022a['context']=this['context'];function _0x204e5e(_0x192005,_0x1a61ea){return _0x62ab23(_0x192005-0x4df,_0x1a61ea);}return _0x1f022a[_0x82b775(0xaa,0x6a)]=[this['textures']['segmentsColor']],_0x1f022a['depthTexture']=this['textures'][_0x204e5e(0x348,0x2ff)],{'segments':new Framebuffer(_0x1f022a)};}['destoryRenderingFramebuffers'](){function _0x520d35(_0x447804,_0x205049){return _0x62ab23(_0x205049-0x5c5,_0x447804);}Object['values'](this['framebuffers'])[_0x520d35(0x4b7,0x456)](_0x404bb4=>{_0x404bb4['destroy']();});}['createColorTableTexture'](){const _0x180a5f=new Float32Array(this[_0x27c9d5(-0xfe,-0x109)]['colors']['flatMap'](_0x16e9ba=>{function _0x7e332d(_0x52793d,_0x34c8ac){return _0x27c9d5(_0x34c8ac,_0x52793d-0x3f7);}const _0x36eef8=Color$1[_0x7e332d(0x369,0x351)](_0x16e9ba);function _0x969844(_0x3125b2,_0x5e2470){return _0x27c9d5(_0x5e2470,_0x3125b2-0x221);}return[_0x36eef8['red'],_0x36eef8[_0x969844(0x14a,0x16f)],_0x36eef8[_0x969844(0x179,0x1cf)],_0x36eef8['alpha']];})),_0x548973={};_0x548973[_0x42f57c(0x502,0x48d)]=TextureMinificationFilter['LINEAR'],_0x548973['magnificationFilter']=TextureMagnificationFilter['LINEAR'];function _0x42f57c(_0x234ef2,_0xf341e9){return _0x4f1b63(_0x234ef2-0x5b8,_0xf341e9);}_0x548973['wrapS']=TextureWrap['CLAMP_TO_EDGE'];function _0x27c9d5(_0x1c423e,_0x1b5b49){return _0x4f1b63(_0x1b5b49-0x9b,_0x1c423e);}return _0x548973[_0x42f57c(0x4a6,0x4fa)]=TextureWrap['CLAMP_TO_EDGE'],new Texture({'context':this['context'],'width':this[_0x42f57c(0x414,0x401)][_0x42f57c(0x48e,0x452)]['length'],'height':0x1,'pixelFormat':PixelFormat[_0x27c9d5(-0xc,-0x98)],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x548973),'source':{'width':this['options']['colors']['length'],'height':0x1,'arrayBufferView':_0x180a5f}});}['createSegmentsGeometry'](){const _0x2c2239=0x4,_0x272df1=this['options'][_0x218d3d(0x235,0x2af)];function _0x215207(_0x8ff05b,_0xcd0c46){return _0x62ab23(_0xcd0c46-0xa,_0x8ff05b);}let _0x23972a=[];for(let _0x48c3ba=0x0;_0x48c3ba<_0x272df1;_0x48c3ba++){for(let _0x170750=0x0;_0x170750<_0x272df1;_0x170750++){for(let _0xd26751=0x0;_0xd26751<_0x2c2239;_0xd26751++){_0x23972a[_0x215207(-0x194,-0x133)](_0x48c3ba/_0x272df1),_0x23972a['push'](_0x170750/_0x272df1);}}}_0x23972a=new Float32Array(_0x23972a);const _0x3c400f=this['options']['particlesTextureSize']**0x2;let _0x190797=[];for(let _0x249fe4=0x0;_0x249fe4<_0x3c400f;_0x249fe4++){_0x190797['push'](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x190797=new Float32Array(_0x190797);let _0x531a6f=[];function _0x218d3d(_0x17fa09,_0x564b87){return _0x62ab23(_0x17fa09-0x3d1,_0x564b87);}for(let _0x35d5c2=0x0,_0x1e0857=0x0;_0x35d5c2<_0x3c400f;_0x35d5c2++){_0x531a6f[_0x215207(-0x18d,-0x133)](_0x1e0857+0x0,_0x1e0857+0x1,_0x1e0857+0x2,_0x1e0857+0x2,_0x1e0857+0x1,_0x1e0857+0x3),_0x1e0857+=_0x2c2239;}_0x531a6f=new Uint32Array(_0x531a6f);const _0x392c84={};_0x392c84[_0x215207(-0x112,-0xc6)]=ComponentDatatype['FLOAT'],_0x392c84['componentsPerAttribute']=0x2,_0x392c84['values']=_0x23972a;const _0x2d45e6={};_0x2d45e6['componentDatatype']=ComponentDatatype[_0x218d3d(0x2a9,0x23b)],_0x2d45e6['componentsPerAttribute']=0x3,_0x2d45e6['values']=_0x190797;const _0x50ef46=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x392c84),'normal':new GeometryAttribute(_0x2d45e6)}),'indices':_0x531a6f});return _0x50ef46;}['createRawRenderState'](_0x29b44e){const _0xedc989={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x29b44e};return Appearance['getDefaultRenderState'](!![],![],_0xedc989);}[_0x62ab23(-0x16b,-0x117)](){const _0x3e783e={};_0x3e783e['st']=0x0,_0x3e783e[_0xdff8bf(0x5ba,0x53c)]=0x1;const _0x3e322a={};_0x3e322a['enabled']=!![];const _0x11e98d={};_0x11e98d[_0x1d6363(-0x15d,-0x11b)]=!![],_0x11e98d[_0xdff8bf(0x52e,0x4f5)]=WebGLRenderingContext['FUNC_ADD'],_0x11e98d['blendFuncSource']=WebGLRenderingContext[_0x1d6363(-0x1ea,-0x235)],_0x11e98d['blendFuncDestination']=WebGLRenderingContext[_0xdff8bf(0x550,0x519)];function _0x1d6363(_0x38965d,_0x15abdf){return _0x4f1b63(_0x38965d- -0x5f,_0x15abdf);}const _0x487f5a={};_0x487f5a[_0xdff8bf(0x519,0x54b)]=undefined,_0x487f5a[_0xdff8bf(0x462,0x4db)]=_0x3e322a,_0x487f5a[_0x1d6363(-0x193,-0x197)]=!![],_0x487f5a['blending']=_0x11e98d;function _0xdff8bf(_0x7fe5f2,_0x55150a){return _0x4f1b63(_0x55150a-0x61b,_0x7fe5f2);}const _0x59a42f=new CustomPrimitive({'commandType':'Draw','attributeLocations':_0x3e783e,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType['TRIANGLES'],'uniformMap':{'previousParticlesPosition':()=>this[_0x1d6363(-0x1c5,-0x1e8)][_0x1d6363(-0x186,-0x17f)]['previousParticlesPosition'],'currentParticlesPosition':()=>this['computing']['particlesTextures']['currentParticlesPosition'],'postProcessingPosition':()=>this['computing'][_0x1d6363(-0x186,-0x161)][_0xdff8bf(0x588,0x56c)],'particlesSpeed':()=>this[_0x1d6363(-0x1c5,-0x175)]['particlesTextures']['particlesSpeed'],'frameRateAdjustment':()=>this[_0x1d6363(-0x1c5,-0x154)][_0x1d6363(-0x156,-0x1ca)],'colorTable':()=>this[_0xdff8bf(0x573,0x572)],'domain':()=>{var _0x4b84c0,_0x1a3bb1;function _0x109c83(_0x4cce8b,_0x3c9a67){return _0xdff8bf(_0x3c9a67,_0x4cce8b- -0x270);}function _0x384f6f(_0x2883ec,_0x367ea9){return _0xdff8bf(_0x367ea9,_0x2883ec- -0x33f);}const _0x82ddf7=new Cartesian2(((_0x4b84c0=this['options']['domain'])===null||_0x4b84c0===void 0x0?void 0x0:_0x4b84c0[_0x384f6f(0x11f,0xea)])??this['computing']['windData'][_0x109c83(0x214,0x18a)][_0x384f6f(0x11f,0x98)],((_0x1a3bb1=this[_0x384f6f(0x138,0x1a7)]['domain'])===null||_0x1a3bb1===void 0x0?void 0x0:_0x1a3bb1[_0x109c83(0x2f1,0x290)])??this['computing'][_0x384f6f(0x20a,0x22a)][_0x109c83(0x214,0x284)][_0x384f6f(0x222,0x1d6)]);return _0x82ddf7;},'displayRange':()=>{function _0x40d5a6(_0x51da27,_0x5c6b1a){return _0x1d6363(_0x51da27-0x61d,_0x5c6b1a);}var _0x9a37b,_0x584880;function _0xcbe90e(_0x4c3386,_0x569597){return _0x1d6363(_0x4c3386- -0x39,_0x569597);}const _0x2aabe0=new Cartesian2(((_0x9a37b=this['options']['displayRange'])===null||_0x9a37b===void 0x0?void 0x0:_0x9a37b['min'])??this['computing'][_0xcbe90e(-0x16a,-0x171)][_0xcbe90e(-0x22f,-0x1e4)]['min'],((_0x584880=this['options'][_0xcbe90e(-0x250,-0x243)])===null||_0x584880===void 0x0?void 0x0:_0x584880['max'])??this['computing'][_0x40d5a6(0x4ec,0x515)][_0xcbe90e(-0x22f,-0x276)]['max']);return _0x2aabe0;},'particleHeight':()=>this['options']['fixedHeight']||0x0,'aspect':()=>this['context']['drawingBufferWidth']/this['context']['drawingBufferHeight'],'pixelSize':()=>this[_0xdff8bf(0x428,0x48d)]['pixelSize'],'lineWidth':()=>{const _0x196144={};function _0x4c6a93(_0x452049,_0x547b25){return _0xdff8bf(_0x547b25,_0x452049- -0x229);}_0x196144['min']=0x1,_0x196144['max']=0x2;const _0x170422=this[_0x44f653(0x335,0x361)]['lineWidth']||_0x196144;function _0x44f653(_0x1ff570,_0x5843cf){return _0xdff8bf(_0x5843cf,_0x1ff570- -0x142);}return new Cartesian2(_0x170422[_0x44f653(0x31c,0x321)],_0x170422['max']);},'lineLength':()=>{const _0x2cbb8c={};function _0x5753f1(_0x204901,_0x20e9bf){return _0x1d6363(_0x20e9bf-0x510,_0x204901);}function _0x4d6fef(_0x238bd7,_0x223cf1){return _0x1d6363(_0x223cf1-0x4d0,_0x238bd7);}_0x2cbb8c[_0x5753f1(0x2e0,0x2f4)]=0x14,_0x2cbb8c[_0x5753f1(0x451,0x3f7)]=0x64;const _0x4ff31f=this['options']['lineLength']||_0x2cbb8c;return new Cartesian2(_0x4ff31f['min'],_0x4ff31f[_0x4d6fef(0x34b,0x3b7)]);},'is3D':()=>this[_0xdff8bf(0x512,0x48d)]['sceneMode']===SceneMode['SCENE3D'],'segmentsDepthTexture':()=>this['textures']['segmentsDepth']},'vertexShaderSource':ShaderManager[_0x1d6363(-0x1a6,-0x1b7)](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this[_0x1d6363(-0x1fd,-0x18c)](_0x487f5a)}),_0xb5b80f={};return _0xb5b80f['segments']=_0x59a42f,_0xb5b80f;}['onParticlesTextureSizeChange'](){const _0x2308f3=this[_0x4fda20(0x2,-0x39)]();this[_0x4fda20(-0x2c,-0x3b)][_0x34b6e6(0x3f8,0x430)][_0x34b6e6(0x390,0x3ca)]=_0x2308f3;const _0x1fe429={};_0x1fe429[_0x4fda20(-0xcb,-0xb4)]=this['context'];function _0x34b6e6(_0x25459a,_0x3398f8){return _0x4f1b63(_0x25459a-0x4fd,_0x3398f8);}_0x1fe429['geometry']=_0x2308f3,_0x1fe429[_0x4fda20(-0x3a,0x18)]=this[_0x34b6e6(0x3fa,0x42e)]['segments']['attributeLocations'],_0x1fe429[_0x4fda20(-0x6e,-0x7)]=BufferUsage[_0x34b6e6(0x44a,0x451)];function _0x4fda20(_0xa7a0d9,_0x3a7da8){return _0x62ab23(_0x3a7da8-0xe1,_0xa7a0d9);}const _0x44b6bc=VertexArray[_0x34b6e6(0x3a8,0x3c6)](_0x1fe429);this[_0x34b6e6(0x3fa,0x38f)][_0x4fda20(-0x6,-0x3d)]['commandToExecute']&&(this[_0x4fda20(-0x29,-0x3b)]['segments']['commandToExecute']['vertexArray']=_0x44b6bc);}[_0x4f1b63(-0x190,-0x178)](){function _0x100ce4(_0xc09c07,_0xb6d860){return _0x62ab23(_0xb6d860-0x6c3,_0xc09c07);}function _0x407b28(_0x4210e0,_0x7a5b5c){return _0x62ab23(_0x7a5b5c- -0xa5,_0x4210e0);}this['colorTable']['destroy'](),this[_0x407b28(-0x103,-0x167)]=this[_0x407b28(-0x202,-0x1be)]();}['updateOptions'](_0x1399dc){const _0x845da2=_0x1399dc['colors']&&JSON[_0x365861(-0xe6,-0x91)](_0x1399dc[_0x4f5e5e(0x37a,0x3d0)])!==JSON['stringify'](this['options']['colors']);this['options']=deepMerge(_0x1399dc,this['options']);function _0x4f5e5e(_0x34fef7,_0x205e3f){return _0x4f1b63(_0x34fef7-0x4a4,_0x205e3f);}function _0x365861(_0x358372,_0x27789c){return _0x4f1b63(_0x27789c-0xbb,_0x358372);}_0x845da2&&this['onColorTableChange']();}[_0x62ab23(-0x1aa,-0x13b)](){function _0x813b0b(_0x387cf7,_0x5eda51){return _0x62ab23(_0x387cf7- -0x10,_0x5eda51);}function _0xa81eb7(_0x5515e7,_0x588b96){return _0x4f1b63(_0x5515e7-0x5ea,_0x588b96);}Object[_0xa81eb7(0x525,0x532)](this['framebuffers'])['forEach'](_0x4ba3e8=>{_0x4ba3e8['destroy']();}),Object['values'](this[_0xa81eb7(0x4e7,0x468)])['forEach'](_0x33bc6f=>{function _0x3f305a(_0x20b1b3,_0x3f4e19){return _0x813b0b(_0x20b1b3-0xe,_0x3f4e19);}_0x33bc6f[_0x3f305a(-0x1ac,-0x1fd)]();}),this['colorTable']['destroy']();}}const {ClearCommand,Color,Pass}=mars3d__namespace['Cesium'];class WindParticleSystem{constructor(_0x109d3f,_0x31a554,_0x412a9d,_0x3ae9eb,_0x559a47){this['context']=_0x109d3f;function _0x5e7a28(_0x5ccf24,_0x541d03){return _0x4f1b63(_0x5ccf24- -0x92,_0x541d03);}this[_0x5e7a28(-0x236,-0x1bb)]=_0x412a9d;function _0x4f1006(_0xf4cff5,_0x4b7bc6){return _0x62ab23(_0xf4cff5-0x46b,_0x4b7bc6);}this[_0x4f1006(0x2c4,0x250)]=_0x3ae9eb,this[_0x5e7a28(-0x1f8,-0x1da)]=new WindParticlesComputing(_0x109d3f,_0x31a554,_0x412a9d,_0x3ae9eb,_0x559a47),this['rendering']=new WindParticlesRendering(_0x109d3f,_0x412a9d,_0x3ae9eb,this['computing']),this['clearFramebuffers']();}['getPrimitives'](){function _0x522858(_0x2d3979,_0x15b0d4){return _0x62ab23(_0x15b0d4- -0x92,_0x2d3979);}function _0x1b32d6(_0x2e4880,_0x5a4a46){return _0x4f1b63(_0x2e4880-0x70,_0x5a4a46);}const _0x4f348c=[this['computing'][_0x522858(-0x141,-0x1ae)]['calculateSpeed'],this['computing'][_0x522858(-0x1e7,-0x1ae)][_0x1b32d6(-0x4f,-0x5)],this[_0x522858(-0x288,-0x211)]['primitives']['postProcessingPosition'],this['rendering']['primitives']['segments']];return _0x4f348c;}['clearFramebuffers'](){const _0x5dd4de=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass['OPAQUE']});function _0x2f2cb8(_0x5f7295,_0x5671e6){return _0x62ab23(_0x5f7295-0x125,_0x5671e6);}Object['keys'](this['rendering']['framebuffers'])[_0x2f2cb8(-0x4a,-0x19)](_0x4270ff=>{function _0x52c183(_0x1569ed,_0xf84243){return _0x2f2cb8(_0x1569ed- -0x155,_0xf84243);}_0x5dd4de[_0x54ac22(-0x1ec,-0x212)]=this[_0x54ac22(-0x24a,-0x1cd)]['framebuffers'][_0x4270ff];function _0x54ac22(_0x70aace,_0x127046){return _0x2f2cb8(_0x127046- -0x185,_0x70aace);}_0x5dd4de['execute'](this[_0x52c183(-0x1c5,-0x238)]);});}[_0x4f1b63(-0xef,-0x125)](_0x3ecb91){let _0x5be637=![];_0x3ecb91['particlesTextureSize']&&this['options']['particlesTextureSize']!==_0x3ecb91[_0x24901a(-0xfc,-0x118)]&&(_0x5be637=!![]);const _0x4f4832=deepMerge(_0x3ecb91,this[_0x2be04e(0x4b6,0x484)]);if(_0x4f4832['particlesTextureSize']<0x1)throw new Error(_0x2be04e(0x52c,0x544));this[_0x2be04e(0x4b6,0x4d3)]=_0x4f4832,this[_0x24901a(-0xcd,-0x15a)]['updateOptions'](_0x3ecb91);function _0x24901a(_0xf7049d,_0x5280e6){return _0x4f1b63(_0xf7049d-0x87,_0x5280e6);}this['computing'][_0x24901a(-0xba,-0xd4)](_0x3ecb91);function _0x2be04e(_0x10135c,_0x3e7314){return _0x4f1b63(_0x10135c-0x65a,_0x3e7314);}_0x5be637&&(this['computing']['destroyParticlesTextures'](),this['computing']['createParticlesTextures'](),this[_0x2be04e(0x506,0x4a0)][_0x24901a(-0x25,-0x5d)]());}[_0x4f1b63(-0x19a,-0x200)](_0xa00adc){this[_0x2a25be(0x2a2,0x28c)]=_0xa00adc;function _0x2a25be(_0x283f4,_0x4137cb){return _0x62ab23(_0x283f4-0x449,_0x4137cb);}this['computing']['viewerParameters']=_0xa00adc,this['rendering']['viewerParameters']=_0xa00adc;}[_0x4f1b63(-0x191,-0x160)](){this['computing']['destroy'](),this['rendering']['destroy']();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x537867={};_0x537867[_0x4f1b63(-0x1bd,-0x1cd)]=0x1,_0x537867[_0x62ab23(-0xd3,-0x135)]=0x2;const _0x410b8b={};_0x410b8b[_0x62ab23(-0x1d6,-0x19d)]=0x14,_0x410b8b['max']=0x64;const _0x1f7551={};_0x1f7551['particlesTextureSize']=0x64,_0x1f7551['fixedHeight']=0x0,_0x1f7551[_0x4f1b63(-0x165,-0x144)]=_0x537867,_0x1f7551[_0x62ab23(-0x145,-0x12f)]=_0x410b8b,_0x1f7551['speedFactor']=0x1,_0x1f7551['dropRate']=0.003,_0x1f7551['dropRateBump']=0.001;function _0x62ab23(_0x51ccb8,_0x5408e9){return _0x24e3(_0x51ccb8- -0x31a,_0x5408e9);}_0x1f7551['colors']=[_0x62ab23(-0x1bb,-0x1f7)],_0x1f7551['flipY']=![];function _0x4f1b63(_0x25df1d,_0x43ed39){return _0x24e3(_0x25df1d- -0x301,_0x43ed39);}_0x1f7551['dynamic']=!![];const DEF_OPTIONS=_0x1f7551;class WindLayer extends BaseLayer$1{constructor(_0xaad8b0={}){_0xaad8b0={...DEF_OPTIONS,..._0xaad8b0},super(_0xaad8b0),this['_setOptionsHook'](_0xaad8b0,_0xaad8b0);}get['layer'](){return this['primitives'];}get[_0x62ab23(-0x185,-0x19c)](){return this['options']['data'];}set['data'](_0x178a00){this['options']['data']=_0x178a00,this['setData'](_0x178a00);}get[_0x62ab23(-0x143,-0x16b)](){function _0x286af4(_0x43c499,_0x2483dd){return _0x4f1b63(_0x2483dd-0x24,_0x43c499);}function _0x49361c(_0x5eb313,_0x2bdbea){return _0x4f1b63(_0x5eb313-0x651,_0x2bdbea);}return this[_0x49361c(0x4ad,0x42f)][_0x286af4(-0x16c,-0x106)];}set['colors'](_0x46c699){this['options']['colors']=_0x46c699;const _0x2bbf8d={};_0x2bbf8d['colors']=_0x46c699,this['_setOptionsHook'](this['options'],_0x2bbf8d);}['_showHook'](_0x5e681c){_0x5e681c?this['_addedHook']():this['_removedHook']();}['_mountedHook'](){}['_addedHook'](){this[_0x537764(0x3b9,0x3fa)]=this[_0x2ddf26(0x296,0x24e)][_0x537764(0x3ad,0x3fa)],this['camera']=this['_map']['camera'];this['options'][_0x2ddf26(0x201,0x1ac)]&&this[_0x537764(0x3c5,0x403)](this[_0x2ddf26(0x1d7,0x174)][_0x537764(0x3e6,0x401)]);if(!this['windData']||!this['show'])return;this['viewerParameters']={'lonRange':new Cesium$1[(_0x2ddf26(0x200,0x272))](-0xb4,0xb4),'latRange':new Cesium$1['Cartesian2'](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this[_0x2ddf26(0x129,0x1a5)][_0x537764(0x3d7,0x402)]};function _0x2ddf26(_0x220b25,_0x114929){return _0x4f1b63(_0x114929-0x318,_0x220b25);}this[_0x537764(0x3d5,0x405)](),this['particleSystem']=new WindParticleSystem(this['scene']['context'],this['windData'],this[_0x2ddf26(0x141,0x174)],this['viewerParameters'],this[_0x537764(0x42f,0x3fa)]),this[_0x537764(0x3fc,0x46a)]=this[_0x537764(0x4f7,0x4ad)][_0x2ddf26(0x227,0x252)]();function _0x537764(_0x5eed7b,_0x5f0988){return _0x4f1b63(_0x5f0988-0x56d,_0x5eed7b);}this['primitives']['forEach'](_0x264f32=>{function _0x1ed3fe(_0x7e0997,_0x1a2cc9){return _0x537764(_0x7e0997,_0x1a2cc9-0xf);}this['scene'][_0x1ed3fe(0x4a8,0x479)]['add'](_0x264f32);}),this[_0x537764(0x428,0x485)]['percentageChanged']=0.01,this['camera'][_0x2ddf26(0x256,0x201)]['addEventListener'](this[_0x2ddf26(0x1f5,0x1b0)]['bind'](this)),this[_0x2ddf26(0x22d,0x1a5)]['morphComplete']['addEventListener'](this['updateViewerParameters']['bind'](this)),window[_0x2ddf26(0x166,0x18f)](_0x537764(0x444,0x414),this['updateViewerParameters'][_0x2ddf26(0x11a,0x180)](this));}[_0x62ab23(-0x17a,-0x182)](){this[_0x366b0a(0x259,0x27a)][_0x6e655(0x168,0x16e)]['removeEventListener'](this['updateViewerParameters'][_0x366b0a(0x1a9,0x12c)](this));function _0x6e655(_0x521127,_0x6eb2d){return _0x4f1b63(_0x521127-0x27f,_0x6eb2d);}function _0x366b0a(_0x2c0114,_0x3cc1ad){return _0x62ab23(_0x2c0114-0x35a,_0x3cc1ad);}this['scene'][_0x6e655(0x163,0x12d)]['removeEventListener'](this['updateViewerParameters']['bind'](this)),window[_0x6e655(0x100,0x105)](_0x366b0a(0x1e8,0x258),this[_0x6e655(0x117,0x123)][_0x6e655(0xe7,0x9f)](this)),this[_0x6e655(0x17c,0x194)]&&(this[_0x366b0a(0x23e,0x1b7)]['forEach'](_0x4730ab=>{function _0x288ae6(_0xd05e06,_0x59fabc){return _0x6e655(_0xd05e06-0x3d6,_0x59fabc);}function _0xa8c184(_0xd58cba,_0x2607eb){return _0x6e655(_0x2607eb- -0xa5,_0xd58cba);}this[_0x288ae6(0x4e2,0x4b6)]['primitives'][_0x288ae6(0x53c,0x4c1)](_0x4730ab);}),delete this[_0x366b0a(0x23e,0x1e1)]),this[_0x366b0a(0x281,0x2bb)]&&(this['particleSystem']['destroy'](),delete this['particleSystem']);}['setData'](_0x27e084,_0x2ec6f8){function _0x512390(_0x5763a7,_0x5aa50b){return _0x62ab23(_0x5aa50b-0x5f0,_0x5763a7);}function _0x2ad739(_0x539d8a,_0x352e21){return _0x62ab23(_0x352e21-0x61d,_0x539d8a);}this[_0x2ad739(0x560,0x532)]=this[_0x2ad739(0x523,0x509)](_0x27e084);if(_0x2ec6f8){this['_removedHook'](),this[_0x2ad739(0x5a0,0x55f)]();return;}this[_0x2ad739(0x57f,0x544)]?(this[_0x2ad739(0x528,0x544)]['computing'][_0x2ad739(0x496,0x4cd)](this[_0x512390(0x51a,0x505)]),this['scene'][_0x512390(0x3fe,0x487)]()):this['_addedHook']();}['_setOptionsHook'](_0x83b5f9,_0x137f86){function _0x45f4cf(_0x408886,_0x49adee){return _0x4f1b63(_0x49adee-0xcd,_0x408886);}function _0x30a6d3(_0x95f08f,_0x371b17){return _0x62ab23(_0x95f08f-0x6a5,_0x371b17);}this[_0x30a6d3(0x5cc,0x65a)]&&(this[_0x30a6d3(0x5cc,0x5fc)]['changeOptions'](_0x137f86),this['scene'][_0x30a6d3(0x53c,0x5b9)]());}['processWindData'](_0x43837d){var _0x3142f3,_0x2e7ca0;function _0x232e9f(_0x2ca312,_0x331727){return _0x4f1b63(_0x2ca312-0x58f,_0x331727);}const _0x356f9d={..._0x43837d},_0x37d5b6=_0x356f9d;!_0x37d5b6['height']&&_0x37d5b6['rows']&&(_0x37d5b6['height']=_0x37d5b6[_0x58d25b(0x8d,0xd7)]);!_0x37d5b6[_0x232e9f(0x47e,0x4e4)]&&_0x37d5b6['cols']&&(_0x37d5b6[_0x232e9f(0x47e,0x4f2)]=_0x37d5b6['cols']);!_0x37d5b6['bounds']&&(_0x37d5b6['bounds']={'west':_0x37d5b6[_0x58d25b(0x12c,0xc3)],'south':_0x37d5b6['ymin'],'east':_0x37d5b6[_0x58d25b(0x79,0xe3)],'north':_0x37d5b6['ymax']});if(!_0x37d5b6['u']){const _0x235655={};_0x235655[_0x232e9f(0x403,0x492)]=_0x43837d[_0x58d25b(0xb7,0x5b)],_0x235655['min']=_0x43837d['umin'],_0x235655[_0x232e9f(0x4d5,0x4e1)]=_0x43837d['umax'],_0x37d5b6['u']=_0x235655;}function _0x58d25b(_0x588a52,_0x1277cd){return _0x62ab23(_0x1277cd-0x1c5,_0x588a52);}if(!_0x37d5b6['v']){const _0x33d8eb={};_0x33d8eb['array']=_0x43837d['vdata'],_0x33d8eb['min']=_0x43837d['vmin'],_0x33d8eb['max']=_0x43837d['vmax'],_0x37d5b6['v']=_0x33d8eb;}if(((_0x3142f3=_0x37d5b6['speed'])===null||_0x3142f3===void 0x0?void 0x0:_0x3142f3[_0x58d25b(-0x5d,-0x11)])===undefined||((_0x2e7ca0=_0x37d5b6['speed'])===null||_0x2e7ca0===void 0x0?void 0x0:_0x2e7ca0['max'])===undefined||_0x37d5b6[_0x232e9f(0x3f8,0x3df)][_0x58d25b(0x3c,0x20)]===undefined){const _0x3ec36d={'array':new Float32Array(_0x37d5b6['u']['array'][_0x232e9f(0x4c8,0x4c0)]),'min':Number['MAX_VALUE'],'max':Number['MIN_VALUE']};for(let _0x1f185e=0x0;_0x1f185e<_0x37d5b6['u'][_0x58d25b(0x1c,0x20)]['length'];_0x1f185e++){_0x3ec36d['array'][_0x1f185e]=Math['sqrt'](_0x37d5b6['u']['array'][_0x1f185e]*_0x37d5b6['u'][_0x58d25b(0x6d,0x20)][_0x1f185e]+_0x37d5b6['v'][_0x232e9f(0x403,0x389)][_0x1f185e]*_0x37d5b6['v']['array'][_0x1f185e]),_0x3ec36d['array'][_0x1f185e]!==0x0&&(_0x3ec36d[_0x58d25b(0x63,-0x11)]=Math[_0x58d25b(0x55,-0x11)](_0x3ec36d['min'],_0x3ec36d['array'][_0x1f185e]),_0x3ec36d[_0x58d25b(0x6e,0xf2)]=Math['max'](_0x3ec36d[_0x58d25b(0x14f,0xf2)],_0x3ec36d['array'][_0x1f185e]));}_0x37d5b6['speed']=_0x3ec36d;}return _0x37d5b6;}[_0x62ab23(-0x181,-0xf5)](){var _0x2f94c7;const _0x226cfd=this['scene'];if(!_0x226cfd)return;const _0xa859cd=_0x226cfd['canvas'],_0x3d0b30={};_0x3d0b30['x']=0x0,_0x3d0b30['y']=0x0;const _0x276eb2={};_0x276eb2['x']=0x0,_0x276eb2['y']=_0xa859cd[_0x80ab62(0x217,0x1f4)];const _0x133738={};_0x133738['x']=_0xa859cd['clientWidth'],_0x133738['y']=0x0;const _0x36a5aa={};function _0x258538(_0x57f6df,_0x19a5d3){return _0x62ab23(_0x19a5d3-0x1dd,_0x57f6df);}_0x36a5aa['x']=_0xa859cd['clientWidth'],_0x36a5aa['y']=_0xa859cd[_0x258538(0x147,0xeb)];const _0x38181d=[_0x3d0b30,_0x276eb2,_0x133738,_0x36a5aa];let _0xbddaf7=0xb4,_0x54bb53=-0xb4,_0x144ca3=0x5a,_0x2c2bd1=-0x5a,_0x5734cb=![];for(const _0x43dff4 of _0x38181d){const _0x3571a4=_0x226cfd['camera']['pickEllipsoid'](new Cesium$1[(_0x258538(0xe1,0x11e))](_0x43dff4['x'],_0x43dff4['y']),_0x226cfd['globe'][_0x80ab62(0x1b1,0x16d)]);if(!_0x3571a4){_0x5734cb=!![];break;}const _0x382f59=_0x226cfd['globe']['ellipsoid'][_0x80ab62(0x1fc,0x188)](_0x3571a4),_0x1e4c1a=Cesium$1['Math'][_0x80ab62(0x13e,0x1ad)](_0x382f59['longitude']),_0x17b3a6=Cesium$1[_0x80ab62(0x196,0x173)]['toDegrees'](_0x382f59['latitude']);_0xbddaf7=Math['min'](_0xbddaf7,_0x1e4c1a),_0x54bb53=Math[_0x80ab62(0x1ed,0x213)](_0x54bb53,_0x1e4c1a),_0x144ca3=Math[_0x80ab62(0xbc,0x110)](_0x144ca3,_0x17b3a6),_0x2c2bd1=Math['max'](_0x2c2bd1,_0x17b3a6);}if(!_0x5734cb){const _0x517309=new Cesium$1['Cartesian2'](Math['max'](this['windData']['bounds'][_0x80ab62(0x1c7,0x14c)],_0xbddaf7),Math['min'](this['windData']['bounds'][_0x258538(0xd5,0xf3)],_0x54bb53)),_0x241b8d=new Cesium$1['Cartesian2'](Math['max'](this['windData'][_0x80ab62(0x204,0x200)][_0x258538(0xfe,0xdd)],_0x144ca3),Math['min'](this['windData']['bounds']['north'],_0x2c2bd1)),_0x9386b6=(_0x517309['y']-_0x517309['x'])*0.05,_0x5103a1=(_0x241b8d['y']-_0x241b8d['x'])*0.05;_0x517309['x']=Math['max'](this[_0x80ab62(0x1dc,0x1fb)]['bounds'][_0x80ab62(0x153,0x14c)],_0x517309['x']-_0x9386b6),_0x517309['y']=Math['min'](this['windData']['bounds']['east'],_0x517309['y']+_0x9386b6),_0x241b8d['x']=Math[_0x258538(0x88,0x10a)](this[_0x258538(0x14a,0xf2)][_0x258538(0x6a,0xf7)]['south'],_0x241b8d['x']-_0x5103a1),_0x241b8d['y']=Math[_0x258538(-0x11,0x7)](this['windData']['bounds']['north'],_0x241b8d['y']+_0x5103a1),this[_0x80ab62(0xb4,0x13f)]['lonRange']=_0x517309,this['viewerParameters'][_0x80ab62(0x25c,0x214)]=_0x241b8d;const _0x116885=this['windData']['bounds']['east']-this['windData'][_0x80ab62(0x1b0,0x200)]['west'],_0x2f2161=this['windData']['bounds'][_0x258538(0xe5,0x103)]-this['windData']['bounds'][_0x80ab62(0x197,0x1e6)],_0x20d617=(_0x517309['y']-_0x517309['x'])/_0x116885,_0x2b608e=(_0x241b8d['y']-_0x241b8d['x'])/_0x2f2161,_0x41bde6=Math['min'](_0x20d617,_0x2b608e),_0x55b580=0x3e8*_0x41bde6;_0x55b580>0x0&&(this['viewerParameters']['pixelSize']=Math['max'](0x0,Math[_0x80ab62(0x9e,0x110)](0x3e8,_0x55b580)));}this[_0x80ab62(0xda,0x13f)][_0x80ab62(0x130,0x1a5)]=this['scene']['mode'];function _0x80ab62(_0x248d75,_0x518e1c){return _0x4f1b63(_0x518e1c-0x2cd,_0x248d75);}(_0x2f94c7=this[_0x80ab62(0x1ce,0x20d)])===null||_0x2f94c7===void 0x0||_0x2f94c7[_0x80ab62(0x135,0x133)](this['viewerParameters']);}['getDataAtLonLat'](_0x4618b2,_0x3fd389){const {bounds:_0x324766,width:_0x740aa0,height:_0x5409ba,u:_0x4410a1,v:_0x46c0fe,speed:_0x431086}=this[_0x2d498b(-0xe3,-0x152)],{flipY:_0x135d46}=this[_0x2d498b(-0x1b5,-0x175)];if(_0x4618b2<_0x324766['west']||_0x4618b2>_0x324766[_0x5a7438(0x377,0x337)]||_0x3fd389<_0x324766['south']||_0x3fd389>_0x324766['north'])return null;function _0x2d498b(_0x105644,_0x24b638){return _0x62ab23(_0x105644-0x8,_0x24b638);}const _0x559725=(_0x4618b2-_0x324766[_0x2d498b(-0x192,-0x20b)])/(_0x324766['east']-_0x324766['west'])*(_0x740aa0-0x1);let _0x48ec9b=(_0x3fd389-_0x324766['south'])/(_0x324766['north']-_0x324766[_0x5a7438(0x2d2,0x321)])*(_0x5409ba-0x1);_0x135d46&&(_0x48ec9b=_0x5409ba-0x1-_0x48ec9b);const _0x246014=Math['floor'](_0x559725),_0x1c9720=Math[_0x2d498b(-0x103,-0xa9)](_0x48ec9b),_0x21f3a2=Math[_0x2d498b(-0x103,-0x154)](_0x559725),_0x3dde73=Math[_0x5a7438(0x1bf,0x24b)](_0x21f3a2+0x1,_0x740aa0-0x1),_0x33deee=Math['floor'](_0x48ec9b),_0x2e38ed=Math['min'](_0x33deee+0x1,_0x5409ba-0x1),_0x28de73=_0x559725-_0x21f3a2,_0x19f229=_0x48ec9b-_0x33deee,_0x132e3e=_0x1c9720*_0x740aa0+_0x246014,_0x468d86=_0x33deee*_0x740aa0+_0x21f3a2,_0x6ba416=_0x33deee*_0x740aa0+_0x3dde73,_0x1a5b63=_0x2e38ed*_0x740aa0+_0x21f3a2,_0x2bb111=_0x2e38ed*_0x740aa0+_0x3dde73,_0x5bde62=_0x4410a1[_0x2d498b(-0x19d,-0x1da)][_0x468d86],_0x29c851=_0x4410a1[_0x2d498b(-0x19d,-0x160)][_0x6ba416],_0x16c6e4=_0x4410a1[_0x2d498b(-0x19d,-0x14a)][_0x1a5b63],_0x32baa2=_0x4410a1['array'][_0x2bb111],_0x5b3a40=(0x1-_0x28de73)*(0x1-_0x19f229)*_0x5bde62+_0x28de73*(0x1-_0x19f229)*_0x29c851+(0x1-_0x28de73)*_0x19f229*_0x16c6e4+_0x28de73*_0x19f229*_0x32baa2,_0xe210c4=_0x46c0fe['array'][_0x468d86],_0x2ecd74=_0x46c0fe['array'][_0x6ba416],_0xa84821=_0x46c0fe[_0x2d498b(-0x19d,-0x12e)][_0x1a5b63],_0x19e5bc=_0x46c0fe[_0x5a7438(0x2e3,0x27c)][_0x2bb111],_0x55c6d4=(0x1-_0x28de73)*(0x1-_0x19f229)*_0xe210c4+_0x28de73*(0x1-_0x19f229)*_0x2ecd74+(0x1-_0x28de73)*_0x19f229*_0xa84821+_0x28de73*_0x19f229*_0x19e5bc,_0xdea429=Math['sqrt'](_0x5b3a40*_0x5b3a40+_0x55c6d4*_0x55c6d4);function _0x5a7438(_0x11a006,_0x4b20){return _0x4f1b63(_0x4b20-0x408,_0x11a006);}const _0x3747b7={};_0x3747b7['u']=_0x4410a1[_0x5a7438(0x283,0x27c)][_0x132e3e],_0x3747b7['v']=_0x46c0fe['array'][_0x132e3e],_0x3747b7[_0x5a7438(0x2a1,0x271)]=_0x431086['array'][_0x132e3e];const _0x559d48={};_0x559d48['u']=_0x5b3a40,_0x559d48['v']=_0x55c6d4,_0x559d48[_0x2d498b(-0x1a8,-0x1d5)]=_0xdea429;const _0xb55687={};return _0xb55687[_0x2d498b(-0x12b,-0x12f)]=_0x3747b7,_0xb55687['interpolated']=_0x559d48,_0xb55687;}}mars3d__namespace[_0x4f1b63(-0xd6,-0xa0)]['register']('wind',WindLayer),mars3d__namespace[_0x4f1b63(-0x1b2,-0x164)][_0x4f1b63(-0x1ae,-0x183)]=WindLayer;class CanvasParticle{constructor(){this['lng']=null;function _0x43ac7d(_0x4ec877,_0x294c49){return _0x62ab23(_0x294c49-0x2f7,_0x4ec877);}this['lat']=null;function _0x2f52c6(_0x109f1b,_0x3e1db6){return _0x62ab23(_0x3e1db6-0x286,_0x109f1b);}this['tlng']=null,this['tlat']=null,this[_0x43ac7d(0xf1,0x14c)]=null,this[_0x43ac7d(0xcd,0x147)]=null;}['destroy'](){for(const _0x3e6e0f in this){delete this[_0x3e6e0f];}}}class CanvasWindField{constructor(_0x521537){function _0x4e9545(_0x4c86be,_0x39072e){return _0x62ab23(_0x39072e-0x554,_0x4c86be);}this[_0x4e9545(0x400,0x48a)](_0x521537);}get['speedRate'](){return this['_speedRate'];}set[_0x62ab23(-0x146,-0x16a)](_0x3b579c){this['_speedRate']=(0x64-(_0x3b579c>0x63?0x63:_0x3b579c))*0x64;function _0x2f0a0d(_0x55fb0e,_0x59f580){return _0x62ab23(_0x59f580-0x2c4,_0x55fb0e);}function _0x12b4ce(_0x46d702,_0x10f4f7){return _0x4f1b63(_0x10f4f7-0x14d,_0x46d702);}this[_0x12b4ce(-0x73,-0x1)]=[(this['xmax']-this[_0x12b4ce(0x66,0x64)])/this['_speedRate'],(this['ymax']-this['ymin'])/this[_0x12b4ce(0x6a,0x6c)]];}get['maxAge'](){function _0x5e5799(_0x5c5d78,_0x5d7ab2){return _0x4f1b63(_0x5c5d78-0x41b,_0x5d7ab2);}return this[_0x5e5799(0x299,0x25e)];}set[_0x4f1b63(-0x1b5,-0x1e0)](_0x54cf34){this['_maxAge']=_0x54cf34;}[_0x62ab23(-0xca,-0x13e)](_0x5703da){this[_0x364fc8(-0x2b3,-0x258)]=_0x5703da,this[_0x364fc8(-0x200,-0x269)]=_0x5703da['maxAge']||0x78,this['speedRate']=_0x5703da['speedRate']||0x32;function _0x364fc8(_0x5b1d30,_0x411f47){return _0x62ab23(_0x411f47- -0x9b,_0x5b1d30);}function _0x48a52b(_0x25799a,_0x1ef08e){return _0x62ab23(_0x1ef08e-0x672,_0x25799a);}this[_0x48a52b(0x584,0x524)]=[];const _0x5112b9=_0x5703da[_0x48a52b(0x51e,0x49d)]||0x1000;for(let _0x120ee7=0x0;_0x120ee7<_0x5112b9;_0x120ee7++){const _0x2da0a0=this['_randomParticle'](new CanvasParticle());this['particles'][_0x48a52b(0x522,0x535)](_0x2da0a0);}}[_0x4f1b63(-0x123,-0x119)](_0x4e8ee9){this[_0xd30380(0x4a,0x10)]=_0x4e8ee9['rows'],this[_0xd30380(-0x2b,-0xb3)]=_0x4e8ee9['cols'],this['xmin']=_0x4e8ee9['xmin'];function _0x3bb713(_0x1b45f6,_0x5d7292){return _0x4f1b63(_0x1b45f6-0x533,_0x5d7292);}this[_0x3bb713(0x46a,0x4aa)]=_0x4e8ee9['xmax'],this['ymin']=_0x4e8ee9['ymin'],this[_0x3bb713(0x458,0x3ea)]=_0x4e8ee9[_0x3bb713(0x458,0x3e6)],this[_0x3bb713(0x3d4,0x397)]=[];const _0x3f817c=_0x4e8ee9[_0xd30380(-0x32,-0x5)];function _0xd30380(_0x56808c,_0x5498d8){return _0x4f1b63(_0x56808c-0x11f,_0x5498d8);}const _0x290d9a=_0x4e8ee9['vdata'];let _0xb22ddd=![];_0x3f817c['length']===this['rows']&&_0x3f817c[0x0]['length']===this['cols']&&(_0xb22ddd=!![]);let _0x500bca=0x0,_0x360daa=null,_0x4fdf4f=null;for(let _0x3be412=0x0;_0x3be412<this['rows'];_0x3be412++){_0x360daa=[];for(let _0x573302=0x0;_0x573302<this[_0x3bb713(0x3e9,0x441)];_0x573302++,_0x500bca++){_0xb22ddd?_0x4fdf4f=this['_calcUV'](_0x3f817c[_0x3be412][_0x573302],_0x290d9a[_0x3be412][_0x573302]):_0x4fdf4f=this['_calcUV'](_0x3f817c[_0x500bca],_0x290d9a[_0x500bca]),_0x360daa['push'](_0x4fdf4f);}this['grid']['push'](_0x360daa);}!this['options'][_0xd30380(-0x81,-0xd8)]&&this['grid']['reverse']();}['clear'](){delete this['rows'],delete this[_0x4c9e1f(0x11a,0xe6)],delete this[_0x4c9e1f(0x17b,0xf6)];function _0x54d8ed(_0x2fdc3a,_0x17fd96){return _0x4f1b63(_0x2fdc3a-0x481,_0x17fd96);}delete this['xmax'],delete this[_0x4c9e1f(0xe4,0xcf)],delete this['ymax'];function _0x4c9e1f(_0x24e832,_0x5df7e4){return _0x62ab23(_0x24e832-0x27d,_0x5df7e4);}delete this['grid'],delete this['particles'];}[_0x4f1b63(-0xff,-0x13d)](_0x573404,_0x390d28){function _0x3158f3(_0x2ebf4f,_0x23e53a){return _0x62ab23(_0x2ebf4f-0x526,_0x23e53a);}const _0x9a37f9=(_0x573404-this['xmin'])/(this['xmax']-this[_0x3d510e(0x3f5,0x415)])*(this[_0x3158f3(0x3c3,0x3a4)]-0x1),_0x197369=(this['ymax']-_0x390d28)/(this[_0x3d510e(0x403,0x412)]-this[_0x3d510e(0x35e,0x35c)])*(this[_0x3158f3(0x438,0x413)]-0x1);function _0x3d510e(_0x4fc6e7,_0xe4b0ac){return _0x4f1b63(_0x4fc6e7-0x4de,_0xe4b0ac);}return[_0x9a37f9,_0x197369];}[_0x62ab23(-0x1c3,-0x1aa)](_0x4f80dd,_0x305129){if(_0x4f80dd<0x0||_0x4f80dd>=this['cols']||_0x305129>=this[_0x4a70d8(-0x19c,-0x1db)])return[0x0,0x0,0x0];const _0xa6a3fc=Math['floor'](_0x4f80dd),_0x3626bd=Math[_0x4a70d8(-0x1b9,-0x13b)](_0x305129);function _0x4a70d8(_0x447487,_0x47bb12){return _0x4f1b63(_0x447487- -0xc7,_0x47bb12);}if(_0xa6a3fc===_0x4f80dd&&_0x3626bd===_0x305129)return this['grid'][_0x305129][_0x4f80dd];const _0xb5b71b=_0xa6a3fc+0x1,_0x27af2f=_0x3626bd+0x1,_0x1b3cc6=this['getUVByXY'](_0xa6a3fc,_0x3626bd);function _0x4294fa(_0x46c10f,_0x1e3c38){return _0x4f1b63(_0x46c10f-0x4ed,_0x1e3c38);}const _0x998050=this[_0x4a70d8(-0x271,-0x2af)](_0xb5b71b,_0x3626bd),_0x4b2833=this['getUVByXY'](_0xa6a3fc,_0x27af2f),_0x47c248=this['getUVByXY'](_0xb5b71b,_0x27af2f);let _0x107f4b=null;try{_0x107f4b=this[_0x4a70d8(-0x195,-0x141)](_0x4f80dd-_0xa6a3fc,_0x305129-_0x3626bd,_0x1b3cc6,_0x998050,_0x4b2833,_0x47c248);}catch(_0x499ca8){console['log'](_0x4f80dd,_0x305129);}return _0x107f4b;}['_bilinearInterpolation'](_0x2526f5,_0x36db6a,_0x8b6340,_0x5da6a3,_0x9ac2bc,_0x346fb2){const _0x541127=0x1-_0x2526f5,_0x444189=0x1-_0x36db6a,_0x30e9d0=_0x541127*_0x444189,_0x3f7b61=_0x2526f5*_0x444189,_0x39098c=_0x541127*_0x36db6a,_0x5686be=_0x2526f5*_0x36db6a,_0xe009e5=_0x8b6340[0x0]*_0x30e9d0+_0x5da6a3[0x0]*_0x3f7b61+_0x9ac2bc[0x0]*_0x39098c+_0x346fb2[0x0]*_0x5686be,_0x7151dc=_0x8b6340[0x1]*_0x30e9d0+_0x5da6a3[0x1]*_0x3f7b61+_0x9ac2bc[0x1]*_0x39098c+_0x346fb2[0x1]*_0x5686be;return this['_calcUV'](_0xe009e5,_0x7151dc);}['_calcUV'](_0x58272c,_0x5b81ee){function _0xd0d2ce(_0x3e4ea6,_0x1c9e8c){return _0x62ab23(_0x3e4ea6- -0x19,_0x1c9e8c);}return[+_0x58272c,+_0x5b81ee,Math[_0xd0d2ce(-0x13c,-0x193)](_0x58272c*_0x58272c+_0x5b81ee*_0x5b81ee)];}[_0x62ab23(-0x189,-0x110)](_0x288334,_0x5d9eb3){if(!this['isInExtent'](_0x288334,_0x5d9eb3))return null;const _0x146238=this['toGridXY'](_0x288334,_0x5d9eb3);function _0x5ef019(_0x94f33c,_0x37a173){return _0x62ab23(_0x94f33c-0x669,_0x37a173);}const _0x31fd7d=this[_0x5ef019(0x4a6,0x49e)](_0x146238[0x0],_0x146238[0x1]);return _0x31fd7d;}['isInExtent'](_0x5704b8,_0xbfd3cb){function _0x513532(_0x6ee808,_0x233c3d){return _0x62ab23(_0x233c3d-0x4fe,_0x6ee808);}function _0x2e2b88(_0x324459,_0x474865){return _0x4f1b63(_0x474865-0x29e,_0x324459);}return _0x5704b8>=this['xmin']&&_0x5704b8<=this[_0x2e2b88(0x1e4,0x1d5)]&&_0xbfd3cb>=this[_0x513532(0x3af,0x365)]&&_0xbfd3cb<=this['ymax']?!![]:![];}['getRandomLatLng'](){const _0x1ca8fa=fRandomByfloat(this[_0x28e4c2(0x3a5,0x3fb)],this['xmax']),_0x47c8b9=fRandomByfloat(this['ymin'],this[_0x28e4c2(0x3b3,0x3c5)]);function _0x28e4c2(_0x5a9bc3,_0x32b637){return _0x62ab23(_0x5a9bc3-0x4a7,_0x32b637);}const _0x2b24fb={};function _0x2c738a(_0x56717b,_0x1becdb){return _0x62ab23(_0x1becdb-0x620,_0x56717b);}return _0x2b24fb[_0x28e4c2(0x2f1,0x351)]=_0x47c8b9,_0x2b24fb['lng']=_0x1ca8fa,_0x2b24fb;}['getParticles'](){function _0x40d9ad(_0x1af1b1,_0x589964){return _0x62ab23(_0x1af1b1-0x497,_0x589964);}let _0x524836,_0x9f5d55,_0x47f7d0;function _0x29e818(_0x41fcf5,_0x3611a3){return _0x62ab23(_0x3611a3- -0x90,_0x41fcf5);}for(let _0x138cac=0x0,_0x1dd47c=this['particles'][_0x40d9ad(0x3b7,0x36f)];_0x138cac<_0x1dd47c;_0x138cac++){let _0x4c3788=this[_0x29e818(-0x17e,-0x1de)][_0x138cac];_0x4c3788['age']<=0x0&&(_0x4c3788=this['_randomParticle'](_0x4c3788));if(_0x4c3788[_0x40d9ad(0x2ec,0x27c)]>0x0){const _0x502675=_0x4c3788['tlng'],_0x3e6fb4=_0x4c3788['tlat'];_0x47f7d0=this[_0x40d9ad(0x30e,0x392)](_0x502675,_0x3e6fb4),_0x47f7d0?(_0x524836=_0x502675+this['_calc_speedRate'][0x0]*_0x47f7d0[0x0],_0x9f5d55=_0x3e6fb4+this['_calc_speedRate'][0x1]*_0x47f7d0[0x1],_0x4c3788[_0x29e818(-0x1ab,-0x1ad)]=_0x502675,_0x4c3788['lat']=_0x3e6fb4,_0x4c3788[_0x40d9ad(0x2d9,0x366)]=_0x524836,_0x4c3788[_0x29e818(-0x1de,-0x1ce)]=_0x9f5d55,_0x4c3788[_0x29e818(-0x23d,-0x240)]=_0x47f7d0[0x2],_0x4c3788[_0x40d9ad(0x2ec,0x323)]--):_0x4c3788['age']=0x0;}}return this['particles'];}[_0x4f1b63(-0x15e,-0x165)](_0x47e44c){let _0x2b0235,_0x47280f;for(let _0x1409a8=0x0;_0x1409a8<0x1e;_0x1409a8++){_0x2b0235=this['getRandomLatLng'](),_0x47280f=this[_0x5ea532(-0x1e6,-0x1b5)](_0x2b0235[_0x310fa3(0x3fb,0x41e)],_0x2b0235[_0x310fa3(0x362,0x3c7)]);if(_0x47280f&&_0x47280f[0x2]>0x0)break;}if(!_0x47280f)return _0x47e44c;const _0x2a8478=_0x2b0235['lng']+this['_calc_speedRate'][0x0]*_0x47280f[0x0],_0x5805c5=_0x2b0235['lat']+this[_0x310fa3(0x3b1,0x386)][0x1]*_0x47280f[0x1];_0x47e44c[_0x310fa3(0x3fb,0x397)]=_0x2b0235['lng'],_0x47e44c['lat']=_0x2b0235['lat'],_0x47e44c['tlng']=_0x2a8478;function _0x310fa3(_0x2c4ec1,_0x13572c){return _0x62ab23(_0x2c4ec1-0x518,_0x13572c);}_0x47e44c[_0x5ea532(-0x19b,-0x1a8)]=_0x5805c5,_0x47e44c[_0x5ea532(-0x208,-0x18e)]=Math['round'](0xa+Math[_0x5ea532(-0x169,-0x1c9)]()*this[_0x310fa3(0x34a,0x2f8)]);function _0x5ea532(_0x3e4b41,_0x4deaef){return _0x62ab23(_0x3e4b41- -0x5d,_0x4deaef);}return _0x47e44c['speed']=_0x47280f[0x2],_0x47e44c;}[_0x62ab23(-0x1aa,-0x18a)](){for(const _0x346421 in this){delete this[_0x346421];}}}function fRandomByfloat(_0x2f36d0,_0x5b06d5){return _0x2f36d0+Math['random']()*(_0x5b06d5-_0x2f36d0);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x4f1b63(-0x1b2,-0x206)]['BaseLayer'];function _0x1afb(){const _0x58d5ab=['remove','WindUtil','changed','34205160lJEzWw','CanvasWindLayer','getU','windTextures','wrapT','width','container','FLOAT','canvas','createWindTextures','SceneMode','pixelDatatype','sqrt','frameState.commandList\x20is\x20undefined','3bAtuCe','previousParticlesPosition','onmessage','segments','lng','primitives','ONE_MINUS_SRC_ALPHA','createSegmentsGeometry','createColorTableTexture','toGridXY','enabled','UNSIGNED_BYTE','talt','processWindData','defineProperty','logInfo','createRenderingTextures','frameRateAdjustment','wheel','getUpdatePositionShader','globalAlpha','random','floor','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a','createCommand','changeOptions','now','slice','all','0px','pow','xmin','camera','south','bindEvent','height','mouse_down','primitiveType','clearCommand','_speedRate','postMessage','normal','frameTime','14242064BTxnOZ','createComputingPrimitives','ymax','_onMapWhellEvent','clientHeight','frameRateMonitor','renderState','LayerUtil','rows','getSegmentDrawFragmentShader','EllipsoidalOccluder','windData','east','viewport','bufferUsage','_bilinearInterpolation','bounds','canvasWind','willReadFrequently','_map','xmax','_updateIng','length','getPrimitives','values','drawingBufferWidth','samplingWindow','create','north','particleSystem','updatePosition','_animateFrame','hidden','moveTo','_onMouseDownEvent','max','latRange','lastFramesPerSecond','componentDatatype','minificationFilter','windField','4912280Zewwbu','STATIC_DRAW','stroke','setOptions','attributeLocations','postProcessingPosition','fromDegrees','getParticles','onParticlesTextureSizeChange','redraw','framebuffers','colorTable','OPAQUE','fillRect','Cartesian2','_addedHook','toWindowCoordinates','frameRate','object','_createCanvas','min','particlesNumber','Unknown\x20command\x20type','destination-in','initFrameRate','displayRange','rawRenderState','vertexShaderSource','maxAge','isDestroy','prototype','layer','toRadians','Rectangle','alt','WindLayer','worker','1lTNpVM','colorTextures','getUVByXY','lineTo','_pointerEvents','#ffffff','Cesium','tlng','options','clear','rgb(206,255,255)','createParticlesTextures','flipY','warn','createRawRenderState','lat','LINEAR','unbindEvent','applyViewerParameters','framebuffer','bind','speed','sin','autoClear','lighter','mouseMove','age','destroy','onColorTableChange','getOwnPropertyDescriptor','viewerParameters','Compute','array','SRC_ALPHA','drawingBufferHeight','addEventListener','isDynamic','1870380cdsosk','fragmentShaderSource','outputTexture','canvasHeight','particlesTextureSize','_maxAge','west','ymin','removeEventListener','segmentsDepth','clientWidth','context','particlesSpeed','pointer-events','_onMouseUpEvent','commandToExecute','nextParticlesPosition','getPostProcessingPositionShader','commandList','418626NuTxMt','scene','green','Log','getUVByPoint','3550510XMKhlE','mouseDown','geometry','data','mode','setData','createRenderingFramebuffers','updateViewerParameters','canvasContext','computing','lineWidth','commandType','mouse_move','_setOptionsHook','_removedHook','ellipsoid','grid','_randomParticle','show','uniformMap','dropRate','Math','resize','update','vertexArray','forEach','fromGeometry','rendering','top','createPrimitives','udata','requestRender','55DAvYNf','_calc_speedRate','_colorRamp','stringify','pointerEvents','cols','preExecute','_tomap','getSegmentDrawVertexShader','sources','cartesianToCartographic','style','blue','_updateIng2','updateOptions','depthTest','visibility','CanvasWindField','shaderProgram','beginPath','9WoMqHp','IDENTITY','lonRange','globe','updateWindData','EventType','particles','depthMask','RGBA','_showHook','off','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a','mouseUp','particlesTextureSize\x20must\x20be\x20greater\x20than\x200','speedRate','lineLength','pixelFormat','colors','fromCssColorString','sceneMode','particlesTextures','blendEquation','tlat','push','setDate','type','SCENE3D','toDegrees','requestAnimationFrame','9352539mUNvVi','globalCompositeOperation','morphComplete','_onMouseMoveEvent','original'];_0x1afb=function(){return _0x58d5ab;};return _0x1afb();}class CanvasWindLayer extends BaseLayer{constructor(_0xcec98={}){function _0x57ce50(_0x4b30c5,_0xef7c0b){return _0x4f1b63(_0xef7c0b-0x4d6,_0x4b30c5);}super(_0xcec98),this[_0x57ce50(0x389,0x374)](_0xcec98);function _0x57b8d7(_0xfcd6b7,_0x5a41ac){return _0x62ab23(_0x5a41ac-0x1a2,_0xfcd6b7);}this['canvas']=null,_0xcec98['colors']&&_0xcec98['steps']&&(this[_0x57ce50(0x413,0x389)]=new mars3d__namespace['ColorRamp'](_0xcec98));}['_setOptionsHook'](_0x544a5c,_0x94b316){this[_0x5c5f50(-0x1a1,-0x17f)]=0x3e8/(_0x544a5c[_0x5c5f50(-0xf1,-0x144)]||0xa),this['_pointerEvents']=this['options']['pointerEvents']??![];function _0x5c5f50(_0x588d1b,_0xca6aac){return _0x4f1b63(_0xca6aac- -0xa1,_0x588d1b);}this['color']=_0x544a5c['color']||_0xc7a1ef(0x514,0x50f),this['lineWidth']=_0x544a5c[_0xc7a1ef(0x4e7,0x551)]||0x1;function _0xc7a1ef(_0x52c61e,_0x3bcd60){return _0x62ab23(_0x3bcd60-0x6cf,_0x52c61e);}this['fixedHeight']=_0x544a5c['fixedHeight']??0x0,this[_0x5c5f50(-0x205,-0x241)]=_0x544a5c['flipY']??![],this[_0x5c5f50(-0x18a,-0x156)]&&this['windField']['setOptions'](_0x544a5c);}get[_0x62ab23(-0x1cb,-0x220)](){function _0x5dce02(_0x2b1264,_0x273b2a){return _0x62ab23(_0x2b1264-0x14d,_0x273b2a);}return this[_0x5dce02(0x26,0x59)];}get['canvasWidth'](){function _0x3f02d7(_0x4862eb,_0x211f4b){return _0x62ab23(_0x4862eb- -0x9f,_0x211f4b);}function _0x2310d4(_0x3fbee2,_0x9bafc1){return _0x62ab23(_0x9bafc1-0x44f,_0x3fbee2);}return this[_0x2310d4(0x3b9,0x36c)][_0x2310d4(0x2fa,0x2c3)][_0x3f02d7(-0x1c6,-0x140)]['clientWidth'];}get[_0x4f1b63(-0x184,-0x12e)](){function _0x55e380(_0x1deff9,_0x2a05ed){return _0x4f1b63(_0x1deff9-0x3ae,_0x2a05ed);}return this['_map'][_0x55e380(0x23b,0x246)]['canvas']['clientHeight'];}get[_0x62ab23(-0x164,-0x137)](){return this['_pointerEvents'];}set[_0x62ab23(-0x164,-0x141)](_0x51e88f){this[_0x765c16(0x21c,0x29c)]=_0x51e88f;function _0x5eeefb(_0x8bcc05,_0x59c85b){return _0x62ab23(_0x59c85b-0x40d,_0x8bcc05);}function _0x765c16(_0x1cf7f4,_0x5d4527){return _0x4f1b63(_0x5d4527-0x444,_0x1cf7f4);}if(!this['canvas'])return;_0x51e88f?this['canvas'][_0x765c16(0x355,0x300)][_0x5eeefb(0x251,0x27a)]=_0x5eeefb(0x2ca,0x308):this[_0x5eeefb(0x267,0x2e6)]['style'][_0x765c16(0x298,0x2ca)]='none';}get['particlesNumber'](){function _0x2a8583(_0x166ed8,_0x23c1cf){return _0x4f1b63(_0x166ed8-0x61f,_0x23c1cf);}function _0x5f2f73(_0xac491b,_0xacffd2){return _0x4f1b63(_0xacffd2- -0x20,_0xac491b);}return this[_0x5f2f73(-0x204,-0x1c4)][_0x2a8583(0x463,0x47e)];}set[_0x4f1b63(-0x1bc,-0x187)](_0x4b10f5){this['options'][_0x16a808(0x3c4,0x39c)]=_0x4b10f5;function _0x16a808(_0x3143f9,_0x12212a){return _0x4f1b63(_0x12212a-0x558,_0x3143f9);}clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(()=>{this['redraw']();},0x1f4);}get[_0x62ab23(-0x146,-0x1ac)](){function _0x4f166b(_0x4d9731,_0x48b4f7){return _0x4f1b63(_0x4d9731-0x3ff,_0x48b4f7);}function _0x4fe5d5(_0x57b558,_0x39414a){return _0x4f1b63(_0x57b558-0x600,_0x39414a);}return this[_0x4fe5d5(0x45c,0x44c)][_0x4fe5d5(0x4d3,0x4fd)];}set[_0x4f1b63(-0x12d,-0x1b2)](_0x1d6940){this[_0xca917c(0x533,0x4fe)][_0xca917c(0x5a9,0x575)]=_0x1d6940;function _0xca917c(_0x29a1f5,_0x4e5126){return _0x4f1b63(_0x4e5126-0x6a2,_0x29a1f5);}function _0x192c72(_0x5658c9,_0x364928){return _0x4f1b63(_0x364928-0x56e,_0x5658c9);}this[_0xca917c(0x573,0x5ed)]&&(this['windField']['speedRate']=_0x1d6940);}get['maxAge'](){return this['options']['maxAge'];}set[_0x4f1b63(-0x1b5,-0x1d8)](_0x312704){this['options'][_0x343232(0x42d,0x432)]=_0x312704;function _0x56ce2a(_0x1aed91,_0xd7f87e){return _0x62ab23(_0x1aed91-0x4d7,_0xd7f87e);}function _0x343232(_0x4d6151,_0x48e1b4){return _0x62ab23(_0x48e1b4-0x600,_0x4d6151);}this['windField']&&(this[_0x343232(0x561,0x532)]['maxAge']=_0x312704);}get[_0x62ab23(-0x185,-0x1e4)](){function _0x9d1594(_0x42bc02,_0x3d2c4e){return _0x4f1b63(_0x42bc02-0x2c7,_0x3d2c4e);}return this[_0x9d1594(0x1f5,0x232)];}set[_0x62ab23(-0x185,-0x161)](_0x134e99){this['setData'](_0x134e99);}get['rectangle'](){let _0x5b7e37=this['windData'][_0x25f016(0x8c,0x75)],_0x1f31bb=this[_0x25f016(0xa,0x8c)]['xmax'],_0x5a5201=this['windData']['ymin'],_0x721158=this['windData'][_0x36cd9b(0x578,0x5ad)];_0x1f31bb>=0x167&&_0x5b7e37===0x0&&(_0x5b7e37=-0xb4,_0x1f31bb=0xb4);_0x5b7e37=Math['max'](_0x5b7e37,-0xb4),_0x1f31bb=Math[_0x36cd9b(0x496,0x4d8)](_0x1f31bb,0xb4);function _0x25f016(_0x4a8720,_0x3658ba){return _0x4f1b63(_0x3658ba-0x15e,_0x4a8720);}_0x5a5201=Math['max'](_0x5a5201,-0x5a);function _0x36cd9b(_0xcbb38f,_0xe155be){return _0x62ab23(_0xcbb38f-0x66c,_0xe155be);}return _0x721158=Math['min'](_0x721158,0x5a),Cesium[_0x36cd9b(0x4a3,0x515)][_0x25f016(0x71,0xb0)](_0x5b7e37,_0x5a5201,_0x1f31bb,_0x721158);}[_0x62ab23(-0x14b,-0x19c)](_0x5867f5){function _0x3ad65e(_0x3d9052,_0xc85fdc){return _0x62ab23(_0x3d9052-0x273,_0xc85fdc);}function _0x8fc112(_0x5ba932,_0x29af15){return _0x62ab23(_0x5ba932-0x239,_0x29af15);}_0x5867f5?this[_0x8fc112(0x17b,0x1e7)]():(this['windData']&&(this[_0x3ad65e(0xb6,0xda)]['data']=this[_0x8fc112(0x14e,0x168)]),this[_0x8fc112(0xbf,0x56)]());}['_mountedHook'](){function _0x3d51eb(_0x2a8642,_0x2af92d){return _0x4f1b63(_0x2a8642-0x276,_0x2af92d);}function _0x3e4cef(_0x369482,_0x3d579d){return _0x62ab23(_0x3d579d-0x227,_0x369482);}this[_0x3d51eb(0xd2,0xae)]['worker']?this['initWorker']():this['windField']=new CanvasWindField(this[_0x3d51eb(0xd2,0x5e)]);}['_addedHook'](){this['canvas']=this[_0x2b4742(0x411,0x456)]();function _0x1cebea(_0x367723,_0x57bc30){return _0x4f1b63(_0x367723-0x4ea,_0x57bc30);}const _0x18117e={};_0x18117e[_0x1cebea(0x41f,0x41d)]=!![],this['canvasContext']=this[_0x2b4742(0x3c0,0x3e9)]['getContext']('2d',_0x18117e),this[_0x1cebea(0x404,0x3b4)]();function _0x2b4742(_0x51220d,_0x3bbf2f){return _0x4f1b63(_0x3bbf2f-0x4f7,_0x51220d);}this['options']['data']&&this[_0x1cebea(0x380,0x31a)](this[_0x2b4742(0x300,0x353)]['data']);}['_removedHook'](){function _0x5db952(_0x4d3172,_0x1c790d){return _0x4f1b63(_0x4d3172-0x411,_0x1c790d);}this[_0x37c514(0x4ae,0x4d5)]();function _0x37c514(_0x50976b,_0x1777c5){return _0x62ab23(_0x1777c5-0x691,_0x50976b);}this['unbindEvent'](),this['canvas']&&(this[_0x5db952(0x347,0x3aa)][_0x37c514(0x59e,0x568)]['removeChild'](this['canvas']),delete this[_0x37c514(0x4e2,0x56a)]);}[_0x62ab23(-0xba,-0x122)](){const _0x1c3a62=mars3d__namespace['DomUtil'][_0x239223(0x55d,0x574)](_0x239223(0x511,0x54d),'mars3d-canvasWind',this['_map']['container']);_0x1c3a62['style']['position']='absolute',_0x1c3a62['style'][_0xad56d6(-0x141,-0x129)]='0px';function _0xad56d6(_0x24084c,_0x510f37){return _0x4f1b63(_0x24084c-0x12,_0x510f37);}_0x1c3a62[_0x239223(0x4db,0x4f9)]['left']=_0xad56d6(-0xd9,-0x121),_0x1c3a62[_0x239223(0x4db,0x51a)][_0x239223(0x50e,0x517)]=this[_0x239223(0x555,0x59d)]['scene'][_0x239223(0x511,0x4b1)]['clientWidth']+'px',_0x1c3a62[_0xad56d6(-0x132,-0xb1)][_0x239223(0x53a,0x500)]=this[_0xad56d6(-0xb8,-0xed)][_0xad56d6(-0x161,-0x149)]['canvas'][_0xad56d6(-0xc7,-0x11a)]+'px',_0x1c3a62['style'][_0x239223(0x4d4,0x4b9)]=this['_pointerEvents']?'auto':'none',_0x1c3a62[_0x239223(0x4db,0x491)]['zIndex']=this['options']['zIndex']??0x9;function _0x239223(_0x192760,_0x3c3553){return _0x62ab23(_0x192760-0x638,_0x3c3553);}return _0x1c3a62[_0xad56d6(-0xff,-0x74)]=this['_map'][_0xad56d6(-0x161,-0xd3)]['canvas']['clientWidth'],_0x1c3a62['height']=this['_map']['scene'][_0xad56d6(-0xfc,-0x129)]['clientHeight'],_0x1c3a62;}['resize'](){function _0x2bf422(_0x318702,_0x15eaff){return _0x62ab23(_0x318702-0x1eb,_0x15eaff);}function _0x529f93(_0x21f1b4,_0x3baaa1){return _0x62ab23(_0x3baaa1- -0x42,_0x21f1b4);}this['canvas']&&(this[_0x529f93(-0xfa,-0x169)][_0x529f93(-0x140,-0x19f)]['width']=this[_0x2bf422(0x108,0x167)]['scene']['canvas']['clientWidth']+'px',this[_0x2bf422(0xc4,0x6e)]['style'][_0x2bf422(0xed,0x152)]=this['_map'][_0x2bf422(0x5f,0xe3)][_0x2bf422(0xc4,0x8e)]['clientHeight']+'px',this['canvas']['width']=this[_0x2bf422(0x108,0x166)]['scene']['canvas'][_0x529f93(-0x1d5,-0x1d8)],this['canvas']['height']=this[_0x2bf422(0x108,0x7a)]['scene'][_0x2bf422(0xc4,0x8b)]['clientHeight']);}['bindEvent'](){function _0x22a1ea(_0x508091,_0x2bb83b){return _0x4f1b63(_0x508091-0x1a8,_0x2bb83b);}const _0x5d126d=this;let _0x5d6814=Date['now']();(function _0x3d5d01(){function _0x20ec9e(_0x2c10e3,_0x30f085){return _0x24e3(_0x2c10e3- -0xe8,_0x30f085);}if(_0x5d126d[_0x20ec9e(0x65,0x96)])return;function _0xcfedff(_0x32f485,_0x30dcae){return _0x24e3(_0x30dcae-0x12,_0x32f485);}_0x5d126d['_animateFrame']=window[_0x20ec9e(0xfa,0x15d)](_0x3d5d01);if(_0x5d126d['show']&&_0x5d126d[_0x20ec9e(0x164,0x157)]){const _0x1ebc72=Date[_0x20ec9e(0x12b,0x163)](),_0x1a3f71=_0x1ebc72-_0x5d6814;_0x1a3f71>_0x5d126d['frameTime']&&(_0x5d6814=_0x1ebc72-_0x1a3f71%_0x5d126d['frameTime'],_0x5d126d['update']());}}(),window['addEventListener'](_0x22a1ea(0x4f,0x1a),this['resize'][_0x22a1ea(0x10,0x97)](this),![]),this['mouse_down']=![]);function _0x6fb0ce(_0x5d2744,_0x979dfc){return _0x4f1b63(_0x5d2744- -0x50,_0x979dfc);}this['mouse_move']=![],this[_0x22a1ea(0x4,-0x5e)]['mouseHidden']&&(this['_map']['on'](mars3d__namespace['EventType'][_0x6fb0ce(-0x146,-0x18d)],this['_onMapWhellEvent'],this),this[_0x22a1ea(0xde,0xe3)]['on'](mars3d__namespace['EventType'][_0x22a1ea(0x3a,0xb5)],this[_0x6fb0ce(-0x10b,-0x162)],this),this[_0x22a1ea(0xde,0xc6)]['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x6fb0ce(-0x1c9,-0x1a7)],this));}[_0x4f1b63(-0x19b,-0x1a1)](){window['cancelAnimationFrame'](this['_animateFrame']);function _0x4986b2(_0x463a24,_0x75d45b){return _0x62ab23(_0x463a24-0x32f,_0x75d45b);}delete this[_0x25b593(0x76,0xaa)];function _0x25b593(_0x1eafd2,_0x3440c8){return _0x62ab23(_0x3440c8-0x181,_0x1eafd2);}window[_0x25b593(-0x9d,-0x17)]('resize',this['resize']),this[_0x4986b2(0x172,0x101)]['mouseHidden']&&(this[_0x25b593(0x39,0x9e)][_0x4986b2(0x1e5,0x1d5)](mars3d__namespace[_0x4986b2(0x1e0,0x23f)][_0x4986b2(0x220,0x256)],this[_0x4986b2(0x23c,0x1f6)],this),this['_map'][_0x4986b2(0x1e5,0x214)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType'][_0x25b593(0xb5,0x39)],this['_onMouseUpEvent'],this),this[_0x25b593(0xfd,0x9e)]['off'](mars3d__namespace['EventType'][_0x25b593(-0xb5,-0x2b)],this['_onMouseMoveEvent'],this));}[_0x62ab23(-0xf3,-0x178)](_0x10c2a6){clearTimeout(this['refreshTimer']);if(!this[_0x8bedf8(0x44d,0x4b2)]||!this['canvas'])return;function _0x8bedf8(_0x1a4d2c,_0x430c9d){return _0x62ab23(_0x1a4d2c-0x5c3,_0x430c9d);}this['canvas']['style']['visibility']='hidden',this['refreshTimer']=setTimeout(()=>{if(!this[_0x330d4b(-0x6,-0x6b)])return;this['redraw']();function _0x330d4b(_0xfbc13f,_0x5c9239){return _0x8bedf8(_0x5c9239- -0x4b8,_0xfbc13f);}function _0x4c1ced(_0x4660fe,_0x275e1b){return _0x8bedf8(_0x4660fe- -0x47,_0x275e1b);}this[_0x330d4b(-0x76,-0x1c)]['style']['visibility']='visible';},0xc8);}['_onMouseDownEvent'](_0x5034ca){function _0x2ab6b5(_0x3666e9,_0xf98f37){return _0x4f1b63(_0x3666e9-0xad,_0xf98f37);}this['mouse_down']=!![],this[_0x2ab6b5(-0x1d,-0x89)]['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x140e17(0x4f5,0x543)],this);function _0x140e17(_0x25caaf,_0x4cf9d3){return _0x4f1b63(_0x4cf9d3-0x65e,_0x25caaf);}this[_0x2ab6b5(-0x1d,0x51)]['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);}['_onMouseMoveEvent'](_0x369cc0){function _0x24663c(_0x5b5985,_0x4d024d){return _0x4f1b63(_0x4d024d-0x3b6,_0x5b5985);}function _0x15038b(_0x55ef5e,_0x4d1b04){return _0x62ab23(_0x4d1b04- -0x1f,_0x55ef5e);}if(!this['show']||!this['canvas'])return;this[_0x24663c(0x2a6,0x2d2)]&&(this['canvas'][_0x24663c(0x2e5,0x272)][_0x15038b(-0xf3,-0x177)]=_0x15038b(-0x134,-0xf5),this[_0x15038b(-0x1b6,-0x19b)]=!![]);}[_0x4f1b63(-0x179,-0x112)](_0x3aea8e){if(!this['show']||!this['canvas'])return;function _0x11211a(_0x41393f,_0x524657){return _0x62ab23(_0x524657-0x2fe,_0x41393f);}this['_map']['off'](mars3d__namespace[_0x11211a(0x1e8,0x1af)]['mouseMove'],this['_onMouseMoveEvent'],this);this['mouse_down']&&this['mouse_move']&&this['redraw']();function _0x4e776b(_0x408828,_0x1596db){return _0x4f1b63(_0x408828-0x423,_0x1596db);}this['canvas']['style']['visibility']='visible',this[_0x11211a(0x1ed,0x201)]=![],this['mouse_move']=![];}['setData'](_0x154691){this['clear']();function _0x45249a(_0x1618d0,_0x243b7b){return _0x4f1b63(_0x243b7b-0x674,_0x1618d0);}this['windData']=_0x154691;function _0x4f6e70(_0x307b70,_0x3c2adf){return _0x62ab23(_0x3c2adf-0x2cf,_0x307b70);}this[_0x4f6e70(0x199,0x201)]['setDate'](_0x154691),this[_0x4f6e70(0x26c,0x20b)]();}['redraw'](){function _0xf2e239(_0x4c696d,_0xd95116){return _0x62ab23(_0xd95116-0x17b,_0x4c696d);}function _0x33a9a4(_0x38d466,_0x5394ab){return _0x4f1b63(_0x5394ab- -0xe2,_0x38d466);}if(!this[_0x33a9a4(-0x2a8,-0x23f)])return;this['windField']['setOptions'](this[_0x33a9a4(-0x275,-0x286)]),this['update']();}['update'](){if(this['_updateIng'])return;this[_0x446e5c(0x24a,0x2d8)]=!![];function _0x425c71(_0x3a5f8a,_0x5225e5){return _0x4f1b63(_0x3a5f8a-0xef,_0x5225e5);}function _0x446e5c(_0x3062ce,_0x336b13){return _0x62ab23(_0x3062ce-0x32b,_0x336b13);}if(this[_0x425c71(-0xbe,-0x4b)])this['windField'][_0x425c71(-0x69,0x22)]();else{const _0x50ac35=this[_0x425c71(0x3a,0xc1)][_0x446e5c(0x265,0x271)]();this['_drawLines'](_0x50ac35);}this[_0x425c71(0x27,0x74)]=![];}['_drawLines'](_0x505c0d){function _0x11b039(_0xb5ce8b,_0x15c11f){return _0x62ab23(_0x15c11f-0x322,_0xb5ce8b);}this['_canvasParticles']=_0x505c0d,this['canvasContext']['globalCompositeOperation']=_0x134c4d(0x2e5,0x349),this['canvasContext'][_0x11b039(0x1e7,0x262)](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this[_0x134c4d(0x338,0x344)][_0x11b039(0x190,0x1ec)]=_0x134c4d(0x30b,0x32e),this[_0x134c4d(0x338,0x2be)][_0x134c4d(0x3ab,0x376)]=0.9;function _0x134c4d(_0x1274e1,_0xfdb2f0){return _0x62ab23(_0x1274e1-0x4b8,_0xfdb2f0);}const _0x133998=this[_0x134c4d(0x3d5,0x373)][_0x11b039(0x1d9,0x196)]['mode']!==Cesium[_0x134c4d(0x393,0x373)][_0x11b039(0x1dd,0x1e8)],_0x3f85d2=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0xe1fc5e=0x0,_0x36e8d1=_0x505c0d['length'];_0xe1fc5e<_0x36e8d1;_0xe1fc5e++){const _0x374c2b=_0x505c0d[_0xe1fc5e],_0xd09664=this[_0x134c4d(0x357,0x330)](_0x374c2b,_0x374c2b[_0x11b039(0x21d,0x205)],_0x374c2b['lat'],_0x374c2b[_0x134c4d(0x2f0,0x35d)]),_0x668b53=this[_0x11b039(0x1ae,0x1c1)](_0x374c2b,_0x374c2b['tlng'],_0x374c2b['tlat'],_0x374c2b[_0x134c4d(0x3a3,0x35e)]);if(!_0xd09664||!_0x668b53)continue;if(_0x133998&&Math['abs'](_0xd09664[0x0]-_0x668b53[0x0])>=_0x3f85d2)continue;this[_0x11b039(0x14c,0x1a2)][_0x11b039(0x198,0x1cd)](),this['canvasContext'][_0x11b039(0x1a5,0x1a4)]=this['lineWidth'],this[_0x134c4d(0x338,0x2a9)]['strokeStyle']=this['_colorRamp']['getColor'](_0x374c2b[_0x134c4d(0x308,0x30a)]),this['canvasContext'][_0x11b039(0x1c1,0x24d)](_0xd09664[0x0],_0xd09664[0x1]),this['canvasContext'][_0x11b039(0xfa,0x160)](_0x668b53[0x0],_0x668b53[0x1]),this['canvasContext'][_0x11b039(0x275,0x257)]();}else{this[_0x11b039(0x1e7,0x1a2)]['beginPath'](),this[_0x134c4d(0x338,0x31f)]['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];for(let _0x100654=0x0,_0x27c63a=_0x505c0d['length'];_0x100654<_0x27c63a;_0x100654++){const _0x20f50=_0x505c0d[_0x100654],_0x492c01=this[_0x11b039(0x181,0x1c1)](_0x20f50,_0x20f50['lng'],_0x20f50['lat'],_0x20f50[_0x134c4d(0x2f0,0x2d3)]),_0x16976d=this['_tomap'](_0x20f50,_0x20f50[_0x134c4d(0x2fa,0x315)],_0x20f50['tlat'],_0x20f50['talt']);if(!_0x492c01||!_0x16976d)continue;if(_0x133998&&Math['abs'](_0x492c01[0x0]-_0x16976d[0x0])>=_0x3f85d2)continue;this['canvasContext'][_0x11b039(0x230,0x24d)](_0x492c01[0x0],_0x492c01[0x1]),this['canvasContext'][_0x11b039(0x152,0x160)](_0x16976d[0x0],_0x16976d[0x1]);}this['canvasContext'][_0x11b039(0x28e,0x257)]();}}['_tomap'](_0x589739,_0xe30fa6,_0x11ee85,_0x5066aa){function _0x3e400d(_0x285988,_0x5e798f){return _0x62ab23(_0x5e798f-0x51e,_0x285988);}const _0x3ce3ab=Cesium['Cartesian3']['fromDegrees'](_0xe30fa6,_0x11ee85,_0x5066aa??this['fixedHeight']);function _0x3bdacc(_0x4f80f7,_0x1ec69d){return _0x62ab23(_0x1ec69d-0x49b,_0x4f80f7);}const _0x46189a=this['_map']['scene'];if(_0x46189a['mode']===Cesium['SceneMode'][_0x3bdacc(0x378,0x361)]){const _0x5e1923=new Cesium[(_0x3e400d(0x41b,0x432))](_0x46189a[_0x3bdacc(0x331,0x34a)]['ellipsoid'],_0x46189a['camera']['positionWC']),_0x55a989=_0x5e1923['isPointVisible'](_0x3ce3ab);if(!_0x55a989)return _0x589739['age']=0x0,null;}const _0x470fbf=mars3d__namespace['PointTrans'][_0x3bdacc(0x3ec,0x3de)](this[_0x3bdacc(0x34a,0x3b8)][_0x3bdacc(0x32e,0x30f)],_0x3ce3ab);return _0x470fbf?[_0x470fbf['x'],_0x470fbf['y']]:null;}[_0x4f1b63(-0x1a3,-0x1c3)](){function _0x16143b(_0x374bd4,_0x302795){return _0x4f1b63(_0x302795-0x18b,_0x374bd4);}this[_0x1d8a86(0x58f,0x568)][_0x16143b(0x4f,-0x18)]();function _0x1d8a86(_0x5e72f5,_0x53a671){return _0x4f1b63(_0x53a671-0x61d,_0x5e72f5);}delete this[_0x1d8a86(0x525,0x54b)];}['initWorker'](){function _0x3a0a2f(_0x4e009e,_0x5cfe49){return _0x4f1b63(_0x5cfe49-0xe4,_0x4e009e);}function _0x4cf99d(_0x3853d5,_0x3bc56b){return _0x4f1b63(_0x3853d5-0x60a,_0x3bc56b);}this['worker']=new Worker(this[_0x3a0a2f(-0x69,-0xc0)]['worker']),this['worker'][_0x3a0a2f(-0x5e,-0x22)]=_0x8eb22b=>{function _0x40ac0e(_0xc2c0fc,_0x37591b){return _0x3a0a2f(_0xc2c0fc,_0x37591b-0xbb);}this['_drawLines'](_0x8eb22b[_0x59ec66(0x180,0x171)]['particles']);function _0x59ec66(_0x1508ea,_0x23ace0){return _0x4cf99d(_0x1508ea- -0x31e,_0x23ace0);}this[_0x40ac0e(0x2b,0x5d)]=![];},this[_0x4cf99d(0x555,0x5e1)]={'init':_0x5302bd=>{const _0x4bea62={};_0x4bea62['type']='init',_0x4bea62['options']=_0x5302bd,this['worker']['postMessage'](_0x4bea62);},'setOptions':_0x1623f0=>{const _0xecbfde={};_0xecbfde['type']='setOptions',_0xecbfde['options']=_0x1623f0,this['worker']['postMessage'](_0xecbfde);},'setDate':_0x353682=>{function _0x2b0d41(_0x380aa9,_0x4fb5e8){return _0x3a0a2f(_0x380aa9,_0x4fb5e8-0x133);}const _0xc4c382={};_0xc4c382['type']='setDate',_0xc4c382[_0x2b0d41(0xa4,0xab)]=_0x353682;function _0x56f49e(_0x1200da,_0x2a8a5f){return _0x4cf99d(_0x2a8a5f-0x4c,_0x1200da);}this['worker'][_0x2b0d41(0x11c,0x137)](_0xc4c382);},'update':()=>{function _0x4525f1(_0xfcf56,_0x2f0969){return _0x4cf99d(_0x2f0969- -0x22d,_0xfcf56);}if(this['_updateIng2'])return;this[_0x4525f1(0x2fb,0x29b)]=!![];const _0x4a0e14={};_0x4a0e14[_0x4525f1(0x24b,0x2bb)]='update';function _0x55415d(_0x381fe5,_0x57c71d){return _0x3a0a2f(_0x381fe5,_0x57c71d- -0x117);}this[_0x4525f1(0x1d3,0x230)]['postMessage'](_0x4a0e14);},'clear':()=>{function _0x25114a(_0x2eb685,_0x225c55){return _0x3a0a2f(_0x225c55,_0x2eb685-0x16f);}const _0xf29784={};_0xf29784['type']='clear',this[_0x25114a(0xa6,0xaa)]['postMessage'](_0xf29784);}},this['windField']['init'](this[_0x4cf99d(0x466,0x4b7)]);}}mars3d__namespace[_0x4f1b63(-0xd6,-0x4a)]['register'](_0x62ab23(-0xe5,-0xb8),CanvasWindLayer),mars3d__namespace['layer'][_0x62ab23(-0x12e,-0x178)]=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace[_0x4f1b63(-0x171,-0x168)][_0x62ab23(-0x112,-0x158)]('mars3d-wind插件\x20注册成功'),mars3d__namespace['WindUtil']=WindUtil,exports[_0x4f1b63(-0x13e,-0x192)]=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports[_0x62ab23(-0x1c7,-0x15d)]=WindLayer,exports[_0x4f1b63(-0x118,-0x123)]=WindUtil;const _0x4eb4df={};_0x4eb4df['value']=!![],Object[_0x62ab23(-0x113,-0x17d)](exports,'__esModule',_0x4eb4df);
}));
