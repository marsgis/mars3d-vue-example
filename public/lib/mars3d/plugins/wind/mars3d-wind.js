/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.9.6
 * 编译日期：2025-04-16 14:51
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：火星科技免费公开版 ，2025-02-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';(function(_0x55ead5,_0x17db00){function _0x1a5762(_0x2a08ad,_0x1e8e3){return _0x5cd5(_0x2a08ad- -0x107,_0x1e8e3);}const _0x3f927f=_0x55ead5();function _0x40f3d5(_0x2655c8,_0x503846){return _0x5cd5(_0x2655c8-0xad,_0x503846);}while(!![]){try{const _0x3ff1f6=-parseInt(_0x40f3d5(0x24e,0x210))/0x1*(-parseInt(_0x40f3d5(0x2bd,0x27e))/0x2)+-parseInt(_0x40f3d5(0x1d3,0x239))/0x3*(parseInt(_0x40f3d5(0x293,0x2d5))/0x4)+parseInt(_0x1a5762(0x2f,-0x34))/0x5+-parseInt(_0x40f3d5(0x1cf,0x1de))/0x6*(parseInt(_0x1a5762(0xb0,0xc0))/0x7)+-parseInt(_0x1a5762(0x99,0xfa))/0x8+parseInt(_0x1a5762(0x83,0xc9))/0x9+parseInt(_0x40f3d5(0x227,0x2aa))/0xa*(parseInt(_0x40f3d5(0x1eb,0x1c8))/0xb);if(_0x3ff1f6===_0x17db00)break;else _0x3f927f['push'](_0x3f927f['shift']());}catch(_0x1b7d9b){_0x3f927f['push'](_0x3f927f['shift']());}}}(_0x37a8,0x23102));function _0x5cd5(_0x3e7447,_0x172b15){const _0x37a842=_0x37a8();return _0x5cd5=function(_0x5cd53c,_0x468c55){_0x5cd53c=_0x5cd53c-0x10d;let _0x4ae57e=_0x37a842[_0x5cd53c];return _0x4ae57e;},_0x5cd5(_0x3e7447,_0x172b15);}function _interopNamespace(_0x2f2d4e){function _0x10cc24(_0x4371f3,_0x3bb607){return _0x5cd5(_0x4371f3-0x68,_0x3bb607);}if(_0x2f2d4e&&_0x2f2d4e['__esModule'])return _0x2f2d4e;var _0x12f030=Object[_0x10cc24(0x235,0x1dd)](null);return _0x2f2d4e&&Object['keys'](_0x2f2d4e)['forEach'](function(_0x1f1c69){function _0x179f48(_0x89ee41,_0x9bf8e8){return _0x10cc24(_0x89ee41- -0x1d3,_0x9bf8e8);}if(_0x1f1c69!=='default'){var _0x5307f8=Object[_0x179f48(-0x32,0x53)](_0x2f2d4e,_0x1f1c69);Object['defineProperty'](_0x12f030,_0x1f1c69,_0x5307f8['get']?_0x5307f8:{'enumerable':!![],'get':function(){return _0x2f2d4e[_0x1f1c69];}});}}),_0x12f030['default']=_0x2f2d4e,_0x12f030;}var mars3d__namespace=_interopNamespace(mars3d);const Cesium$2=mars3d__namespace['Cesium'];function getU(_0x5ed0f1,_0x47c17a){function _0x4783a9(_0x5f20bd,_0x521200){return _0x5cd5(_0x5f20bd- -0x77,_0x521200);}const _0x30bfa7=_0x5ed0f1*Math['cos'](Cesium$2[_0x4783a9(0x12d,0xb3)]['toRadians'](_0x47c17a));return _0x30bfa7;}function getV(_0x27eead,_0x5ed548){function _0x585a5b(_0x3b2e04,_0x70bca4){return _0x5cd5(_0x70bca4-0x1c9,_0x3b2e04);}function _0x2375c6(_0x3d54ee,_0x10eed0){return _0x5cd5(_0x3d54ee-0x2d8,_0x10eed0);}const _0x546103=_0x27eead*Math['sin'](Cesium$2[_0x2375c6(0x47c,0x451)][_0x585a5b(0x386,0x35c)](_0x5ed548));return _0x546103;}function getSpeed(_0x45f3ab,_0xe2ff7){const _0x3cae19=Math['sqrt'](Math['pow'](_0x45f3ab,0x2)+Math['pow'](_0xe2ff7,0x2));return _0x3cae19;}function getDirection(_0x14d030,_0x1d3faa){let _0x6cabd=Cesium$2['Math']['toDegrees'](Math['atan2'](_0x1d3faa,_0x14d030));return _0x6cabd+=_0x6cabd<0x0?0x168:0x0,_0x6cabd;}const _0x1e7379={};_0x1e7379['__proto__']=null,_0x1e7379[_0x15ab6e(0x118,0xee)]=getU,_0x1e7379[_0x398695(0x8e,0x119)]=getV,_0x1e7379[_0x15ab6e(0x2e,0x4f)]=getSpeed,_0x1e7379['getDirection']=getDirection;var WindUtil=_0x1e7379,updatePositionShader=_0x398695(0x169,0x186),calculateSpeedShader=_0x398695(0x82,0xeb),postProcessingPositionFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x20//\x20(u,\x20v,\x20norm)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20dataLonRange;\x0auniform\x20vec2\x20dataLatRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x0auniform\x20float\x20dropRate;\x0auniform\x20float\x20dropRateBump;\x0a\x0a//\x20添加新的\x20uniform\x20变量\x0auniform\x20bool\x20useViewerBounds;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898f,\x2078.233f,\x204375.85453f);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0f,\x201.0f);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec2\x20generateRandomParticle(vec2\x20seed)\x20{\x0a\x20\x20vec2\x20range;\x0a\x20\x20float\x20randomLon,\x20randomLat;\x0a\x0a\x20\x20if(useViewerBounds)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在当前视域范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20lonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20在数据范围内生成粒子\x0a\x20\x20\x20\x20randomLon\x20=\x20rand(seed,\x20dataLonRange);\x0a\x20\x20\x20\x20randomLat\x20=\x20rand(-seed,\x20dataLatRange);\x0a\x20\x20}\x0a\x0a\x20\x20return\x20vec2(randomLon,\x20randomLat);\x0a}\x0a\x0abool\x20particleOutbound(vec2\x20particle)\x20{\x0a\x20\x20return\x20particle.y\x20<\x20dataLatRange.x\x20||\x20particle.y\x20>\x20dataLatRange.y\x20||\x20particle.x\x20<\x20dataLonRange.x\x20||\x20particle.x\x20>\x20dataLonRange.y;\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec2\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec4\x20nextSpeed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20float\x20speedNorm\x20=\x20nextSpeed.a;\x0a\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20speedNorm;\x0a\x0a\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20seed2\x20=\x20nextSpeed.rg\x20+\x20v_textureCoordinates;\x0a\x20\x20vec2\x20randomParticle\x20=\x20generateRandomParticle(seed1);\x0a\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20if(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(randomParticle,\x200.0f,\x201.0f);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(nextParticle,\x200.0f,\x200.0f);\x0a\x20\x20}\x0a}\x0a',renderParticlesFragmentShader='#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec4\x20speed;\x0ain\x20float\x20v_segmentPosition;\x0ain\x20vec2\x20textureCoordinate;\x0a\x0auniform\x20vec2\x20domain;\x0auniform\x20vec2\x20displayRange;\x0auniform\x20sampler2D\x20colorTable;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20const\x20float\x20zero\x20=\x200.0f;\x0a\x20\x20if(speed.a\x20>\x20zero\x20&&\x20speed.b\x20>\x20displayRange.x\x20&&\x20speed.b\x20<\x20displayRange.y)\x20{\x0a\x20\x20\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x20\x20\x20\x20vec4\x20baseColor\x20=\x20texture(colorTable,\x20vec2(normalizedSpeed,\x20zero));\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用更平滑的渐变效果\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20smoothstep(0.0f,\x201.0f,\x20v_segmentPosition);\x0a\x20\x20\x20\x20alpha\x20=\x20pow(alpha,\x201.5f);\x20//\x20调整透明度渐变曲线\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20根据速度调整透明度\x0a\x20\x20\x20\x20float\x20speedAlpha\x20=\x20mix(0.3f,\x201.0f,\x20speed.a);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20组合颜色和透明度\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(baseColor.rgb,\x20baseColor.a\x20*\x20alpha\x20*\x20speedAlpha);\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a\x0a\x20\x20float\x20segmentsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x20\x20if(segmentsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20fragColor\x20=\x20vec4(zero);\x0a\x20\x20}\x0a}\x0a',renderParticlesVertexShader=_0x15ab6e(0xf9,0x14e);const {ShaderSource:ShaderSource$1}=mars3d__namespace['Cesium'];class ShaderManager{static[_0x398695(0x181,0x14d)](){const _0x5bc7c2={};return _0x5bc7c2['sources']=[calculateSpeedShader],new ShaderSource$1(_0x5bc7c2);}static['getUpdatePositionShader'](){const _0x35fee7={};function _0x5b7547(_0x31b25d,_0x47d908){return _0x398695(_0x47d908,_0x31b25d-0x13c);}return _0x35fee7[_0x5b7547(0x2fb,0x2fd)]=[updatePositionShader],new ShaderSource$1(_0x35fee7);}static[_0x15ab6e(0x69,0x17)](){function _0x4a435c(_0x56af7,_0x2f7319){return _0x398695(_0x56af7,_0x2f7319- -0x108);}const _0x2b3af3={};return _0x2b3af3[_0x4a435c(0x13f,0xb7)]=[renderParticlesVertexShader],new ShaderSource$1(_0x2b3af3);}static[_0x398695(0x16a,0x168)](){const _0xdb37f1={};return _0xdb37f1['sources']=[renderParticlesFragmentShader],new ShaderSource$1(_0xdb37f1);}static['getPostProcessingPositionShader'](){const _0x47f689={};return _0x47f689['sources']=[postProcessingPositionFragmentShader],new ShaderSource$1(_0x47f689);}}const {BufferUsage:BufferUsage$1,ClearCommand:ClearCommand$1,Color:Color$2,ComputeCommand,DrawCommand,Geometry:Geometry$1,Matrix4,Pass:Pass$1,PrimitiveType:PrimitiveType$1,RenderState,ShaderProgram,ShaderSource,VertexArray:VertexArray$1,defined,destroyObject}=mars3d__namespace[_0x398695(0x13d,0xee)];class CustomPrimitive{constructor(_0x4cfde4){this[_0x3f88eb(-0x70,-0x39)]=_0x4cfde4[_0x3f88eb(-0x70,-0x71)],this[_0x2c6454(-0x189,-0x1ca)]=_0x4cfde4['geometry'],this[_0x2c6454(-0x1af,-0x183)]=_0x4cfde4['attributeLocations'],this[_0x3f88eb(0x36,0xb4)]=_0x4cfde4['primitiveType'],this[_0x3f88eb(0x7a,0x97)]=_0x4cfde4['uniformMap']||{},this['vertexShaderSource']=_0x4cfde4['vertexShaderSource'];function _0x3f88eb(_0x264540,_0x3d628e){return _0x15ab6e(_0x264540- -0xb5,_0x3d628e);}this['fragmentShaderSource']=_0x4cfde4[_0x2c6454(-0x185,-0x159)],this['rawRenderState']=_0x4cfde4['rawRenderState'],this['framebuffer']=_0x4cfde4[_0x3f88eb(0x54,-0x2)],this[_0x3f88eb(0x45,0x2a)]=_0x4cfde4['outputTexture'],this['autoClear']=_0x4cfde4['autoClear']??![],this['preExecute']=_0x4cfde4[_0x2c6454(-0xaf,-0xd7)];function _0x2c6454(_0x5db344,_0x4beb3f){return _0x15ab6e(_0x4beb3f- -0x201,_0x5db344);}this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['isDynamic']=_0x4cfde4[_0x2c6454(-0x147,-0x121)]??(()=>!![]),this['autoClear']&&(this['clearCommand']=new ClearCommand$1({'color':new Color$2(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Pass$1[_0x3f88eb(0x1a,-0x34)]}));}['createCommand'](_0x5d7f59){function _0xb5a04(_0x36c755,_0x19fce8){return _0x15ab6e(_0x19fce8-0x23c,_0x36c755);}function _0x229e36(_0x21a780,_0x143c09){return _0x15ab6e(_0x21a780- -0x4d,_0x143c09);}if(this['commandType']===_0x229e36(-0x11,0x24)){const _0x4f44ab={};_0x4f44ab[_0x229e36(0xb9,0x117)]=_0x5d7f59,_0x4f44ab[_0x229e36(-0x16,-0x19)]=this['geometry'],_0x4f44ab['attributeLocations']=this['attributeLocations'],_0x4f44ab[_0x229e36(0x1a,0x7c)]=BufferUsage$1['STATIC_DRAW'];const _0x256fa0=VertexArray$1['fromGeometry'](_0x4f44ab),_0x3af125={};_0x3af125[_0x229e36(0xb9,0x126)]=_0x5d7f59,_0x3af125['vertexShaderSource']=this[_0xb5a04(0x30f,0x369)],_0x3af125[_0xb5a04(0x262,0x2e4)]=this['fragmentShaderSource'],_0x3af125['attributeLocations']=this['attributeLocations'];const _0x564868=ShaderProgram[_0xb5a04(0x30a,0x373)](_0x3af125),_0x154728=RenderState[_0xb5a04(0x323,0x373)](this['rawRenderState']),_0x59fdc0={};return _0x59fdc0['owner']=this,_0x59fdc0['vertexArray']=_0x256fa0,_0x59fdc0[_0xb5a04(0x2cb,0x327)]=this['primitiveType'],_0x59fdc0['modelMatrix']=Matrix4['IDENTITY'],_0x59fdc0['renderState']=_0x154728,_0x59fdc0['shaderProgram']=_0x564868,_0x59fdc0['framebuffer']=this[_0x229e36(0xbc,0x97)],_0x59fdc0[_0xb5a04(0x2f5,0x36b)]=this[_0x229e36(0xe2,0x10b)],_0x59fdc0[_0x229e36(0x24,0x40)]=Pass$1['OPAQUE'],new DrawCommand(_0x59fdc0);}else{if(this['commandType']===_0xb5a04(0x390,0x328)){const _0x4192c3={};return _0x4192c3['owner']=this,_0x4192c3[_0x229e36(0x5b,0xb2)]=this['fragmentShaderSource'],_0x4192c3['uniformMap']=this['uniformMap'],_0x4192c3[_0xb5a04(0x331,0x336)]=this[_0x229e36(0xad,0xe0)],_0x4192c3['persists']=!![],new ComputeCommand(_0x4192c3);}else throw new Error('Unknown\x20command\x20type');}}['setGeometry'](_0x29080d,_0x3ccea6){this['geometry']=_0x3ccea6;function _0x10f847(_0x2adfb8,_0x238d1c){return _0x398695(_0x2adfb8,_0x238d1c-0x3d9);}function _0x4d214d(_0x367f04,_0x163875){return _0x398695(_0x163875,_0x367f04-0x137);}defined(this['commandToExecute'])&&(this['commandToExecute'][_0x10f847(0x54e,0x4cc)]=VertexArray$1[_0x4d214d(0x2be,0x345)]({'context':_0x29080d,'geometry':this[_0x10f847(0x547,0x4ce)],'attributeLocations':this['attributeLocations'],'bufferUsage':BufferUsage$1['STATIC_DRAW']}));}['update'](_0x46d688){if(!this[_0x4372db(0x297,0x28e)]())return;if(!this['show']||!defined(_0x46d688))return;function _0x4372db(_0x1bc5c1,_0x499010){return _0x398695(_0x1bc5c1,_0x499010-0xf0);}!defined(this[_0x4372db(0x295,0x223)])&&(this[_0x6cfbf0(-0x166,-0x135)]=this['createCommand'](_0x46d688[_0x6cfbf0(-0xd5,-0x73)]));defined(this['preExecute'])&&this['preExecute']();if(!_0x46d688['commandList']){console[_0x6cfbf0(-0x11f,-0x10b)](_0x4372db(0x2c3,0x240));return;}function _0x6cfbf0(_0x4bb72e,_0xfba8f0){return _0x398695(_0xfba8f0,_0x4bb72e- -0x299);}defined(this[_0x6cfbf0(-0x13f,-0xe4)])&&_0x46d688['commandList']['push'](this[_0x4372db(0x1d2,0x24a)]),defined(this[_0x6cfbf0(-0x166,-0x1c0)])&&_0x46d688['commandList'][_0x4372db(0x1f6,0x20e)](this[_0x4372db(0x241,0x223)]);}['isDestroyed'](){return![];}['destroy'](){if(defined(this[_0x1f164f(0x2b0,0x2d2)])){var _0x943c;(_0x943c=this['commandToExecute'][_0x1f164f(0x347,0x2da)])===null||_0x943c===void 0x0||_0x943c[_0x545245(0x426,0x3dc)](),this['commandToExecute'][_0x545245(0x47c,0x4d4)]=undefined;}function _0x1f164f(_0x59257a,_0x4ad8ae){return _0x398695(_0x4ad8ae,_0x59257a-0x17d);}function _0x545245(_0x44d035,_0xc0ce2c){return _0x398695(_0xc0ce2c,_0x44d035-0x2b2);}return destroyObject(this);}}function deepMerge(_0xc4c3ed,_0x4fc996){function _0x40f2ff(_0x33e176,_0x56bb5d){return _0x15ab6e(_0x33e176- -0x241,_0x56bb5d);}if(!_0xc4c3ed)return _0x4fc996;if(!_0x4fc996)return _0xc4c3ed;const _0xbdedf3={..._0x4fc996},_0x317c78=_0xbdedf3;for(const _0x2c6f74 in _0xc4c3ed){if(Object['prototype']['hasOwnProperty'][_0x40f2ff(-0x12e,-0x1af)](_0xc4c3ed,_0x2c6f74)){const _0x3f6d68=_0xc4c3ed[_0x2c6f74],_0x108188=_0x4fc996[_0x2c6f74];if(Array['isArray'](_0x3f6d68)){_0x317c78[_0x2c6f74]=_0x3f6d68['slice']();continue;}if(_0x3f6d68&&typeof _0x3f6d68==='object'){_0x317c78[_0x2c6f74]=deepMerge(_0x3f6d68,_0x108188||{});continue;}_0x3f6d68!==undefined&&(_0x317c78[_0x2c6f74]=_0x3f6d68);}}return _0x317c78;}const {Cartesian2:Cartesian2$1,FrameRateMonitor,PixelDatatype:PixelDatatype$1,PixelFormat:PixelFormat$1,Sampler:Sampler$1,Texture:Texture$1,TextureMagnificationFilter:TextureMagnificationFilter$1,TextureMinificationFilter:TextureMinificationFilter$1}=mars3d__namespace[_0x15ab6e(0x30,-0xe)];class WindParticlesComputing{constructor(_0x13ffe9,_0x15e4d4,_0x47cf71,_0x171b9a,_0x254950){this['context']=_0x13ffe9,this['options']=_0x47cf71,this['viewerParameters']=_0x171b9a,this[_0x949f5(0x535,0x559)]=_0x15e4d4,this['frameRate']=0x3c,this[_0x949f5(0x4ae,0x4c9)]=0x1;function _0x55a25c(_0x5a6910,_0x5e4224){return _0x398695(_0x5a6910,_0x5e4224-0x3f2);}const _0x411290={};_0x411290['scene']=_0x254950,_0x411290['samplingWindow']=0x1;function _0x949f5(_0x41927f,_0x496595){return _0x398695(_0x496595,_0x41927f-0x394);}_0x411290[_0x949f5(0x4c8,0x555)]=0x0,this[_0x949f5(0x560,0x50f)]=new FrameRateMonitor(_0x411290),this['initFrameRate'](),this['createWindTextures'](),this[_0x55a25c(0x4ef,0x4df)](),this[_0x55a25c(0x54c,0x4e4)]();}[_0x15ab6e(0x55,0x59)](){function _0x29cb2d(_0x1b4d17,_0x5a53e2){return _0x15ab6e(_0x1b4d17-0x350,_0x5a53e2);}const _0x191986=()=>{function _0x2e7954(_0x3eaa65,_0x206e96){return _0x5cd5(_0x206e96-0x133,_0x3eaa65);}function _0x1ffc0a(_0x414294,_0x50434b){return _0x5cd5(_0x50434b-0x2e5,_0x414294);}this[_0x2e7954(0x30e,0x328)][_0x1ffc0a(0x4bd,0x479)]>0x14&&(this['frameRate']=this['frameRateMonitor'][_0x1ffc0a(0x40c,0x479)],this[_0x2e7954(0x206,0x276)]=0x3c/Math[_0x2e7954(0x393,0x357)](this['frameRate'],0x1));};_0x191986();const _0x4139d5=setInterval(_0x191986,0x3e8);function _0xe17481(_0x2ad611,_0x4658a5){return _0x398695(_0x4658a5,_0x2ad611-0xe5);}const _0x564199=this[_0xe17481(0x259,0x200)]['bind'](this);this[_0x29cb2d(0x406,0x41f)]=()=>{clearInterval(_0x4139d5),_0x564199();};}['createWindTextures'](){function _0xc0b98c(_0x3244df,_0x18bc79){return _0x398695(_0x3244df,_0x18bc79- -0x2c9);}const _0x17eedf={};_0x17eedf[_0x43992b(-0x58,0x2c)]=TextureMinificationFilter$1[_0xc0b98c(-0x199,-0x110)],_0x17eedf[_0xc0b98c(-0xec,-0x167)]=TextureMagnificationFilter$1['LINEAR'];function _0x43992b(_0x2a6927,_0x2f1a5b){return _0x398695(_0x2a6927,_0x2f1a5b- -0xd8);}const _0xb165c={'context':this['context'],'width':this[_0xc0b98c(-0x13a,-0x128)]['width'],'height':this['windData'][_0xc0b98c(-0x156,-0x17d)],'pixelFormat':PixelFormat$1['RED'],'pixelDatatype':PixelDatatype$1[_0xc0b98c(-0x12c,-0x1b3)],'flipY':this['options']['flipY']??![],'sampler':new Sampler$1(_0x17eedf)};this['windTextures']={'U':new Texture$1({..._0xb165c,'source':{'arrayBufferView':new Float32Array(this[_0xc0b98c(-0xe4,-0x128)]['u'][_0x43992b(0x7f,0xde)])}}),'V':new Texture$1({..._0xb165c,'source':{'arrayBufferView':new Float32Array(this[_0xc0b98c(-0xda,-0x128)]['v'][_0x43992b(0x53,0xde)])}})};}[_0x398695(0xb0,0xed)](){function _0x26a5f9(_0x40b1f7,_0x8a1c05){return _0x398695(_0x40b1f7,_0x8a1c05-0x1e9);}const _0x2dd51f={};_0x2dd51f[_0x2d104d(-0x1cf,-0x177)]=TextureMinificationFilter$1[_0x26a5f9(0x39c,0x38e)],_0x2dd51f['magnificationFilter']=TextureMagnificationFilter$1['NEAREST'];const _0x7a2111={'context':this[_0x2d104d(-0x140,-0xb7)],'width':this[_0x2d104d(-0x136,-0xca)][_0x2d104d(-0x151,-0x192)],'height':this['options']['particlesTextureSize'],'pixelFormat':PixelFormat$1[_0x2d104d(-0x11a,-0xc1)],'pixelDatatype':PixelDatatype$1[_0x26a5f9(0x2bb,0x2ff)],'flipY':![],'source':{'arrayBufferView':new Float32Array(this['options']['particlesTextureSize']*this['options'][_0x26a5f9(0x2ff,0x2d2)]*0x4)['fill'](0x0)},'sampler':new Sampler$1(_0x2dd51f)};function _0x2d104d(_0x1d5bc1,_0x5ab9b1){return _0x398695(_0x1d5bc1,_0x5ab9b1- -0x27b);}this[_0x26a5f9(0x3ab,0x383)]={'previousParticlesPosition':new Texture$1(_0x7a2111),'currentParticlesPosition':new Texture$1(_0x7a2111),'nextParticlesPosition':new Texture$1(_0x7a2111),'postProcessingPosition':new Texture$1(_0x7a2111),'particlesSpeed':new Texture$1(_0x7a2111)};}['destroyParticlesTextures'](){function _0x53868a(_0x32bcdd,_0x5407ff){return _0x15ab6e(_0x5407ff- -0x2d9,_0x32bcdd);}function _0x4d46d4(_0x2b0bef,_0x484d24){return _0x15ab6e(_0x2b0bef-0x80,_0x484d24);}Object[_0x53868a(-0x32d,-0x2b3)](this[_0x4d46d4(0x15c,0xdd)])[_0x4d46d4(0x135,0x1a1)](_0x4bbd6e=>_0x4bbd6e[_0x53868a(-0x21f,-0x223)]());}[_0x15ab6e(0x34,-0x44)](){function _0x418ca1(_0x1171a1,_0x36e0ae){return _0x15ab6e(_0x36e0ae-0x1b3,_0x1171a1);}function _0x40c013(_0x14e10e,_0x5c571e){return _0x398695(_0x14e10e,_0x5c571e-0xdd);}this['primitives']={'calculateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':()=>this[_0x418ca1(0x1e3,0x21b)]['U'],'V':()=>this['windTextures']['V'],'uRange':()=>new Cartesian2$1(this[_0x418ca1(0x2fa,0x296)]['u']['min'],this[_0x418ca1(0x2d3,0x296)]['u']['max']),'vRange':()=>new Cartesian2$1(this['windData']['v']['min'],this[_0x40c013(0x222,0x27e)]['v'][_0x418ca1(0x349,0x2f0)]),'speedRange':()=>new Cartesian2$1(this['windData']['speed'][_0x418ca1(0x1cc,0x248)],this[_0x40c013(0x250,0x27e)]['speed']['max']),'currentParticlesPosition':()=>this[_0x418ca1(0x238,0x28f)][_0x40c013(0x21a,0x1f1)],'speedScaleFactor':()=>{function _0x3b0b50(_0x12939b,_0x28a1f8){return _0x40c013(_0x28a1f8,_0x12939b-0x123);}return(this['viewerParameters'][_0x3b0b50(0x396,0x349)]+0x32)*this['options']['speedFactor'];},'frameRateAdjustment':()=>this[_0x418ca1(0x26c,0x20f)],'dimension':()=>new Cartesian2$1(this[_0x40c013(0x2df,0x27e)]['width'],this[_0x418ca1(0x274,0x296)][_0x40c013(0x226,0x229)]),'minimum':()=>new Cartesian2$1(this['windData']['bounds']['west'],this['windData']['bounds'][_0x40c013(0x258,0x2cc)]),'maximum':()=>new Cartesian2$1(this['windData']['bounds'][_0x40c013(0x208,0x1d4)],this[_0x418ca1(0x2d6,0x296)][_0x40c013(0x296,0x24b)]['north'])},'fragmentShaderSource':ShaderManager['getCalculateSpeedShader'](),'outputTexture':this['particlesTextures']['particlesSpeed'],'preExecute':()=>{function _0x226770(_0x1c7c57,_0x267cb8){return _0x40c013(_0x1c7c57,_0x267cb8- -0x153);}const _0x138d42=this['particlesTextures']['previousParticlesPosition'];this['particlesTextures'][_0x226770(0x151,0x112)]=this['particlesTextures']['currentParticlesPosition'];function _0x8ca02f(_0x571ff3,_0x5173cd){return _0x418ca1(_0x5173cd,_0x571ff3-0x2c9);}this[_0x226770(0x197,0x124)][_0x226770(0x46,0x9e)]=this['particlesTextures']['postProcessingPosition'],this[_0x8ca02f(0x558,0x56b)][_0x8ca02f(0x5ae,0x633)]=_0x138d42,this['primitives']['calculateSpeed']['commandToExecute']&&(this['primitives'][_0x226770(0x89,0xc7)]['commandToExecute']['outputTexture']=this['particlesTextures'][_0x8ca02f(0x504,0x504)]);},'isDynamic':()=>this['options']['dynamic']}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':()=>this[_0x418ca1(0x2ae,0x28f)][_0x418ca1(0x200,0x209)],'particlesSpeed':()=>this[_0x418ca1(0x29d,0x28f)][_0x418ca1(0x1b6,0x23b)]},'fragmentShaderSource':ShaderManager['getUpdatePositionShader'](),'outputTexture':this[_0x40c013(0x27a,0x277)]['nextParticlesPosition'],'preExecute':()=>{function _0x5c8463(_0x7ece03,_0x520de8){return _0x40c013(_0x7ece03,_0x520de8-0x318);}function _0x59c8d4(_0x38b440,_0x5a0411){return _0x418ca1(_0x5a0411,_0x38b440- -0x1dc);}this[_0x59c8d4(0x49,-0x2f)]['updatePosition']['commandToExecute']&&(this[_0x5c8463(0x52e,0x525)]['updatePosition'][_0x59c8d4(0x4c,0x5e)]['outputTexture']=this['particlesTextures']['nextParticlesPosition']);},'isDynamic':()=>this['options'][_0x40c013(0x261,0x2a2)]}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x418ca1(0x2f8,0x29f),'uniformMap':{'nextParticlesPosition':()=>this['particlesTextures'][_0x40c013(0x28a,0x244)],'particlesSpeed':()=>this['particlesTextures'][_0x418ca1(0x282,0x23b)],'lonRange':()=>this['viewerParameters']['lonRange'],'latRange':()=>this[_0x40c013(0x1e4,0x242)]['latRange'],'dataLonRange':()=>new Cartesian2$1(this['windData'][_0x40c013(0x234,0x24b)]['west'],this['windData'][_0x418ca1(0x28e,0x263)][_0x40c013(0x1a4,0x1d4)]),'dataLatRange':()=>new Cartesian2$1(this[_0x418ca1(0x231,0x296)]['bounds']['south'],this[_0x40c013(0x27d,0x27e)]['bounds']['north']),'randomCoefficient':function(){function _0xb010a5(_0x49b513,_0x232bc5){return _0x418ca1(_0x232bc5,_0x49b513- -0x346);}return Math[_0xb010a5(-0x148,-0xc0)]();},'dropRate':()=>this['options'][_0x40c013(0x210,0x220)],'dropRateBump':()=>this['options']['dropRateBump'],'useViewerBounds':()=>this['options'][_0x40c013(0x2a2,0x292)]},'fragmentShaderSource':ShaderManager[_0x418ca1(0x1f4,0x204)](),'outputTexture':this[_0x40c013(0x27a,0x277)]['postProcessingPosition'],'preExecute':()=>{function _0x4583d3(_0x27c090,_0x511e60){return _0x40c013(_0x27c090,_0x511e60- -0x40e);}function _0x8c9b13(_0x32cec4,_0x3c2d4e){return _0x418ca1(_0x32cec4,_0x3c2d4e-0x2f8);}this['primitives']['postProcessingPosition'][_0x8c9b13(0x52f,0x520)]&&(this[_0x8c9b13(0x559,0x51d)]['postProcessingPosition'][_0x8c9b13(0x592,0x520)]['outputTexture']=this[_0x8c9b13(0x502,0x587)]['postProcessingPosition']);},'isDynamic':()=>this['options'][_0x40c013(0x2ab,0x2a2)]})};}['reCreateWindTextures'](){function _0x36f901(_0x44ac88,_0x55f622){return _0x15ab6e(_0x44ac88-0x3cb,_0x55f622);}function _0xc188e5(_0x3da36d,_0x1182be){return _0x15ab6e(_0x1182be- -0x43,_0x3da36d);}this['windTextures']['U'][_0x36f901(0x481,0x497)](),this['windTextures']['V'][_0x36f901(0x481,0x4ef)](),this['createWindTextures']();}['updateWindData'](_0x5db445){function _0x567c44(_0x40524d,_0x1eaa21){return _0x398695(_0x40524d,_0x1eaa21- -0x168);}this[_0x567c44(0x31,0x39)]=_0x5db445,this['reCreateWindTextures']();}['updateOptions'](_0x775074){const _0x3525ec=_0x775074['flipY']!==undefined&&_0x775074['flipY']!==this[_0x318a9(0x1ef,0x21f)][_0x183080(0x305,0x34b)];this['options']=deepMerge(_0x775074,this['options']);function _0x183080(_0x10dfc0,_0x297864){return _0x398695(_0x297864,_0x10dfc0-0x145);}function _0x318a9(_0x17fd31,_0x1c4733){return _0x398695(_0x1c4733,_0x17fd31-0x3e);}_0x3525ec&&this['reCreateWindTextures']();}[_0x15ab6e(0x116,0x104)](_0x18ffbc){const {array:_0x3f37ec}=_0x18ffbc;let {min:_0x38db74,max:_0x512fe3}=_0x18ffbc;const _0x3e657d=new Float32Array(_0x3f37ec['length']);_0x38db74===undefined&&(console['warn'](_0x544c6d(0x4dd,0x462)),_0x38db74=Math[_0x544c6d(0x485,0x434)](..._0x3f37ec));_0x512fe3===undefined&&(console[_0x544c6d(0x3f2,0x45b)]('max\x20is\x20undefined,\x20calculate\x20max'),_0x512fe3=Math['max'](..._0x3f37ec));function _0x544c6d(_0x128c1c,_0x152434){return _0x15ab6e(_0x152434-0x39f,_0x128c1c);}const _0x4cef5c=Math[_0x544c6d(0x528,0x4dc)](Math[_0x5f4f7f(0x3e4,0x453)](_0x38db74),Math['abs'](_0x512fe3));for(let _0x1a8d3b=0x0;_0x1a8d3b<_0x3f37ec['length'];_0x1a8d3b++){const _0x4ae667=_0x3f37ec[_0x1a8d3b]/_0x4cef5c;_0x3e657d[_0x1a8d3b]=_0x4ae667;}function _0x5f4f7f(_0x486cc3,_0x22faf7){return _0x398695(_0x486cc3,_0x22faf7-0x337);}return _0x3e657d;}[_0x398695(0x1a9,0x174)](){Object['values'](this[_0x26efec(-0x7,-0x10)])['forEach'](_0x55a974=>_0x55a974['destroy']());function _0x246a64(_0x92e3ef,_0xef2f50){return _0x398695(_0xef2f50,_0x92e3ef-0x306);}Object['values'](this['particlesTextures'])['forEach'](_0xe39282=>_0xe39282[_0x26efec(-0x36,0x3e)]()),Object[_0x26efec(-0x11,-0x52)](this['primitives'])[_0x246a64(0x479,0x502)](_0x526647=>_0x526647[_0x26efec(-0x42,0x3e)]());function _0x26efec(_0xb9fa84,_0x1dc52c){return _0x398695(_0xb9fa84,_0x1dc52c- -0x136);}this['frameRateMonitor']['destroy']();}}const {Appearance,BufferUsage,Cartesian2,Color:Color$1,ComponentDatatype,Framebuffer,Geometry,GeometryAttribute,GeometryAttributes,PixelDatatype,PixelFormat,PrimitiveType,Sampler,SceneMode,Texture,TextureMagnificationFilter,TextureMinificationFilter,TextureWrap,VertexArray}=mars3d__namespace[_0x15ab6e(0x30,-0x5d)];class WindParticlesRendering{constructor(_0x5bb76b,_0x43757f,_0x301ea3,_0x4f6aa4){function _0x54b928(_0x15fd8e,_0x1c1a1f){return _0x398695(_0x1c1a1f,_0x15fd8e- -0x2ef);}this[_0x4f0e75(0x90,0xcc)]=_0x5bb76b,this[_0x4f0e75(0x10a,0xb9)]=_0x43757f,this['viewerParameters']=_0x301ea3,this[_0x54b928(-0x191,-0x14a)]=_0x4f6aa4;(typeof this['options']['particlesTextureSize']!==_0x4f0e75(0x21,0x61)||this['options']['particlesTextureSize']<=0x0)&&(console['error']('Invalid\x20particlesTextureSize.\x20Using\x20default\x20value\x20of\x20256.'),this[_0x54b928(-0x13e,-0x178)][_0x4f0e75(-0x97,-0xf)]=0x100);function _0x4f0e75(_0x19687c,_0x2d9a01){return _0x398695(_0x19687c,_0x2d9a01- -0xf8);}this[_0x54b928(-0x113,-0x86)]=this[_0x4f0e75(0x2a,0x77)](),this['textures']=this[_0x4f0e75(0xca,0xd1)](),this[_0x54b928(-0x1cf,-0x149)]=this['createRenderingFramebuffers'](),this['primitives']=this[_0x54b928(-0x12d,-0xb3)]();}['createRenderingTextures'](){const _0x133b7a={};_0x133b7a[_0xea23d5(0xd5,0x11c)]=this['context'],_0x133b7a['width']=this[_0x18fe05(0x147,0x16f)]['drawingBufferWidth'],_0x133b7a['height']=this['context']['drawingBufferHeight'],_0x133b7a[_0x18fe05(0x85,0x102)]=PixelFormat['RGBA'];function _0x18fe05(_0x50e41e,_0x4132b6){return _0x15ab6e(_0x4132b6-0x69,_0x50e41e);}_0x133b7a['pixelDatatype']=PixelDatatype['UNSIGNED_BYTE'];const _0x55b34f=_0x133b7a,_0x5afd62={};_0x5afd62['context']=this['context'],_0x5afd62['width']=this[_0xea23d5(0x125,0x11c)]['drawingBufferWidth'],_0x5afd62[_0xea23d5(0x78,0xa4)]=this['context']['drawingBufferHeight'];function _0xea23d5(_0x32aecc,_0x4006f9){return _0x398695(_0x32aecc,_0x4006f9- -0xa8);}_0x5afd62['pixelFormat']=PixelFormat['DEPTH_COMPONENT'],_0x5afd62['pixelDatatype']=PixelDatatype['UNSIGNED_INT'];const _0x541969=_0x5afd62;return{'segmentsColor':new Texture(_0x55b34f),'segmentsDepth':new Texture(_0x541969)};}['createRenderingFramebuffers'](){const _0x1e16dc={};_0x1e16dc['context']=this['context'];function _0x4244b5(_0x1ff0e2,_0x474998){return _0x398695(_0x1ff0e2,_0x474998- -0x393);}function _0x9c718d(_0x30a824,_0x3452f5){return _0x15ab6e(_0x3452f5- -0x1b1,_0x30a824);}return _0x1e16dc[_0x4244b5(-0x23f,-0x2ab)]=[this[_0x4244b5(-0x262,-0x271)]['segmentsColor']],_0x1e16dc['depthTexture']=this[_0x4244b5(-0x213,-0x271)]['segmentsDepth'],{'segments':new Framebuffer(_0x1e16dc)};}[_0x398695(0xc1,0x13f)](){function _0x578acf(_0x27aba0,_0x2c1c4c){return _0x15ab6e(_0x2c1c4c-0x31f,_0x27aba0);}function _0x200f6f(_0x2b4655,_0x4dc0bd){return _0x15ab6e(_0x4dc0bd- -0x2e0,_0x2b4655);}Object['values'](this[_0x578acf(0x3c7,0x381)])[_0x200f6f(-0x1f4,-0x22b)](_0x35e202=>{function _0x2a1502(_0x3f5bc3,_0x15072c){return _0x200f6f(_0x15072c,_0x3f5bc3-0x718);}_0x35e202[_0x2a1502(0x4ee,0x566)]();});}['createColorTableTexture'](){const _0x2f79de=new Float32Array(this[_0x11564b(-0x19e,-0x1f8)]['colors']['flatMap'](_0x1a7449=>{const _0x7d8682=Color$1[_0x21f502(0x2fd,0x2f5)](_0x1a7449);function _0x21f502(_0x480de3,_0x2119d8){return _0x11564b(_0x480de3-0x54c,_0x2119d8);}function _0x1c2a69(_0xa76b91,_0x4eddfc){return _0x11564b(_0x4eddfc-0x40c,_0xa76b91);}return[_0x7d8682['red'],_0x7d8682[_0x1c2a69(0x2fd,0x288)],_0x7d8682[_0x1c2a69(0x219,0x28d)],_0x7d8682['alpha']];})),_0x318e80={};_0x318e80[_0x56a851(-0x229,-0x25f)]=TextureMinificationFilter[_0x11564b(-0x196,-0x174)],_0x318e80['magnificationFilter']=TextureMagnificationFilter[_0x56a851(-0x1f9,-0x1aa)];function _0x56a851(_0x2961d9,_0x52c902){return _0x398695(_0x2961d9,_0x52c902- -0x363);}function _0x11564b(_0x2617f9,_0x4da521){return _0x15ab6e(_0x2617f9- -0x291,_0x4da521);}return _0x318e80[_0x11564b(-0x1a3,-0x1c3)]=TextureWrap['CLAMP_TO_EDGE'],_0x318e80['wrapT']=TextureWrap['CLAMP_TO_EDGE'],new Texture({'context':this[_0x11564b(-0x18b,-0x1ff)],'width':this[_0x11564b(-0x19e,-0x1dd)][_0x56a851(-0x250,-0x232)][_0x11564b(-0x24a,-0x25b)],'height':0x1,'pixelFormat':PixelFormat['RGBA'],'pixelDatatype':PixelDatatype['FLOAT'],'sampler':new Sampler(_0x318e80),'source':{'width':this[_0x56a851(-0x19d,-0x1b2)]['colors']['length'],'height':0x1,'arrayBufferView':_0x2f79de}});}['createSegmentsGeometry'](){const _0x1939dd=0x4,_0x4dfa43=this['options'][_0x505578(0x1aa,0x12d)];let _0x320d57=[];for(let _0x127c93=0x0;_0x127c93<_0x4dfa43;_0x127c93++){for(let _0x105002=0x0;_0x105002<_0x4dfa43;_0x105002++){for(let _0x278fb4=0x0;_0x278fb4<_0x1939dd;_0x278fb4++){_0x320d57['push'](_0x127c93/_0x4dfa43),_0x320d57['push'](_0x105002/_0x4dfa43);}}}_0x320d57=new Float32Array(_0x320d57);const _0x4616ae=this['options']['particlesTextureSize']**0x2;let _0x200531=[];for(let _0x509558=0x0;_0x509558<_0x4616ae;_0x509558++){_0x200531[_0x505578(0x1de,0x162)](-0x1,-0x1,0x0,-0x1,0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0);}_0x200531=new Float32Array(_0x200531);let _0x9df722=[];for(let _0x1a416f=0x0,_0x115261=0x0;_0x1a416f<_0x4616ae;_0x1a416f++){_0x9df722['push'](_0x115261+0x0,_0x115261+0x1,_0x115261+0x2,_0x115261+0x2,_0x115261+0x1,_0x115261+0x3),_0x115261+=_0x1939dd;}_0x9df722=new Uint32Array(_0x9df722);const _0x7bd305={};_0x7bd305[_0x505578(0x10f,0x150)]=ComponentDatatype['FLOAT'];function _0x505578(_0x37bf51,_0x5c650f){return _0x15ab6e(_0x5c650f-0x102,_0x37bf51);}_0x7bd305['componentsPerAttribute']=0x2;function _0x18271d(_0x5049bf,_0x3f96ef){return _0x15ab6e(_0x5049bf-0x31e,_0x3f96ef);}_0x7bd305[_0x505578(0xc9,0x128)]=_0x320d57;const _0x1f3405={};_0x1f3405[_0x505578(0x19b,0x150)]=ComponentDatatype['FLOAT'],_0x1f3405['componentsPerAttribute']=0x3,_0x1f3405['values']=_0x200531;const _0xdeb8cd=new Geometry({'attributes':new GeometryAttributes({'st':new GeometryAttribute(_0x7bd305),'normal':new GeometryAttribute(_0x1f3405)}),'indices':_0x9df722});return _0xdeb8cd;}['createRawRenderState'](_0x1574dd){const _0x5c5e82={'viewport':undefined,'depthTest':undefined,'depthMask':undefined,'blending':undefined,..._0x1574dd};return Appearance['getDefaultRenderState'](!![],![],_0x5c5e82);}[_0x15ab6e(0x104,0x133)](){const _0xd5750d={};_0xd5750d['st']=0x0,_0xd5750d[_0xc04982(-0xc6,-0x57)]=0x1;const _0x1c8cb5={};_0x1c8cb5['enabled']=!![];const _0x1416a0={};function _0x2fc94b(_0x394576,_0x2426be){return _0x15ab6e(_0x2426be-0x482,_0x394576);}function _0xc04982(_0x54a3c9,_0x2839aa){return _0x398695(_0x54a3c9,_0x2839aa- -0x18f);}_0x1416a0[_0x2fc94b(0x5cc,0x542)]=!![],_0x1416a0['blendEquation']=WebGLRenderingContext[_0xc04982(-0xd8,-0x89)],_0x1416a0['blendFuncSource']=WebGLRenderingContext['SRC_ALPHA'],_0x1416a0['blendFuncDestination']=WebGLRenderingContext['ONE_MINUS_SRC_ALPHA'];const _0x14d908={};_0x14d908['viewport']=undefined,_0x14d908[_0x2fc94b(0x5b3,0x549)]=_0x1c8cb5,_0x14d908[_0x2fc94b(0x587,0x54f)]=!![],_0x14d908['blending']=_0x1416a0;const _0x326633=new CustomPrimitive({'commandType':_0x2fc94b(0x53d,0x4be),'attributeLocations':_0xd5750d,'geometry':this['createSegmentsGeometry'](),'primitiveType':PrimitiveType[_0xc04982(-0x125,-0x99)],'uniformMap':{'previousParticlesPosition':()=>this['computing']['particlesTextures']['previousParticlesPosition'],'currentParticlesPosition':()=>this[_0xc04982(-0x88,-0x31)]['particlesTextures'][_0x2fc94b(0x4d1,0x4d8)],'postProcessingPosition':()=>this['computing'][_0xc04982(-0x64,0xb)]['postProcessingPosition'],'particlesSpeed':()=>this['computing']['particlesTextures'][_0x2fc94b(0x586,0x50a)],'frameRateAdjustment':()=>this['computing']['frameRateAdjustment'],'colorTable':()=>this[_0xc04982(0xb7,0x4d)],'domain':()=>{function _0x2b4b20(_0x249b78,_0x60686){return _0xc04982(_0x249b78,_0x60686-0x249);}function _0x1b18f8(_0x30981a,_0x476112){return _0x2fc94b(_0x30981a,_0x476112- -0x16e);}var _0xae89c,_0x373d9b;const _0x41a01f=new Cartesian2(((_0xae89c=this['options']['domain'])===null||_0xae89c===void 0x0?void 0x0:_0xae89c['min'])??this[_0x1b18f8(0x3b7,0x3b4)][_0x1b18f8(0x424,0x3f7)]['speed'][_0x2b4b20(0x217,0x20d)],((_0x373d9b=this['options']['domain'])===null||_0x373d9b===void 0x0?void 0x0:_0x373d9b['max'])??this[_0x1b18f8(0x34e,0x3b4)][_0x1b18f8(0x382,0x3f7)][_0x1b18f8(0x411,0x3eb)]['max']);return _0x41a01f;},'displayRange':()=>{function _0x124c8c(_0x209fb9,_0x438c02){return _0xc04982(_0x438c02,_0x209fb9-0x95);}var _0x4d1ef1,_0x2c6c9b;function _0x157381(_0x3016ad,_0x147640){return _0xc04982(_0x3016ad,_0x147640- -0x102);}const _0x7bb61f=new Cartesian2(((_0x4d1ef1=this[_0x124c8c(0xb7,0x6a)]['displayRange'])===null||_0x4d1ef1===void 0x0?void 0x0:_0x4d1ef1[_0x124c8c(0x59,0xd1)])??this['computing'][_0x157381(-0xe5,-0xf0)]['speed']['min'],((_0x2c6c9b=this['options'][_0x124c8c(0xb5,0x11e)])===null||_0x2c6c9b===void 0x0?void 0x0:_0x2c6c9b[_0x124c8c(0x101,0x114)])??this['computing'][_0x157381(-0x6c,-0xf0)]['speed']['max']);return _0x7bb61f;},'particleHeight':()=>this[_0x2fc94b(0x568,0x575)]['fixedHeight']||0x0,'aspect':()=>this[_0x2fc94b(0x588,0x588)]['drawingBufferWidth']/this['context']['drawingBufferHeight'],'pixelSize':()=>this['viewerParameters']['pixelSize'],'lineWidth':()=>{const _0x3d8a1c={};_0x3d8a1c['min']=0x1,_0x3d8a1c['max']=0x2;const _0x378246=this['options']['lineWidth']||_0x3d8a1c;function _0x2fd1fb(_0xef949b,_0x2edc2f){return _0x2fc94b(_0x2edc2f,_0xef949b- -0x4bd);}return new Cartesian2(_0x378246[_0x2fd1fb(0x5a,0x42)],_0x378246['max']);},'lineLength':()=>{function _0x45e6e6(_0x5304e0,_0x20bc8b){return _0x2fc94b(_0x20bc8b,_0x5304e0- -0x727);}const _0x172c07={};_0x172c07['min']=0x14,_0x172c07[_0x45e6e6(-0x168,-0x1d3)]=0x64;function _0x121970(_0x3cdcaa,_0x4f3a6b){return _0x2fc94b(_0x3cdcaa,_0x4f3a6b- -0x45f);}const _0x5114f6=this['options'][_0x121970(0x76,0x9a)]||_0x172c07;return new Cartesian2(_0x5114f6[_0x121970(0xba,0xb8)],_0x5114f6['max']);},'is3D':()=>this['viewerParameters'][_0x2fc94b(0x52e,0x50d)]===SceneMode['SCENE3D'],'segmentsDepthTexture':()=>this[_0x2fc94b(0x495,0x4e6)][_0x2fc94b(0x534,0x576)]},'vertexShaderSource':ShaderManager['getSegmentDrawVertexShader'](),'fragmentShaderSource':ShaderManager['getSegmentDrawFragmentShader'](),'rawRenderState':this[_0x2fc94b(0x526,0x4ec)](_0x14d908)}),_0x2e3b1b={};return _0x2e3b1b['segments']=_0x326633,_0x2e3b1b;}['onParticlesTextureSizeChange'](){function _0x3f1164(_0x584524,_0x5e1580){return _0x398695(_0x584524,_0x5e1580-0x1a7);}const _0x2cf5ab=this[_0x8b911d(0x5e8,0x5d6)]();this['primitives'][_0x8b911d(0x587,0x576)][_0x8b911d(0x4f8,0x47c)]=_0x2cf5ab;function _0x8b911d(_0x3604f7,_0x547c0e){return _0x398695(_0x547c0e,_0x3604f7-0x403);}const _0x3f408a={};_0x3f408a[_0x3f1164(0x31c,0x36b)]=this[_0x8b911d(0x5c7,0x543)],_0x3f408a['geometry']=_0x2cf5ab,_0x3f408a[_0x8b911d(0x53f,0x4db)]=this['primitives']['segments'][_0x8b911d(0x53f,0x4f0)],_0x3f408a['bufferUsage']=BufferUsage['STATIC_DRAW'];const _0x31b86a=VertexArray['fromGeometry'](_0x3f408a);this['primitives'][_0x8b911d(0x587,0x596)]['commandToExecute']&&(this[_0x3f1164(0x2ad,0x2d7)][_0x8b911d(0x587,0x5d2)]['commandToExecute']['vertexArray']=_0x31b86a);}[_0x398695(0x10d,0x121)](){function _0x9e740d(_0x12705c,_0x26d4a0){return _0x398695(_0x26d4a0,_0x12705c-0x371);}this[_0x9e740d(0x54d,0x523)][_0x35bfbb(-0x23a,-0x1d1)]();function _0x35bfbb(_0xb56075,_0x3114ea){return _0x398695(_0x3114ea,_0xb56075- -0x3ae);}this[_0x35bfbb(-0x1d2,-0x15d)]=this[_0x35bfbb(-0x23f,-0x247)]();}['updateOptions'](_0x17a9a0){function _0x4b7a55(_0x2c3af0,_0x5e7af7){return _0x15ab6e(_0x5e7af7-0xcc,_0x2c3af0);}const _0x567670=_0x17a9a0['colors']&&JSON[_0x4b7a55(0x1b3,0x191)](_0x17a9a0[_0x4b7a55(0x1b1,0x13f)])!==JSON['stringify'](this['options'][_0x4b7a55(0xec,0x13f)]);this['options']=deepMerge(_0x17a9a0,this['options']);function _0x543f3f(_0x4e5989,_0x16ca15){return _0x398695(_0x16ca15,_0x4e5989-0x56);}_0x567670&&this['onColorTableChange']();}['destroy'](){Object[_0x2d6b30(-0x1df,-0x1e9)](this['framebuffers'])[_0x3c2349(-0x1cb,-0x201)](_0xf56b2d=>{_0xf56b2d['destroy']();}),Object[_0x2d6b30(-0x243,-0x1e9)](this['primitives'])['forEach'](_0x560d32=>{function _0x1a4f58(_0x26fc89,_0x222542){return _0x2d6b30(_0x26fc89,_0x222542-0x39e);}_0x560d32[_0x1a4f58(0x1ff,0x245)]();});function _0x2d6b30(_0x2102dd,_0x14abce){return _0x15ab6e(_0x14abce- -0x20f,_0x2102dd);}function _0x3c2349(_0xd43c2f,_0x179286){return _0x15ab6e(_0x179286- -0x2b6,_0xd43c2f);}this['colorTable']['destroy']();}}const {ClearCommand,Color,Pass}=mars3d__namespace[_0x15ab6e(0x30,-0x1f)];function _0x37a8(){const _0x1ec604=['destroyParticlesTextures','wheel','particlesSpeed','xmin','maxAge','sceneMode','xmax','ymin','height','getCalculateSpeedShader','DomUtil','umin','frameState.commandList\x20is\x20undefined','99630FSfUiF','onmessage','min','rows','alt','lng','pixelFormat','clearFramebuffers','number','clearCommand','vmin','_onMouseDownEvent','positionWC','computing','lighter','resize','1439361obyhuB','magnificationFilter','refreshTimer','fillRect','viewerParameters','fragmentShaderSource','nextParticlesPosition','getSegmentDrawFragmentShader','width','toRadians','lastFramesPerSecond','show','postMessage','bounds','createColorTableTexture','left','pointerEvents','update','forEach','destroy','_onMapWhellEvent','getUVByXY','1063880gmFxGF','1ZggDHN','strokeStyle','warn','Math','lineTo','wind','enabled','pointer-events','_removedHook','min\x20is\x20undefined,\x20calculate\x20min','requestRender','stringify','segments','depthTest','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20获取当前粒子的位置\x0a\x20\x20vec2\x20currentPos\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20获取粒子的速度\x0a\x20\x20vec2\x20speed\x20=\x20texture(particlesSpeed,\x20v_textureCoordinates).rg;\x0a\x20\x20\x20\x20//\x20计算下一个位置\x0a\x20\x20vec2\x20nextPos\x20=\x20currentPos\x20+\x20speed;\x0a\x0a\x20\x20\x20\x20//\x20将新的位置写入\x20fragColor\x0a\x20\x20fragColor\x20=\x20vec4(nextPos,\x200.0f,\x201.0f);\x0a}\x0a','fromGeometry','previousParticlesPosition','register','worker','depthMask','clientHeight','OPAQUE','50491CNavyd','mode','age','color','style','updateWindData','cols','speed','pixelSize','grid','particles','WindUtil','particlesTextures','canvasContext','_speedRate','data','isDynamic','removeEventListener','addEventListener','windData','Cartesian2','willReadFrequently','create','NEAREST','windField','original','_calc_speedRate','primitiveType','Compute','tlat','wrapS','getPrimitives','__esModule','displayRange','_randomParticle','options','segmentsDepth','talt','type','useViewerBounds','array','#version\x20300\x20es\x0aprecision\x20highp\x20float;\x0a\x0ain\x20vec2\x20st;\x0ain\x20vec3\x20normal;\x0a\x0auniform\x20sampler2D\x20previousParticlesPosition;\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20particlesSpeed;\x0a\x0auniform\x20float\x20frameRateAdjustment;\x0auniform\x20float\x20particleHeight;\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20vec2\x20lineWidth;\x0auniform\x20vec2\x20lineLength;\x0auniform\x20vec2\x20domain;\x0auniform\x20bool\x20is3D;\x0a\x0a//\x20添加输出变量传递给片元着色器\x0aout\x20vec4\x20speed;\x0aout\x20float\x20v_segmentPosition;\x0aout\x20vec2\x20textureCoordinate;\x0a\x0a//\x20添加结构体定义\x0astruct\x20adjacentPoints\x20{\x0a\x20\x20vec4\x20previous;\x0a\x20\x20vec4\x20current;\x0a\x20\x20vec4\x20next;\x0a};\x0a\x0avec3\x20convertCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20read\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20float\x20a\x20=\x206378137.0f;\x20//\x20Semi-major\x20axis\x0a\x20\x20float\x20b\x20=\x206356752.3142f;\x20//\x20Semi-minor\x20axis\x0a\x20\x20float\x20e2\x20=\x206.69437999014e-3f;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x20\x20float\x20longitude\x20=\x20radians(lonLat.x);\x0a\x0a\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0f\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0f);\x0a\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calculateProjectedCoordinate(vec2\x20lonLat)\x20{\x0a\x20\x20if(is3D)\x20{\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLat);\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20使用\x20modelViewProjection\x20矩阵进行投影变换\x0a\x20\x20\x20\x20vec4\x20projectedPosition\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0f);\x0a\x20\x20\x20\x20return\x20projectedPosition;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20vec3\x20position2D\x20=\x20vec3(radians(lonLat.x),\x20radians(lonLat.y),\x200.0f);\x0a\x20\x20\x20\x20return\x20czm_modelViewProjection\x20*\x20vec4(position2D,\x201.0f);\x0a\x20\x20}\x0a}\x0a\x0avec4\x20calculateOffsetOnNormalDirection(vec4\x20pointA,\x20vec4\x20pointB,\x20float\x20offsetSign,\x20float\x20widthFactor)\x20{\x0a\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0f);\x0a\x20\x20vec2\x20pointA_XY\x20=\x20(pointA.xy\x20/\x20pointA.w)\x20*\x20aspectVec2;\x0a\x20\x20vec2\x20pointB_XY\x20=\x20(pointB.xy\x20/\x20pointB.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20//\x20计算方向向量\x0a\x20\x20vec2\x20direction\x20=\x20normalize(pointB_XY\x20-\x20pointA_XY);\x0a\x0a\x20\x20\x20\x20//\x20计算法向量\x0a\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x0a\x20\x20\x20\x20//\x20使用\x20widthFactor\x20调整宽度\x0a\x20\x20float\x20offsetLength\x20=\x20widthFactor\x20*\x20lineWidth.y;\x0a\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0f,\x200.0f);\x0a\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20翻转\x20Y\x20轴坐标\x0a\x20\x20vec2\x20flippedIndex\x20=\x20vec2(st.x,\x201.0f\x20-\x20st.y);\x0a\x0a\x20\x20vec2\x20particleIndex\x20=\x20flippedIndex;\x0a\x20\x20speed\x20=\x20texture(particlesSpeed,\x20particleIndex);\x0a\x0a\x20\x20vec2\x20previousPosition\x20=\x20texture(previousParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rg;\x0a\x20\x20vec2\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex).rg;\x0a\x0a\x20\x20float\x20isAnyRandomPointUsed\x20=\x20texture(postProcessingPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(currentParticlesPosition,\x20particleIndex).a\x20+\x0a\x20\x20\x20\x20texture(previousParticlesPosition,\x20particleIndex).a;\x0a\x0a\x20\x20adjacentPoints\x20projectedCoordinates;\x0a\x20\x20if(isAnyRandomPointUsed\x20>\x200.0f)\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20projectedCoordinates.previous;\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20projectedCoordinates.previous;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20projectedCoordinates.previous\x20=\x20calculateProjectedCoordinate(previousPosition);\x0a\x20\x20\x20\x20projectedCoordinates.current\x20=\x20calculateProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20projectedCoordinates.next\x20=\x20calculateProjectedCoordinate(nextPosition);\x0a\x20\x20}\x0a\x0a\x20\x20int\x20pointToUse\x20=\x20int(normal.x);\x0a\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x20\x20vec4\x20offset\x20=\x20vec4(0.0f);\x0a\x0a\x20\x20\x20\x20//\x20计算速度相关的宽度和长度因子\x0a\x20\x20float\x20speedLength\x20=\x20clamp(speed.b,\x20domain.x,\x20domain.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(speedLength\x20-\x20domain.x)\x20/\x20(domain.y\x20-\x20domain.x);\x0a\x0a\x20\x20\x20\x20//\x20根据速度计算宽度\x0a\x20\x20float\x20widthFactor\x20=\x20mix(lineWidth.x,\x20lineWidth.y,\x20normalizedSpeed);\x0a\x20\x20widthFactor\x20*=\x20(pointToUse\x20<\x200\x20?\x201.0f\x20:\x200.5f);\x20//\x20头部更宽，尾部更窄\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20length\x20based\x20on\x20speed\x0a\x20\x20float\x20lengthFactor\x20=\x20mix(lineLength.x,\x20lineLength.y,\x20normalizedSpeed)\x20*\x20pixelSize;\x0a\x0a\x20\x20if(pointToUse\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20头部位置\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.previous,\x20projectedCoordinates.current,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20projectedCoordinates.previous\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x200.0f;\x20//\x20头部\x0a\x20\x20}\x20else\x20if(pointToUse\x20==\x20-1)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20//\x20Get\x20direction\x20and\x20normalize\x20it\x20to\x20length\x201.0\x0a\x20\x20\x20\x20vec4\x20direction\x20=\x20normalize(projectedCoordinates.next\x20-\x20projectedCoordinates.current);\x0a\x20\x20\x20\x20vec4\x20extendedPosition\x20=\x20projectedCoordinates.current\x20+\x20direction\x20*\x20lengthFactor;\x0a\x0a\x20\x20\x20\x20offset\x20=\x20pixelSize\x20*\x20calculateOffsetOnNormalDirection(projectedCoordinates.current,\x20extendedPosition,\x20offsetSign,\x20widthFactor);\x0a\x20\x20\x20\x20gl_Position\x20=\x20extendedPosition\x20+\x20offset;\x0a\x20\x20\x20\x20v_segmentPosition\x20=\x201.0f;\x20//\x20尾部\x0a\x20\x20}\x0a\x0a\x20\x20textureCoordinate\x20=\x20st;\x0a}\x0a','outputTexture','LINEAR','RGBA','top','floor','12QYRmmW','canvasHeight','sources','flipY','speedRate','createPrimitives','steps','context','dynamic','cancelAnimationFrame','framebuffer','_createCanvas','createRenderingTextures','shaderProgram','green','frameRateMonitor','changed','toDegrees','longitude','blue','call','_tomap','off','processWindData','isInExtent','getU','EventType','scene','defineProperty','speedFactor','mouseHidden','colorTable','ymax','getRandomLatLng','clear','layer','updatePosition','getUVByPoint','all','mouseMove','createSegmentsGeometry','_updateIng','147494nZvBnf','preExecute','LayerUtil','getParticles','vertexShaderSource','redraw','uniformMap','init','south','postProcessingPosition','BaseLayer','_bilinearInterpolation','particleSystem','fixedHeight','fromCache','tlng','_drawLines','udata','_addedHook','globalAlpha','max','_canrefresh','values','_onMouseMoveEvent','stroke','_calcUV','colorTextures','particlesTextureSize','PointTrans','#version\x20300\x20es\x0a\x0a//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec2\x20uRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20vRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20speedRange;\x20//\x20(min,\x20max)\x0auniform\x20vec2\x20dimension;\x20//\x20(lon,\x20lat)\x0auniform\x20vec2\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec2\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0a\x0auniform\x20float\x20speedScaleFactor;\x0auniform\x20float\x20frameRateAdjustment;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20getInterval(vec2\x20maximum,\x20vec2\x20minimum,\x20vec2\x20dimension)\x20{\x0a\x20\x20return\x20(maximum\x20-\x20minimum)\x20/\x20(dimension\x20-\x201.0f);\x0a}\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20lonLat.x\x20=\x20clamp(lonLat.x,\x20minimum.x,\x20maximum.x);\x0a\x20\x20lonLat.y\x20=\x20clamp(lonLat.y,\x20minimum.y,\x20maximum.y);\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20vec2\x20index2D\x20=\x20vec2(0.0f);\x0a\x20\x20index2D.x\x20=\x20(lonLat.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20index2D.y\x20=\x20(lonLat.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20dimension.y);\x0a\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWindComponent(sampler2D\x20componentTexture,\x20vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20result\x20=\x20texture(componentTexture,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20result;\x0a}\x0a\x0avec2\x20getWindComponents(vec2\x20lonLat)\x20{\x0a\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLat);\x0a\x20\x20float\x20u\x20=\x20texture(U,\x20normalizedIndex2D).r;\x0a\x20\x20float\x20v\x20=\x20texture(V,\x20normalizedIndex2D).r;\x0a\x20\x20return\x20vec2(u,\x20v);\x0a}\x0a\x0avec2\x20bilinearInterpolation(vec2\x20lonLat)\x20{\x0a\x20\x20float\x20lon\x20=\x20lonLat.x;\x0a\x20\x20float\x20lat\x20=\x20lonLat.y;\x0a\x0a\x20\x20vec2\x20interval\x20=\x20getInterval(maximum,\x20minimum,\x20dimension);\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20grid\x20cell\x20coordinates\x0a\x20\x20float\x20lon0\x20=\x20floor(lon\x20/\x20interval.x)\x20*\x20interval.x;\x0a\x20\x20float\x20lon1\x20=\x20lon0\x20+\x20interval.x;\x0a\x20\x20float\x20lat0\x20=\x20floor(lat\x20/\x20interval.y)\x20*\x20interval.y;\x0a\x20\x20float\x20lat1\x20=\x20lat0\x20+\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Get\x20wind\x20vectors\x20at\x20four\x20corners\x0a\x20\x20vec2\x20v00\x20=\x20getWindComponents(vec2(lon0,\x20lat0));\x0a\x20\x20vec2\x20v10\x20=\x20getWindComponents(vec2(lon1,\x20lat0));\x0a\x20\x20vec2\x20v01\x20=\x20getWindComponents(vec2(lon0,\x20lat1));\x0a\x20\x20vec2\x20v11\x20=\x20getWindComponents(vec2(lon1,\x20lat1));\x0a\x0a\x20\x20\x20\x20//\x20Check\x20if\x20all\x20wind\x20vectors\x20are\x20zero\x0a\x20\x20if(length(v00)\x20==\x200.0f\x20&&\x20length(v10)\x20==\x200.0f\x20&&\x20length(v01)\x20==\x200.0f\x20&&\x20length(v11)\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f,\x200.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20interpolation\x20weights\x0a\x20\x20float\x20s\x20=\x20(lon\x20-\x20lon0)\x20/\x20interval.x;\x0a\x20\x20float\x20t\x20=\x20(lat\x20-\x20lat0)\x20/\x20interval.y;\x0a\x0a\x20\x20\x20\x20//\x20Perform\x20bilinear\x20interpolation\x20on\x20vector\x20components\x0a\x20\x20vec2\x20v0\x20=\x20mix(v00,\x20v10,\x20s);\x0a\x20\x20vec2\x20v1\x20=\x20mix(v01,\x20v11,\x20s);\x0a\x20\x20return\x20mix(v0,\x20v1,\x20t);\x0a}\x0a\x0avec2\x20lengthOfLonLat(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20float\x20latitude\x20=\x20radians(lonLat.y);\x0a\x0a\x20\x20float\x20term1\x20=\x20111132.92f;\x0a\x20\x20float\x20term2\x20=\x20559.82f\x20*\x20cos(2.0f\x20*\x20latitude);\x0a\x20\x20float\x20term3\x20=\x201.175f\x20*\x20cos(4.0f\x20*\x20latitude);\x0a\x20\x20float\x20term4\x20=\x200.0023f\x20*\x20cos(6.0f\x20*\x20latitude);\x0a\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20float\x20term5\x20=\x20111412.84f\x20*\x20cos(latitude);\x0a\x20\x20float\x20term6\x20=\x2093.5f\x20*\x20cos(3.0f\x20*\x20latitude);\x0a\x20\x20float\x20term7\x20=\x200.118f\x20*\x20cos(5.0f\x20*\x20latitude);\x0a\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avec2\x20convertSpeedUnitToLonLat(vec2\x20lonLat,\x20vec2\x20speed)\x20{\x0a\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLat);\x0a\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20vec2\x20windVectorInLonLat\x20=\x20vec2(u,\x20v);\x0a\x0a\x20\x20return\x20windVectorInLonLat;\x0a}\x0a\x0avec2\x20calculateSpeedByRungeKutta2(vec2\x20lonLat)\x20{\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages\x20for\x20detail\x0a\x20\x20const\x20float\x20h\x20=\x200.5f;\x0a\x0a\x20\x20vec2\x20y_n\x20=\x20lonLat;\x0a\x20\x20vec2\x20f_n\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20midpoint\x20=\x20y_n\x20+\x200.5f\x20*\x20h\x20*\x20convertSpeedUnitToLonLat(y_n,\x20f_n)\x20*\x20speedScaleFactor;\x0a\x20\x20vec2\x20speed\x20=\x20h\x20*\x20bilinearInterpolation(midpoint)\x20*\x20speedScaleFactor;\x0a\x0a\x20\x20return\x20speed;\x0a}\x0a\x0avec2\x20calculateWindNorm(vec2\x20speed)\x20{\x0a\x20\x20float\x20speedLength\x20=\x20length(speed.xy);\x0a\x20\x20if(speedLength\x20==\x200.0f)\x20{\x0a\x20\x20\x20\x20return\x20vec2(0.0f);\x0a\x20\x20}\x0a\x0a\x20\x20\x20\x20//\x20Clamp\x20speedLength\x20to\x20range\x0a\x20\x20float\x20clampedSpeed\x20=\x20clamp(speedLength,\x20speedRange.x,\x20speedRange.y);\x0a\x20\x20float\x20normalizedSpeed\x20=\x20(clampedSpeed\x20-\x20speedRange.x)\x20/\x20(speedRange.y\x20-\x20speedRange.x);\x0a\x20\x20return\x20vec2(speedLength,\x20normalizedSpeed);\x0a}\x0a\x0aout\x20vec4\x20fragColor;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20vec2\x20lonLat\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rg;\x0a\x20\x20vec2\x20speedOrigin\x20=\x20bilinearInterpolation(lonLat);\x0a\x20\x20vec2\x20speed\x20=\x20calculateSpeedByRungeKutta2(lonLat)\x20*\x20frameRateAdjustment;\x0a\x20\x20vec2\x20speedInLonLat\x20=\x20convertSpeedUnitToLonLat(lonLat,\x20speed);\x0a\x0a\x20\x20fragColor\x20=\x20vec4(speedInLonLat,\x20calculateWindNorm(speedOrigin));\x0a}\x0a','getSpeed','createParticlesTextures','Cesium','north','_pointerEvents','percentageChanged','createComputingPrimitives','vertexArray','auto','geometry','TRIANGLES','east','_colorRamp','156UzsTzp','Draw','absolute','SCENE3D','236331xfkXQW','_map','updateViewerParameters','fromCssColorString','updateOptions','camera','commandType','minificationFilter','length','FUNC_ADD','clientWidth','hidden','random','west','setData','componentDatatype','1188235eYBmpK','visibility','getPostProcessingPositionShader','getOwnPropertyDescriptor','_setOptionsHook','bindEvent','initFrameRate','currentParticlesPosition','253NXvpAD','FLOAT','canvasWidth','keys','getV','frameRateAdjustment','log','abs','morphComplete','push','unbindEvent','framebuffers','onColorTableChange','textures','rendering','mouseUp','bufferUsage','windTextures','getSegmentDrawVertexShader','createRawRenderState','MIN_VALUE','bind','globalCompositeOperation','CanvasWindLayer','mouse_down','cartesianToCartographic','pass','primitives','colors','setOptions','commandToExecute','quietPeriod','lineLength','remove','none','normal','canvas','frameRate','ellipsoid','attributeLocations','calculateSpeed','destination-in','destoryRenderingFramebuffers','fromDegrees','lat','beginPath','dropRate'];_0x37a8=function(){return _0x1ec604;};return _0x37a8();}class WindParticleSystem{constructor(_0x1839d8,_0x3eb996,_0x3144b6,_0x5c6878,_0x20ad42){function _0x54ccc4(_0x1dc9aa,_0x519a45){return _0x15ab6e(_0x519a45-0x83,_0x1dc9aa);}this['context']=_0x1839d8;function _0x406cd2(_0x23b299,_0x41adb2){return _0x15ab6e(_0x41adb2- -0x2be,_0x23b299);}this[_0x54ccc4(0x19f,0x176)]=_0x3144b6,this['viewerParameters']=_0x5c6878,this['computing']=new WindParticlesComputing(_0x1839d8,_0x3eb996,_0x3144b6,_0x5c6878,_0x20ad42),this['rendering']=new WindParticlesRendering(_0x1839d8,_0x3144b6,_0x5c6878,this[_0x54ccc4(0x120,0x123)]),this[_0x406cd2(-0x200,-0x224)]();}[_0x15ab6e(0xef,0xab)](){function _0x46e53e(_0x3e1557,_0x394f12){return _0x398695(_0x3e1557,_0x394f12- -0x1d8);}function _0x270d9f(_0x2da266,_0x375195){return _0x15ab6e(_0x2da266-0x319,_0x375195);}const _0x34b6b9=[this[_0x46e53e(-0x4e,-0x7a)]['primitives']['calculateSpeed'],this['computing']['primitives'][_0x46e53e(-0x13,0x9)],this[_0x270d9f(0x3b9,0x401)][_0x46e53e(-0xf1,-0xa8)][_0x46e53e(0x1b,0x18)],this[_0x46e53e(-0x112,-0xb5)]['primitives'][_0x270d9f(0x3df,0x384)]];return _0x34b6b9;}[_0x398695(0xd2,0x158)](){const _0x198ddb=new ClearCommand({'color':new Color(0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Pass[_0x587de0(0x25f,0x1ec)]});function _0x2c7850(_0x3622b9,_0x2e1f5e){return _0x15ab6e(_0x3622b9-0x149,_0x2e1f5e);}function _0x587de0(_0x44652b,_0x97159c){return _0x398695(_0x44652b,_0x97159c-0x5f);}Object[_0x587de0(0x16d,0x177)](this['rendering']['framebuffers'])['forEach'](_0x321779=>{function _0x1fe219(_0x3516b3,_0x4b73af){return _0x587de0(_0x3516b3,_0x4b73af-0x254);}_0x198ddb['framebuffer']=this[_0x1fe219(0x428,0x3d6)][_0x1fe219(0x36c,0x3d3)][_0x321779];function _0x6d374a(_0x1963cd,_0x3d2d4c){return _0x587de0(_0x1963cd,_0x3d2d4c-0x362);}_0x198ddb['execute'](this['context']);});}['changeOptions'](_0x1653ff){let _0x4e9a29=![];_0x1653ff['particlesTextureSize']&&this[_0x22c2f3(0x16,-0x5)][_0x22c2f3(-0xad,-0xcd)]!==_0x1653ff['particlesTextureSize']&&(_0x4e9a29=!![]);const _0x40097b=deepMerge(_0x1653ff,this['options']);if(_0x40097b['particlesTextureSize']<0x1)throw new Error('particlesTextureSize\x20must\x20be\x20greater\x20than\x200');this[_0x2c654a(0xce,0xe2)]=_0x40097b,this[_0x22c2f3(-0xc1,-0x93)]['updateOptions'](_0x1653ff);function _0x22c2f3(_0x501a18,_0x424aec){return _0x398695(_0x501a18,_0x424aec- -0x1b6);}this[_0x22c2f3(-0x9a,-0x58)][_0x22c2f3(-0x28,-0xb5)](_0x1653ff);function _0x2c654a(_0x553b5a,_0x26cab1){return _0x398695(_0x26cab1,_0x553b5a- -0xe3);}_0x4e9a29&&(this['computing'][_0x22c2f3(-0xee,-0x72)](),this[_0x22c2f3(-0xa6,-0x58)]['createParticlesTextures'](),this['rendering']['onParticlesTextureSizeChange']());}['applyViewerParameters'](_0x48dc54){this[_0x54df7d(0x4af,0x4eb)]=_0x48dc54;function _0x54df7d(_0x55534d,_0x48680d){return _0x398695(_0x48680d,_0x55534d-0x34a);}function _0x472a2c(_0x382924,_0x142e76){return _0x398695(_0x382924,_0x142e76- -0x32);}this[_0x472a2c(0x12b,0x12c)]['viewerParameters']=_0x48dc54,this[_0x54df7d(0x46d,0x428)]['viewerParameters']=_0x48dc54;}['destroy'](){this['computing'][_0x185f52(0x128,0xe7)]();function _0x185f52(_0x1b9e2c,_0x4bb822){return _0x15ab6e(_0x4bb822-0x31,_0x1b9e2c);}this['rendering']['destroy']();}}const Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],_0x4a9db2={};_0x4a9db2['min']=0x1,_0x4a9db2[_0x15ab6e(0x13d,0x1ae)]=0x2;const _0xbb72de={};_0xbb72de['min']=0x14,_0xbb72de[_0x398695(0x25d,0x1fb)]=0x64;const _0x5c1b23={};_0x5c1b23['particlesTextureSize']=0x64,_0x5c1b23['fixedHeight']=0x0,_0x5c1b23['lineWidth']=_0x4a9db2,_0x5c1b23['lineLength']=_0xbb72de,_0x5c1b23[_0x15ab6e(0x11c,0x131)]=0x1,_0x5c1b23[_0x15ab6e(0x85,0x92)]=0.003,_0x5c1b23['dropRateBump']=0.001,_0x5c1b23[_0x398695(0x142,0x131)]=['rgb(206,255,255)'],_0x5c1b23[_0x15ab6e(0x102,0xe6)]=![],_0x5c1b23['dynamic']=!![];const DEF_OPTIONS=_0x5c1b23;class WindLayer extends BaseLayer$1{constructor(_0x257403={}){_0x257403={...DEF_OPTIONS,..._0x257403},super(_0x257403),this['_setOptionsHook'](_0x257403,_0x257403);}get['layer'](){return this['primitives'];}get['data'](){function _0x231d0b(_0x535639,_0x4fab91){return _0x398695(_0x4fab91,_0x535639- -0x1d7);}return this['options'][_0x231d0b(-0x3a,-0x15)];}set['data'](_0x54cfe0){function _0x3b8629(_0x3d1790,_0x4e5423){return _0x15ab6e(_0x3d1790-0x1c6,_0x4e5423);}this['options']['data']=_0x54cfe0,this[_0x3b8629(0x213,0x218)](_0x54cfe0);}get['colors'](){function _0x45ed38(_0x156a2e,_0x32faec){return _0x15ab6e(_0x156a2e- -0x1ec,_0x32faec);}return this[_0x45ed38(-0xf9,-0x16a)]['colors'];}set['colors'](_0x1ab3fa){this[_0xf88164(0x249,0x1e8)]['colors']=_0x1ab3fa;const _0x5f3d76={};_0x5f3d76[_0xf88164(0x1c9,0x231)]=_0x1ab3fa;function _0xf88164(_0x45eb6f,_0x40fa55){return _0x15ab6e(_0x45eb6f-0x156,_0x40fa55);}function _0x3fa7e8(_0x9fab75,_0x16386e){return _0x398695(_0x16386e,_0x9fab75- -0x49);}this['_setOptionsHook'](this['options'],_0x5f3d76);}['_showHook'](_0x2999f2){function _0x387c17(_0x2cc354,_0x269322){return _0x398695(_0x269322,_0x2cc354-0x291);}_0x2999f2?this[_0x387c17(0x48a,0x4a1)]():this['_removedHook']();}['_mountedHook'](){}[_0x398695(0x18b,0x1f9)](){this[_0x46335f(0x5c,0x5c)]=this[_0x4b41f0(0x393,0x3b9)]['scene'],this['camera']=this['_map'][_0x46335f(-0xff,-0x7a)];this['options'][_0x4b41f0(0x432,0x3b5)]&&this['setData'](this['options'][_0x4b41f0(0x432,0x43f)]);if(!this[_0x4b41f0(0x436,0x489)]||!this[_0x46335f(-0x84,-0x10)])return;this[_0x4b41f0(0x3fa,0x40f)]={'lonRange':new Cesium$1[(_0x4b41f0(0x437,0x3c8))](-0xb4,0xb4),'latRange':new Cesium$1[(_0x46335f(0x6d,0x26))](-0x5a,0x5a),'pixelSize':0x3e8,'sceneMode':this[_0x46335f(0x8f,0x5c)]['mode']},this['updateViewerParameters'](),this[_0x46335f(0x48,0x77)]=new WindParticleSystem(this['scene'][_0x4b41f0(0x459,0x461)],this[_0x46335f(-0x39,0x25)],this[_0x4b41f0(0x446,0x3be)],this['viewerParameters'],this['scene']),this[_0x46335f(0x21,-0x4c)]=this['particleSystem']['getPrimitives'](),this['primitives']['forEach'](_0xce905b=>{this['scene']['primitives']['add'](_0xce905b);});function _0x4b41f0(_0x2d4831,_0x3412b0){return _0x15ab6e(_0x2d4831-0x353,_0x3412b0);}this['camera'][_0x4b41f0(0x386,0x38c)]=0.01,this['camera'][_0x4b41f0(0x462,0x4dc)][_0x4b41f0(0x435,0x3ec)](this['updateViewerParameters']['bind'](this)),this[_0x4b41f0(0x46d,0x4bc)]['morphComplete'][_0x46335f(-0xe,0x24)](this['updateViewerParameters']['bind'](this));function _0x46335f(_0x2cbba4,_0x3d01f5){return _0x15ab6e(_0x3d01f5- -0xbe,_0x2cbba4);}window['addEventListener']('resize',this[_0x4b41f0(0x394,0x355)]['bind'](this));}[_0x398695(0x1c1,0x180)](){this[_0x11a13b(-0x13e,-0x100)]['changed']['removeEventListener'](this['updateViewerParameters'][_0x11a13b(-0x116,-0xaf)](this)),this[_0x11a13b(-0x68,-0x43)][_0x11a13b(-0x123,-0x18a)]['removeEventListener'](this['updateViewerParameters'][_0x11a13b(-0x116,-0xdd)](this));function _0x11a13b(_0x3b2237,_0x27ba8e){return _0x398695(_0x27ba8e,_0x3b2237- -0x240);}window[_0x11a13b(-0xa1,-0x92)](_0x5c1156(0x547,0x550),this['updateViewerParameters']['bind'](this));this['primitives']&&(this[_0x5c1156(0x595,0x520)]['forEach'](_0x575214=>{function _0x42afbd(_0x1cd993,_0x2ef93e){return _0x11a13b(_0x1cd993-0x2c4,_0x2ef93e);}function _0x53b456(_0x5588d2,_0x1c5f41){return _0x5c1156(_0x1c5f41,_0x5588d2- -0x2bb);}this['scene'][_0x53b456(0x265,0x2e0)][_0x53b456(0x26b,0x2ca)](_0x575214);}),delete this[_0x5c1156(0x4de,0x520)]);function _0x5c1156(_0x346fc2,_0x2079eb){return _0x15ab6e(_0x2079eb-0x4ae,_0x346fc2);}this['particleSystem']&&(this['particleSystem'][_0x5c1156(0x587,0x564)](),delete this[_0x11a13b(-0x4d,-0x48)]);}[_0x15ab6e(0x4d,0x69)](_0x3ca95c,_0x81c5f5){function _0x42d49c(_0x535597,_0x546b8f){return _0x398695(_0x535597,_0x546b8f-0x347);}function _0x5e54a9(_0x18d172,_0x46afe8){return _0x15ab6e(_0x46afe8- -0x192,_0x18d172);}this['windData']=this['processWindData'](_0x3ca95c);if(_0x81c5f5){this[_0x42d49c(0x4d0,0x4c7)](),this[_0x42d49c(0x4ba,0x540)]();return;}this['particleSystem']?(this['particleSystem'][_0x42d49c(0x47e,0x4a5)][_0x5e54a9(-0x34,-0xbd)](this['windData']),this['scene']['requestRender']()):this[_0x42d49c(0x558,0x540)]();}['_setOptionsHook'](_0x5be140,_0x44e6b1){function _0x34447e(_0xbc597d,_0x2d56e7){return _0x398695(_0xbc597d,_0x2d56e7- -0x4e);}function _0xd6db56(_0x36ce80,_0x5a65b4){return _0x398695(_0x36ce80,_0x5a65b4-0x23e);}this['particleSystem']&&(this['particleSystem']['changeOptions'](_0x44e6b1),this[_0xd6db56(0x393,0x416)][_0x34447e(0x128,0x134)]());}['processWindData'](_0x37a45b){var _0x51b09b,_0x8a7dfa;function _0x135284(_0xee490,_0x38ab3e){return _0x398695(_0x38ab3e,_0xee490- -0x56);}const _0x4edb25={..._0x37a45b},_0x2bed2f=_0x4edb25;!_0x2bed2f[_0xdba0(0x4a7,0x452)]&&_0x2bed2f['rows']&&(_0x2bed2f[_0x135284(0xf6,0x17e)]=_0x2bed2f['rows']);!_0x2bed2f[_0xdba0(0x475,0x46f)]&&_0x2bed2f['cols']&&(_0x2bed2f[_0xdba0(0x4aa,0x46f)]=_0x2bed2f['cols']);!_0x2bed2f['bounds']&&(_0x2bed2f['bounds']={'west':_0x2bed2f['xmin'],'south':_0x2bed2f[_0xdba0(0x447,0x451)],'east':_0x2bed2f['xmax'],'north':_0x2bed2f['ymax']});if(!_0x2bed2f['u']){const _0x4d9ec9={};_0x4d9ec9['array']=_0x37a45b[_0xdba0(0x4fd,0x4fe)],_0x4d9ec9['min']=_0x37a45b[_0xdba0(0x478,0x455)],_0x4d9ec9['max']=_0x37a45b['umax'],_0x2bed2f['u']=_0x4d9ec9;}if(!_0x2bed2f['v']){const _0xfdedb6={};_0xfdedb6['array']=_0x37a45b['vdata'],_0xfdedb6[_0xdba0(0x3de,0x459)]=_0x37a45b[_0xdba0(0x442,0x461)],_0xfdedb6['max']=_0x37a45b['vmax'],_0x2bed2f['v']=_0xfdedb6;}function _0xdba0(_0x8a9336,_0x3cbd11){return _0x15ab6e(_0x3cbd11-0x3c4,_0x8a9336);}if(((_0x51b09b=_0x2bed2f['speed'])===null||_0x51b09b===void 0x0?void 0x0:_0x51b09b[_0xdba0(0x490,0x459)])===undefined||((_0x8a7dfa=_0x2bed2f['speed'])===null||_0x8a7dfa===void 0x0?void 0x0:_0x8a7dfa['max'])===undefined||_0x2bed2f['speed'][_0xdba0(0x44f,0x4bc)]===undefined){const _0x301c5b={'array':new Float32Array(_0x2bed2f['u'][_0x135284(0x160,0xfe)]['length']),'min':Number['MAX_VALUE'],'max':Number[_0xdba0(0x493,0x42f)]};for(let _0x4e1beb=0x0;_0x4e1beb<_0x2bed2f['u']['array'][_0x135284(0xaf,0xb5)];_0x4e1beb++){_0x301c5b['array'][_0x4e1beb]=Math['sqrt'](_0x2bed2f['u'][_0xdba0(0x46c,0x4bc)][_0x4e1beb]*_0x2bed2f['u']['array'][_0x4e1beb]+_0x2bed2f['v']['array'][_0x4e1beb]*_0x2bed2f['v']['array'][_0x4e1beb]),_0x301c5b['array'][_0x4e1beb]!==0x0&&(_0x301c5b['min']=Math[_0x135284(0xfd,0x130)](_0x301c5b['min'],_0x301c5b['array'][_0x4e1beb]),_0x301c5b[_0x135284(0x1a5,0x1e7)]=Math[_0xdba0(0x57e,0x501)](_0x301c5b[_0x135284(0x1a5,0x11c)],_0x301c5b['array'][_0x4e1beb]));}_0x2bed2f['speed']=_0x301c5b;}return _0x2bed2f;}['updateViewerParameters'](){var _0x279783;const _0x149624=this['scene'];if(!_0x149624)return;const _0x12f9f8=_0x149624['canvas'],_0x5c5c36={};_0x5c5c36['x']=0x0,_0x5c5c36['y']=0x0;const _0x3565fc={};_0x3565fc['x']=0x0,_0x3565fc['y']=_0x12f9f8[_0x28c4c4(-0x17f,-0x1f6)];const _0x364ea8={};_0x364ea8['x']=_0x12f9f8['clientWidth'],_0x364ea8['y']=0x0;const _0x10c3d6={};_0x10c3d6['x']=_0x12f9f8[_0x28c4c4(-0x2b6,-0x27b)];function _0x275d28(_0x9101fd,_0x99f8a9){return _0x398695(_0x9101fd,_0x99f8a9-0x2ee);}_0x10c3d6['y']=_0x12f9f8['clientHeight'];const _0x48c57a=[_0x5c5c36,_0x3565fc,_0x364ea8,_0x10c3d6];let _0x207413=0xb4,_0x566bb8=-0xb4,_0x2bf922=0x5a,_0x13b4dc=-0x5a,_0xc6e7bf=![];for(const _0x31bf7b of _0x48c57a){const _0x42ca85=_0x149624['camera']['pickEllipsoid'](new Cesium$1['Cartesian2'](_0x31bf7b['x'],_0x31bf7b['y']),_0x149624['globe']['ellipsoid']);if(!_0x42ca85){_0xc6e7bf=!![];break;}const _0x19d00f=_0x149624['globe'][_0x28c4c4(-0x1f1,-0x247)][_0x28c4c4(-0x23f,-0x254)](_0x42ca85),_0x28e711=Cesium$1['Math'][_0x28c4c4(-0x198,-0x1b4)](_0x19d00f[_0x28c4c4(-0x127,-0x1b3)]),_0x5a35a3=Cesium$1['Math']['toDegrees'](_0x19d00f['latitude']);_0x207413=Math['min'](_0x207413,_0x28e711),_0x566bb8=Math['max'](_0x566bb8,_0x28e711),_0x2bf922=Math[_0x275d28(0x3cb,0x441)](_0x2bf922,_0x5a35a3),_0x13b4dc=Math[_0x275d28(0x54b,0x4e9)](_0x13b4dc,_0x5a35a3);}if(!_0xc6e7bf){const _0x421f00=new Cesium$1['Cartesian2'](Math['max'](this['windData']['bounds'][_0x28c4c4(-0x246,-0x278)],_0x207413),Math[_0x275d28(0x446,0x441)](this['windData']['bounds'][_0x28c4c4(-0x299,-0x28b)],_0x566bb8)),_0x283d07=new Cesium$1[(_0x28c4c4(-0x159,-0x1e0))](Math['max'](this['windData']['bounds'][_0x275d28(0x4bd,0x4dd)],_0x2bf922),Math['min'](this['windData']['bounds']['north'],_0x13b4dc)),_0x28b2a5=(_0x421f00['y']-_0x421f00['x'])*0.05,_0x4b8e82=(_0x283d07['y']-_0x283d07['x'])*0.05;_0x421f00['x']=Math['max'](this[_0x275d28(0x4f0,0x48f)]['bounds']['west'],_0x421f00['x']-_0x28b2a5),_0x421f00['y']=Math['min'](this['windData'][_0x275d28(0x482,0x45c)]['east'],_0x421f00['y']+_0x28b2a5),_0x283d07['x']=Math[_0x275d28(0x4e7,0x4e9)](this[_0x275d28(0x413,0x48f)][_0x28c4c4(-0x1b6,-0x214)]['south'],_0x283d07['x']-_0x4b8e82),_0x283d07['y']=Math[_0x275d28(0x4c4,0x441)](this[_0x275d28(0x45f,0x48f)]['bounds']['north'],_0x283d07['y']+_0x4b8e82),this[_0x275d28(0x445,0x453)]['lonRange']=_0x421f00,this[_0x275d28(0x439,0x453)]['latRange']=_0x283d07;const _0x721cf2=this['windData']['bounds']['east']-this[_0x275d28(0x422,0x48f)][_0x275d28(0x402,0x45c)]['west'],_0xfa7a44=this['windData'][_0x275d28(0x450,0x45c)][_0x28c4c4(-0x218,-0x293)]-this['windData']['bounds'][_0x275d28(0x48b,0x4dd)],_0x4cb89a=(_0x421f00['y']-_0x421f00['x'])/_0x721cf2,_0x2ee415=(_0x283d07['y']-_0x283d07['x'])/_0xfa7a44,_0x5aa294=Math['min'](_0x4cb89a,_0x2ee415),_0x87d742=0x3e8*_0x5aa294;_0x87d742>0x0&&(this['viewerParameters']['pixelSize']=Math[_0x28c4c4(-0x1df,-0x187)](0x0,Math[_0x28c4c4(-0x2b8,-0x22f)](0x3e8,_0x87d742)));}this['viewerParameters']['sceneMode']=this['scene']['mode'];function _0x28c4c4(_0x3f3c24,_0x5151b5){return _0x398695(_0x3f3c24,_0x5151b5- -0x382);}(_0x279783=this['particleSystem'])===null||_0x279783===void 0x0||_0x279783['applyViewerParameters'](this[_0x28c4c4(-0x1f8,-0x21d)]);}['getDataAtLonLat'](_0x5907df,_0x29fba1){const {bounds:_0x3e38d9,width:_0xe3b3c1,height:_0x4e1f6c,u:_0x3488a8,v:_0x28d603,speed:_0x54a428}=this[_0x1c75e0(0x54d,0x51f)],{flipY:_0x7c81af}=this[_0x1c75e0(0x55d,0x5e9)];if(_0x5907df<_0x3e38d9['west']||_0x5907df>_0x3e38d9[_0x578f2c(-0x19d,-0x1ad)]||_0x29fba1<_0x3e38d9['south']||_0x29fba1>_0x3e38d9[_0x578f2c(-0x1a5,-0x20f)])return null;const _0x14554c=(_0x5907df-_0x3e38d9['west'])/(_0x3e38d9[_0x578f2c(-0x19d,-0x129)]-_0x3e38d9['west'])*(_0xe3b3c1-0x1);let _0x29fa8c=(_0x29fba1-_0x3e38d9[_0x1c75e0(0x59b,0x5b8)])/(_0x3e38d9['north']-_0x3e38d9[_0x578f2c(-0xa5,-0xc4)])*(_0x4e1f6c-0x1);function _0x1c75e0(_0x31e2b6,_0x183a12){return _0x398695(_0x183a12,_0x31e2b6-0x3ac);}_0x7c81af&&(_0x29fa8c=_0x4e1f6c-0x1-_0x29fa8c);const _0x1c7d5b=Math[_0x578f2c(-0xd8,-0x89)](_0x14554c),_0x2c07d7=Math[_0x578f2c(-0xd8,-0xf8)](_0x29fa8c),_0x58865e=Math['floor'](_0x14554c),_0x4d37ad=Math['min'](_0x58865e+0x1,_0xe3b3c1-0x1),_0x2ee677=Math['floor'](_0x29fa8c),_0x2f2a4c=Math['min'](_0x2ee677+0x1,_0x4e1f6c-0x1),_0xf7e271=_0x14554c-_0x58865e,_0x652f06=_0x29fa8c-_0x2ee677,_0x560606=_0x2c07d7*_0xe3b3c1+_0x1c7d5b,_0x2c5dd5=_0x2ee677*_0xe3b3c1+_0x58865e,_0x48f51b=_0x2ee677*_0xe3b3c1+_0x4d37ad,_0x389d1b=_0x2f2a4c*_0xe3b3c1+_0x58865e,_0x1dc229=_0x2f2a4c*_0xe3b3c1+_0x4d37ad,_0x599039=_0x3488a8[_0x1c75e0(0x562,0x572)][_0x2c5dd5],_0x395519=_0x3488a8[_0x578f2c(-0xde,-0x16b)][_0x48f51b],_0x3f4b83=_0x3488a8['array'][_0x389d1b],_0x735db5=_0x3488a8['array'][_0x1dc229],_0x349d9d=(0x1-_0xf7e271)*(0x1-_0x652f06)*_0x599039+_0xf7e271*(0x1-_0x652f06)*_0x395519+(0x1-_0xf7e271)*_0x652f06*_0x3f4b83+_0xf7e271*_0x652f06*_0x735db5,_0x2d39f6=_0x28d603[_0x578f2c(-0xde,-0x65)][_0x2c5dd5],_0xc5c13d=_0x28d603['array'][_0x48f51b],_0x31ed7a=_0x28d603['array'][_0x389d1b],_0x2b6c0f=_0x28d603[_0x1c75e0(0x562,0x564)][_0x1dc229],_0x11a6d9=(0x1-_0xf7e271)*(0x1-_0x652f06)*_0x2d39f6+_0xf7e271*(0x1-_0x652f06)*_0xc5c13d+(0x1-_0xf7e271)*_0x652f06*_0x31ed7a+_0xf7e271*_0x652f06*_0x2b6c0f,_0x304236=Math['sqrt'](_0x349d9d*_0x349d9d+_0x11a6d9*_0x11a6d9),_0x5a3100={};_0x5a3100['u']=_0x3488a8[_0x578f2c(-0xde,-0xbb)][_0x560606],_0x5a3100['v']=_0x28d603[_0x578f2c(-0xde,-0xa3)][_0x560606],_0x5a3100[_0x578f2c(-0xff,-0x111)]=_0x54a428['array'][_0x560606];const _0x1bdc6f={};_0x1bdc6f['u']=_0x349d9d,_0x1bdc6f['v']=_0x11a6d9;function _0x578f2c(_0x5711ce,_0x4f8978){return _0x15ab6e(_0x5711ce- -0x1d6,_0x4f8978);}_0x1bdc6f['speed']=_0x304236;const _0x4d6cfb={};return _0x4d6cfb[_0x578f2c(-0xed,-0xa3)]=_0x5a3100,_0x4d6cfb['interpolated']=_0x1bdc6f,_0x4d6cfb;}}mars3d__namespace[_0x398695(0x1f9,0x1e9)][_0x15ab6e(0xcb,0x8a)](_0x398695(0x1a5,0x17d),WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;function _0x398695(_0x5acb99,_0x33ee12){return _0x5cd5(_0x33ee12- -0x29,_0x5acb99);}class CanvasParticle{constructor(){function _0x16e053(_0x19975e,_0x57de8b){return _0x15ab6e(_0x19975e-0x2d4,_0x57de8b);}this[_0x47d8b6(0x28,0x92)]=null;function _0x47d8b6(_0x3eb380,_0x23d4e2){return _0x398695(_0x3eb380,_0x23d4e2- -0xc4);}this['lat']=null,this[_0x47d8b6(0x168,0x132)]=null,this['tlat']=null,this['age']=null,this[_0x16e053(0x3ab,0x411)]=null;}['destroy'](){for(const _0x384e4f in this){delete this[_0x384e4f];}}}class CanvasWindField{constructor(_0x2b0250){this['setOptions'](_0x2b0250);}get['speedRate'](){return this['_speedRate'];}set['speedRate'](_0x89829d){function _0x3519aa(_0x5dea8d,_0x5ea0a4){return _0x398695(_0x5dea8d,_0x5ea0a4- -0x4c);}this['_speedRate']=(0x64-(_0x89829d>0x63?0x63:_0x89829d))*0x64;function _0x851a92(_0xb9af10,_0x7cbac3){return _0x15ab6e(_0x7cbac3-0x36c,_0xb9af10);}this[_0x3519aa(0xe0,0x15c)]=[(this[_0x3519aa(0xa0,0xfe)]-this['xmin'])/this['_speedRate'],(this[_0x3519aa(0x122,0x191)]-this['ymin'])/this[_0x3519aa(0x144,0x150)]];}get['maxAge'](){return this['_maxAge'];}set[_0x398695(0x1ab,0x148)](_0x1acfed){this['_maxAge']=_0x1acfed;}[_0x398695(0xd4,0x132)](_0x342871){function _0x545060(_0x36cc46,_0x107923){return _0x15ab6e(_0x36cc46-0x125,_0x107923);}function _0x2a3d92(_0x1eb740,_0xe08fbb){return _0x398695(_0xe08fbb,_0x1eb740- -0x21c);}this[_0x2a3d92(-0x6b,0x15)]=_0x342871,this[_0x545060(0x1af,0x220)]=_0x342871[_0x545060(0x1af,0x21e)]||0x78,this[_0x545060(0x228,0x23b)]=_0x342871['speedRate']||0x32,this[_0x545060(0x1ff,0x18d)]=[];const _0x14918d=_0x342871['particlesNumber']||0x1000;for(let _0x5f122b=0x0;_0x5f122b<_0x14918d;_0x5f122b++){const _0x3488b2=this[_0x2a3d92(-0x6c,-0xdb)](new CanvasParticle());this['particles']['push'](_0x3488b2);}}['setDate'](_0x2ec748){this[_0x360d48(0x3a7,0x32a)]=_0x2ec748['rows'],this['cols']=_0x2ec748['cols'],this['xmin']=_0x2ec748[_0x21f9da(0x36a,0x3cf)],this[_0x360d48(0x356,0x320)]=_0x2ec748['xmax'],this['ymin']=_0x2ec748['ymin'],this['ymax']=_0x2ec748['ymax'],this[_0x21f9da(0x3ba,0x374)]=[];const _0x24fb5a=_0x2ec748[_0x21f9da(0x41b,0x3ee)],_0x372efe=_0x2ec748['vdata'];let _0x160d47=![];_0x24fb5a['length']===this['rows']&&_0x24fb5a[0x0]['length']===this['cols']&&(_0x160d47=!![]);function _0x21f9da(_0x5f5635,_0x5c7715){return _0x398695(_0x5c7715,_0x5f5635-0x223);}let _0x38deb1=0x0,_0x423c90=null,_0x434959=null;function _0x360d48(_0xf7c9f2,_0x250bd3){return _0x15ab6e(_0x250bd3-0x294,_0xf7c9f2);}for(let _0x287ca1=0x0;_0x287ca1<this['rows'];_0x287ca1++){_0x423c90=[];for(let _0x48f1f1=0x0;_0x48f1f1<this[_0x360d48(0x38d,0x36a)];_0x48f1f1++,_0x38deb1++){_0x160d47?_0x434959=this['_calcUV'](_0x24fb5a[_0x287ca1][_0x48f1f1],_0x372efe[_0x287ca1][_0x48f1f1]):_0x434959=this[_0x360d48(0x323,0x2bd)](_0x24fb5a[_0x38deb1],_0x372efe[_0x38deb1]),_0x423c90[_0x360d48(0x289,0x2f4)](_0x434959);}this['grid']['push'](_0x423c90);}!this['options']['flipY']&&this[_0x21f9da(0x3ba,0x3cd)]['reverse']();}[_0x15ab6e(0x121,0xf2)](){delete this['rows'];function _0x5557df(_0x1605a9,_0x4c093b){return _0x398695(_0x4c093b,_0x1605a9- -0x213);}delete this['cols'];function _0x4b87d6(_0x1367de,_0x2b8b53){return _0x15ab6e(_0x2b8b53-0x70,_0x1367de);}delete this['xmin'],delete this['xmax'],delete this[_0x4b87d6(0x116,0xfd)],delete this['ymax'],delete this['grid'],delete this[_0x5557df(-0x7b,-0x51)];}['toGridXY'](_0x1d77e8,_0x490a15){const _0x2e3fb2=(_0x1d77e8-this[_0x4147f2(-0x29,-0x95)])/(this[_0x4147f2(-0x41,-0x92)]-this[_0x4147f2(-0x3b,-0x95)])*(this['cols']-0x1),_0x225bea=(this['ymax']-_0x490a15)/(this[_0x5000ec(0x1cb,0x195)]-this['ymin'])*(this['rows']-0x1);function _0x5000ec(_0x2f6a19,_0x44fe7d){return _0x15ab6e(_0x44fe7d-0x76,_0x2f6a19);}function _0x4147f2(_0x1fda43,_0x45e91f){return _0x15ab6e(_0x45e91f- -0x11e,_0x1fda43);}return[_0x2e3fb2,_0x225bea];}[_0x15ab6e(0xb8,0x7d)](_0x4f9305,_0x33bcde){function _0x3d6e0a(_0x707870,_0x46c1ec){return _0x15ab6e(_0x707870- -0x18c,_0x46c1ec);}if(_0x4f9305<0x0||_0x4f9305>=this['cols']||_0x33bcde>=this['rows'])return[0x0,0x0,0x0];const _0x810a81=Math['floor'](_0x4f9305),_0x2b0d28=Math[_0x252c60(0x34c,0x33e)](_0x33bcde);if(_0x810a81===_0x4f9305&&_0x2b0d28===_0x33bcde)return this['grid'][_0x33bcde][_0x4f9305];function _0x252c60(_0x1748ec,_0x5a4e7d){return _0x15ab6e(_0x1748ec-0x24e,_0x5a4e7d);}const _0x410178=_0x810a81+0x1,_0x29fb96=_0x2b0d28+0x1,_0x20b522=this['getUVByXY'](_0x810a81,_0x2b0d28),_0x2e9ab2=this[_0x252c60(0x306,0x2fb)](_0x410178,_0x2b0d28),_0x4ca2ed=this['getUVByXY'](_0x810a81,_0x29fb96),_0x414a20=this['getUVByXY'](_0x410178,_0x29fb96);let _0x46acb2=null;try{_0x46acb2=this['_bilinearInterpolation'](_0x4f9305-_0x810a81,_0x33bcde-_0x2b0d28,_0x20b522,_0x2e9ab2,_0x4ca2ed,_0x414a20);}catch(_0x350318){console[_0x252c60(0x2ab,0x22a)](_0x4f9305,_0x33bcde);}return _0x46acb2;}[_0x15ab6e(0x134,0x123)](_0xf2cad4,_0x54e69f,_0x56aed3,_0x51966d,_0x4553e3,_0x5bc7e0){const _0x113df4=0x1-_0xf2cad4,_0x2f33ae=0x1-_0x54e69f,_0x17b49e=_0x113df4*_0x2f33ae,_0x20f63b=_0xf2cad4*_0x2f33ae,_0x4890c6=_0x113df4*_0x54e69f,_0x5048ed=_0xf2cad4*_0x54e69f,_0x7b2094=_0x56aed3[0x0]*_0x17b49e+_0x51966d[0x0]*_0x20f63b+_0x4553e3[0x0]*_0x4890c6+_0x5bc7e0[0x0]*_0x5048ed,_0x27b7dc=_0x56aed3[0x1]*_0x17b49e+_0x51966d[0x1]*_0x20f63b+_0x4553e3[0x1]*_0x4890c6+_0x5bc7e0[0x1]*_0x5048ed;return this['_calcUV'](_0x7b2094,_0x27b7dc);}[_0x15ab6e(0x29,0x19)](_0x939058,_0x375d2d){return[+_0x939058,+_0x375d2d,Math['sqrt'](_0x939058*_0x939058+_0x375d2d*_0x375d2d)];}['getUVByPoint'](_0x4f6e41,_0x4ec093){if(!this[_0x463aa5(-0xe9,-0x10f)](_0x4f6e41,_0x4ec093))return null;function _0x463aa5(_0x34bcc5,_0x1d6c05){return _0x398695(_0x1d6c05,_0x34bcc5- -0x2be);}const _0x5d55df=this['toGridXY'](_0x4f6e41,_0x4ec093),_0x5e2abb=this['getUVByXY'](_0x5d55df[0x0],_0x5d55df[0x1]);return _0x5e2abb;}[_0x15ab6e(0x117,0xba)](_0x1888d4,_0x5b3795){function _0x244fa2(_0x16b043,_0x21503c){return _0x398695(_0x16b043,_0x21503c-0x120);}function _0x46c65b(_0x2d535e,_0x33ba5b){return _0x398695(_0x33ba5b,_0x2d535e-0x227);}return _0x1888d4>=this['xmin']&&_0x1888d4<=this[_0x244fa2(0x2c9,0x26a)]&&_0x5b3795>=this[_0x46c65b(0x372,0x2f5)]&&_0x5b3795<=this['ymax']?!![]:![];}[_0x15ab6e(0x120,0xf7)](){function _0x5efe43(_0xfaa816,_0x477ec8){return _0x15ab6e(_0xfaa816- -0x2e8,_0x477ec8);}const _0x22c33e=fRandomByfloat(this['xmin'],this['xmax']),_0x455215=fRandomByfloat(this[_0x5efe43(-0x25b,-0x2b6)],this['ymax']),_0x4b2f23={};_0x4b2f23['lat']=_0x455215,_0x4b2f23[_0x5efe43(-0x250,-0x20c)]=_0x22c33e;function _0x387840(_0x23b4eb,_0x24e615){return _0x15ab6e(_0x23b4eb-0x2ef,_0x24e615);}return _0x4b2f23;}[_0x398695(0x1d2,0x1ea)](){function _0x52d771(_0x182224,_0x2b46bf){return _0x15ab6e(_0x2b46bf- -0x2b1,_0x182224);}let _0x19ffef,_0x4fb445,_0x31214c;for(let _0x33ce7c=0x0,_0x53e966=this['particles']['length'];_0x33ce7c<_0x53e966;_0x33ce7c++){let _0x5c85eb=this['particles'][_0x33ce7c];_0x5c85eb['age']<=0x0&&(_0x5c85eb=this[_0x45c056(-0x6c,-0xd5)](_0x5c85eb));if(_0x5c85eb['age']>0x0){const _0x3c4f34=_0x5c85eb['tlng'],_0x1fcff7=_0x5c85eb['tlat'];_0x31214c=this[_0x45c056(-0x89,-0xa3)](_0x3c4f34,_0x1fcff7),_0x31214c?(_0x19ffef=_0x3c4f34+this['_calc_speedRate'][0x0]*_0x31214c[0x0],_0x4fb445=_0x1fcff7+this['_calc_speedRate'][0x1]*_0x31214c[0x1],_0x5c85eb['lng']=_0x3c4f34,_0x5c85eb['lat']=_0x1fcff7,_0x5c85eb['tlng']=_0x19ffef,_0x5c85eb['tlat']=_0x4fb445,_0x5c85eb['speed']=_0x31214c[0x2],_0x5c85eb[_0x52d771(-0x182,-0x1df)]--):_0x5c85eb['age']=0x0;}}function _0x45c056(_0x388ef2,_0x412fe5){return _0x398695(_0x388ef2,_0x412fe5- -0x285);}return this[_0x45c056(-0xe8,-0xed)];}['_randomParticle'](_0x554bb3){let _0x5d516a,_0x4208ac;for(let _0x388201=0x0;_0x388201<0x1e;_0x388201++){_0x5d516a=this['getRandomLatLng'](),_0x4208ac=this['getUVByPoint'](_0x5d516a['lng'],_0x5d516a[_0x5b50a4(0x2eb,0x2ba)]);if(_0x4208ac&&_0x4208ac[0x2]>0x0)break;}if(!_0x4208ac)return _0x554bb3;const _0x21841e=_0x5d516a['lng']+this['_calc_speedRate'][0x0]*_0x4208ac[0x0],_0x10cef9=_0x5d516a[_0x5b50a4(0x2af,0x2ba)]+this['_calc_speedRate'][0x1]*_0x4208ac[0x1];function _0x267474(_0x51709d,_0x7f4d86){return _0x398695(_0x51709d,_0x7f4d86-0x97);}_0x554bb3['lng']=_0x5d516a[_0x267474(0x1eb,0x1ed)],_0x554bb3['lat']=_0x5d516a[_0x267474(0x252,0x1d8)],_0x554bb3[_0x267474(0x28c,0x28d)]=_0x21841e,_0x554bb3['tlat']=_0x10cef9;function _0x5b50a4(_0x36c91b,_0x1a1283){return _0x15ab6e(_0x1a1283-0x237,_0x36c91b);}return _0x554bb3[_0x267474(0x200,0x227)]=Math['round'](0xa+Math[_0x5b50a4(0x2b0,0x282)]()*this['maxAge']),_0x554bb3[_0x267474(0x2a2,0x22c)]=_0x4208ac[0x2],_0x554bb3;}['destroy'](){for(const _0x479cdd in this){delete this[_0x479cdd];}}}function fRandomByfloat(_0x5f1069,_0x2d975d){function _0xd9ed13(_0x5eb3ad,_0x3d17eb){return _0x15ab6e(_0x5eb3ad-0x2df,_0x3d17eb);}return _0x5f1069+Math[_0xd9ed13(0x32a,0x2a0)]()*(_0x2d975d-_0x5f1069);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x15ab6e(0x133,0x188)];class CanvasWindLayer extends BaseLayer{constructor(_0x4fe3b3={}){super(_0x4fe3b3);function _0x130579(_0x4bca47,_0x5635ce){return _0x398695(_0x4bca47,_0x5635ce-0x237);}this['_setOptionsHook'](_0x4fe3b3),this['canvas']=null;function _0x2fcdbb(_0x2d4b8d,_0xff712c){return _0x15ab6e(_0x2d4b8d- -0x255,_0xff712c);}_0x4fe3b3['colors']&&_0x4fe3b3[_0x130579(0x395,0x3fa)]&&(this[_0x2fcdbb(-0x21b,-0x1a9)]=new mars3d__namespace['ColorRamp'](_0x4fe3b3));}[_0x15ab6e(0x53,0x92)](_0x255894,_0x5245a1){this['frameTime']=0x3e8/(_0x255894[_0x341379(0x3f7,0x3eb)]||0xa),this[_0x341379(0x3ad,0x419)]=this['options'][_0x391d37(0x5b3,0x531)]??![],this['color']=_0x255894[_0x341379(0x44e,0x4b6)]||'#ffffff';function _0x391d37(_0x445ad1,_0x5bb2c9){return _0x398695(_0x445ad1,_0x5bb2c9-0x3c0);}function _0x341379(_0x44104c,_0x2aa5e7){return _0x15ab6e(_0x44104c-0x37b,_0x2aa5e7);}this['lineWidth']=_0x255894['lineWidth']||0x1,this['fixedHeight']=_0x255894[_0x341379(0x4b1,0x525)]??0x0,this['flipY']=_0x255894[_0x341379(0x47d,0x465)]??![],this['windField']&&this[_0x391d37(0x55b,0x566)][_0x391d37(0x472,0x4f2)](_0x255894);}get['layer'](){return this['canvas'];}get['canvasWidth'](){function _0x594998(_0x2dc142,_0x1822b2){return _0x398695(_0x2dc142,_0x1822b2-0x1fb);}function _0x280ade(_0xb98bf5,_0x6687ab){return _0x15ab6e(_0x6687ab- -0x77,_0xb98bf5);}return this[_0x280ade(0x4d,-0x37)][_0x280ade(0x5e,0xa3)]['canvas']['clientWidth'];}get[_0x398695(0x15d,0x1be)](){function _0x4e27f8(_0x1cd089,_0x179f11){return _0x398695(_0x1cd089,_0x179f11- -0x397);}function _0x4f9515(_0x446b14,_0x48ef94){return _0x15ab6e(_0x446b14-0x12f,_0x48ef94);}return this['_map']['scene'][_0x4e27f8(-0x299,-0x25e)][_0x4e27f8(-0x210,-0x20b)];}get['pointerEvents'](){function _0x4f9c4c(_0x3e5563,_0x4735da){return _0x15ab6e(_0x4735da-0x34b,_0x3e5563);}return this[_0x4f9c4c(0x38d,0x37d)];}set['pointerEvents'](_0x5c14ab){this[_0xc2c0b6(-0x269,-0x22e)]=_0x5c14ab;function _0x413343(_0x3c30be,_0x38b7ca){return _0x398695(_0x3c30be,_0x38b7ca- -0x2d0);}if(!this[_0x413343(-0x1eb,-0x197)])return;function _0xc2c0b6(_0x58c781,_0x1b708c){return _0x15ab6e(_0x1b708c- -0x260,_0x58c781);}_0x5c14ab?this['canvas']['style'][_0xc2c0b6(-0x12d,-0x19f)]=_0x413343(-0x97,-0xed):this['canvas']['style']['pointer-events']='none';}get['particlesNumber'](){return this['options']['particlesNumber'];}set['particlesNumber'](_0xb1e6c2){function _0x53722b(_0x3b4441,_0x4b30e0){return _0x398695(_0x4b30e0,_0x3b4441-0x199);}function _0x9d9b7b(_0x337667,_0x7360b2){return _0x398695(_0x337667,_0x7360b2-0x278);}this[_0x53722b(0x34a,0x339)]['particlesNumber']=_0xb1e6c2,clearTimeout(this['_canrefresh']),this[_0x9d9b7b(0x436,0x474)]=setTimeout(()=>{this['redraw']();},0x1f4);}get[_0x398695(0x23a,0x1c1)](){function _0x421222(_0x2e8a15,_0x5573a4){return _0x15ab6e(_0x2e8a15-0x33d,_0x5573a4);}function _0x39f8f5(_0x41c4aa,_0x3dfc9f){return _0x398695(_0x3dfc9f,_0x41c4aa- -0x6c);}return this[_0x39f8f5(0x145,0x188)][_0x421222(0x440,0x3eb)];}set[_0x15ab6e(0x103,0x136)](_0x1b6c44){function _0x27539d(_0x171f43,_0x3ecd4e){return _0x15ab6e(_0x3ecd4e- -0x201,_0x171f43);}this['options']['speedRate']=_0x1b6c44,this['windField']&&(this['windField'][_0x27539d(-0xdf,-0xfe)]=_0x1b6c44);}get[_0x398695(0x18a,0x148)](){function _0x4001fe(_0x188cb9,_0x248251){return _0x15ab6e(_0x248251-0x420,_0x188cb9);}return this['options'][_0x4001fe(0x507,0x4aa)];}set['maxAge'](_0x20be45){this[_0x5c4cab(0x339,0x2f9)]['maxAge']=_0x20be45;function _0xd10c7e(_0x21157e,_0x4ea284){return _0x398695(_0x4ea284,_0x21157e- -0x1b0);}function _0x5c4cab(_0x420565,_0x2ac785){return _0x15ab6e(_0x2ac785-0x206,_0x420565);}this['windField']&&(this[_0x5c4cab(0x366,0x2ee)]['maxAge']=_0x20be45);}get['data'](){function _0x3f2443(_0x3a6e8c,_0x569a25){return _0x15ab6e(_0x569a25- -0x1f7,_0x3a6e8c);}return this[_0x3f2443(-0xdd,-0x114)];}set[_0x398695(0x146,0x19d)](_0x2e57fb){this['setData'](_0x2e57fb);}get['rectangle'](){function _0x3a0fdb(_0x410dcd,_0x174056){return _0x398695(_0x174056,_0x410dcd- -0x116);}let _0x34bdf6=this[_0x3a0fdb(0x8b,0x10a)]['xmin'],_0x1a4373=this[_0x3a0fdb(0x8b,0x8c)]['xmax'],_0x2ff32c=this['windData'][_0x3a0fdb(0x35,0xaa)],_0x492860=this['windData'][_0x27de6c(0x20,0xa3)];function _0x27de6c(_0x5d467e,_0x548afc){return _0x398695(_0x548afc,_0x5d467e- -0x1bd);}return _0x1a4373>=0x167&&_0x34bdf6===0x0&&(_0x34bdf6=-0xb4,_0x1a4373=0xb4),_0x34bdf6=Math['max'](_0x34bdf6,-0xb4),_0x1a4373=Math['min'](_0x1a4373,0xb4),_0x2ff32c=Math['max'](_0x2ff32c,-0x5a),_0x492860=Math[_0x27de6c(-0x6a,-0x9d)](_0x492860,0x5a),Cesium['Rectangle'][_0x3a0fdb(0x2a,0x50)](_0x34bdf6,_0x2ff32c,_0x1a4373,_0x492860);}['_showHook'](_0x2787f1){function _0x2b2ba2(_0x3a3426,_0x202a09){return _0x398695(_0x202a09,_0x3a3426- -0x19);}function _0x5796af(_0x51618e,_0x41c98f){return _0x398695(_0x41c98f,_0x51618e-0x35);}_0x2787f1?this['_addedHook']():(this[_0x2b2ba2(0x188,0x16a)]&&(this[_0x2b2ba2(0x198,0x15b)]['data']=this['windData']),this[_0x5796af(0x1b5,0x141)]());}['_mountedHook'](){function _0x2897bc(_0x127489,_0x2c1d63){return _0x398695(_0x2c1d63,_0x127489-0x302);}function _0x378a7d(_0x2e8c14,_0x43e497){return _0x15ab6e(_0x2e8c14-0x30,_0x43e497);}this['options']['worker']?this['initWorker']():this[_0x378a7d(0x118,0xac)]=new CanvasWindField(this[_0x2897bc(0x4b3,0x4e4)]);}['_addedHook'](){this[_0x20d581(0x29a,0x211)]=this['_createCanvas']();const _0x208ffb={};_0x208ffb[_0x5c90ee(-0x166,-0x16c)]=!![];function _0x5c90ee(_0x42b056,_0x222284){return _0x398695(_0x222284,_0x42b056- -0x309);}this['canvasContext']=this[_0x5c90ee(-0x1d0,-0x22d)]['getContext']('2d',_0x208ffb),this[_0x5c90ee(-0x1f7,-0x1a9)]();function _0x20d581(_0x29f085,_0x4fc46b){return _0x398695(_0x4fc46b,_0x29f085-0x161);}this[_0x20d581(0x312,0x35b)]['data']&&this[_0x20d581(0x26c,0x2a2)](this[_0x20d581(0x312,0x371)]['data']);}[_0x15ab6e(0xc2,0xb2)](){this['clear']();function _0x89a686(_0x174140,_0x5ee52c){return _0x398695(_0x174140,_0x5ee52c- -0x336);}function _0x3668cd(_0x495a73,_0x255c15){return _0x398695(_0x495a73,_0x255c15-0x7c);}this[_0x3668cd(0x125,0x19b)](),this['canvas']&&(this[_0x3668cd(0x10f,0x17a)]['container']['removeChild'](this[_0x3668cd(0x188,0x1b5)]),delete this[_0x3668cd(0x131,0x1b5)]);}[_0x15ab6e(0x10a,0x11b)](){const _0xffc163=mars3d__namespace[_0x22ceab(0xa1,0x34)]['create']('canvas','mars3d-canvasWind',this['_map']['container']);_0xffc163[_0x22ceab(0xe5,0xc3)]['position']=_0x22ceab(0x4e,0x61);function _0x346b24(_0x4b4f1f,_0x2c73a1){return _0x398695(_0x2c73a1,_0x4b4f1f- -0x118);}_0xffc163['style'][_0x346b24(0xa3,0x58)]='0px',_0xffc163['style'][_0x22ceab(0xc3,0x52)]='0px',_0xffc163[_0x346b24(0x7a,0xb2)]['width']=this[_0x22ceab(0x51,-0x35)]['scene']['canvas']['clientWidth']+'px',_0xffc163['style']['height']=this[_0x346b24(-0x1a,-0x91)][_0x22ceab(0x12b,0x188)]['canvas']['clientHeight']+'px',_0xffc163[_0x346b24(0x7a,0x3e)]['pointerEvents']=this['_pointerEvents']?_0x346b24(-0x24,-0x23):_0x346b24(0x1f,0x84),_0xffc163[_0x346b24(0x7a,0xb7)]['zIndex']=this[_0x346b24(0x99,0x110)]['zIndex']??0x9,_0xffc163['width']=this['_map'][_0x346b24(0xc0,0x6b)]['canvas']['clientWidth'];function _0x22ceab(_0x2a42e4,_0x2e0033){return _0x15ab6e(_0x2a42e4-0x11,_0x2e0033);}return _0xffc163[_0x22ceab(0x9f,0x55)]=this[_0x346b24(-0x1a,-0x44)]['scene']['canvas']['clientHeight'],_0xffc163;}['resize'](){function _0x15d698(_0x1437e3,_0x1bb6e2){return _0x398695(_0x1437e3,_0x1bb6e2-0x2e8);}function _0x29a857(_0x3181dc,_0xcd5d02){return _0x15ab6e(_0xcd5d02-0x230,_0x3181dc);}this['canvas']&&(this[_0x29a857(0x2b8,0x2ab)]['style'][_0x15d698(0x3f2,0x451)]=this[_0x15d698(0x406,0x3e6)][_0x15d698(0x514,0x4c0)]['canvas']['clientWidth']+'px',this[_0x15d698(0x3df,0x421)][_0x15d698(0x4af,0x47a)]['height']=this[_0x15d698(0x3ec,0x3e6)][_0x29a857(0x331,0x34a)]['canvas'][_0x15d698(0x425,0x474)]+'px',this['canvas'][_0x29a857(0x2b6,0x2db)]=this['_map'][_0x15d698(0x43c,0x4c0)]['canvas'][_0x29a857(0x267,0x279)],this['canvas']['height']=this['_map']['scene']['canvas']['clientHeight']);}['bindEvent'](){const _0x9c2aa2=this;let _0x11bf16=Date['now']();function _0x11f269(_0x128d34,_0x4236dd){return _0x15ab6e(_0x4236dd-0x4b5,_0x128d34);}function _0x18c6a4(_0x22339d,_0x3c0596){return _0x398695(_0x3c0596,_0x22339d-0x1c9);}(function _0x35e7e7(){function _0x43852d(_0x959124,_0x5048a2){return _0x5cd5(_0x5048a2-0x3e3,_0x959124);}if(_0x9c2aa2['isDestroy'])return;_0x9c2aa2['_animateFrame']=window['requestAnimationFrame'](_0x35e7e7);if(_0x9c2aa2['show']&&_0x9c2aa2[_0x43852d(0x5a9,0x5b2)]){const _0x1e2b42=Date['now'](),_0x4e5478=_0x1e2b42-_0x11bf16;_0x4e5478>_0x9c2aa2['frameTime']&&(_0x11bf16=_0x1e2b42-_0x4e5478%_0x9c2aa2['frameTime'],_0x9c2aa2['update']());}}(),window['addEventListener'](_0x11f269(0x5d2,0x557),this['resize'][_0x18c6a4(0x2f3,0x2d2)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this[_0x18c6a4(0x37a,0x323)][_0x18c6a4(0x3a4,0x32a)]&&(this[_0x11f269(0x4c1,0x4f5)]['on'](mars3d__namespace[_0x18c6a4(0x3a0,0x3e6)][_0x18c6a4(0x30e,0x303)],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this[_0x11f269(0x510,0x553)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this)));}[_0x398695(0x18e,0x11f)](){window[_0x27bb0c(-0x175,-0x167)](this['_animateFrame']),delete this['_animateFrame'];function _0x27bb0c(_0x1adc15,_0x40f933){return _0x15ab6e(_0x1adc15- -0x27d,_0x40f933);}function _0x151967(_0x5c2cdf,_0x44f14c){return _0x398695(_0x5c2cdf,_0x44f14c- -0x225);}window[_0x27bb0c(-0x19c,-0x1d7)](_0x151967(-0xca,-0xc5),this['resize']),this[_0x27bb0c(-0x18a,-0x138)][_0x27bb0c(-0x160,-0x11a)]&&(this['_map']['off'](mars3d__namespace['EventType'][_0x151967(-0x111,-0xe0)],this['_onMapWhellEvent'],this),this[_0x151967(-0x18b,-0x127)]['off'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType'][_0x151967(-0x178,-0x101)],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace[_0x151967(-0x7a,-0x4e)]['mouseMove'],this[_0x151967(-0x129,-0x140)],this));}[_0x15ab6e(0xb7,0x64)](_0x351ca5){clearTimeout(this[_0x1c9b17(0x4be,0x4fd)]);function _0x17ef07(_0x5ce8ab,_0x398ced){return _0x15ab6e(_0x398ced- -0x149,_0x5ce8ab);}function _0x1c9b17(_0xd10f48,_0x169973){return _0x398695(_0x169973,_0xd10f48-0x35b);}if(!this['show']||!this[_0x1c9b17(0x494,0x506)])return;this['canvas']['style'][_0x17ef07(-0x121,-0xf9)]=_0x1c9b17(0x463,0x4d7),this[_0x17ef07(-0xac,-0xa4)]=setTimeout(()=>{if(!this['show'])return;function _0x5ea866(_0x145f2f,_0x311ee6){return _0x17ef07(_0x311ee6,_0x145f2f-0x4ce);}this[_0x5ea866(0x4b3,0x540)]();function _0x4b3d14(_0x533c3a,_0x55643a){return _0x17ef07(_0x533c3a,_0x55643a-0x407);}this[_0x4b3d14(0x33e,0x339)]['style']['visibility']='visible';},0xc8);}[_0x15ab6e(0x9e,0x5e)](_0x5bb5f1){function _0x3961d2(_0x244078,_0x391ee8){return _0x398695(_0x391ee8,_0x244078- -0x2c);}this[_0x3961d2(0x101,0xa8)]=!![],this[_0x3961d2(0xd2,0x155)][_0x3961d2(0x1a7,0x1df)](mars3d__namespace['EventType'][_0x383bdf(0x14,0x49)],this['_onMouseMoveEvent'],this);function _0x383bdf(_0x296aac,_0x379672){return _0x15ab6e(_0x379672- -0xdd,_0x296aac);}this[_0x383bdf(-0x35,-0x9d)]['on'](mars3d__namespace[_0x383bdf(0x15,0x3c)][_0x383bdf(0x3c,0x49)],this['_onMouseMoveEvent'],this);}[_0x15ab6e(0x27,0x53)](_0x360173){function _0x3cf6ed(_0x4fa3f6,_0x2ad042){return _0x398695(_0x4fa3f6,_0x2ad042-0x17b);}function _0x5eb510(_0x1a5b37,_0x33f6af){return _0x15ab6e(_0x33f6af- -0x72,_0x1a5b37);}if(!this['show']||!this[_0x3cf6ed(0x24a,0x2b4)])return;this['mouse_down']&&(this[_0x3cf6ed(0x2fb,0x2b4)]['style']['visibility']=_0x5eb510(-0x92,-0x28),this['mouse_move']=!![]);}['_onMouseUpEvent'](_0x24f3e3){if(!this['show']||!this['canvas'])return;this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this);this['mouse_down']&&this['mouse_move']&&this['redraw']();this['canvas'][_0x13c3a4(0x51,0x71)]['visibility']='visible';function _0x13c3a4(_0x4af3ea,_0x578c17){return _0x15ab6e(_0x4af3ea- -0x83,_0x578c17);}this['mouse_down']=![],this['mouse_move']=![];}['setData'](_0x255b68){this[_0xac59a9(0x9f,0x60)](),this[_0xac59a9(0x61,0x6d)]=_0x255b68;function _0xac59a9(_0x7f3d3a,_0xb01d07){return _0x15ab6e(_0x7f3d3a- -0x82,_0xb01d07);}this[_0x54c47e(0xe1,0x74)]['setDate'](_0x255b68);function _0x54c47e(_0x169aba,_0x42781f){return _0x15ab6e(_0x169aba- -0x7,_0x42781f);}this['redraw']();}['redraw'](){function _0x46aca3(_0xf0a5ca,_0x37133f){return _0x15ab6e(_0x37133f-0x4b4,_0xf0a5ca);}if(!this['show'])return;this['windField'][_0x46aca3(0x576,0x528)](this['options']);function _0x89697b(_0x34ac2f,_0x378bf4){return _0x398695(_0x378bf4,_0x34ac2f- -0x1bd);}this[_0x89697b(-0x4b,0x24)]();}[_0x15ab6e(0xb4,0x42)](){if(this['_updateIng'])return;function _0x24644d(_0x3d58da,_0x398716){return _0x15ab6e(_0x3d58da-0x29,_0x398716);}this[_0x24644d(0x151,0x136)]=!![];if(this['worker'])this[_0x24644d(0x111,0x110)]['update']();else{const _0x4ae0c9=this['windField']['getParticles']();this[_0x24644d(0x162,0x190)](_0x4ae0c9);}function _0x5ecd94(_0x20b7e3,_0x317963){return _0x398695(_0x317963,_0x20b7e3-0x260);}this['_updateIng']=![];}[_0x398695(0x283,0x1f7)](_0x33bcd3){function _0x16ad59(_0x46750f,_0x532435){return _0x398695(_0x532435,_0x46750f- -0x2a2);}this['_canvasParticles']=_0x33bcd3,this[_0x115501(0x31a,0x2dc)][_0x115501(0x2aa,0x22e)]=_0x115501(0x2bd,0x327);function _0x115501(_0x5cc185,_0x57ae45){return _0x398695(_0x57ae45,_0x5cc185-0x17f);}this['canvasContext'][_0x16ad59(-0x13e,-0x1c2)](0x0,0x0,this[_0x16ad59(-0x18b,-0x1c0)],this[_0x115501(0x33d,0x389)]),this[_0x16ad59(-0x107,-0x150)]['globalCompositeOperation']=_0x115501(0x2de,0x31b),this[_0x115501(0x31a,0x382)][_0x115501(0x379,0x3bb)]=0.9;const _0x103954=this['_map']['scene'][_0x115501(0x30e,0x369)]!==Cesium['SceneMode'][_0x16ad59(-0x1a6,-0x18e)],_0x2a4e94=this['canvasWidth']*0.25;if(this['_colorRamp'])for(let _0xa95140=0x0,_0x500edc=_0x33bcd3[_0x115501(0x284,0x25d)];_0xa95140<_0x500edc;_0xa95140++){const _0x753fe4=_0x33bcd3[_0xa95140],_0x2cc9e8=this['_tomap'](_0x753fe4,_0x753fe4[_0x16ad59(-0x14c,-0x1d7)],_0x753fe4['lat'],_0x753fe4[_0x16ad59(-0x14d,-0x190)]),_0x4087e7=this[_0x115501(0x351,0x34a)](_0x753fe4,_0x753fe4[_0x115501(0x375,0x36c)],_0x753fe4[_0x115501(0x32a,0x387)],_0x753fe4['talt']);if(!_0x2cc9e8||!_0x4087e7)continue;if(_0x103954&&Math[_0x16ad59(-0x186,-0x16d)](_0x2cc9e8[0x0]-_0x4087e7[0x0])>=_0x2a4e94)continue;this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this[_0x16ad59(-0x107,-0x13f)][_0x115501(0x2f8,0x375)]=this['_colorRamp']['getColor'](_0x753fe4[_0x115501(0x314,0x36a)]),this[_0x16ad59(-0x107,-0xb6)]['moveTo'](_0x2cc9e8[0x0],_0x2cc9e8[0x1]),this['canvasContext']['lineTo'](_0x4087e7[0x0],_0x4087e7[0x1]),this['canvasContext'][_0x115501(0x265,0x1ec)]();}else{this[_0x16ad59(-0x107,-0xcc)][_0x115501(0x2c1,0x33b)](),this[_0x16ad59(-0x107,-0xc5)]['lineWidth']=this['lineWidth'],this['canvasContext'][_0x16ad59(-0x129,-0x1aa)]=this[_0x115501(0x310,0x301)];for(let _0x11be1c=0x0,_0x1fac0f=_0x33bcd3[_0x115501(0x284,0x30f)];_0x11be1c<_0x1fac0f;_0x11be1c++){const _0x542362=_0x33bcd3[_0x11be1c],_0x10628a=this['_tomap'](_0x542362,_0x542362['lng'],_0x542362[_0x16ad59(-0x161,-0x13d)],_0x542362[_0x115501(0x2d4,0x33b)]),_0x432c66=this[_0x115501(0x351,0x35f)](_0x542362,_0x542362['tlng'],_0x542362[_0x16ad59(-0xf7,-0x137)],_0x542362[_0x16ad59(-0xef,-0x122)]);if(!_0x10628a||!_0x432c66)continue;if(_0x103954&&Math[_0x115501(0x29b,0x325)](_0x10628a[0x0]-_0x432c66[0x0])>=_0x2a4e94)continue;this['canvasContext']['moveTo'](_0x10628a[0x0],_0x10628a[0x1]),this[_0x115501(0x31a,0x322)][_0x115501(0x2fb,0x380)](_0x432c66[0x0],_0x432c66[0x1]);}this['canvasContext']['stroke']();}}[_0x15ab6e(0x114,0x13b)](_0x4bcd1d,_0x42209f,_0x586e73,_0x441421){const _0x49a381=Cesium['Cartesian3']['fromDegrees'](_0x42209f,_0x586e73,_0x441421??this['fixedHeight']),_0x277901=this['_map']['scene'];if(_0x277901['mode']===Cesium['SceneMode'][_0xd7db68(0x79,0x27)]){const _0x484a88=new Cesium['EllipsoidalOccluder'](_0x277901['globe'][_0x3b542b(0x267,0x2b8)],_0x277901['camera'][_0xd7db68(0xda,0x76)]),_0x1115b3=_0x484a88['isPointVisible'](_0x49a381);if(!_0x1115b3)return _0x4bcd1d['age']=0x0,null;}const _0x3c400e=mars3d__namespace[_0xd7db68(0x67,0xc8)]['toWindowCoordinates'](this['_map']['scene'],_0x49a381);function _0xd7db68(_0x45f80f,_0x25bc34){return _0x398695(_0x25bc34,_0x45f80f- -0x83);}function _0x3b542b(_0x282055,_0x423080){return _0x15ab6e(_0x282055-0x1ea,_0x423080);}return _0x3c400e?[_0x3c400e['x'],_0x3c400e['y']]:null;}[_0x398695(0x205,0x1df)](){function _0xa5a5a5(_0x240a18,_0xa6f468){return _0x15ab6e(_0x240a18-0x356,_0xa6f468);}function _0x57a43a(_0xbe6f47,_0x48c839){return _0x398695(_0x48c839,_0xbe6f47- -0x252);}this[_0x57a43a(-0xac,-0xe3)][_0xa5a5a5(0x477,0x469)](),delete this[_0x57a43a(-0xb1,-0x84)];}['initWorker'](){function _0x6e62f8(_0x43f83c,_0x586e22){return _0x398695(_0x586e22,_0x43f83c-0x276);}this[_0x3b4559(-0x1fa,-0x27d)]=new Worker(this[_0x6e62f8(0x427,0x490)]['worker']);function _0x3b4559(_0x1a79d8,_0x48b8d3){return _0x15ab6e(_0x1a79d8- -0x2c6,_0x48b8d3);}this['worker'][_0x3b4559(-0x232,-0x1c3)]=_0x55fdec=>{this['_drawLines'](_0x55fdec['data'][_0x719e4f(0x506,0x52b)]);function _0x719e4f(_0x21b865,_0x1239f5){return _0x3b4559(_0x1239f5-0x717,_0x21b865);}this['_updateIng2']=![];},this['windField']={'init':_0x5b6277=>{function _0x3e399d(_0x5bd3d9,_0x344d5b){return _0x6e62f8(_0x344d5b- -0x2d4,_0x5bd3d9);}const _0x4c4f3a={};_0x4c4f3a[_0x1a4242(-0x125,-0x136)]=_0x1a4242(-0x10f,-0xfc),_0x4c4f3a['options']=_0x5b6277;function _0x1a4242(_0x7b7a48,_0x2a4e40){return _0x6e62f8(_0x2a4e40- -0x560,_0x7b7a48);}this['worker'][_0x1a4242(-0x138,-0x17d)](_0x4c4f3a);},'setOptions':_0x2bc929=>{const _0x10eb15={};function _0xe1bf40(_0x3e2c19,_0x37b4fd){return _0x6e62f8(_0x37b4fd- -0x130,_0x3e2c19);}_0x10eb15['type']='setOptions',_0x10eb15['options']=_0x2bc929,this['worker'][_0xe1bf40(0x2c7,0x2b3)](_0x10eb15);},'setDate':_0x2fbffa=>{function _0x4b65b4(_0x3bb15b,_0x5ca54f){return _0x6e62f8(_0x3bb15b- -0x49d,_0x5ca54f);}const _0x5560d4={};_0x5560d4['type']='setDate',_0x5560d4['data']=_0x2fbffa,this[_0x4b65b4(-0x9d,-0xb0)]['postMessage'](_0x5560d4);},'update':()=>{if(this['_updateIng2'])return;function _0x2d2d54(_0x3a6c71,_0x48b70b){return _0x3b4559(_0x48b70b-0x3f3,_0x3a6c71);}this['_updateIng2']=!![];const _0x5dce97={};_0x5dce97[_0x2d2d54(0x20e,0x223)]=_0x2d2d54(0x20b,0x1e1);function _0x162ad6(_0x1c4c23,_0x5e6527){return _0x3b4559(_0x5e6527-0x2e6,_0x1c4c23);}this[_0x2d2d54(0x255,0x1f9)][_0x162ad6(0xfd,0xcf)](_0x5dce97);},'clear':()=>{const _0x5a68ee={};function _0x5410da(_0x27b8d0,_0x38f5e9){return _0x6e62f8(_0x38f5e9-0x69,_0x27b8d0);}_0x5a68ee[_0x43ae34(-0x66,-0xea)]='clear';function _0x43ae34(_0x4a6149,_0x4bff7b){return _0x3b4559(_0x4bff7b-0xe6,_0x4a6149);}this['worker'][_0x43ae34(-0xbb,-0x131)](_0x5a68ee);}},this['windField']['init'](this[_0x3b4559(-0x1d3,-0x20f)]);}}mars3d__namespace['LayerUtil']['register']('canvasWind',CanvasWindLayer),mars3d__namespace[_0x15ab6e(0x122,0x1a0)][_0x15ab6e(0x6e,0xc9)]=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace[_0x398695(0x12f,0x199)]=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports[_0x15ab6e(0xdb,0x104)]=WindUtil;const _0x1159a0={};function _0x15ab6e(_0x3595d4,_0x34d134){return _0x5cd5(_0x3595d4- -0xe7,_0x34d134);}_0x1159a0['value']=!![],Object[_0x15ab6e(0x11b,0x159)](exports,_0x15ab6e(0xf0,0xd3),_0x1159a0);
}));
