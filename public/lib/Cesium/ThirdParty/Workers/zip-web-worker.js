(function(){"use strict";const{Array:ae,Object:k,Number:oe,Math:I,Error:b,Uint8Array:g,Uint16Array:ot,Uint32Array:ce,Int32Array:ct,Map:le,DataView:L,Promise:Z,TextEncoder:ue,crypto:V,postMessage:x,TransformStream:v,ReadableStream:Ee,WritableStream:De,CompressionStream:lt,DecompressionStream:ut}=self,he=void 0,F="undefined",X="function",fe=[];for(let t=0;256>t;t++){let e=t;for(let n=0;8>n;n++)1&e?e=e>>>1^3988292384:e>>>=1;fe[t]=e}class J{constructor(e){this.crc=e||-1}append(e){let n=0|this.crc;for(let s=0,r=0|e.length;r>s;s++)n=n>>>8^fe[255&(n^e[s])];this.crc=n}get(){return~this.crc}}class pe extends v{constructor(){let e;const n=new J;super({transform(s,r){n.append(s),r.enqueue(s)},flush(){const s=new g(4);new L(s.buffer).setUint32(0,n.get()),e.value=s}}),e=this}}const S={concat(t,e){if(t.length===0||e.length===0)return t.concat(e);const n=t[t.length-1],s=S.getPartial(n);return s===32?t.concat(e):S._shiftRight(e,s,0|n,t.slice(0,t.length-1))},bitLength(t){const e=t.length;if(e===0)return 0;const n=t[e-1];return 32*(e-1)+S.getPartial(n)},clamp(t,e){if(32*t.length<e)return t;const n=(t=t.slice(0,I.ceil(e/32))).length;return e&=31,n>0&&e&&(t[n-1]=S.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:(t,e,n)=>t===32?e:(n?0|e:e<<32-t)+1099511627776*t,getPartial:t=>I.round(t/1099511627776)||32,_shiftRight(t,e,n,s){for(s===void 0&&(s=[]);e>=32;e-=32)s.push(n),n=0;if(e===0)return s.concat(t);for(let a=0;a<t.length;a++)s.push(n|t[a]>>>e),n=t[a]<<32-e;const r=t.length?t[t.length-1]:0,i=S.getPartial(r);return s.push(S.partial(e+i&31,e+i>32?n:s.pop(),1)),s}},N={bytes:{fromBits(t){const e=S.bitLength(t)/8,n=new g(e);let s;for(let r=0;e>r;r++)3&r||(s=t[r/4]),n[r]=s>>>24,s<<=8;return n},toBits(t){const e=[];let n,s=0;for(n=0;n<t.length;n++)s=s<<8|t[n],3&~n||(e.push(s),s=0);return 3&n&&e.push(S.partial(8*(3&n),s)),e}}},Me=class{constructor(t){const e=this;e.blockSize=512,e._init=[1732584193,4023233417,2562383102,271733878,3285377520],e._key=[1518500249,1859775393,2400959708,3395469782],t?(e._h=t._h.slice(0),e._buffer=t._buffer.slice(0),e._length=t._length):e.reset()}reset(){const t=this;return t._h=t._init.slice(0),t._buffer=[],t._length=0,t}update(t){const e=this;typeof t=="string"&&(t=N.utf8String.toBits(t));const n=e._buffer=S.concat(e._buffer,t),s=e._length,r=e._length=s+S.bitLength(t);if(r>9007199254740991)throw new b("Cannot hash more than 2^53 - 1 bits");const i=new ce(n);let a=0;for(let l=e.blockSize+s-(e.blockSize+s&e.blockSize-1);r>=l;l+=e.blockSize)e._block(i.subarray(16*a,16*(a+1))),a+=1;return n.splice(0,16*a),e}finalize(){const t=this;let e=t._buffer;const n=t._h;e=S.concat(e,[S.partial(1,1)]);for(let s=e.length+2;15&s;s++)e.push(0);for(e.push(I.floor(t._length/4294967296)),e.push(0|t._length);e.length;)t._block(e.splice(0,16));return t.reset(),n}_f(t,e,n,s){return t>19?t>39?t>59?t>79?void 0:e^n^s:e&n|e&s|n&s:e^n^s:e&n|~e&s}_S(t,e){return e<<t|e>>>32-t}_block(t){const e=this,n=e._h,s=ae(80);for(let c=0;16>c;c++)s[c]=t[c];let r=n[0],i=n[1],a=n[2],l=n[3],h=n[4];for(let c=0;79>=c;c++){16>c||(s[c]=e._S(1,s[c-3]^s[c-8]^s[c-14]^s[c-16]));const o=e._S(5,r)+e._f(c,i,a,l)+h+s[c]+e._key[I.floor(c/20)]|0;h=l,l=a,a=e._S(30,i),i=r,r=o}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+l|0,n[4]=n[4]+h|0}},Le={getRandomValues(t){const e=new ce(t.buffer),n=s=>{let r=987654321;const i=4294967295;return()=>(r=36969*(65535&r)+(r>>16)&i,(((r<<16)+(s=18e3*(65535&s)+(s>>16)&i)&i)/4294967296+.5)*(I.random()>.5?1:-1))};for(let s,r=0;r<t.length;r+=4){const i=n(4294967296*(s||I.random()));s=987654071*i(),e[r/4]=4294967296*i()|0}return t}},P={importKey:t=>new P.hmacSha1(N.bytes.toBits(t)),pbkdf2(t,e,n,s){if(n=n||1e4,0>s||0>n)throw new b("invalid params to pbkdf2");const r=1+(s>>5)<<2;let i,a,l,h,c;const o=new ArrayBuffer(r),u=new L(o);let f=0;const d=S;for(e=N.bytes.toBits(e),c=1;(r||1)>f;c++){for(i=a=t.encrypt(d.concat(e,[c])),l=1;n>l;l++)for(a=t.encrypt(a),h=0;h<a.length;h++)i[h]^=a[h];for(l=0;(r||1)>f&&l<i.length;l++)u.setInt32(f,i[l]),f+=4}return o.slice(0,s/8)},hmacSha1:class{constructor(t){const e=this,n=e._hash=Me,s=[[],[]];e._baseHash=[new n,new n];const r=e._baseHash[0].blockSize/32;t.length>r&&(t=new n().update(t).finalize());for(let i=0;r>i;i++)s[0][i]=909522486^t[i],s[1][i]=1549556828^t[i];e._baseHash[0].update(s[0]),e._baseHash[1].update(s[1]),e._resultHash=new n(e._baseHash[0])}reset(){const t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){this._updated=!0,this._resultHash.update(t)}digest(){const t=this,e=t._resultHash.finalize(),n=new t._hash(t._baseHash[1]).update(e).finalize();return t.reset(),n}encrypt(t){if(this._updated)throw new b("encrypt on already updated hmac called!");return this.update(t),this.digest(t)}}},Ze=typeof V!=F&&typeof V.getRandomValues==X,de="Invalid password",we="Invalid signature",ge="zipjs-abort-check-password";function _e(t){return Ze?V.getRandomValues(t):Le.getRandomValues(t)}const T=16,me={name:"PBKDF2"},Fe=k.assign({hash:{name:"HMAC"}},me),Q=k.assign({iterations:1e3,hash:{name:"SHA-1"}},me),Ne=["deriveBits"],U=[8,12,16],W=[16,24,32],q=10,Oe=[0,0,0,0],O=typeof V!=F,E=O&&V.subtle,ye=O&&typeof E!=F,A=N.bytes,je=class{constructor(t){const e=this;e._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],e._tables[0][0][0]||e._precompute();const n=e._tables[0][4],s=e._tables[1],r=t.length;let i,a,l,h=1;if(r!==4&&r!==6&&r!==8)throw new b("invalid aes key size");for(e._key=[a=t.slice(0),l=[]],i=r;4*r+28>i;i++){let c=a[i-1];(i%r===0||r===8&&i%r===4)&&(c=n[c>>>24]<<24^n[c>>16&255]<<16^n[c>>8&255]<<8^n[255&c],i%r===0&&(c=c<<8^c>>>24^h<<24,h=h<<1^283*(h>>7))),a[i]=a[i-r]^c}for(let c=0;i;c++,i--){const o=a[3&c?i:i-4];l[c]=4>=i||4>c?o:s[0][n[o>>>24]]^s[1][n[o>>16&255]]^s[2][n[o>>8&255]]^s[3][n[255&o]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){const t=this._tables[0],e=this._tables[1],n=t[4],s=e[4],r=[],i=[];let a,l,h,c;for(let o=0;256>o;o++)i[(r[o]=o<<1^283*(o>>7))^o]=o;for(let o=a=0;!n[o];o^=l||1,a=i[a]||1){let u=a^a<<1^a<<2^a<<3^a<<4;u=u>>8^255&u^99,n[o]=u,s[u]=o,c=r[h=r[l=r[o]]];let f=16843009*c^65537*h^257*l^16843008*o,d=257*r[u]^16843008*u;for(let p=0;4>p;p++)t[p][o]=d=d<<24^d>>>8,e[p][u]=f=f<<24^f>>>8}for(let o=0;5>o;o++)t[o]=t[o].slice(0),e[o]=e[o].slice(0)}_crypt(t,e){if(t.length!==4)throw new b("invalid aes block size");const n=this._key[e],s=n.length/4-2,r=[0,0,0,0],i=this._tables[e],a=i[0],l=i[1],h=i[2],c=i[3],o=i[4];let u,f,d,p=t[0]^n[0],w=t[e?3:1]^n[1],_=t[2]^n[2],y=t[e?1:3]^n[3],z=4;for(let H=0;s>H;H++)u=a[p>>>24]^l[w>>16&255]^h[_>>8&255]^c[255&y]^n[z],f=a[w>>>24]^l[_>>16&255]^h[y>>8&255]^c[255&p]^n[z+1],d=a[_>>>24]^l[y>>16&255]^h[p>>8&255]^c[255&w]^n[z+2],y=a[y>>>24]^l[p>>16&255]^h[w>>8&255]^c[255&_]^n[z+3],z+=4,p=u,w=f,_=d;for(let H=0;4>H;H++)r[e?3&-H:H]=o[p>>>24]<<24^o[w>>16&255]<<16^o[_>>8&255]<<8^o[255&y]^n[z++],u=p,p=w,w=_,_=y,y=u;return r}},Ge=class{constructor(t,e){this._prf=t,this._initIv=e,this._iv=e}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if(255&~(t>>24))t+=1<<24;else{let e=t>>16&255,n=t>>8&255,s=255&t;e===255?(e=0,n===255?(n=0,s===255?s=0:++s):++n):++e,t=0,t+=e<<16,t+=n<<8,t+=s}return t}incCounter(t){(t[0]=this.incWord(t[0]))===0&&(t[1]=this.incWord(t[1]))}calculate(t,e,n){let s;if(!(s=e.length))return[];const r=S.bitLength(e);for(let i=0;s>i;i+=4){this.incCounter(n);const a=t.encrypt(n);e[i]^=a[0],e[i+1]^=a[1],e[i+2]^=a[2],e[i+3]^=a[3]}return S.clamp(e,r)}},Xe=P.hmacSha1;let be=O&&ye&&typeof E.importKey==X,Se=O&&ye&&typeof E.deriveBits==X;class Je extends v{constructor({password:e,rawPassword:n,signed:s,encryptionStrength:r,checkPasswordOnly:i}){super({start(){k.assign(this,{ready:new Z(a=>this.resolveReady=a),password:ve(e,n),signed:s,strength:r-1,pending:new g})},async transform(a,l){const h=this,{password:c,strength:o,resolveReady:u,ready:f}=h;c?(await(async(p,w,_,y)=>{const z=await ke(p,w,_,C(y,0,U[w])),H=C(y,U[w]);if(z[0]!=H[0]||z[1]!=H[1])throw new b(de)})(h,o,c,C(a,0,U[o]+2)),a=C(a,U[o]+2),i?l.error(new b(ge)):u()):await f;const d=new g(a.length-q-(a.length-q)%T);l.enqueue(ze(h,a,d,0,q,!0))},async flush(a){const{signed:l,ctr:h,hmac:c,pending:o,ready:u}=this;if(c&&h){await u;const f=C(o,0,o.length-q),d=C(o,o.length-q);let p=new g;if(f.length){const w=M(A,f);c.update(w);const _=h.update(w);p=D(A,_)}if(l){const w=C(D(A,c.digest()),0,q);for(let _=0;q>_;_++)if(w[_]!=d[_])throw new b(we)}a.enqueue(p)}}})}}class Qe extends v{constructor({password:e,rawPassword:n,encryptionStrength:s}){let r;super({start(){k.assign(this,{ready:new Z(i=>this.resolveReady=i),password:ve(e,n),strength:s-1,pending:new g})},async transform(i,a){const l=this,{password:h,strength:c,resolveReady:o,ready:u}=l;let f=new g;h?(f=await(async(p,w,_)=>{const y=_e(new g(U[w]));return Y(y,await ke(p,w,_,y))})(l,c,h),o()):await u;const d=new g(f.length+i.length-i.length%T);d.set(f,0),a.enqueue(ze(l,i,d,f.length,0))},async flush(i){const{ctr:a,hmac:l,pending:h,ready:c}=this;if(l&&a){await c;let o=new g;if(h.length){const u=a.update(M(A,h));l.update(u),o=D(A,u)}r.signature=D(A,l.digest()).slice(0,q),i.enqueue(Y(o,r.signature))}}}),r=this}}function ze(t,e,n,s,r,i){const{ctr:a,hmac:l,pending:h}=t,c=e.length-r;let o;for(h.length&&(e=Y(h,e),n=((u,f)=>{if(f&&f>u.length){const d=u;(u=new g(f)).set(d,0)}return u})(n,c-c%T)),o=0;c-T>=o;o+=T){const u=M(A,C(e,o,o+T));i&&l.update(u);const f=a.update(u);i||l.update(f),n.set(D(A,f),o+s)}return t.pending=C(e,o),n}async function ke(t,e,n,s){t.password=null;const r=await(async(o,u,f,d,p)=>{if(!be)return P.importKey(u);try{return await E.importKey("raw",u,f,!1,p)}catch{return be=!1,P.importKey(u)}})(0,n,Fe,0,Ne),i=await(async(o,u,f)=>{if(!Se)return P.pbkdf2(u,o.salt,Q.iterations,f);try{return await E.deriveBits(o,u,f)}catch{return Se=!1,P.pbkdf2(u,o.salt,Q.iterations,f)}})(k.assign({salt:s},Q),r,8*(2*W[e]+2)),a=new g(i),l=M(A,C(a,0,W[e])),h=M(A,C(a,W[e],2*W[e])),c=C(a,2*W[e]);return k.assign(t,{keys:{key:l,authentication:h,passwordVerification:c},ctr:new Ge(new je(l),ae.from(Oe)),hmac:new Xe(h)}),c}function ve(t,e){return e===he?(n=>{if(typeof ue==F){const s=new g((n=unescape(encodeURIComponent(n))).length);for(let r=0;r<s.length;r++)s[r]=n.charCodeAt(r);return s}return new ue().encode(n)})(t):e}function Y(t,e){let n=t;return t.length+e.length&&(n=new g(t.length+e.length),n.set(t,0),n.set(e,t.length)),n}function C(t,e,n){return t.subarray(e,n)}function D(t,e){return t.fromBits(e)}function M(t,e){return t.toBits(e)}class Ye extends v{constructor({password:e,passwordVerification:n,checkPasswordOnly:s}){super({start(){k.assign(this,{password:e,passwordVerification:n}),Be(this,e)},transform(r,i){const a=this;if(a.password){const l=He(a,r.subarray(0,12));if(a.password=null,l.at(-1)!=a.passwordVerification)throw new b(de);r=r.subarray(12)}s?i.error(new b(ge)):i.enqueue(He(a,r))}})}}class $e extends v{constructor({password:e,passwordVerification:n}){super({start(){k.assign(this,{password:e,passwordVerification:n}),Be(this,e)},transform(s,r){const i=this;let a,l;if(i.password){i.password=null;const h=_e(new g(12));h[11]=i.passwordVerification,a=new g(s.length+h.length),a.set(Ce(i,h),0),l=12}else a=new g(s.length),l=0;a.set(Ce(i,s),l),r.enqueue(a)}})}}function He(t,e){const n=new g(e.length);for(let s=0;s<e.length;s++)n[s]=Ae(t)^e[s],$(t,n[s]);return n}function Ce(t,e){const n=new g(e.length);for(let s=0;s<e.length;s++)n[s]=Ae(t)^e[s],$(t,e[s]);return n}function Be(t,e){const n=[305419896,591751049,878082192];k.assign(t,{keys:n,crcKey0:new J(n[0]),crcKey2:new J(n[2])});for(let s=0;s<e.length;s++)$(t,e.charCodeAt(s))}function $(t,e){let[n,s,r]=t.keys;t.crcKey0.append([e]),n=~t.crcKey0.get(),s=Ie(I.imul(Ie(s+Re(n)),134775813)+1),t.crcKey2.append([s>>>24]),r=~t.crcKey2.get(),t.keys=[n,s,r]}function Ae(t){const e=2|t.keys[2];return Re(I.imul(e,1^e)>>>8)}function Re(t){return 255&t}function Ie(t){return 4294967295&t}class et extends v{constructor(e,{chunkSize:n,CompressionStreamZlib:s,CompressionStream:r}){super({});const{compressed:i,encrypted:a,useCompressionStream:l,zipCrypto:h,signed:c,level:o}=e,u=this;let f,d,p=super.readable;a&&!h||!c||(f=new pe,p=R(p,f)),i&&(p=Ke(p,l,{level:o,chunkSize:n},r,s,r)),a&&(h?p=R(p,new $e(e)):(d=new Qe(e),p=R(p,d))),qe(u,p,()=>{let w;a&&!h&&(w=d.signature),a&&!h||!c||(w=new L(f.value.buffer).getUint32(0)),u.signature=w})}}class tt extends v{constructor(e,{chunkSize:n,DecompressionStreamZlib:s,DecompressionStream:r}){super({});const{zipCrypto:i,encrypted:a,signed:l,signature:h,compressed:c,useCompressionStream:o,deflate64:u}=e;let f,d,p=super.readable;a&&(i?p=R(p,new Ye(e)):(d=new Je(e),p=R(p,d))),c&&(p=Ke(p,o,{chunkSize:n,deflate64:u},r,s,r)),a&&!i||!l||(f=new pe,p=R(p,f)),qe(this,p,()=>{if((!a||i)&&l){const w=new L(f.value.buffer);if(h!=w.getUint32(0,!1))throw new b(we)}})}}function qe(t,e,n){e=R(e,new v({flush:n})),k.defineProperty(t,"readable",{get:()=>e})}function Ke(t,e,n,s,r,i){const a=e&&s?s:r||i,l=n.deflate64?"deflate64-raw":"deflate-raw";try{t=R(t,new a(l,n))}catch(h){if(!e)throw h;if(r)t=R(t,new r(l,n));else{if(!i)throw h;t=R(t,new i(l,n))}}return t}function R(t,e){return t.pipeThrough(e)}const Pe="data",Te="close";class nt extends v{constructor(e,n){super({});const s=this,{codecType:r}=e;let i;r.startsWith("deflate")?i=et:r.startsWith("inflate")&&(i=tt),s.outputSize=0;let a=0;const l=new i(e,n),h=super.readable,c=new v({transform(u,f){u&&u.length&&(a+=u.length,f.enqueue(u))},flush(){k.assign(s,{inputSize:a})}}),o=new v({transform(u,f){if(u&&u.length&&(f.enqueue(u),s.outputSize+=u.length,e.outputSize!==he&&s.outputSize>e.outputSize))throw new b("Invalid uncompressed size")},flush(){const{signature:u}=l;k.assign(s,{signature:u,inputSize:a})}});k.defineProperty(s,"readable",{get:()=>h.pipeThrough(c).pipeThrough(l).pipeThrough(o)})}}class st extends v{constructor(e){let n;super({transform:function s(r,i){if(n){const a=new g(n.length+r.length);a.set(n),a.set(r,n.length),r=a,n=null}r.length>e?(i.enqueue(r.slice(0,e)),s(r.slice(e),i)):n=r},flush(s){n&&n.length&&s.enqueue(n)}})}}let m,j,B,ee;function Ve(t,e,n={}){const s=typeof n.level=="number"?n.level:-1,r=typeof n.outBuffer=="number"?n.outBuffer:65536,i=typeof n.inBufferSize=="number"?n.inBufferSize:65536;return new v({start(){let a;if(this.out=j(r),this.in=j(i),this.inBufferSize=i,this._scratch=new g(r),t?(this._process=m.deflate_process,this._last_consumed=m.deflate_last_consumed,this._end=m.deflate_end,this.streamHandle=m.deflate_new(),a=e==="gzip"?m.deflate_init_gzip(this.streamHandle,s):e==="deflate-raw"?m.deflate_init_raw(this.streamHandle,s):m.deflate_init(this.streamHandle,s)):e==="deflate64-raw"?(this._process=m.inflate9_process,this._last_consumed=m.inflate9_last_consumed,this._end=m.inflate9_end,this.streamHandle=m.inflate9_new(),a=m.inflate9_init_raw(this.streamHandle)):(this._process=m.inflate_process,this._last_consumed=m.inflate_last_consumed,this._end=m.inflate_end,this.streamHandle=m.inflate_new(),a=e==="deflate-raw"?m.inflate_init_raw(this.streamHandle):e==="gzip"?m.inflate_init_gzip(this.streamHandle):m.inflate_init(this.streamHandle)),a!==0)throw new b("init failed:"+a)},transform(a,l){try{const h=a,c=new g(ee.buffer),o=this._process,u=this._last_consumed,f=this.out,d=this._scratch;let p=0;for(;p<h.length;){const w=I.min(h.length-p,32768);this.in&&this.inBufferSize>=w||(this.in&&B&&B(this.in),this.in=j(w),this.inBufferSize=w),c.set(h.subarray(p,p+w),this.in);const _=o(this.streamHandle,this.in,w,f,r,0);if(!t&&0>_)throw new b("process error:"+_);const y=16777215&_;y&&(d.set(c.subarray(f,f+y),0),l.enqueue(d.slice(0,y)));const z=u(this.streamHandle);if(z===0)break;p+=z}}catch(h){this._end&&this.streamHandle&&this._end(this.streamHandle),this.in&&B&&B(this.in),this.out&&B&&B(this.out),l.error(h)}},flush(a){try{const l=new g(ee.buffer),h=this._process,c=this.out,o=this._scratch;for(;;){const u=h(this.streamHandle,0,0,c,r,4);if(!t&&0>u)throw new b("process error:"+u);const f=16777215&u,d=u>>24&255;if(f&&(o.set(l.subarray(c,c+f),0),a.enqueue(o.slice(0,f))),d===1||f===0)break}}catch(l){a.error(l)}finally{if(this._end&&this.streamHandle){const l=this._end(this.streamHandle);l!==0&&a.error(new b("end error:"+l))}this.in&&B&&B(this.in),this.out&&B&&B(this.out)}}})}class rt{constructor(e="deflate",n){return Ve(!0,e,n)}}class it{constructor(e="deflate",n){return Ve(!1,e,n)}}let te=!1;const ne=new le,se=new le;let re,K=0;async function at(t){try{const{options:e,config:n}=t;te||e.useCompressionStream||await(async(u,{baseURI:f})=>{if(!te){let p,w;try{try{w=new URL(u,f)}catch{}p=await(await fetch(w)).arrayBuffer()}catch(_){if(!u.startsWith("data:application/wasm;base64,"))throw _;p=(y=>{const z=y.split(",")[1],H=atob(z),Ue=H.length,We=new g(Ue);for(let G=0;Ue>G;++G)We[G]=H.charCodeAt(G);return We.buffer})(u)}d=(await WebAssembly.instantiate(p)).instance.exports,m=d,{malloc:j,free:B,memory:ee}=m,te=!0}var d})(t.config.wasmURI,t.config),n.CompressionStream=self.CompressionStream,n.DecompressionStream=self.DecompressionStream,n.CompressionStreamZlib=rt,n.DecompressionStreamZlib=it;const s={highWaterMark:1},r=t.readable||new Ee({async pull(u){const f=new Z(w=>ne.set(K,w));ie({type:"pull",messageId:K}),K=(K+1)%oe.MAX_SAFE_INTEGER;const{value:d,done:p}=await f;u.enqueue(d),p&&u.close()}},s),i=t.writable||new De({async write(u){let f;const d=new Z(p=>f=p);se.set(K,f),ie({type:Pe,value:u,messageId:K}),K=(K+1)%oe.MAX_SAFE_INTEGER,await d}},s),a=new nt(e,n);re=new AbortController;const{signal:l}=re;await r.pipeThrough(a).pipeThrough(new st(n.chunkSize)).pipeTo(i,{signal:l,preventClose:!0,preventAbort:!0}),await i.getWriter().close();const{signature:h,inputSize:c,outputSize:o}=a;ie({type:Te,result:{signature:h,inputSize:c,outputSize:o}})}catch(e){e.outputSize=0,xe(e)}}function ie(t){let{value:e}=t;if(e)if(e.length)try{e=new g(e),t.value=e.buffer,x(t,[t.value])}catch{x(t)}else x(t);else x(t)}function xe(t=new b("Unknown error")){const{message:e,stack:n,code:s,name:r,outputSize:i}=t;x({error:{message:e,stack:n,code:s,name:r,outputSize:i}})}addEventListener("message",({data:t})=>{const{type:e,messageId:n,value:s,done:r}=t;try{if(e=="start"&&at(t),e==Pe){const i=ne.get(n);ne.delete(n),i({value:new g(s),done:r})}if(e=="ack"){const i=se.get(n);se.delete(n),i()}e==Te&&re.abort()}catch(i){xe(i)}})})();
